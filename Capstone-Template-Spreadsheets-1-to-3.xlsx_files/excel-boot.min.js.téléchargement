var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(t){var i={};function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(i){return t[i]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=24)}({24:function(t,i,e){"use strict";e.r(i);var n,o,r,s=function(){function t(){}return t.prototype.u=function(){},t.prototype.shipAssertTag=function(){},t.prototype.debugAssertTag=function(){},t}();(o=n||(n={}))[o.Error=10]="Error",o[o.Warning=15]="Warning",o[o.Info=50]="Info",o[o.Verbose=100]="Verbose",o[o.Spam=200]="Spam",function(t){t[t.h=0]="msoulscat_ES_EWAJS",t[t.v=1]="msoulscat_ES_EWAJSGrid",t[t.g=6]="msoulscat_ES_EWAJSChart",t[t._=301]="msoulscat_Wac_WordViewer",t[t.O=306]="msoulscat_Wac_BrowserGeneral",t[t.A=320]="msoulscat_Wac_TaskPane",t[t.U=339]="msoulscat_Wac_OneNoteGeneral",t[t.R=340]="msoulscat_Wac_Ribbon",t[t.P=379]="msoulscat_Wac_WopiPendingApplication",t[t.W=383]="msoulscat_Wac_Telemetry",t[t.F=391]="msoulscat_Wac_WacCatchUpActivities",t[t.N=394]="msoulscat_Wac_Dictation",t[t.k=395]="msoulscat_Wac_OneNoteSync",t[t.B=700]="msoulscat_Wac_VisioApp",t[t.H=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.J=800]="msoulscat_Wac_PptAnimation",t[t.j=833]="msoulscat_Wac_PptLive",t[t.q=834]="msoulscat_Wac_PptMWeb",t[t.X=815]="msoulscat_Wac_PptShape",t[t.Z=817]="msoulscat_Wac_PptSession",t[t.$=830]="msoulscat_Wac_PptSlideshow",t[t.K=2300]="msoulscat_Wac_VersionHistory",t[t.Y=302]="msoulscat_Wac_WordPresence",t[t.tt=3005]="msoulscat_Wac_WordVersionHistory",t[t.et=3006]="msoulscat_Wac_LivePersonaCard",t[t.nt=3012]="msoulscat_Wac_CatchUpFlyout"}(r||(r={}));var a;(function(){function t(){}t.tagIntToString=function(i){return i<=t.maxNumericTag?i.toString():i>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i):t.map.charAt(i>>24&63)+t.map.charAt(i>>18&63)+t.map.charAt(i>>12&63)+t.map.charAt(i>>6&63)+t.map.charAt(63&i)},t.getLogMessage=function(i,e,n){return"tag_"+t.tagIntToString(i)+" ["+r[e]+"] "+n},t.prototype.u=function(i,e,o,r){var s=console.log;switch(o){case n.Error:s=console.error;break;case n.Warning:s=console.warn;break;case n.Info:s=console.info;break;case n.Verbose:s=console.debug;break;case n.Spam:default:s=console.log}try{s(t.getLogMessage(i,e,r))}catch(t){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw t}},t.prototype.shipAssertTag=function(i,e,n,o){console.assert(n,t.getLogMessage(i,e,o))},t.prototype.debugAssertTag=function(t,i,e,n){this.shipAssertTag(t,i,e,n)},t.maxNumericTag=65535,t.minOldSchemeHighByteValue=36,t.map="abcdefghijklmnopqrstuvwxyz0123456789"})(),new(function(){function t(){this.externalLogger=new s}return t.prototype.setLogger=function(t){this.externalLogger=t},t.prototype.u=function(t,i,e,n){this.externalLogger.u(t,i,e,n)},t.prototype.debugAssertTag=function(t,i,e,n){this.externalLogger.debugAssertTag(t,i,e,n)},t.prototype.shipAssertTag=function(t,i,e,n){this.externalLogger.shipAssertTag(t,i,e,n)},t}());function c(t,i,e){if(""!==i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",i,e),n.send(t))}}function u(t,i,e,n){var o=t.map((function(t){return function(t,i){var e={};e.G=t.tag,e.T=t.timestamp-i,e.M=t.message,e.C=t.category;var n=1e3*t.type+t.level;return e.D=n,e}(t,n)})),r=function(t,i,e,n){var o={};return o.T=t,o.L=i,o.S=e,o.I=n,o.V=1,o}(n,o,i,e);return JSON.stringify(r)}!function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(a||(a={}));!function(){function t(i,e){var n=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){n.triggerUpload(!1,!1)},this.flush=function(){n.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(i,e){(window.clearTimeout(n.timeoutId),n.logCache.length>0)&&(n.uploadId+=1,c(u(n.logCache,n.userSessionId,n.uploadId,n.timestampBase),n.remoteUrlEndpoint,e),n.logCache=[],n.timestampBase=Date.now());i&&(n.timeoutId=window.setTimeout(n.triggerUploadAsync,t.uploadCadenceInMsSec))},this.userSessionId=i,this.remoteUrlEndpoint=e+"?usid="+i,window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)}t.prototype.handleTrace=function(i){i.message.length>t.messageMaxChars&&(i.message=i.message.substr(0,t.messageMaxChars-t.trimmedMessage.length)+t.trimmedMessage),this.logCache.push(i),(this.logCache.length>t.uploadTriggerSize||i.level===n.Error)&&this.triggerUploadAsync()},t.messageMaxChars=3072,t.uploadCadenceInMsSec=3e4,t.uploadTriggerSize=30,t.trimmedMessage="... [Trimmed]"}();n.Info;var h=function(t,i){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};var f=function(){return(f=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)};var l;!function(t){function i(){return null!==t&&t.apply(this,arguments)||this}(function(t,i){function e(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)})(i,t)}(s);function d(){if(null!=navigator&&null!=navigator.userAgent){var t=navigator.userAgent;if(t.indexOf("Firefox")>-1)return l.Firefox;if(t.indexOf("Opera")>-1)return l.Opera;if(t.indexOf("Trident")>-1)return l.IE;if(t.indexOf("Edge")>-1)return l.Edge;if(t.indexOf("Chrome")>-1)return l.Chrome;if(t.indexOf("Safari")>-1)return l.Safari}return l.Unknown}!function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.Unknown=6]="Unknown"}(l||(l={}));var p=function(){try{var t=window.performance;return t&&t.now&&t.now()!==1/0}catch(t){return!1}}();function v(){try{return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&m()&&!(navigator.userAgent.indexOf("iPhone")>=0)||navigator.userAgent.indexOf("Android")>=0||m()}catch(t){return!1}}function w(){return d()===l.IE&&!function(){if(d()!==l.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function m(){return navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function g(t){return 8===t.toLowerCase().indexOf("ffc")}function S(t){return 8===t.toLowerCase().indexOf("ppc")}function _(t){var i=t.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!i)throw new Error("Invalid URL");return i[1]}function b(t,i){var e=t.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!e)throw new Error("Invalid URL");var n=e[2];if(void 0===i)return n;if(i<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(i+1)).join(".")}function y(t,i){var e=t.indexOf("&"+i+"=");if(-1===e&&(e=t.indexOf("?"+i+"=")),-1===e)return"";var n=e+(i.length+2),o=t.indexOf("&",n);return t.substring(n,-1===o?void 0:o)}function I(t,i,e,n){if(void 0===n&&(n=!1),!e)return t;var o=t,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=i.toLowerCase()+"=",c=o.toLowerCase().indexOf(a,r);if("?"!==s&&c>=0){if(n){var u=o.indexOf("&",c);o=o.substring(0,c)+a+e+(-1===u?"":o.substring(u))}return o}return o.concat(s,a,e)}function O(t){if(!t)return"";var i=-1===t.indexOf("#")?t.length:t.indexOf("#"),e=t.lastIndexOf("/",i);if(-1!==e&&e+1===t.indexOf("://")+"://".length)return"";e+=1;var n=t.indexOf("?");if(-1!==(n=n>=i?-1:n)&&e>n)return"";var o=-1===n?i:n;return e>=o?"":t.substring(e,o)}var E,T=(E=d())===l.Firefox||E===l.IE?"prefetch":"preload";var C={en:"1033",cs:"1029",da:"1030",de:"1031",el:"1032",fi:"1035",fr:"1036",hu:"1038",it:"1040",ja:"1041",ko:"1042",nl:"1043",nb:"1044",sk:"1051",sv:"1053",tr:"1055",uk:"1058",sl:"1060",es:"3082",pl:"1045",ro:"1048",ru:"1049"};var A= "16.0.13023.35051";function x(){return A}var U,R,P,W;function F(t){return JSON.stringify(t,Object.getOwnPropertyNames(t))}function N(t,i){try{if(void 0===window.performance)return void i.ULS.u(595948609,r.P,n.Info,"Performance not supported");var e=window.performance.getEntriesByType("resource");if(void 0===e||e.length<=0)return void i.ULS.u(595948610,r.P,n.Info,"No resources under performance");for(var o=new RegExp(t+"[-.]boot(.min)?.js","i"),s=e.length-1;s>=0;s-=1){var a=e[s],c=a.name.match(o);if(c){var u=JSON.stringify(a);return u=u.replace(new RegExp(a.name,"g"),c[0]),void i.ULS.u(595948616,r.P,n.Info,u)}}i.ULS.u(595948484,r.P,n.Info,"Could not find JSAPI resource timing entry")}catch(t){i.ULS.u(595948617,r.P,n.Info,"Could not trace the resource timing: "+F(t))}}function k(){var t={perfNowSupported:p};try{var i=window.navigator,e=i.connection||i.mozConnection||i.webkitConnection;e&&(t.netDownlink=e.downlink,t.netDownlinkMax=e.downlinkMax,t.netEffectiveType=e.effectiveType,t.netRtt=e.rtt,t.netSaveData=e.saveData,t.netType=e.type),t.deviceMemory=i.deviceMemory,t.logicalProcessors=i.hardwareConcurrency}catch(t){}return t}function D(t,i,e){t.ULS.u(595957843,r.P,n.Info,"Page lifecycle: "+i+" fired"+(e?", flushing logger":"")),e&&t.ULS.flush()}function M(){return p?window.performance.now():Date.now()}!function(t){t.ot="ExcelInstantShellEnabled",t.rt="BootstrapperMaxUlsHeartbeatTime",t.st="BootstrapperNoCompleteWarning1Time",t.at="BootstrapperNoCompleteWarning2Time",t.ct="RemoteUlsETag",t.ut="RemoteUlsSuppressions",t.ht="BootstrapperSettingsFetchPeriod",t.ft="timestamp",t.lt="BootstrapperUlsHeartbeatIntervalMs",t.dt="BootstrapperUlsHeartBeatIsEnabled",t.pt="BootstrapperUlsUploadCadenceMs"}(U||(U={}));var L,B;function H(){B&&(window.clearInterval(B),B=void 0)}function J(){var t=new Uint8Array(31),i=function(t){var i={crypto:!1,perfNow:!1,exceptions:[]},e=window.crypto||window.msCrypto;if(e){i.crypto=!0;try{return e.getRandomValues(t),i}catch(t){i.exceptions.push("crypto: "+F(t))}}i.perfNow=p;for(var n=0;n<t.length;n+=1){try{if(p){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(t){i.exceptions.push("Math.random: "+F(t))}t[n]=Math.floor(16*Math.random())}return i}(t),e=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){var n=15&t[e];return e+=1,("x"===i?n:3&n|8).toString(16)})),i]}var j,z=function(){function t(t){var i=this;this.vt=3e4,this.wt=30,this.gt=0,this.St=[],this._t=Date.now(),this.bt="",this.flushOnClose=function(){i.yt(!1,!1)},this.flush=function(){i.It()},this.It=function(){window.setTimeout((function(){return i.yt(!0,!0)}),0)},this.yt=function(t,e){if(window.clearTimeout(i.Ot),i.Et){if(i.St.length>0)i.gt+=1,c(u(i.St.splice(0,t?i.wt:i.St.length),i.bt,i.gt,i._t),i.Et,e),i._t=Date.now();t&&(i.Ot=window.setTimeout(i.It,i.St.length>i.wt?1e3:i.vt))}},t&&this.configure(t)}return t.prototype.configure=function(t){var i=this;if(t.uploadCadenceInMs&&(this.vt=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.wt=t.uploadTriggerSize),t.sessionId&&(this.bt=t.sessionId),t.remoteUlsEndpoint){if(!t.sessionId&&this.Et)throw new Error("Remote ULS endpoint is already set");this.Et=t.remoteUlsEndpoint+"?usid="+this.bt,this._t=Date.now(),window.setTimeout((function(){return i.yt(!0,!0)}),0)}},t.prototype.handleTrace=function(t){t.message.length>3072&&(t.message=t.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.St.push(t),(this.St.length>this.wt||t.level===n.Error)&&this.It()},t}(),V=[];var q,G,X,Z,$;function K(t){var i=new z(t);function e(t,e,n,o){if(!function(t){return 1===V[t]}(t)){var r={timestamp:Date.now(),category:e,tag:t,level:n,type:a.Trace,message:o};i.handleTrace(r)}}return{ULS:{u:function(t,i,n,o){e(t,i,n,o)},shipAssertTag:function(t,i,o,r){o&&e(t,i,n.Error,r)},debugAssertTag:function(t,i,e,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:i.flush,flushOnClose:i.flushOnClose},configure:function(t){i.configure(t)},settingsChangeHandler:function(t){var e,n;e=t.settingsManager.getValue(U.ut,""),n=t.settingsManager.getValue(U.ct,""),j&&n===j||(V=[],j=n,e&&e.split(",").forEach((function(t){var i=parseInt(t,10);i&&(V[i]=1)}))),i.configure({uploadCadenceInMs:t.settingsManager.getValue(U.pt,6e4)})}}}function Q(t){var i=t.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!i)throw new Error("Invalid URL");return i[1]}function Y(t,i){i&&i.Diagnostics&&Object.keys(i.Diagnostics).forEach((function(e){return t[e]=i.Diagnostics[e]}))}function tt(t,i,e){i.ULS.u(596459999,r.P,e,"SessionTraces: "+JSON.stringify(t))}function it(t,i,e){e.Stop();var n=e.GetVisibilityChangeEvents();null!=n&&n.length>0&&(t.documentLoadedWithTabSwitch=!0,i.tabSwitchDiagnostics=JSON.stringify(n)),e.Dispose()}function et(t,i,e){t.ULS.u(596464283,r.P,n.Info,"Initializing session. Build version: "+x()),e&&t.ULS.u(595937313,r.P,n.Info,JSON.stringify(e)),i.rebootOverrideData&&(i.rebootOverrideData.previousSessionId||t.ULS.u(594613645,r.P,n.Warning,"Missing previous session id")),t.ULS.u(595632928,r.P,n.Info,function(){if(window&&window.navigator){var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;if(i)return"EffectiveType: "+i.effectiveType+", BandwidthMps: "+i.downlink+", ConnectionType: "+i.type}return""}()),i&&i.wopiInfo&&i.wopiInfo.AccessToken&&i.wopiInfo.AccessTokenExpiry?(0===i.wopiInfo.AccessToken.length||i.wopiInfo.AccessTokenExpiry.getTime()<=Date.now())&&t.ULS.u(595894621,r.P,n.Error,"Invalid AccessToken. AccessTokenLength: "+i.wopiInfo.AccessToken.length+", AccessTokenExpiry: "+i.wopiInfo.AccessTokenExpiry+", AccessTokenTTL: "+i.wopiInfo.AccessTokenExpiry.getTime()+", DateNow: "+Date.now()):t.ULS.u(595894553,r.P,n.Warning,"There are some missing paramters");var o=function(t,i){var e=JSON.parse(JSON.stringify(i));delete e.UserId,delete e.OwnerId,delete e.WdParams;var n=i.WdParams?JSON.parse(JSON.stringify(i.WdParams).toLowerCase()):{};return e.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf","wdsandboxwacframe"].forEach((function(t){n[t]&&(e.WdParams[t]=n[t])})),e.UiEmbedMode=t.toLowerCase().indexOf("uiembed=1")>=0,e.UiHostName=y(t,"uih")||"N/A",e.hostName=location?location.hostname:"",e}(i.applicationUrl,i.sessionInformation);t.ULS.u(596444237,r.P,n.Info,JSON.stringify({hostSessionInformation:o,clientSignals:k()})),t.ULS.u(596444238,r.P,n.Info,"HostInitDiagnostics: "+(i.diagnostics.HostInitializeDiagnostics?JSON.stringify(i.diagnostics.HostInitializeDiagnostics):"N/A"))}function nt(t,i,e){void 0===e&&(e=!1);var n=t.applicationUrl;t.wopiPrecheckInfo.IsNewFile&&n.replace("unified=1","edit=1&new=1");var o={jsApi:"1"};if(e&&(o.NewSession="1"),o.corrid=t.sessionId,o.usid=t.sessionId,o.sftc="1",(t.applicationCustomSettings&&t.applicationCustomSettings.IsCore||t.sessionInformation.IsCore)&&(o.core="1"),t.sessionInformation.HideViewerToolbar&&(o.hvt="1"),t.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),t.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(t.sessionInformation.HighContrastMode)),t.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),t.sessionInformation.SupportsDocReboot){var r=t.sessionInformation.SupportsDocReboot;o.sdr=!0===r?"1":r.toString()}return t.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),t.sessionInformation.HideHeader&&(o.hhdr="1"),t.applicationCustomSettings&&t.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),t.wopiPrecheckInfo.ReadOnly&&(o.readOnly="1"),t.sessionInformation.UIEmbed&&(o.uiEmbed="1"),t.applicationCustomSettings&&t.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),i.isSingleStepBoot?(i.bootFlowType===$.unifiedSingleFlush&&(t.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=i.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(t.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(_(window.location.href)),t.isCreateNew&&(o.new="1",t.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),t.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(t.wopiPrecheckInfo.PreseededSessionKey)),t.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(t.wopiPrecheckInfo.PreseededWacSessionId)),t.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=t.wopiPrecheckInfo.RequestedCallThrottling),t.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=t.wopiPrecheckInfo.ClientThrottlingProtection),function(t){var i=t.featureManager.isFeatureEnabled(X.Tt),e=t.applicationUrl;return(g(e)||S(e))&&t.settingsManager.getValue(U.ot,!1)||i;return!1}(t)&&(o.instantshell="1"),t.applicationCustomSettings&&t.applicationCustomSettings.additionalApplicationParameters&&(o=f(f({},t.applicationCustomSettings.additionalApplicationParameters),o)),t.rebootOverrideData&&t.rebootOverrideData.queryOverrides&&(o=f(f({},o),t.rebootOverrideData.queryOverrides)),function(t,i,e,n,o){var r=function(t){var i={},e=t.indexOf("?");return-1===e||e===t.length-1||t.substring(e+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(t){if(t){var e=t.indexOf("=");-1!==e&&e!==t.length-1&&(i[t.substring(0,e).toLowerCase()]=t.substring(e+1))}})),i}(t);"teams"!==r.uih&&"owa"!==r.uih||(r.hhdr="1");var s=t.indexOf("?"),a=-1===s?t.concat("?"):t.substring(0,s+1);i.UiLocale&&(r.ui=encodeURIComponent(i.UiLocale));i.DataLocale&&(r.rs=encodeURIComponent(i.DataLocale));i.HostSessionId&&(r.hid=encodeURIComponent(i.HostSessionId));i.DisableChat&&(r.dchat="1");i.SessionContext&&(r.sc=encodeURIComponent(i.SessionContext));e&&e.WopiSrc&&(r.wopisrc=encodeURIComponent(e.WopiSrc));i.CookieCompliant&&(r.mscc="1");n&&(n.entryPoint&&(r.wdorigin=encodeURI(n.entryPoint)),n.userClickTime&&(r.wdhostclicktime=n.userClickTime.toString()));r=f(f(f({},r),i.WdParams),o);var c={};for(var u in r)c[u.toLowerCase()]=r[u];var h=[];for(var u in c)c[u]&&h.push(u.concat("=",c[u]));return a.concat(h.join("&"))}(n,t.sessionInformation,t.wopiInfo,t.diagnostics.HostInitializeDiagnostics,o)}function ot(t){return t.AccessTokenExpiry?t.AccessTokenExpiry.getTime().toString():"0"}!function(t){t.Ct="App_AccessibilityLoopComplete",t.At="Wac_AppFailed",t.xt="Wac_AppBootState",t.Ut="Wac_AppCompleted",t.Rt="BrowserEvent",t.Pt="UI_Close",t.Wt="UI_Conversation",t.Ft="UI_CopyAndEdit",t.Nt="UI_Download",t.kt="Error",t.Dt="UI_FileEmbed",t.Mt="UI_FileProperties",t.Lt="File_Rename",t.Bt="File_RenameFailed",t.Ht="UI_FileVersions",t.Jt="StateChanged",t.jt="App_WopiInfoFromUrl",t.zt="WacInitialize_FrameLoaded",t.Vt="WacInitialize_Ready",t.qt="App_LoadingStatus",t.Gt="App_SwitchMode",t.Xt="UI_OpenInBrowser",t.Zt="UI_OpenInClient",t.$t="PageChanged",t.Kt="App_PushState",t.Qt="App_DocReboot",t.Yt="UI_RedeemForCommenting",t.ti="App_RefreshSessionInfo",t.ii="UI_ReplyWithChanges",t.ei="UI_ReportAbuse",t.ni="UI_SaveStatus",t.oi="WopiSession_Complete_Ack",t.ri="UI_Sharing",t.si="UI_ShareForm",t.ai="UI_SignIn",t.ci="App_IsFrameTrusted",t.hi="App_Unloaded",t.li="PageCount",t.di="UI_CheckUserAccessAndGrantPermissions",t.pi="User_Activity",t.vi="Edit_Notification",t.wi="UI_Workflow",t.mi="ZoomChanged"}(q||(q={})),function(t){t.gi="Ack",t.Si="Blur_Focus",t._i="Wac_AppFailed_Ack",t.bi="Wac_AppCompleted_Ack",t.yi="Host_AccessibilityLoopComplete",t.Ii="WopiPendingSession_Fail",t.Oi="Grab_Focus",t.Ei="HostCacheDiagnostic",t.Ti="WacInitialize_Ready_Ack",t.Ci="JsApiDiagnostics",t.Ai="PageChanged_Ack",t.xi="WopiPendingApplicationComplete_Received",t.Ui="WopiPendingSession_Complete",t.Ri="App_PopState",t.Pi="Host_PostmessageReady",t.Wi="File_Rename",t.Fi="CanEmbed",t.Ni="Host_RefreshSessionInfo",t.ki="CheckUserAccessAndGrantPermissions_Result",t.Di="Host_WopiInfoFromUrl",t.Mi="SetCurrentPage",t.Li="SetZoomLevel",t.Bi="WopiStartSession_Complete",t.Hi="Host_SwitchMode",t.ci="Host_IsFrameTrusted",t.Ji="Host_Unload",t.ji="PageCount_Ack",t.zi="ZoomChanged_Ack"}(G||(G={})),function(t){t.Vi="EnterpriseTemplates",t.qi="ExcelAdaptiveLayoutDownload",t.Gi="ExcelHashedUrl",t.Xi="ExcelLandingPageOfflineTelemetry",t.Zi="ExcelLandingPageObserverRetry",t.$i="H2StaticContent",t.Ki="HashedUrl",t.Tt="InstantShell",t.Qi="ODCShareLinkPreload",t.Yi="OfficeComUiHost",t.te="WordJsApiV2"}(X||(X={})),function(t){t.Unknown="Unknown",t.AppInitError="AppInitError",t.ApiDisabledError="ApiDisabledError",t.CannotLoadFirstPage="CannotLoadFirstPage",t.CannotLoadScript="CannotLoadScript",t.PageChangeError="PageChangeError",t.ZoomChangeError="ZoomChangeError",t.CannotLoadBundleItem="CannotLoadBundleItem",t.InvalidPageIndex="InvalidPageIndex",t.UnsupportedBundleVersion="UnsupportedBundleVersion",t.InvalidWopiInfo="InvalidWopiInfo",t.TimeoutWacReady="TimeoutWacReady",t.WacFailed="WacFailed"}(Z||(Z={})),function(t){t.bootWithoutWopiInfo="",t.unifiedSingleFlush="Unified_SingleFlush",t.unifiedIrmEnabled="Unified_IrmEnabled",t.unifiedViewActionUrl="Unified_ViewActionUrl",t.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",t.forceSingleStepBoot="Force_SingleStepBoot",t.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",t.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect"}($||($={}));var rt,st,at,ct,ut,ht,ft,lt=!1,dt=!1,pt=["xlviewerinternal.aspx","xlembed.aspx"],vt=0;function wt(t,i,e,o){at=t,ct=i,ht=e,ft=o,mt(),setTimeout((function(){at.ULS.u(593589517,r.P,n.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver heartbeat signal called after ms: 3000")}),3e3),setTimeout((function(){!function t(){if(vt>=3)return void at.ULS.u(595350870,r.P,n.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Max Limit reached for retry attempts3");if(mt(),lt)setTimeout((function(){(!dt||vt>0)&&at.ULS.u(595350872,r.P,n.Info,"ExcelLandingPageObserver: checkSecondFlushArrived Second Flush status: "+dt+" after first flush retry attempt: "+vt)}),st);else{if(vt+=1,at.ULS.u(595350871,r.P,n.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Retry Request: "+vt),ht.isFeatureEnabled(X.Zi)&&1===vt)document.getElementById(ct).submit();setTimeout((function(){t()}),rt)}}()}),rt),ht.isFeatureEnabled(X.Xi)&&(window.localStorage?window.addEventListener("offline",gt):at.ULS.u(593589518,r.P,n.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver localstorage not supported by Browser. Skip saving in cache")),at.ULS.u(594622165,r.P,n.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver called with OfflineTelemetry: "+ht.isFeatureEnabled(X.Xi))}function mt(){rt=3750,st=6e3;var t=function(){if(window&&window.navigator){var t=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return t?t.effectiveType:void 0}}();if(void 0!==t)switch(void 0!==ut&&ut!==t&&at.ULS.u(595350873,r.P,n.Info,"ExcelLandingPageObserver: initializeTimeOutIntervals previousConnection: "+ut+" currentConnection: "+t+" First Flush: "+lt+" Second Flush:"+dt),ut=t,t){case"4g":rt=3750,st=6e3;break;case"3g":rt=5e3,st=8e3;break;case"2g":rt=1e4,st=24e3;break;case"slow-2g":rt=2e4,st=4e4}}function gt(){try{var t=(new Date).getTime(),i="OfflineMode_"+ft+"_"+t,e={"Sessionid:":ft,OfflineTime:t};localStorage.setItem(i,JSON.stringify(e))}catch(t){at.ULS.u(593589522,r.P,n.Error,"ExcelLandingPageObserver:logOfflineModeTelemetry exception during saving into cache exception: "+F(t))}}var St;function _t(t,i,e,n,o,r,s,a){var c=function(t,i,e,n,o){var r=t.ownerDocument.createElement("iframe");r.name=n||"WebApplicationFrame",r.id="WebApplicationFrame",r.src="",r.title="Office Online Frame",r.width="100%",r.height="100%",r.marginWidth="0",r.marginHeight="0",r.style.left="0",r.style.top="0",r.style.right="0",r.style.bottom="0",r.style.display="block",r.style.position="absolute",r.style.backgroundColor="transparent",r.style.border="none",r.frameBorder="0",r.setAttribute("allowfullscreen","true"),r.setAttribute("allowTransparency","true"),e&&r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-popups-to-escape-sandbox");var s=_(i);return r.setAttribute("allow","microphone "+s+"; camera "+s+";"),o&&(r.onload=o),t.appendChild(r),r}(t,i,n,r);return function(t){return pt.some((function(i){return-1!==t.indexOf(i)}))}(i)&&wt(s,"office_form",o,a),function(t,i,e,n){!function(t,i){i[St.wacFrameComputedHeightPx]=String(t.offsetHeight),i[St.wacFrameComputedWidthPx]=String(t.offsetWidth),i[St.wacFrameTouchMode]=String(v()),i[St.wacFrameHighContrast]=String(function(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(t){return!1}}()),i[St.wacFrameForceSLR]=String(function(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(t){return!1}}())}(t,n);var o=i.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=e,r.target=t.name,r.method="POST",n){var a=o.createElement("input");a.type="hidden",a.name=s,a.value=n[s],r.appendChild(a)}return i.appendChild(r),r.submit(),t}(c,t,i,e)}function bt(t,i){var e={};if(t.wopiInfo&&(e[St.wacFrameAccessToken]=t.wopiInfo.AccessToken,e[St.wacFrameAccessTokenTtl]=ot(t.wopiInfo)),t.wopiPrecheckInfo.BundleInfo&&t.wopiPrecheckInfo.BundleInfo.Url&&t.wopiPrecheckInfo.BundleInfo.Url.length>0)if(e[St.wacFrameBundleSource]=t.wopiPrecheckInfo.BundleInfo.Url,null!=t.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==t.wopiPrecheckInfo.BundleInfo.BundleStaleness){var o=t.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();i.ULS.u(593503580,r.P,n.Info,"Content bundle staleness - "+o),e[St.wacFrameBundleStaleness]=o}else i.ULS.u(593503581,r.P,n.Info,"Content bundle staleness does not exist");if(t.wopiPrecheckInfo.FileGetUrl&&(e[St.wacFrameFileGetUrl]=t.wopiPrecheckInfo.FileGetUrl),t.wopiPrecheckInfo.FileName){var s=t.wopiPrecheckInfo.FileName.lastIndexOf(".");if(-1!==s){var a=t.wopiPrecheckInfo.FileName.substring(s+1);a&&(e[St.wacFrameFileExtension]=a)}e[St.wacFrameFileName]=t.wopiPrecheckInfo.FileName}return t.newFileTemplateSource&&t.newFileTemplateSource.FileSize?e[St.wacFrameFileSize]=t.newFileTemplateSource.FileSize.toString():t.wopiPrecheckInfo.FileSize&&(e[St.wacFrameFileSize]=t.wopiPrecheckInfo.FileSize.toString()),t.sessionInformation.UserId&&(e[St.wacFrameUserId]=t.sessionInformation.UserId),t.sessionInformation.OwnerId&&(e[St.wacFrameOwnerId]=t.sessionInformation.OwnerId),t.sessionInformation.SessionContext&&(e[St.wacFrameSessionContext]=t.sessionInformation.SessionContext),t.diagnostics&&(e[St.wacFrameHostDiagnostics]=JSON.stringify(t.diagnostics)),e[St.wacFrameFeatureStatus]=function(t,i){var e={};if(Object.keys(X).forEach((function(i){var n=t.isFeatureEnabled(X[i]);void 0!==n&&(e[X[i]]=n?"1":"0")})),i&&i.wdFlights)for(var n=i.wdFlights.toLowerCase(),o=0,r=n.split(",");o<r.length;o++){var s=r[o];"et-treatment"!==s&&"et-control"!==s||(e[X.Vi]="et-treatment"===s?"1":"0")}return JSON.stringify(e)}(t.featureManager,t.sessionInformation.WdParams),t.applicationCustomSettings&&t.applicationCustomSettings.HostUIControls&&(e[St.wacFrameHostUIControlOverrides]=JSON.stringify(t.applicationCustomSettings.HostUIControls)),e[St.wacFrameHighDpi]=String(window.devicePixelRatio>1.24),e[St.wacSoftBlockedBrowser]=String(w()),e[St.wacFrameHostName]=t.sessionInformation.HostName,t.newFileTemplateSource&&(e[St.wacFrameTemplateUrl]=t.newFileTemplateSource.FileGetUrl),t.newFileTemplateSource&&t.newFileTemplateSource.DocUniqueId?e[St.wacFrameDocID]=t.newFileTemplateSource.DocUniqueId:t.wopiPrecheckInfo.DocUniqueId&&(e[St.wacFrameDocID]=t.wopiPrecheckInfo.DocUniqueId),t.newFileTemplateSource&&t.newFileTemplateSource.ETag?e[St.wacFrameETag]=t.newFileTemplateSource.ETag:t.wopiPrecheckInfo.ETag&&(e[St.wacFrameETag]=t.wopiPrecheckInfo.ETag),e}!function(t){t.wacFrameAccessToken="access_token",t.wacFrameAccessTokenTtl="access_token_ttl",t.wacFrameBundleSource="bundleSrc",t.wacFrameBundleStaleness="bundleStaleness",t.wacFrameFileGetUrl="fileGetUrl",t.wacFrameFileExtension="fileExtension",t.wacFrameFileSize="fileSize",t.wacFrameFileName="fileName",t.wacFrameOwnerId="owner_id",t.wacFrameUserId="user_id",t.wacFrameSessionContext="sc",t.wacFrameHostDiagnostics="host_diagnostics",t.wacFrameHighDpi="highDpi",t.wacFrameComputedHeightPx="frameHeightPx",t.wacFrameComputedWidthPx="frameWidthtPx",t.wacFrameHostFlights="hostFlights",t.wacFrameHighContrast="highContrast",t.wacFrameTouchMode="touchMode",t.wacFrameHostUIControlOverrides="huictrls",t.wacSoftBlockedBrowser="softBlockedBrowser",t.wacFrameHostName="hostName",t.wacFrameFeatureStatus="feature_status",t.wacFrameTemplateUrl="templateUrl",t.wacFrameETag="ETag",t.wacFrameDocID="DocID",t.wacFrameForceSLR="forceSLR"}(St||(St={}));var yt=function(){function t(t,i,e,o,s,a,c,u){var h=this;if(this.ie=!1,this.ee=[],this.logWarningOnNoAppComplete=function(t){h.ie||(h.ne.ULS.u(594901218,r.P,n.Warning,"Boot_NotComplete_"+(t||"Final")),h.ne.ULS.flush())},void 0===i)throw new TypeError("bootFlowInfo");if(i.isSingleStepBoot&&void 0===t.wopiInfo)throw new TypeError("wopiInfo");this.oe=t,this.re=i,this.ne=s,this.se=a,this.ae=c,this.ce=u,this.ue=e,this.he=o,this.he.wopiInitializeTime=Date.now()}return t.prototype.Boot=function(){var t=this;this.ne.ULS.u(596444241,r.P,n.Info,"Initializing WAC frame");var i=nt(this.oe,this.re,!0),e=bt(this.oe,this.ne);if(function(t,i,e,o){if(i.getValue(U.dt,!1)){L=M();var s=t?3e3:5e3;B=window.setInterval((function(){e.ULS.u(595724178,r.P,n.Info,"Boot_HeartBeat"),M()-L>i.getValue(U.rt,3e5)&&(H(),o&&o())}),i.getValue(U.lt,s))}}(g(i),this.oe.settingsManager,this.ne,this.logWarningOnNoAppComplete),this.se.registerMessagePayloadHandler(q.xt,(function(i){t.handleWacAppBootState(i)})),this.se.registerMessagePayloadHandler(q.ci,(function(i){t.handleTrustFrameRequest(i)})),this.re.ignoreWacFramePostMessages||this.populateWacFrameCompletedAndFailedHandlers(),this.bootWacFrame(i,e),this.re.ignoreWacFramePostMessages){var o=this.getApplicationState();this.ae(o)}return this.ne.ULS.u(595661019,r.P,n.Info,"Created Wac Frame"),this.fe},t.prototype.bootWacFrame=function(t,i){this.ue.officeFrameCreateTime=Date.now(),this.he.frameCreateStartTime=this.ue.officeFrameCreateTime;var e=!(!this.oe.sessionInformation.WdParams||!this.oe.sessionInformation.WdParams.wdSandboxWacFrame),n=this.oe.applicationCustomSettings&&this.oe.applicationCustomSettings.appFrameName;this.fe=_t(this.oe.container,t,i,e,this.oe.featureManager,n,this.ne,this.ue.officeSessionId),this.se.activate(this.fe)},t.prototype.populateWacFrameCompletedAndFailedHandlers=function(){var t=this;this.se.registerMessagePayloadHandler(q.Ut,(function(i){t.handleWacCompleteMessage(i)})),this.se.registerMessagePayloadHandler(q.At,(function(i){t.handleWacFailureMessage(i)})),this.ee.push(window.setTimeout((function(){return t.timeoutWacAppCompleteOrFail()}),15e3)),this.ee.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(1)}),this.oe.settingsManager.getValue(U.st,6e4))),this.ee.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(2)}),this.oe.settingsManager.getValue(U.at,18e4)))},t.prototype.handleWacAppBootState=function(t){var i=t&&t.state?t.state:"unknown";this.ne.ULS.u(595714271,r.P,n.Info,"WAC Boot App state:["+i+"]"),function(t){"PageLoadSkeleton Presented"===t?lt=!0:"BootstapContext Recieved"===t&&(dt=!0)}(i)},t.prototype.handleTrustFrameRequest=function(t){var i=function(t){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(i){return t&&t.ULS.u(591525084,r.P,n.Info,"Trust check error: "+F(i)),!1}}(this.ne);this.ne.ULS.u(595653903,r.P,n.Info,"Top frame is trusted: "+i),this.se.sendPostMessage(this.fe.contentWindow,G.ci,{isTopFrameTrusted:i})},t.prototype.handleWacCompleteMessage=function(t){if(this.ne.ULS.u(595986314,r.P,n.Info,"Received wac complete message"),this.ne.ULS.flush(),H(),this.clearLogTimers(),function(){if(ht.isFeatureEnabled(X.Xi))if(window.localStorage)for(var t=0;t<localStorage.length;t+=1)try{var i=localStorage.key(t);if("OfflineMode_"===i.substring(0,"OfflineMode_".length)){var e=localStorage.getItem(i);at.ULS.u(593589520,r.P,n.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry Message"+e),localStorage.removeItem(i)}}catch(t){at.ULS.u(593589521,r.P,n.Error,"ExcelLandingPageObserver:uploadOfflineModeTelemetry exception during loading from cache. Exception: "+F(t))}else at.ULS.u(593589519,r.P,n.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry localstorage not supported by Browser. Skip uploading")}(),this.ie)this.ne.ULS.u(596444234,r.P,n.Info,"Received multiple wac complete or failure messages");else{this.ie=!0,this.sendWacPostMessage(G.bi,{}),Y(this.ue,t);var i=this.getApplicationState();this.ae(i),this.sendJsApiDiagnosticsToWacFrame(this.oe.diagnostics)}},t.prototype.getApplicationState=function(){return{innerApplicationFrame:this.fe}},t.prototype.handleWacFailureMessage=function(t){if(this.ne.ULS.u(595986315,r.P,n.Error,"Received wac failed message"),this.ne.ULS.flush(),H(),this.clearLogTimers(),this.ie)this.ne.ULS.u(596444235,r.P,n.Info,"Received multiple wac complete or failure messages");else{this.ie=!0,this.sendWacPostMessage(G._i,{});var i={errorType:Z.WacFailed,errorObject:{}};t&&(i.errorObject=t.Error,this.he.error=i),this.ce(i)}},t.prototype.timeoutWacAppCompleteOrFail=function(){this.ie||this.ne.ULS.u(596444236,r.P,n.Warning,"Timeout. SessionTraces:"+JSON.stringify(this.he))},t.prototype.clearLogTimers=function(){for(var t=0;t<this.ee.length;t+=1)this.ee[t]&&window.clearTimeout(this.ee[t]);this.ee=[]},t.prototype.sendJsApiDiagnosticsToWacFrame=function(t){this.sendWacPostMessage(G.Ci,t)},t.prototype.sendWacPostMessage=function(t,i){this.fe&&this.fe.contentWindow?this.se.sendPostMessage(this.fe.contentWindow,t,i):this.ne.ULS.u(595955718,r.P,n.Info,"Attempted to send postmessage: "+t)},t}(),It=!1,Ot=!1;function Et(){It=!1}function Tt(t,i,e,o,s,a){if(i.ULS.u(595714433,r.P,n.Info,"Starting disposing the application. unloadApp:"+t+"; disposed:"+It+"; unloading:"+Ot),It||Ot&&t)i.ULS.u(595714908,r.P,n.Info,"Application is already disposed or unloading");else{var c,u={logger:i,postMessenger:e,innerApplicationFrame:o,onDisposed:s,unloadTimeoutInMs:a||1e3,forceAppUnload:!1,disposeStartTime:Date.now(),appUnloadTimedOut:!1};if(t&&o)return Ot=!0,u.forceAppUnload=!0,(c=u).forceAppUnloadStartTime=Date.now(),c.logger.ULS.u(595855490,r.P,n.Info,"Sending postmessage to unload app"),c.logger.ULS.flush(),c.postMessenger.registerMessagePayloadHandler(q.hi,(function(t){return function(t,i){t.forceAppUnloadEndTime=Date.now(),t.appUnloadedMessageValues=i,t.logger.ULS.u(595855491,r.P,n.Info,"AppUnloaded received from app"),Ct(t)}(c,t)})),c.postMessenger.sendPostMessage(c.innerApplicationFrame.contentWindow,G.Ji,{}),void window.setTimeout((function(){return function(t){!Ot&&It||(t.appUnloadTimedOut=!0,t.logger.ULS.u(595855492,r.P,n.Info,"ApplicationUnload timed out, forcing dispose"),Ct(t))}(c)}),c.unloadTimeoutInMs);Ct(u)}}function Ct(t){if(!It)try{It=!0,Ot=!1,function(t){if(!t.innerApplicationFrame)return;t.innerApplicationFrame.src="about:blank",window.setTimeout((function(){t.innerApplicationFrame&&t.innerApplicationFrame.parentElement&&t.innerApplicationFrame.parentElement.removeChild(t.innerApplicationFrame)}),0)}(t),function(t){var i={disposeStartTime:t.disposeStartTime,disposeEndTime:Date.now(),forceAppUnload:t.forceAppUnload,appUnloadTimedOut:t.appUnloadTimedOut};t.forceAppUnloadStartTime&&(i.appUnloadStartTime=t.forceAppUnloadStartTime);t.forceAppUnloadEndTime&&(i.appUnloadEndTime=t.forceAppUnloadEndTime);if(t.appUnloadedMessageValues){var e=t.appUnloadedMessageValues;void 0!==e.sendBeaconFlight&&(i.sendBeaconFlight=e.sendBeaconFlight),void 0!==e.sendBeaconSupported&&(i.sendBeaconSupported=e.sendBeaconSupported);var o=Number(e.hostMessageReceived);t.forceAppUnloadStartTime&&!isNaN(o)&&(i.hostToAppPostMessageLatency=o-t.forceAppUnloadStartTime);var s=Number(e.appMessageSent);!isNaN(s)&&t.forceAppUnloadEndTime&&(i.appToHostPostMessageLatency=t.forceAppUnloadEndTime-s);var a=Number(e.appUnloadStart),c=Number(e.appUnloadEnd);if(isNaN(a)||isNaN(c)||(i.appUnloadLatency=c-a),e.serverTimings){var u=e.serverTimings;for(var h in u)i["st-"+h.toString()]=u[h]}}t.logger.ULS.u(595855436,r.P,n.Info,"App disposed "+JSON.stringify(i)),t.logger.ULS.flushOnClose()}(t),t.onDisposed&&t.onDisposed()}catch(i){t.logger.ULS.u(595714434,r.P,n.Error,"Error disposing: "+F(i))}}var At,xt,Ut=function(){function t(t,i,e,n,o,r,s,a,c){var u=this;this.le=!1,this.pe=!1,this.ve=!1,this.we=null,this.me=!0,this.ge=!1,this.Se=!1,this.oe=t,this.re=i,this.ue=e,this.ne=n,this.se=o,this.ae=a,this.ce=c,this.he=r,this.he.wopiPendingInitializeTime=Date.now(),this._e=s,Et(),window.setTimeout((function(){return u.timeoutCompleteOrFail()}),5e3)}return t.prototype.Complete=function(t,i){if(this.ve)this.ne.ULS.u(596444184,r.P,n.Warning,"Complete called after Complete/Fail already called");else{this.ne.ULS.u(596444185,r.P,n.Info,"Complete called."),this.ve=!0,this.be=t,this.he.wopiPendingCompleteTime=Date.now();try{this.re.isSingleStepBoot?this.completeSingleStepFlow():this.completeTwoStepFlow(),this.le&&this.sendWacPostMessage(G.xi,{}),this.updateBrowserHistoryForCreateNew(i)}catch(t){this.ne.ULS.u(596444186,r.P,n.Error,"Unexpected script error: "+F(t))}finally{this.ne.ULS.flush()}}},t.prototype.Fail=function(t){this.ve?this.ne.ULS.u(596444187,r.P,n.Warning,"Fail called after Complete/Fail already called"):(this.ne.ULS.u(596444188,r.P,n.Warning,"Fail called. Reason: "+(t?JSON.stringify(t):"N/A")),this.ve=!0,this.re.isSingleStepBoot?this.failSingleStepFlow():this.failTwoStepFlow(t),this.ne.ULS.flush())},t.prototype.Dispose=function(t,i,e){var n=this;Tt(t||!1,this.ne,this.se,this.fe,(function(){delete n.fe,i&&i(),n._e(),n.se.dispose()}),e)},t.prototype.Boot=function(){this.re.isSingleStepBoot||this.bootTwoStepFlow(),this.ne.ULS.flush()},t.prototype.bootTwoStepFlow=function(){var t=this;this.ne.ULS.u(596444231,r.P,n.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout((function(){return t.timeoutWacReadyMessage()}),5e3),this.populateWacFrameEventHandlersForTwoStepFlow();var i=new yt(this.oe,this.re,this.ue,this.he,this.ne,this.se,this.ae,this.ce);this.fe=i.Boot()},t.prototype.populateWacFrameEventHandlersForTwoStepFlow=function(){var t=this;this.se.registerMessagePayloadHandler(q.Vt,(function(i){t.handleWacReadyMessage(i)})),this.se.registerMessagePayloadHandler(q.zt,(function(i){t.handleWacFrameLoadedMessage(i)})),this.se.registerMessagePayloadHandler(q.oi,(function(i){t.handleWacFrameSessionCompleteAckMessage(i)}))},t.prototype.completeTwoStepFlow=function(){var t={ParallelizeStartSession:this.me,WacFrameIsLoaded:this.le,WacAcceptsStartSessionComplete:this.ge};this.ne.ULS.u(596444232,r.P,n.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(t)),!this.me||this.le&&!this.ge?this.le&&this.sendWopiInfoToWacFrame():this.makeStartSessionRequest()},t.prototype.completeSingleStepFlow=function(){this.ne.ULS.u(596444233,r.P,n.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),this.oe.wopiInfo=this.be;var t=new yt(this.oe,this.re,this.ue,this.he,this.ne,this.se,this.ae,this.ce);this.fe=t.Boot()},t.prototype.failTwoStepFlow=function(t){this.le?(this.ne.ULS.u(595968481,r.P,n.Warning,"Fail called and wacframe is able to accept postmessages"),this.sendFailurePostMessageToWacFrame(t)):(this.ne.ULS.u(595968482,r.P,n.Warning,"Fail was called on the session prior to WacReady."),this.we=t)},t.prototype.sendFailurePostMessageToWacFrame=function(t){this.ne.ULS.u(596444189,r.P,n.Warning,"Fail called, sending the failure postmessage to IFrame"),this.sendWacPostMessage(G.Ii,t)},t.prototype.failSingleStepFlow=function(){this.ne.ULS.u(596444190,r.P,n.Warning,"Fail called during single step boot, calling host failure callback..."),this.ce({errorType:Z.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},t.prototype.timeoutWacReadyMessage=function(){this.le||(this.ne.ULS.u(596444191,r.P,n.Warning,"Timeout Wac Ready"),this.ce({errorType:Z.TimeoutWacReady,errorObject:void 0}))},t.prototype.timeoutCompleteOrFail=function(){this.ve||(this.he.timeoutCompleteOrFail=Date.now(),this.ne.ULS.u(596444192,r.P,n.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(this.he)))},t.prototype.timeoutWacSessionCompletionMessageAck=function(t,i,e){this.Se||(this.ne.ULS.u(596444193,r.P,n.Info,"SessionCompletion timed out with no ack."),this.sendSessionCompletionMessageWithRetryHelper(t,i,e+1))},t.prototype.handleWacReadyMessage=function(t){if(this.he.readyMessageReceiveTime=Date.now(),this.sendWacPostMessage(G.Ti,{}),this.le)this.ne.ULS.u(596444194,r.P,n.Info,"Received multiple ready messages - frame is already loaded.");else{this.le=!0,this.ge=t&&t.CanAcceptStartSessionComplete;var i={AcceptStartSessionComplete:this.ge,ParallelizeStartSession:this.me,StartSessionResponse:null!=this.ye,WopiInfo:null!=this.be};this.ne.ULS.u(596444195,r.P,n.Info,"HandleWacReadyMessage - "+JSON.stringify(i)),this.ve&&(this.we?this.sendFailurePostMessageToWacFrame(this.we):this.sendWacPostMessage(G.xi,{})),this.me&&this.ge?this.ye&&this.startSessionCompleted():this.be&&this.sendWopiInfoToWacFrame(),Y(this.ue,t)}},t.prototype.handleWacFrameLoadedMessage=function(t){Y(this.ue,t)},t.prototype.handleWacFrameSessionCompleteAckMessage=function(t){this.Se=!0,this.he.sessionCompleteAckReceivedTime=Date.now()},t.prototype.sendWacPostMessage=function(t,i){this.fe&&this.se.sendPostMessage(this.fe.contentWindow,t,i)},t.prototype.sendSessionCompletionMessageWithRetry=function(t,i){this.sendSessionCompletionMessageWithRetryHelper(t,i,1)},t.prototype.sendSessionCompletionMessageWithRetryHelper=function(t,i,e){var o=this;if(e>3)this.ne.ULS.u(596444224,r.P,n.Error,"Attempted to call complete, but received no ack from the frame. Time: "+Date.now());else{this.ne.ULS.u(596444225,r.P,n.Info,"Sending completion message to frame. Attempt number: "+e+", Time: "+Date.now());var s=Date.now();1===e&&(this.ye&&this.ye.Diagnostics&&(this.ye.Diagnostics.completeMessageCreateTime=s),this.he.completeMessageCreateTime=s),i.Diagnostics.completeMessageSendTime=s,this.he.completeMessageSendTime=s,this.sendWacPostMessage(t,i),window.setTimeout((function(){return o.timeoutWacSessionCompletionMessageAck(t,i,e)}),1e3)}},t.prototype.makeStartSessionRequest=function(){var t=this;this.ne.ULS.u(596444226,r.P,n.Info,"Making parallelized startSession request.");var i=this.buildStartSessionUrl(this.be),e={"Content-Type":"application/x-www-form-urlencoded"},o="access_token="+encodeURIComponent(this.be.AccessToken)+"&access_token_ttl="+encodeURIComponent(ot(this.be));this.he.startSessionStartTime=Date.now(),function(t,i,e,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",t),e)o.setRequestHeader(r,e[r]);o.send(i)}(i,o,e,(function(i){return t.onStartSessionRequestCompleted(i)}))},t.prototype.onStartSessionRequestCompleted=function(t){if(this.he.startSessionCompleteTime=Date.now(),this.he.startSessionResponseStatus=t.status,this.ye={StartSessionResponse:{RequestStatus:t.status,ResponseText:t.responseText},Diagnostics:{wopiPendingInitializeTime:this.he.wopiPendingInitializeTime,wopiPendingCompleteTime:this.he.wopiPendingCompleteTime,startSessionStartTime:this.he.startSessionStartTime,startSessionCompleteTime:this.he.startSessionCompleteTime,readyMessageReceiveTime:this.he.readyMessageReceiveTime}},this.ne.ULS.u(596444227,r.P,n.Info,"StartSession request completed with status code: "+this.ye.StartSessionResponse.RequestStatus+", Time: "+Date.now()),this.le&&this.ge)this.startSessionCompleted();else{var i={WacFrameIsLoaded:this.le,InitializeCompleted:this.pe};this.ne.ULS.u(596444228,r.P,n.Info,"StartSessionCompleted not called - "+JSON.stringify(i))}},t.prototype.sendWopiInfoToWacFrame=function(){if(!this.pe){this.pe=!0,this.ne.ULS.u(596444229,r.P,n.Info,"Sending wopi info to the frame.");var t={WopiDetails:{WopiSrc:this.be.WopiSrc,AccessToken:this.be.AccessToken,AccessTokenTtl:ot(this.be)},Diagnostics:{wopiPendingInitializeTime:this.he.wopiPendingInitializeTime,wopiPendingCompleteTime:this.he.wopiPendingCompleteTime,readyMessageReceiveTime:this.he.readyMessageReceiveTime}};this.sendSessionCompletionMessageWithRetry(G.Ui,t)}},t.prototype.startSessionCompleted=function(){200===this.ye.StartSessionResponse.RequestStatus?this.pe||(this.pe=!0,this.sendSessionCompletionMessageWithRetry(G.Bi,this.ye)):this.sendWopiInfoToWacFrame()},t.prototype.buildStartSessionUrl=function(t){var i=this.oe.applicationBasePath+"wordeditorstartsession.ashx",e=nt(this.oe,this.re,!1);return i=I(i+="?"+e.substring(e.indexOf("?")+1),"WOPISrc",encodeURIComponent(t.WopiSrc)),i=I(i,"build",encodeURIComponent(x())),i=I(i,"WacUserType",encodeURIComponent("WOPI")),this.oe.wopiPrecheckInfo.FileGetUrl&&(i=I(i,"fileGetUrlPresent","1")),i},t.prototype.updateBrowserHistoryForCreateNew=function(t){if(this.oe.isCreateNew){if(!t||!t.NewFilePath)return void this.ne.ULS.u(596444230,r.P,n.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",t.NewFilePath),t.UpdatedPageTitle&&(document.title=t.UpdatedPageTitle)}},t}();!function(t){t.blurFocus="blurFocus",t.boot="boot",t.continueAccessibilityLoop="continueAccessibilityLoop",t.dispose="dispose",t.grabFocus="grabFocus",t.rename="rename",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.switchMode="switchMode"}(At||(At={})),function(t){t.AckExpected="ackExpected",t.ErrorObject="errorObject",t.ErrorType="errorType",t.IsDisabled="isDisabled",t.NewPageNumber="newPage",t.NewZoomLevel="newLevel",t.PageCount="pageCount"}(xt||(xt={}));var Rt=function(){function t(t,i){var e=this;if(this.Ie=!1,this.Oe=function(t){return e.handleWacFramePostMessage(t)},this.Ee=!1,this.Te=!1,this.Ce=!1,this.Ae={},!t)throw new Error("Missing origin for PostMessageHandler");this.Te=g(t),this.Ce=S(t),this.ne=i,this.setOrigin(t)}return t.prototype.registerMessagePayloadHandler=function(t,i){if(this.Ae[t])throw new Error("Duplicate registration!");this.Ae[t]=i},t.prototype.removeMessageHandler=function(t){delete this.Ae[t]},t.prototype.sendPostMessage=function(t,i,e){if(t){this.ne.ULS.u(596464334,r.P,n.Info,"Sending message: "+i);var o={MessageId:i,SendTime:Date.now(),Values:e};this.sendPostMessageInternal(t,JSON.stringify(o),this.xe)}else this.ne.ULS.u(595948308,r.P,n.Info,"Missing target for SendPostMessage")},t.prototype.activate=function(t,i){void 0===i&&(i=!1),this.fe=t,this.Ee=i,this.Ie||(window.addEventListener("message",this.Oe,!1),this.Ie=!0)},t.prototype.postMessageForCommand=function(t,i,e){var o;(o=i===At.sendWopiInfo?G.Di:void 0)?(this.ne.ULS.u(595702598,r.P,n.Info,"Sending message "+o+" for command "+i),this.sendPostMessage(t,o,e)):this.ne.ULS.u(595702599,r.P,n.Warning,"No mapping for command "+i)},t.prototype.dispose=function(){for(var t=0,i=Object.keys(this.Ae);t<i.length;t++){var e=i[t];delete this.Ae[e]}this.Ie&&(window.removeEventListener("message",this.Oe,!1),this.Ie=!1)},t.prototype.sendAckBack=function(t,i,e){if(t){var o={MessageId:G.gi,CorrelationId:e,SendTime:Date.now()};this.ne.ULS.u(595732176,r.P,n.Info,"Sending Ack back"),t.postMessage(JSON.stringify(o),i)}else this.ne.ULS.u(595736136,r.P,n.Info,"Missing target to send Ack back")},t.prototype.handleWacFramePostMessage=function(t){var i=!1,e=!0,o="",s=!1;if(this.fe&&this.fe.contentWindow&&(i=!0,e=t.source===this.fe.contentWindow),t.origin&&(s=(o=b(t.origin,2).toLowerCase())===this.Ue),!this.Te&&(!this.Ce||s&&e)||this.ne.ULS.u(595730526,r.P,n.Info,"Window is available: "+i+", window is valid: "+e+", origin is valid: "+s+", expected origin: "+this.Ue+", actual origin: "+o),s&&(!this.Ee||e)){var a;try{a=JSON.parse(t.data)}catch(i){return this.ne.ULS.u(596464282,r.P,n.Info,"Failed to parse event data: "+F(i)+"."),void(this.Te&&this.ne.ULS.u(595732175,r.P,n.Info,"string"==typeof t.data?"Length of event data: "+t.data.length+". First 200 characters of event data: "+t.data.substring(0,200):"Event data: "+JSON.stringify(t.data)))}var c=a.MessageId;if(c){this.ne.ULS.u(595714715,r.P,n.Info,"Received messageId: "+c+", correlation: "+a.CorrelationId),c!==q.Ut&&c!==q.qt||this.setOrigin(t.origin),a.Values&&a.Values[xt.AckExpected]&&this.sendAckBack(t.source,t.origin,a.CorrelationId);var u=this.Ae[c];if(u){this.ne.ULS.u(596464288,r.P,n.Info,"Processing message: "+c);try{u(a.Values||{})}catch(t){this.ne.ULS.u(593773704,r.P,n.Error,"Handler error: "+F(t))}}else this.ne.ULS.u(596464289,r.P,n.Info,"No handler found for message id: "+c)}else(this.Te||this.Ce)&&this.ne.ULS.u(595730520,r.P,n.Info,"Could not find message id")}},t.prototype.sendPostMessageInternal=function(t,i,e){t.postMessage(i,e)},t.prototype.setOrigin=function(t){var i=t.toLowerCase();this.xe&&this.xe!==i&&this.ne.ULS.u(596128131,r.P,n.Warning,"Updating origin:"+this.xe+"->"+i),this.xe=i,this.Ue=b(i,2),this.Te=g(i),this.Ce=S(i)},t}(),Pt=function(){function t(){var t=this;if(this.Re=[],this.Ae=[],this.Pe=function(){return t.handleVisibilityChange()},"hidden"===document.visibilityState){var i={visibility:document.visibilityState,time:Date.now(),initialState:!0};this.Re.push(i)}document.addEventListener("visibilitychange",this.Pe)}return t.prototype.RegisterEventHandler=function(t){this.Ae.push(t)},t.prototype.RemoveEventHandler=function(t){if(t){var i=this.Ae.indexOf(t);this.Ae.splice(i,1)}},t.prototype.Stop=function(){document.removeEventListener("visibilitychange",this.Pe)},t.prototype.GetVisibilityChangeEvents=function(){return this.Re},t.prototype.Dispose=function(){this.Stop(),this.Ae=[],this.Re=[]},t.prototype.handleVisibilityChange=function(){var t={visibility:document.visibilityState,time:Date.now(),initialState:!1};this.Re.push(t);for(var i=0,e=this.Ae;i<e.length;i++){var n=e[i];n&&n(t)}},t}();var Wt=function(){function t(){this.We=[]}return t.prototype.add=function(t){t&&this.We.push(t)},t.prototype.remove=function(t){if(t){var i=this.We.indexOf(t);i>-1&&this.We.splice(i,1)}},t.prototype.removeAll=function(){this.We=[]},t.prototype.dispatch=function(t,i){this.We.forEach((function(e){try{e(t)}catch(t){i&&i(t)}}))},t}(),Ft=function(){function t(t,i){var e=this;this.Fe=0,this.Ne=function(){if(e.ke){var t=new XMLHttpRequest;t.open("GET",e.ke),t.responseType="json",t.timeout=5e3,t.send(),t.onload=function(){if(200===t.status&&t.response?(e.setSettingsOnIdle(t.response),e.Fe=0):(e.ne.ULS.u(592836771,r.P,n.Error,"Fetch settings error. Status: "+t.status+", curErrors: "+e.Fe),e.Fe+=1),!(e.Fe>7)){var i=e.getValue(U.ht,3e5);e.Fe>3&&(i+=(e.Fe-3+1)*(i/2)),e.De=window.setTimeout(e.Ne,i)}}}},this.Me=t,this.Le="Prod"+t+"Settings",this.ne=i,this.Be=new Wt,this.getCurrentSettings()}return t.prototype.initializePeriodicFetch=function(t,i){g(t)&&(this.Le="FF"+this.Me+"Settings",this.getCurrentSettings()),this.ke=t+"AppSettingsHandler.ashx?app="+this.Me+"&usid="+i+"&build="+x(),this.De||(this.De=window.setTimeout(this.Ne,3e4))},t.prototype.getValue=function(t,i){if(this.He||this.getCurrentSettings(),!this.He||!this.He.hasOwnProperty(t))return i;var e=this.He[t],n=typeof i;if(typeof e===n)return e;if("string"==typeof e){if("number"===n)return parseInt(e,10);if("boolean"===n)return"true"===e}return i},t.prototype.addSettingsChangeListener=function(t){this.Be.add(t)},t.prototype.removeSettingsChangeListener=function(t){this.Be.remove(t)},t.prototype.dispose=function(){this.De&&window.clearTimeout(this.De),this.Je&&self.cancelIdleCallback(this.Je),this.De=void 0,this.Je=void 0,this.He=void 0,this.Be.removeAll()},t.prototype.getCurrentSettings=function(){try{if(!window||!window.localStorage)return;var t=window.localStorage.getItem(this.Le);if(!t)return;var i=JSON.parse(t);this.updateCurrentSettings(i)}catch(t){this.ne.ULS.u(592836768,r.P,n.Warning,"Failed to get settings from localStorage: "+F(t))}},t.prototype.updateCurrentSettings=function(t){var i=this;return!!this.isValidSettings(t)&&(this.He=t,this.Be.dispatch({settingsManager:this},(function(t){i.ne.ULS.u(592836769,r.P,n.Error,"Settings listener error: "+F(t))})),!0)},t.prototype.isValidSettings=function(t){if(t&&"object"==typeof t){if(t.hasOwnProperty(U.ft)&&!isNaN(t.timestamp))return!0;this.ne.ULS.u(592836770,r.P,n.Error,"Received invalid settings")}return!1},t.prototype.setSettingsOnIdle=function(t){var i=this;"requestIdleCallback"in window?(this.Je&&self.cancelIdleCallback(this.Je),this.Je=window.requestIdleCallback((function(){return i.setSettings(t)}),{timeout:1e4})):window.setTimeout((function(){return i.setSettings(t)}),0)},t.prototype.setSettings=function(t){if(this.updateCurrentSettings(t)&&window&&window.localStorage){var i=JSON.stringify(t);try{window.localStorage.setItem(this.Le,i)}catch(t){this.ne.ULS.u(592836800,r.P,n.Warning,"Failed to set localStorage: "+F(t))}}},t}();function Nt(t,i){return{isFeatureEnabled:function(e){return function(t,i,e){if(!i)return;try{return i(t)}catch(t){e&&e.ULS.u(594883024,r.P,n.Error,"IsFeatureEnabled callback error: "+F(t))}return}(e,t,i)}}}var kt=["excel-boot.min.js"];var Dt,Mt=function(){function t(t,i){this.je=t,this.ze=i}return t.prototype.GetVersion=function(){return x()},t.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},t.prototype.Prefetch=function(t){if(null!=t&&void 0!==t){var i=document.createElement("link");i.rel="prefetch";var e=t.BootstrapperUrl;".js"!==e.toString().slice(-3)&&(e+=".js"),i.href=e;var n=document.getElementsByTagName("head")[0];null!=n&&void 0!==n&&n.appendChild(i)}},t.prototype.InitializeWopiPending=function(t,i,e,o,s,a){var c,u;try{var h=Date.now();!function(t){if(void 0===t)throw new TypeError("initParams");var i=t.Container;if(void 0===i||void 0===i.appendChild)throw new TypeError("Container");var e=t.SessionInformation;if(void 0===e||void 0===e.HostName||void 0===e.HostSessionId||void 0===e.UserId)throw new TypeError("SessionInformation");var n=t.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=t.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===t.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===t.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(t),function(t){var i=t.RebootOverrideData;if(i){var e=i.mode;if(!e)throw new Error("Missing mode in RebootOverrideData");if("view"!==(e=e.toLowerCase())&&"edit"!==e)throw new Error("Unknown mode in RebootOverrideData");0,i.queryOverrides||(i.queryOverrides={}),i.queryOverrides.wdforcedmode="view"===e?"View":"Edit"}}(t);var l=void 0,d=void 0;e?l=e:t.RebootOverrideData&&!t.RebootOverrideData.isNewSession&&t.RebootOverrideData.previousSessionId?l=t.RebootOverrideData.previousSessionId:(l=(c=J())[0],d=c[1]);var p=function(t,i,e,n,o,r){void 0===r&&(r=!1),t.SessionInformation.IsCore&&(t.SessionInformation.HideViewerToolbar=!0),function(t,i){t.SessionInformation.WdParams||(t.SessionInformation.WdParams={});if(t.SessionInformation.WdParams.wd)return;i.substring(1).split("&").filter((function(i){if(0===i.indexOf("wd")){var e=i.split("=");e[0].length>2&&(t.SessionInformation.WdParams[e[0]]=e[1])}})),t.RebootOverrideData&&t.RebootOverrideData.isNewSession&&t.RebootOverrideData.previousSessionId&&(t.SessionInformation.WdParams.wdprevioussession=t.RebootOverrideData.previousSessionId)}(t,window.location.search);var s=o||new Ft("Excel",e);return{container:t.Container,sessionInformation:t.SessionInformation,applicationUrl:t.ApplicationUrl,wopiPrecheckInfo:t.WopiPrecheckInfo,applicationCustomSettings:t.ApplicationCustomSettings,diagnostics:{HostInitializeDiagnostics:t.Diagnostics},fnOnInitializeSuccess:t.FnOnInitializeSuccess,fnOnInitializeFailure:t.FnOnInitializeFailure,sessionId:i,applicationBasePath:Q(t.ApplicationUrl),wopiInfo:t.WopiInfo,forceSingleStepBoot:r,isCreateNew:t.WopiPrecheckInfo.IsNewFile||"1"===y(t.ApplicationUrl,"new"),featureManager:n||Nt(t.FnIsFeatureEnabled,e),settingsManager:s,newFileTemplateSource:t.NewFileTemplateSource,rebootOverrideData:t.RebootOverrideData}}(t,l,u=i||K({remoteUlsEndpoint:Q(t.ApplicationUrl)+"RemoteUls.ashx",sessionId:l}),s,a,this.ze.forceSingleStepBoot);a||(p.settingsManager.addSettingsChangeListener(u.settingsChangeHandler),p.settingsManager.initializePeriodicFetch(p.applicationBasePath,l)),p.diagnostics.HostInitializeDiagnostics&&(p.diagnostics.HostInitializeDiagnostics.hostInitializeCallTime=h),et(u,p,d),function(t,i){R=function(){return D(t,"OnBeforeUnload",i)},P=function(){return D(t,"OnPageHide",i)},W=function(){return D(t,"VisibilityChange_"+document.visibilityState,i)},window.addEventListener("beforeunload",R,{capture:!0,once:!0}),window.addEventListener("pagehide",P,{capture:!0}),window.addEventListener("visibilitychange",W,{capture:!0})}(u,!0);var v,w=function(t){return function(t,i){if(t){var e=F(i);/{("isTrusted":\w{4,5})?}/.test(e)||(t.ULS.u(594895886,r.P,n.Warning,"Unhandled Error:"+e),t.ULS.flush())}}(u,t)};window.addEventListener("error",w,{capture:!0});var m=t.BootstrapperUrl;m&&(v=this.periodicPrefetch(m,u));var g=function(){p.settingsManager.dispose(),window.removeEventListener("beforeunload",R,{capture:!0}),window.removeEventListener("pagehide",P,{capture:!0}),window.removeEventListener("visibilitychange",W,{capture:!0}),window.removeEventListener("error",w,{capture:!0}),window.clearInterval(v)},S=_(t.ApplicationUrl),b=o||new Rt(S,u),I=new Pt,E={},T=function(t,i){var e={isSingleStepBoot:t.forceSingleStepBoot,bootFlowType:t.forceSingleStepBoot?$.forceSingleStepBoot:$.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(t.forceSingleStepBoot,e.isSingleStepBoot){var o={singleStepBootIsRequired:!0,singleStepBootReason:e.bootFlowType,irmEnabled:t.wopiPrecheckInfo.IrmEnabled,readOnly:t.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:e.ignoreWacFramePostMessages};i.ULS.u(596444182,r.P,o.irmEnabled?n.Warning:n.Info,JSON.stringify(o))}else i.ULS.u(596444183,r.P,n.Info,"Received input valid for two step flow");return e}(p,u),C=f(f({},p.diagnostics.HostInitializeDiagnostics),{officeSessionId:p.sessionId,officeBootstrapperVersion:x(),hostName:p.sessionInformation.HostName}),A=function(t,i,e,o,s,a,c,u,h){return function(f){it(t,s,a),tt(s,o,n.Info),o.ULS.u(596448985,r.P,n.Info,JSON.stringify(t));var l=h(i,o,e,c,f);try{u(l,t)}catch(t){o.ULS.u(595719171,r.P,n.Error,"Exception thrown from host's success callback: "+F(t))}N("excel",o)}}(C,p.sessionId,b,u,E,I,g,t.FnOnInitializeSuccess,this.je),U=function(t,i,e,o,s){return function(a){it(t,e,o),tt(e,i,n.Warning),i.ULS.u(596448986,r.P,n.Error,JSON.stringify({error:a,appInitDiagnostics:t}));try{s(a,t)}catch(t){i.ULS.u(595719172,r.P,n.Error,"Exception thrown from host's failure callback: "+F(t))}N("excel",i)}}(C,u,E,I,t.FnOnInitializeFailure);if("undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}}),t.FnOnAppModeSwitched&&b.registerMessagePayloadHandler(q.Gt,t.FnOnAppModeSwitched),t.WopiPrecheckInfo.ReadOnly&&t.FnOnAppModeSwitched,m&&this.ze.preloader&&this.ze.preloader.shouldPreload(p.applicationUrl))try{var k=m;(function(t){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",(function(){try{for(var i=0,e=window.performance.getEntriesByType("resource");i<e.length;i++){var o=e[i],s=O(o.name);if("about:blank"!==o.name&&-1===s.indexOf("RemoteUls.ashx")&&-1===s.indexOf("mhtml:file")&&-1!==kt.indexOf(s)){var a=JSON.stringify(o);a=a.replace(new RegExp(o.name,"g"),s),t.ULS.u(595736532,r.P,n.Info,a)}}window.performance.clearResourceTimings()}catch(i){t.ULS.u(595732049,r.P,n.Info,"ExcelPreloader.tryObserveResourceTiming: could not trace resource timing, error is: "+JSON.stringify(i))}}),{once:!0})})(u),p.featureManager.isFeatureEnabled(X.$i)&&(u.ULS.u(595645891,r.P,n.Info,"HTTP2 preload enabled"),k=function(t){var i=new RegExp("(c[1-5])h?(-)");return t.replace(i,"$1h$2")}(m));var M=p.sessionInformation.UiLocale;M||(M=decodeURIComponent(y(p.applicationUrl,"ui"))),this.ze.preloader.preload(k,M,u,p.featureManager)}catch(t){u.ULS.u(595943884,r.P,n.Error,F(t))}var L=new Ut(p,T,C,u,b,E,g,A,U);return L.Boot(),L}catch(i){return u&&(u.ULS.u(596459925,r.P,n.Error,Z.AppInitError+": "+F(i)),u.ULS.flushOnClose()),void t.FnOnInitializeFailure({errorType:Z.AppInitError,errorObject:i},void 0)}},t.prototype.periodicPrefetch=function(t,i){var e=this;return window.setInterval((function(){e.Prefetch({BootstrapperUrl:t}),i.ULS.u(595895774,r.P,n.Info,"Prefetching "+O(t))}),36e5)},t}();!function(t){t.BrowserEvent="BrowserEvent",t.PageChanged="PageChanged",t.ZoomChanged="ZoomChanged",t.ContentRefreshBegin="ContentRefreshBegin",t.ContentRefreshEnd="ContentRefreshEnd",t.AppClosed="UI_Close",t.UserEdit="Edit_Notification",t.FileRename="File_Rename",t.FileShare="UI_Sharing",t.ShowFileVersions="UI_FileVersions",t.UIWorkflow="UI_Workflow",t.IsDisabled="IsDisabled",t.AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.Unloaded="Unloaded",t.SwitchMode="App_SwitchMode",t.DocumentReboot="DocReboot",t.WopiInfoFromUrl="WopiInfoFromUrl",t.ModeSwitched="ModeSwitched"}(Dt||(Dt={}));var Lt=function(){function t(t,i,e,n,o){this.Ae={},this.Ve=!1,this.qe=!1,this.Ge=t,this.ne=i,this.fe=o.innerApplicationFrame,this.se=e,this.Xe=n,this.registerPostMessageHandlers(),Et()}return t.prototype.GetApplicationType=function(){throw new Error("Not implemented")},t.prototype.GetVersion=function(){return x()},t.prototype.GetSessionId=function(){return this.Ge},t.prototype.RegisterEventHandler=function(t,i){if(this.qe)throw new Error("RegisterEventHandler is not supposed to be called");this.Ve=!0,this.registerEventHandlerInternal(t,i)},t.prototype.RemoveEventHandler=function(t,i){if(this.qe)throw new Error("RemoveEventHandler is not supposed to be called");switch(t){case Dt.Unloaded:case Dt.DocumentReboot:case Dt.WopiInfoFromUrl:if(this.Ae[t]!==i)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ae[t];break;default:this.se.removeMessageHandler(t)}},t.prototype.RegisterErrorHandler=function(t){},t.prototype.RemoveErrorHandler=function(t){},t.prototype.RegisterAllEventsHandler=function(t){throw new Error("RegisterAllEventsHandler is not supposed to be called")},t.prototype.PostCommand=function(t,i){this.se.postMessageForCommand(this.fe.contentWindow,t,i)},t.prototype.Dispose=function(t,i){var e=this;Tt(t||!1,this.ne,this.se,this.fe,(function(){delete e.fe,e.Xe(),e.se.dispose(),e.raiseEvent(Dt.Unloaded,{});for(var t=0,i=Object.keys(e.Ae);t<i.length;t++){var n=i[t];delete e.Ae[n]}}),i)},t.prototype.registerEventHandlerInternal=function(t,i){switch(t){case Dt.Unloaded:case Dt.DocumentReboot:case Dt.WopiInfoFromUrl:if(this.Ae[t])throw new Error("Duplicate registration");this.Ae[t]=i;break;default:this.se.registerMessagePayloadHandler(t,i)}},t.prototype.registerPostMessageHandlers=function(){this.se.registerMessagePayloadHandler(q.Qt,this.handleDocumentRebootMessage.bind(this)),this.se.registerMessagePayloadHandler(q.jt,this.handleWopiInfoFromUrlRequest.bind(this))},t.prototype.raiseEvent=function(t,i){var e=this.Ae[t];if(e)try{e(i||{})}catch(t){this.ne.ULS.u(593773706,r.P,n.Error,"Handler error: "+F(t))}},t.prototype.handleDocumentRebootMessage=function(t){t.previousSessionId=this.Ge,this.raiseEvent(Dt.DocumentReboot,t)},t.prototype.handleWopiInfoFromUrlRequest=function(t){this.raiseEvent(Dt.WopiInfoFromUrl,t)},t}();var Bt;!function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(Bt||(Bt={})),e.d(i,"Application",(function(){return jt})),e.d(i,"DocRebootSupportMode",(function(){return Bt})),e.d(i,"CommandIds",(function(){return At}));var Ht,Jt,jt=new Mt((function(t,i,e,n,o){return new Lt(t,i,e,n,o)}),{forceSingleStepBoot:!0,preloader:(Ht=function(t){return t.toLowerCase().indexOf("_layouts/xlviewerinternal.aspx".split("/")[1])>0},Jt=function(t,i,e){var n=_(t)+"/x/s/"+function(){var t=x();if(!t)throw new Error("Build number not available");var i=t.split(".");if(4!==i.length)throw new Error("Build number has incorrect format");return i[0]+i[2]+i[3]}()+"__layouts/",o=["App_Scripts/Ewa.js","App_Scripts/Aacorlib.min.js","App_Scripts/CookieCompliance.js","App_Scripts/gridRenderer.min.js"],r=function(t){var i=t?t.toLowerCase().split("-")[0]:"en";return C[i]}(i);return r&&(o=o.concat(["App_Scripts/"+r+"/Ewa.Strings.Wac.js","Resources/"+r+"/EwrDefault.css","Resources/"+r+"/excelframe.css"])),e&&e.isFeatureEnabled(X.qi)&&o.push("App_Scripts/adaptiveLayout.min.js"),o.map((function(t){return kt.push(t.substring(t.lastIndexOf("/")+1)),n+t}))},{shouldPreload:function(t){return Ht(t)},preload:function(t,i,e,o){Jt(t,i,o).forEach((function(t){!function(t,i,e){var o=document.createElement("link");if(o.setAttribute("crossorigin","anonymous"),o.rel=T,o.href=t,i){var s=e||O(t);i.ULS.u(592315601,r.P,n.Info,"Preloading resource: "+s),o.addEventListener("error",(function(){i.ULS.u(592479445,r.P,n.Error,"Resource failed to load: "+s)}))}o.setAttribute("as","script"),document.head.appendChild(o)}(t,e)}))}})})}});

