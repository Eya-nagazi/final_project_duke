var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return c})),r.d(t,"f",(function(){return s}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function u(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}c((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function s(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9);t.utils=n;var a=r(10);t.ULS=a.ULS,t.TraceLevel=a.TraceLevel,t.LogCategory=a.LogCategory,t.NulLogger=a.NulLogger,t.ConsoleLogger=a.ConsoleLogger;var i=r(11);t.browserSupport=i;var o=r(12);t.perfWatch=o;var u=r(13);t.initEwaUtils=u.initEwaUtils,t.ewaUtils=u.ewaUtils;var c=r(14);t.initStopwatchFactory=c.initStopwatchFactory;var s=r(15);t.getNewGuid=s.getNewGuid;var l=r(16);t.TextAreaVirtualKeyboardPolicy=l.TextAreaVirtualKeyboardPolicy,t.TextAreaInputMode=l.TextAreaInputMode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.mathpack=n;var a=r(20);t.dtr=a,r(4)._start()},function(e,t,r){"use strict";r.r(t);var n=r(0);function a(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}var i=function(e){function t(t,r){var n=this.constructor,a=e.call(this,t)||this;a.info=r,a.name="WorkerError";var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return Object(n.c)(t,e),t.isWorkerError=a,t}(Error);function o(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function u(e){return o(e)?e:new Error("(non-Error object) "+e)}var c={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function s(e){return{name:e.name,message:e.message,stack:e.stack,info:a(e)?(t=e.info,Object(n.a)(Object(n.a)({},t),{error:t.error?s(t.error):void 0})):void 0};var t}function l(e){return o(e)?{isError:!0,value:s(e)}:{isError:!1,value:e}}function f(e){var t;if("WorkerError"===e.name)t=new i(e.message,function(e){return Object(n.a)(Object(n.a)({},e),{error:e.error?f(e.error):void 0})}(e.info));else{var r=c[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function d(e){return e.isError?f(e.value):e.value}function h(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function v(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function p(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function m(e,t){var r=p(),n=function(t,r){var n;return null!=(n=t[r])?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function g(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}var C;function S(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function E(e){if(C)throw new TypeError("setConfig has already been called");C=e}function y(){var e=null!=C?C:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(n.f)(e.importScriptUrls):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName}}function O(e,t){var r,n=null!=(r=t.stack)?r:t.message;console.warn(e+": "+n),a(t)&&console.warn("WorkerError info:",t.info)}function A(e){if(g()){var t={kind:1,error:l(e)};self.postMessage(t)}else O("defaultOnWorkerError",e)}function k(e){var t,r;try{(null!=(r=null===(t=C)||void 0===t?void 0:t.onWorkerError)?r:A)(e)}catch(t){O("dispatchWorkerError",u(t)),O("dispatchWorkerError (original)",e)}}function b(e){if(g()){var t={kind:2,stats:e};self.postMessage(t)}}function R(e){var t,r;try{(null!=(r=null===(t=C)||void 0===t?void 0:t.onCreateWorker)?r:b)(e)}catch(e){O("dispatchCreateWorker",u(e))}}var I=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return I.transfer.apply(I,Object(n.f)([e,void 0],t))};I.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var T=-1,N=function(){function e(e,t){var r,n,a=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=p();var i=function(){var e,t;return null===(t=(e=a).onClose)||void 0===t?void 0:t.call(e)},o=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r,n=e.funcNames;null===(r=(t=a).onImports)||void 0===r||r.call(t,m(a.createPostProxy.bind(a),n),m(a.createCallProxy.bind(a),n))},r[3]=i,r),u=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=i,n[3]=i,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return u[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:"function"==typeof Proxy?void 0:function(e){for(var t=p();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var a=n[r];try{"function"==typeof e[a]&&(t[a]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,a={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new i("Importing Endpoint closed while waiting for "+n+" result",a))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,a=e.args,o=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,a);var o=r>=0?"call":"post",u={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new i("Exporting Endpoint received a "+o+" to unknown function "+n,u)}));r>=0?o.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):o.catch((function(e){return t.sendResult(r,n,!1,e)}))},e.prototype.sendResult=function(e,t,r,n){var a={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:l(n)};try{this.port.postMessage(a,void 0)}catch(e){this.onSendResultFailed(a,u(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,a=e.resultValue,o=t?"Exporting Endpoint failed to send "+n+" result":"Importing Endpoint failed to deserialize "+n+" result",u={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},c=new i(o,u);a.isError?k(c):this.sendResult(r,n,!1,c)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var a=this;if(r>1<<30)return n;return v(r,(function(){var n=a.takeCallbacks(e);if(n){var o={cause:"Timeout",idInfo:a.idInfo,timeout:r,callId:e,funcName:t};n.reject(new i("Importing Endpoint's call to "+t+" timed out",o))}}),n)},e.prototype.sendCall=function(e,t,r,a){var o=this;return new Promise((function(c,s){var l=T+=1,f={kind:0,callId:l,funcName:e,args:t};o.unresolvedCalls[l]=Object(n.a)(Object(n.a)({},o.setCallTimeout(l,e,r,{resolve:c,reject:s})),{funcName:e});try{o.port.postMessage(f,a)}catch(t){var d=o.takeCallbacks(l);if(d){var h=u(t),v={cause:"MessageError",idInfo:o.idInfo,error:h,callId:l,funcName:e};d.reject(new i("Importing Endpoint failed to send call to "+e,v))}}}))},e.prototype.sendPost=function(e,t,r){var n={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(n,r)}catch(t){var a=u(t),o={cause:"MessageError",idInfo:this.idInfo,error:a,callId:-1,funcName:e};throw new i("Importing Endpoint failed to post to "+e,o)}},e.prototype.onSendInvokeFailed=function(e){var t,r,n=e.callId,a=e.funcName,o=n>=0?"call":"post",u={cause:"MessageError",idInfo:this.idInfo,callId:n,funcName:a},c=new i("Exporting Endpoint failed to deserialize "+o+" to "+a,u);(null!=(r=null===(t=n>=0?this.takeCallbacks(n):void 0)||void 0===t?void 0:t.reject)?r:k)(c)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,a=e.resultValue;if(t>=0){var o=this.takeCallbacks(t);if(o)(n?o.resolve:o.reject)(d(a))}else if(!n){var u=a.isError?f(a.value):void 0,c={cause:"UnhandledError",idInfo:this.idInfo,error:u,callId:t,funcName:r};k(new i("Exporting Endpoint's "+r+" implementation threw or rejected",c))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.f)([void 0],e))};return r.transfer=function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];t.isClosed||t.sendPost(e,n,r)},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.f)([void 0],e))};return r.transfer=function(n){for(var a,o,u,c,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];if(t.isClosed){var f={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new i(t.idInfo.side+" Endpoint's call."+e+" called after close",f))}var d=null!=(c=null!=(a=r.timeout)?a:null===(u=(o=t).getCallTimeout)||void 0===u?void 0:u.call(o))?c:1/0;return t.sendCall(e,s,d,n)},r.timeout=void 0,r},e}();var F,_=function(){function e(e,t,r){this.callTimeout=1/0,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new i(e.side+" Endpoint's "+t+" referenced before the "+r+" Endpoint started",n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var a,o,u,c=r.port,s=r.options,l=r.createMode,f={type:"Endpoint",side:t,id:null===(a=s)||void 0===a?void 0:a.id};try{o=new N(f,c),u=new e(f,o,l)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var a;o.getCallTimeout=function(){return u.callTimeout},o.onImports=function(e,t){Object.defineProperties(u,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),d.resolve()},o.onClose=function(){return u.close("Force")};var c,l=function(e){var t,r,n,a;return null!=(a=null!=(r=null===(t=e)||void 0===t?void 0:t.createTimeout)?r:null===(n=C)||void 0===n?void 0:n.createTimeout)?a:3e5}(s),d=v(l,(function(){var e=new i(t+" Endpoint timed out waiting for the "+("Outside"===t?"inside":"outside")+" to start",{cause:"Timeout",idInfo:f,timeout:l});d.reject(e)}),{resolve:e,reject:r});u._closedDuringCreate=function(){d.resolve()};try{c=n(u)}catch(e){return d.reject(e)}null===(a=u._state)||void 0===a||a.setExports(c)})).then((function(){return u._closedDuringCreate=void 0,u}),(function(e){return u._closedDuringCreate=void 0,u.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new i(this._idInfo.side+" Endpoint's close called during creation",n)}this._closedDuringCreate()}var a=this._state;this._state=void 0;try{a.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:u(e)};k(new i(this._idInfo.side+" Endpoint's close threw an error",n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r).then((function(){}))},e}(),M=function(){!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){r.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,u=i.length;o<u;o++,a++)n[a]=i[o];return n}function o(e){return u(e)&&"WorkerError"===e.name&&"object"==typeof e.info}!function(e){function t(t,r){var n=this.constructor,a=e.call(this,t)||this;a.info=r,a.name="WorkerError";var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}(function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(t,e),t.isWorkerError=o}(Error);function u(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError;function c(e){return{name:e.name,message:e.message,stack:e.stack,info:o(e)?(t=e.info,a(a({},t),{error:t.error?c(t.error):void 0})):void 0};var t}function s(e){throw new ReferenceError(e+" is not defined")}function l(e,t,r){void 0===r&&(r=s);try{for(var n=t.split("."),a=0,i=n;a<i.length;a++){e=e[i[a]]}return null!=e?e:r(t)}catch(e){return r(t)}}var f=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return f.transfer.apply(f,i([e,void 0],t))};f.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var d="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function h(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:d()))}self.onmessage=function(e){var t,r=e.data,n=r.config,a=r.port,s=r.options,f=r.script,v=r.args;function p(){var e;if(t)return t;if(void 0===n.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return importScripts(n.typedWorkersUrl),(t=l(self,null!=(e=n.typedWorkersName)?e:"typedWorkers")).setConfig(n),t}self.onmessage=null,self.__typed_workers_thread=!0;var m={status:"Pending",start:d()};function g(e,t){var r,n={kind:0,error:e?void 0:(r=function(e){return u(e)?e:new Error("(non-Error object) "+e)}(t),u(r)?{isError:!0,value:c(r)}:{isError:!1,value:r}),stopwatch:m};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw h(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!=(r=h(e,"Success"))?r:t}),r)}catch(e){r(e)}})(m,(function(){var e,t,r;return importScripts.apply(void 0,i(null!=(r=null!=(t=null===(e=s)||void 0===e?void 0:e.importScriptUrls)?t:n.importScriptUrls)?r:[],void 0!==f.scriptUrl?[f.scriptUrl]:[])),l(self,f.insideInitName).apply(void 0,i([{config:n,importTypedWorkers:p,connection:{port:a,options:s,createMode:"Thread"}}],v))})).then((function(){return g(!0)}),(function(e){return g(!1,e)}))}catch(e){g(!1,e)}}}])},w=-1;function L(){return void 0===F&&(F="("+M.toString()+")();"),F}var D=function(){function e(e){var t,r;try{var n;t=function(e){var t="def"in e?e:I(e),r=t.def,n=t.args,a=t.transferables;if("function"!=typeof r)return[r,n,a,void 0];var i="__generatedInsideInit"+(w+=1);return[{scriptUrl:void 0,insideInitName:i},n,a,"var "+i+" = "+r.toString()+";"]}(e),this.script=t[0],this.args=t[1],this.transferables=t[2];var a=void 0===(n=t[3])?[L()]:[n,"\n\n",L()];this.blobUrl=URL.createObjectURL(new Blob(a,{type:"application/javascript"})),this.worker=new Worker(this.blobUrl)}catch(e){throw null===(r=this.worker)||void 0===r||r.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,u=e.port,c=e.options,s={type:"Thread",side:"Outside",id:c.id},l=this.worker;return h(new Promise((function(e,f){r.createCallbacks={resolve:e,reject:f};var h={config:y(),port:u,options:c,script:r.script,args:r.args};l.postMessage(h,Object(n.f)([u],r.transferables)),l.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(o(r.error)){if(a(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new i(t+" received an unhandled error",n)}if(null==r.message)return new i(t+" received a non-error (worker script fetch probably failed)",{cause:"UnhandledError",idInfo:e});var u={cause:"UnhandledError",idInfo:e},c=r.message+" at "+r.filename+":"+r.lineno+":"+r.colno;return new i(t+" received an unhandled error: "+c,u)}(s,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):k(t)},l.onmessage=function(e){var n,a,i=e.data;switch(i.kind){case 0:return t.insideInit=i.stopwatch,void 0===i.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(a=r.createCallbacks)||void 0===a?void 0:a.reject(d(i.error));case 1:return k(d(i.error));case 2:return R(i.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),U="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function x(){return{status:"Pending",start:U()}}function P(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:U()))}function G(e,t){function r(t){throw P(e,a(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!=(r=P(e,"Success"))?r:t}),r)}catch(e){r(e)}}function V(e){return Math.round(1e3*e)/1e3}function B(e,t,r){return e<t?t:e>r?r:e}function W(e,t,r){var n,a,i,o,u,c,s=B(null!=(a=null===(n=e)||void 0===n?void 0:n.start)?a:1/0,t,r),l=B(null!=(o=null===(i=e)||void 0===i?void 0:i.end)?o:1/0,t,r);return{status:(c=null===(u=e)||void 0===u?void 0:u.status,null!=c?c:"Pending"),start:V(s-t),end:V(l-t),duration:V(l-s)}}var j=function(){return r(3)};function H(e,t,r,n,a){var i,o=new MessageChannel,u=o.port1,c=o.port2;return Promise.all([n({port:u,options:e,createMode:t}),G(r.createOutside=x(),(function(){return _.createOutside({port:c,options:e,createMode:t},(function(e){return a(i=e)}))}))]).then((function(){return i}),(function(e){return i?i.close("Force"):c.close(),Promise.reject(e)}))}function K(e,t,r,a){return H(e,"Local",t,(function(e){return function(e,t,r){var a="def"in r?r:I(r),o=a.def,u=a.args;if("function"!=typeof o){var c={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new i("Loading an InsideScript to create a local worker is unimplemented",c))}return Promise.resolve().then((function(){return G(t.insideInit=x(),(function(){return o.apply(void 0,Object(n.f)([{config:y(),importTypedWorkers:j,connection:e}],u))}))}))}(e,t,r)}),a)}function q(e,t,r,n){var a;t.createThread=x();try{a=new D(r)}catch(e){return P(t.createThread,"Error"),Promise.reject(e)}return P(t.createThread,"Success"),H(e,"Thread",t,(function(e){return a.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e}),(function(e){return a.terminate(),Promise.reject(e)}))}function J(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n,a,i=null!=(a=null!=(r=null===(t=e)||void 0===t?void 0:t.createMode)?r:null===(n=C)||void 0===n?void 0:n.createMode)?a:"Thread";return"ThreadOrLocal"===i?S()?"Thread":"Local":i}(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?K:q,o={id:e.id,createMode:n,createWorker:x()};return h(G(o.createWorker,(function(){return i(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls}}(e),o,a,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,a=e.insideInit,i=e.createOutside,o=e.createThread,u=n.status,c=n.start,s=n.end;if("Pending"!==u&&void 0!==s)return{id:t,createMode:r,createWorker:{status:u,absStart:c,duration:V(s-c)},createThread:"Thread"===r?W(o,c,s):void 0,createOutside:W(i,c,s),insideInit:W(a,c,s)}}(o);e&&R(e)}))}r.d(t,"WorkerError",(function(){return i})),r.d(t,"isThreadingSupported",(function(){return S})),r.d(t,"setConfig",(function(){return E})),r.d(t,"paramInsideDef",(function(){return I})),r.d(t,"Endpoint",(function(){return _})),r.d(t,"createWorker",(function(){return J}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__growWasmMemory=t.stackRestore=t.stackAlloc=t.stackSave=t.setThrew=t.__errno_location=t._start=t.Mathpack_Pack=t.Mathpack_FormatGeneral=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Acos=t.Mathpack_Asin=t.Mathpack_Tan=t.Mathpack_Cos=t.Mathpack_Sin=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_Exp=t.Mathpack_Sqrt=t.Mathpack_ViewRound=t.Mathpack_Equal=t.Mathpack_GetExp32=t.Mathpack_Compare=t.Mathpack_RoundDown=t.Mathpack_RoundUp=t.Mathpack_Round=t.Mathpack_SFix=t.Mathpack_LFix=t.Mathpack_Fix=t.Mathpack_SFloat=t.Mathpack_Float=t.Mathpack_Neg=t.Mathpack_Abs=t.Mathpack_Floor=t.Mathpack_Ceil=t.Mathpack_Trunc=t.Mathpack_TakeMathError=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Power=t.Mathpack_Add=t.Mathpack_Sub=t.Mathpack_Mul=t.Mathpack_Div=t.Mathpack_Pi=t.Mathpack_One=t.Mathpack_Zero=t.Dtr_ToNum=t.Dtr_FracSec=t.Dtr_Wdy=t.Dtr_Sec=t.Dtr_Min=t.Dtr_Hour=t.Dtr_DOM=t.Dtr_Mon=t.Dtr_Yr=t.Dtr_FromNum=t.Dtr_DaysPerMonth=t.Base_StrBufSize=t.Base_StrBuf=t.memory=void 0;var n=r(17),a=r(18),i=r(19),o=new ArrayBuffer(8),u=new Int32Array(o),c=(new Float32Array(o),new Float64Array(o));function s(e){return u[e]}function l(e,t){u[e]=t}function f(){return c[0]}function d(e){c[0]=e}var h,v=new ArrayBuffer(65536),p=(h=new Uint8Array(v),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)h[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)h[e+n]=r[n]});p(1024,"+AgAAAEAAAACAAAAAwAAAAAAAAAE"),p(1056,"yAgAANAIAADYCAAA4AgAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),p(1152,"kAgAAKgIAACgCAAAsAg="),p(1175,"oAQ="),p(1191,"yAc="),p(1207,"+go="),p(1222,"QJwO"),p(1238,"UMMR"),p(1254,"JPQU"),p(1269,"gJaYGA=="),p(1285,"ILy+Gw=="),p(1301,"KGvuHg=="),p(1317,"+QKVIg=="),p(1332,"QLdDuiU="),p(1348,"EKXU6Cg="),p(1364,"KueEkSw="),p(1379,"gPQg5rUv"),p(1395,"oDGpX+My"),p(1411,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),p(2214,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),p(2401,"Sg==");var m=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),c=new e.Uint32Array(r),h=(new e.Float32Array(r),new e.Float64Array(r)),v=e.Math.imul,p=(e.Math.fround,e.Math.abs),m=(e.Math.clz32,e.Math.min),g=(e.Math.max,e.Math.floor),C=e.Math.ceil,S=e.Math.sqrt,E=t.abort,y=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),O=t.Base_LocaleGetOrdinal,A=t.Base_LocaleDecimalSeparator,k=t.Math_log10,b=t.Math_log,R=(S=t.Math_sqrt,t.Math_sin),I=t.Math_cos,T=t.Math_tan,N=t.Math_atan,F=t.Math_exp,_=t.proc_exit,M=18784;function w(){}function L(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function D(e,t){var r,c,l=0,f=0,v=0,p=0;if(f=2368,M=r=M-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,h[296]=e,c=G(e),h[296]=c,le(c,r+40|0,r),u[r+42>>1]){l=(0|(l=re(t)<<16))<0?100:l>>16,d(+t),v=0|s(1),s(0),(p=-65536&v)&&(2146435072!=(2146435072&v)?l=(0|p)<1?0-l|0:l:i[594]=1);e:{if(!((0|(l=a[r+40>>1]+l|0))>=a[r+42>>1])){if((0|l)<1){f=2200;break e}(255&l)>>>0>=o[r+30|0]||(n[r+30|0]=l)}se(2300,2368,r)}e=h[f>>3]}return M=r+48|0,e}function U(e,t){var r,n=0,a=0,o=0;if(h[296]=e,d(+e),a=0|s(1),s(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[594]=1,a=0)),i[593]=2147483647&o,J(h[274]),n=-65536&(o=i[593]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return V(8),0}else i[594]=1;r=Q(h[274],e),h[296]=Q(h[272],r),X(r),ie();e:{t:{if((n=i[593])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[594]=1}if(t){if(i[592]=0,i[593]=0,!a)break e;return t=i[541],i[592]=i[540],i[593]=t,h[296]}if(n=i[547],i[592]=i[546],i[593]=n,t=n,1^a|n>>>0<65536)break e;return i[593]=-2147483648^t,h[296]}he(e),oe(),t&&(h[296]=Q(h[273],h[296]))}return h[296]}function x(e,t,r){var n,o=0,c=0,s=0,l=0,f=0;if(M=n=M-16|0,r&&(s=r>>31,s^=s+r))for(r=(0|r)>0?1152:1648;(o=15&s)&&(c=a[(o=(o<<4)+r|0)+8>>1],f=P(h[e>>3],h[o>>3],n),t=t+c|0,a[n+14>>1]<=0?(o=u[n+6>>1],c=u[n+8>>1]):(c=i[n+4>>2],o=u[n+6>>1]<<1,a[n+6>>1]=o,l=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|l>>>31,c=l<<1|c>>>31,i[n+8>>2]=c,t=t+-1|0),(65535&o|1&c|0!=(0|f))>>>0<32769||(c=(o=i[n+8>>2])+1|0,i[n+8>>2]=c,c>>>0>=o>>>0||(c=(o=i[n+12>>2])+1|0,i[n+12>>2]=c,c>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,s>>=4;);return M=n+16|0,t}function P(e,t,r){var n,i,o,u=0,c=0,l=0,f=0,h=0,p=0,m=0,g=0,C=0,S=0,E=0,y=0;return d(+t),f=0|s(1),h=65535&(c=0|s(0)),d(+e),S=0|s(1),u=0|s(0),l=S,i=v(g=65535&u,h),a[r>>1]=i,o=((65535&(E=v(C=u>>>16,h)))+(i>>>16)|0)+(65535&(m=v(c>>>=16,g)))|0,a[r+2>>1]=o,E=(((p=((65535&(u=v(n=65535&l,h)))+(E>>>16)|0)+(m>>>16)|0)+(65535&(m=v(c,C)))|0)+(65535&(y=v(S=65535&f,g)))|0)+(o>>>16)|0,a[r+4>>1]=E,m=(((((((65535&(p=v(f>>>=16,g)))+(u>>>16)|0)+(65535&(l=v(u=l>>>16,h)))|0)+(m>>>16)|0)+(y>>>16)|0)+(65535&(h=v(S,C)))|0)+(65535&(g=v(c,n)))|0)+(E>>>16)|0,a[r+6>>1]=m,C=((((((y=(l>>>16)+(p>>>16)|0)+(65535&(l=v(f,C)))|0)+(h>>>16)|0)+(g>>>16)|0)+(65535&(p=v(u,c)))|0)+(65535&(c=v(S,n)))|0)+(m>>>16)|0,a[r+8>>1]=C,p=((c=(((65535&(h=v(f,n)))+(l>>>16)|0)+(p>>>16)|0)+(c>>>16)|0)+(65535&(l=v(u,S)))|0)+(C>>>16)|0,a[r+10>>1]=p,u=(((65535&(f=v(u,f)))+(h>>>16)|0)+(l>>>16)|0)+(p>>>16)|0,a[r+12>>1]=u,a[r+14>>1]=(u>>>16)+(f>>>16),65535&(i|o|E)}function G(e){var t,r,n=0,a=0,o=0,u=0,l=0,f=0;return M=t=M-16|0,h[t+8>>3]=e,d(+e),n=0|s(1),a=0|s(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,u=(n=v(a=(n>>>20)-1022|0,39457)>>17)+-14|0,o=x(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(c[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=x(t+8|0,o,1),a=i[t+8>>2],u=n+-15|0),n=u,u=(u=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=u,u>>>0>=a>>>0||(f=(l=i[t+12>>2])+1|0,i[t+12>>2]=f,f>>>0>=l>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=u&0-(a<<1),o=x(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(u=(n=i[t+12>>2])+1|0,i[t+12>>2]=u,o=(u>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=h[t+8>>3]),M=t+16|0,e}function V(e){var t;return t=i[594],i[594]=e,t}function B(){var e,t,r;return e=i[592],t=i[593],K(1048576),K(2146435072),a[1187]<0?(i[592]=e,i[593]=t,-2147483648):(r=te(),i[592]=e,i[593]=t,-2147483648^r)}function W(e){var t,r=0,n=0,a=0,i=0;if(d(+e),r=0|s(1),t=0|s(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return l(0,n&t),l(1,0|i),+f();i&=n,l(0,0),l(1,0|i),a=+f()}return a}function j(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[592]=0,i[593]=-2147483648,n=x(2368,1,e),r=i[592],e=i[593],3071&r&&(t=i[593],(e=i[592]+1024|0)>>>0<1024&&(t=t+1|0),i[592]=e,i[593]=t,r=e,e=t),i[592]=e<<21|r>>>11,void(i[593]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[594]=1),i[592]=0,i[593]=0}function H(){var e=0,t=0,r=0;e:{if(r=i[592],t=-65536&(e=i[593])){if(2146435072==(2146435072&e))return i[594]=1,void ue();if((0|t)<1)break e}return void ue()}ue(),(0|r)==i[592]&&i[593]==(0|e)||J(1)}function K(e){h[296]=q(h[296],e)}function q(e,t){var r;return d(+(e+=t)),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[594]=1,e=h[275]),e}function J(e){h[296]=Q(h[296],e)}function Q(e,t){var r;return d(+(e-=t)),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[594]=1,e=h[275]),e}function X(e){h[296]=Y(h[296],e)}function Y(e,t){var r,n=0,a=0,o=0;return d(+e*t),n=0|s(1),r=0|s(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[550]:r,n=a?i[551]:n,l(0,0|o),l(1,0|n),+f()):(i[594]=1,n=i[551],l(0,i[550]),l(1,0|n),+f())}function z(e,t){var r=0,n=0,a=0,o=0;if(d(+t),r=0|s(1),s(0),2146435072&r){if(n=1,d(+e/t),r=0|s(1),a=0|s(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[550]:a,r=n?i[551]:r,l(0,0|a),l(1,0|r),+f()}else n=4;return i[594]=n,r=i[551],l(0,i[550]),l(1,0|r),+f()}function Z(e){h[296]=e>>>0}function $(e){h[296]=0|e}function ee(){var e,t;e=+b(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=8)}function te(){return re(h[296])}function re(e){var t,r=0,n=0,a=0,i=0;return d(+e),i=1106247680==(0|(a=2146435072&(r=0|s(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,l(0,0|(n=0|s(0))),l(1,0|r),(e=+f())<0x10000000000000000&e>=0?(a=p(e)>=1?e>0?~~m(g(e/4294967296),4294967295)>>>0:~~C((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function ne(){return ae(h[296])}function ae(e){var t=0,r=0;return d(+e),t=0|s(1),s(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=p(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function ie(){var e,t;e=+S(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=8)}function oe(){var e,t;e=+N(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=8)}function ue(){h[296]=W(h[296])}function ce(){var e,t;e=+F(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=1)}function se(e,t,r){return function(e,t,r){var n=0,c=0,l=0,f=0;if(n=o[r+30|0]){for(c=r;f=10*f+ +(0|pe[i[i[e>>2]+4>>2]](e,u[c>>1])),c=c+2|0,l=(0|n)>1,n=n+-1|0,l;);if(d(+f),n=0|s(1),e=0|s(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=x(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(c=i[t>>2])?(e=c+1024|0,i[t>>2]=e,c>>>0<4294966272||(l=(c=i[t+4>>2])+1|0,i[t+4>>2]=l,n=(l>>>0<c>>>0)+n|0)):e=c,!((0|n)<=-1022))return(0|(c=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|c|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function le(e,t,r){!function(e,t,r){var o,c,l=0,f=0,p=0,m=0,g=0,C=0,S=0,E=0,y=0;if(g=15,M=o=M-16|0,h[o+8>>3]=e,c=t,d(+e),f=0|s(1),p=0|s(0),m=f,C=f,f&=2146435072){if(f=v(l=(f>>>20)-1022|0,39457)>>17,a[r+32>>1]=f+16385|m>>>16&32768,i[o+8>>2]=p<<11,i[o+12>>2]=C<<11|p>>>21|-2147483648,(0|(l=x(o+8|0,l,-1^f)))>=1)for(p=r+32|0;m=u[p>>1],a[p>>1]=m+1&32767|32768&m,(0|(l=x(o+8|0,l,-1)))>0;);for(l?(f=(p=i[o+12>>2])>>>(m=0-l|0),i[o+12>>2]=f,l=p<<l+32|i[o+8>>2]>>>m,i[o+8>>2]=l):(l=i[o+8>>2],f=i[o+12>>2]),l=(m=f>>>0<(l>>>0<2576980377?429496730:429496729)>>>0?922:9223)+l|0,i[o+8>>2]=l,l>>>0<m>>>0&&(f=f+1|0,i[o+12>>2]=f),S=l>>>16,C=u[o+14>>1],E=r+32|0,p=r,y=1;;){for(m=g;g=(g=v(C,10))+((C=v(S,10)+(v(65535&l,10)>>>16)>>>16)+v(65535&f,10)>>>16)>>>16|48,a[p>>1]=g,C=(f=C+v(f,10)|0)>>>16,S=(l=v(l,10))>>>16,!(1&(-1^y|48!=(0|g)));)g=u[E>>1],a[E>>1]=g+-1&32767|32768&g;if(p=p+2|0,y=0,g=m+-1|0,!((0|m)>1))break}i[o+12>>2]=f,i[o+8>>2]=l,l=(m=p-r|0)>>1;e:{if((0|m)<=29){if((0|f)<=-1){a[p>>1]=57,f=l+1|0;break e}a[p>>1]=48}for(;;){if(f=l,(0|l)<1)break e;if(l=f+-1|0,48!=u[(p=p+-2|0)>>1])break}}n[r+30|0]=f,a[t+2>>1]=f,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[c>>1]=t,M=o+16|0}(e,t,r)}function fe(e){return Q(h[296],e)}function de(e){return z(h[296],e)}function he(e){h[296]=z(e,h[296])}function ve(e,t){h[296]=z(e,t)}var pe=[null,function(e,t){return 0,0!=(0|y(0|(t|=0)))|0},function(e,t){return 0,0|O(0|(t|=0))},function(e){return 0,0|A()},function(e,t){return 0,(t|=0)+-48|0},w];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 2304},Base_StrBufSize:function(){return 22},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1072+(((v(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n){return e=+e,t|=0,r|=0,n|=0,a[1174]=0,t=function(e,t,r,n){var c=0,p=0,m=0,g=0,C=0,S=0,E=0,y=0,O=0;e:if(!u[1174]){if(h[296]=e,d(+e),c=0|s(1),m=0|s(0),S=c,O=-65536&c)if(2146435072!=(2146435072&c)){if(!((0|O)>=1))return-2147467259}else i[594]=1;C=i[570],E=i[571],g=-1;t:{if(!((0|c)<(0|(p=E))||(g=1,(0|c)>(0|p)))){if((0|C)==(0|(p=m)))break t;g=p>>>0<C>>>0?-1:1}if(p=-2147467259,1==(0|((S&E)>-1?g:0-g|0)))break e}t:{if(C=i[572],p=i[573],E=p,g=-1,!((0|c)<(0|p)||(g=1,(0|c)>(0|E)))){if((0|m)==(0|C))break t;g=m>>>0<C>>>0?-1:1}if(C=g,-1==(0|((p&S)>-1?C:0-C|0)))return-2147467259}t:{r:{if(!(n|!O))if(2146435072!=(2146435072&c)){if((0|O)<1)break r}else i[594]=1;K(h[i[1056+(t<<2)>>2]>>3]),y=h[296];break t}H(),J(e),S=i[593],m=S,l(0,0|(c=i[592])),l(1,0|m),y=+f(),i[550]==(0|c)&&i[551]==(0|m)||(p=i[593])>>>0<65536||(i[593]=-2147483648^p,d(+(y=h[296])),m=0|s(1),c=0|s(0)),S=m,C=m,m=i[1056+(t<<2)>>2],E=i[m+4>>2],p=i[m>>2],g=-1;r:{if(!((0|C)<(0|(m=E))||(g=1,(0|C)>(0|m)))){if((0|c)==(0|p)){h[296]=e;break r}g=c>>>0<p>>>0?-1:1}if(C=g,h[296]=e,-1==(0|((S&E)>-1?C:0-C|0)))break t}J(h[274])}if(a[1183]=t,c=ne(),p=-2147467259,!V(0)){if(r){if((0|c)>2957003)break e;c=c+1462|0}else if(c+4346018>>>0>7304483)break e;if(a[1181]=1+((c+6|0)%7|0),!n|c)if(c){if((0|c)<=-1?(m=-4-((r=(-1^c)/1461|0)<<2)|0,p=1461+(v(r,1461)+c|0)|0):(m=(r=(c+-1|0)/1461|0)<<2,p=v(r,-1461)+c|0),!(n&&(0|m)<=199))if((0|(p=(((0|(r=m+-101|0))/100|0)-((0|r)/400|0)|0)+p|0))>=1462){c=3&(r=m+1900|0);t:if(n){if(c|(0|m)<200)break t;c=!((r>>>0)%100)&0!=((r>>>0)%400|0)}else c||(c=!((0|r)%100)&0!=((0|r)%400|0));m=m+4|0,p=(12==(0|v(c,12))?-1460:-1461)+p|0}else(0|p)>0||(m=m+-4|0,p=p+1461|0);c=3&(r=m+1900|0);t:if(n){if(c|(0|m)<200)break t;c=!((r>>>0)%100)&0!=((r>>>0)%400|0)}else c||(c=!((0|r)%100)&0!=((0|r)%400|0));for(S=v(c,12),c=S;n=c,c=c+1|0,(0|(p=(r=p)-o[n+1072|0]|0))>0;);n=((p=n)-((0|S)<(0|(n=n+-11|0))?S:n)>>>0)/12|0,a[1174]=1900+(n+m|0),a[1175]=(v(n,-12)+c|0)-S}else i[587]=788331,r=30;else i[587]=67436;if(i[588]=r,h[296]=y,ue(),(r=i[593])>>>0>=65536&&(i[593]=-2147483648^r),K(y),X(h[279]),e=h[296],r=te(),a[1178]=r,Z(r<<16>>16),(r=i[593])>>>0>=65536&&(i[593]=-2147483648^r),K(e),X(h[280]),e=h[296],r=te(),a[1179]=r,Z(r<<16>>16),(r=i[593])>>>0>=65536&&(i[593]=-2147483648^r),K(e),X(h[280]),!t)return t=te(),a[1182]=0,a[1180]=t,0;e=h[296],r=te(),a[1180]=r,Z(r<<16>>16),(r=i[593])>>>0>=65536&&(i[593]=-2147483648^r),K(e),X(h[i[1152+(t<<2)>>2]>>3]),h[296]=G(h[296]),a[1182]=te(),p=0}}return p}(e,t,0!=(0|r),0!=(0|n)),i[594]=0,0|t},Dtr_Yr:function(){return a[1174]},Dtr_Mon:function(){return a[1175]},Dtr_DOM:function(){return i[588]},Dtr_Hour:function(){return a[1178]},Dtr_Min:function(){return a[1179]},Dtr_Sec:function(){return a[1180]},Dtr_Wdy:function(){return a[1181]},Dtr_FracSec:function(){return a[1182]},Dtr_ToNum:function(e,t,r,n,c,s,l,f,d,p){return e|=0,t|=0,r|=0,n|=0,c|=0,s|=0,l|=0,f|=0,d|=0,p|=0,a[1182]=l,a[1180]=s,a[1179]=c,a[1178]=n,i[588]=r,a[1175]=t,a[1174]=e,a[1183]=f,i[592]=0,i[593]=0,a[1181]=0,function(e,t){var r,n=0;M=r=M-16|0;e:{t:{r:{if((u[1175]+-32767&65535)>>>0>1){if(a[1183]>=1?($(a[1182]),n=de(h[i[1152+(a[1183]<<2)>>2]>>3]),$(a[1180]),K(n)):$(a[1180]),n=de(h[280]),$(a[1179]),K(n),n=de(h[280]),$(a[1178]),K(n),n=de(h[279]),!((0|function(e,t,r){var n,c=0,s=0,l=0,f=0,d=0,h=0,p=0,m=0;s=i[588],d=-2146827284;c=(0|(l=a[1175]))>=1?(l+-1|0)/12|0:(0|l)/-12^-1;if(!((0|(n=c+u[1174]<<16>>16))>9999|((t?1900:-9999)+(e?4:0)|0)>(0|n)||((l=l+v(c,-12)<<16>>16)+-1&65535)>>>0>11|(!s|1900==(0|n)&2==(0|l)&29==(0|s)?!t:0))){if(p=(0|(f=(c=(0|(h=n+1e4|0))/4|0)<<2))%100|0,m=(0|f)%400|0,s=v(c,1461)+s|0,c=((s+((0|(c=f+-1|0))/-100|0)|0)+((0|c)/400|0)|0)-1|0,f=(v(h-f|0,12)+l|0)-1|0)for(f=f+(s=m?p?0:12:0)|0;c=o[s+1072|0]+c|0,(0|f)!=(0|(s=s+1|0)););n:if(t||e){if(e=c+-4346385|0,!((0|n)>1900|(0|l)>=3))break n;e=c+-4346384|0}else e=c+-4346384|0;e>>>0>2958465||(i[r>>2]=e,d=0)}return d}(e,t,r+12|0))<0)){if(t=i[r+12>>2],!e)break r;if($(t+-1462|0),!((0|t)<1462)){if(e=i[593],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[594]=1;break t}if((0|t)>=1)break t}}i[592]=0,i[593]=0}i[592]=0,i[593]=0,V(8);break e}Z(t)}K(n)}M=r+16|0}(0!=(0|d),0!=(0|p)),+h[296]},Mathpack_Zero:function(){return+h[275]},Mathpack_One:function(){return+h[274]},Mathpack_Pi:function(){return+h[270]},Mathpack_Div:function(e,t){return+z(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+Y(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+Q(e=+e,t=+t)},Mathpack_Add:function(e,t){return+q(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,c=0;h[296]=t,d(+t),r=0|s(1),s(0),o=r,i[593]=2147483647&r,t=h[296];e:{if(d(+fe(h[271])),r=0|s(1),n=0|s(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)h[296]=e,ie();else if(ue(),d(+fe(t)),r=0|s(1),n=0|s(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=te()))){if(h[296]=e,d(+e),n=0|s(1),s(0),(0|(n=(r=n)>>>16<<16))>=1)ee(),X(t),ce();else if(!((0|n)>-1)){if(ve(h[274],t),c=G(h[296]),h[296]=c,ue(),d(+fe(c)),65535==(0|(n=0|s(1)))&s(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=ne()))|!(1&n))break e;h[296]=e,i[593]=2147483647&r,ee(),X(t),ce(),(r=i[593])>>>0<65536||(i[593]=-2147483648^r)}}else h[296]=e,function(e){var t,r=0;if(!((t=a[1187])|e))return void(i[594]=4&i[594]?4:64);if(!((0|t)<1)&&10==(0|te())){if(r=h[296],ue(),J(r),!u[1187])return void j(e);h[296]=r}r=1;for(;1&e&&(r=Y(h[296],r)),e>>>=1;)X(h[296]);h[296]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[594]))return i[592]=0,i[593]=0,i[594]=-2&o,h[296];he(h[274])}return h[296]}return i[594]=8,h[296]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return d(+(e=+e)),t=0|s(1),s(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[594]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,u=0,c=0;d(+(e=+e)),o=0|s(1),r=0|s(0),n=o,i=o,d(+t),a=0|s(1),o=0|s(0),c=-1;e:{if(!((0|n)<(0|(u=a))||(c=1,(0|i)>(0|u)))){if(u=0,(0|o)==(0|r))break e;c=r>>>0<o>>>0?-1:1}o=c,u=(a&n)>-1?o:0-o|0}return 0|u},Mathpack_TakeMathError:function(){var e;return e=i[594],i[594]=0,0|e},Mathpack_Trunc:function(e){return+W(e=+e)},Mathpack_Ceil:function(e){return e=+e,h[296]=e,function(){var e=0,t=0,r=0;e:{if(r=i[592],e=i[593],t=-65536&e){if(2146435072==(2146435072&e))return i[594]=1,void ue();if((0|t)>0)break e}return void ue()}ue(),(0|r)==i[592]&&i[593]==(0|e)||K(1)}(),+h[296]},Mathpack_Floor:function(e){return e=+e,h[296]=e,H(),+h[296]},Mathpack_Abs:function(e){var t=0;return d(+(e=+e)),t=0|s(1),t&=2147483647,l(0,0|(0|s(0))),l(1,0|t),+f()},Mathpack_Neg:function(e){var t,r,n,a;return d(+(e=+e)),n=-2147483648^(t=0|s(1)),l(0,0|(r=0|s(0))),l(1,0|n),a=+f(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|re(e=+e)},Mathpack_LFix:function(e){return 0|ae(e=+e)},Mathpack_SFix:function(e){return e=+e,h[296]=e,0|B()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,c=0,l=0,f=0;M=r=M+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,h[296]=e,d(+e),o=0|s(1),s(0);e:if(c=-65536&o)if(2146435072!=(2146435072&o)){(0|c)>0||(f=32768,o>>>0<65536||(i[593]=-2147483648^o,e=h[296])),le(e,r+56|0,r+16|0),u[r+58>>1]||(a[r+56>>1]=1),h[296]=t,o=(0|(o=B()))<0?100:o;t:{if(c=i[593],l=-65536&c)if(2146435072!=(2146435072&c)){if(!((0|l)>0)){if((o=i[593])>>>0>=65536&&(i[593]=-2147483648^o),(0|(o=B()))<=-1)break t;o=0-o|0}}else i[594]=1;c=a[r+56>>1],l=o+c|0,o=a[r+58>>1],(0|l)<(0|o)&&(i[r+12>>2]=o,i[r+8>>2]=c,function(e,t,r,n){var o=0,c=0,s=0;r:{n:{a:{i:{if(!n){if(u[e>>1]<=52)break i;break n}if(!((0|n)<1)&&(0|n)<15)break a}return i[t>>2]=1,void(i[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break r;for(;;){if(s=u[(c=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[c>>1]=s,58!=(65535&s))break r;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}(r+16|0,r+8|0,r+12|0,l),o=i[r+12>>2],a[r+58>>1]=o,c=i[r+8>>2],a[r+56>>1]=c),n[r+46|0]=o,a[r+48>>1]=c+16384&32767|f,se(2300,2368,r+16|0),e=h[296];break e}e=h[275]}else i[594]=1;return M=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0;d(+e),r=0|s(1),s(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?u=(0|n)<1?-1:1:i[594]=1);if(a=D(e,t),h[296]=e,h[296]=G(e),J(a),(r=i[593])>>>0>=65536){if(2146435072==(2146435072&r))return i[594]=1,a;if(r=(0|(r=re(t)<<16))<0?309:r>>16,d(+t),n=0|s(1),s(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[594]=1),(0|r)<=-309)return V(8),0;j(0-r|0),(0|u)>-1||(r=i[593])>>>0<65536||(i[593]=-2147483648^r),K(a),a=h[296]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return d(+(e=D(e=+e,t=+t))),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[594]=1,e=-1),+e},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,u=0,c=0;M=r=M-16|0,h[r+8>>3]=e,h[r>>3]=t,d(+e),n=0|s(1),a=0|s(0),o=n,d(+t),n=0|s(1),u=0|s(0),c=n;e:{if((0|a)!=(0|u)||(0|o)!=(0|n)){if((c+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=G(e),h[r+8>>3]=e,d(+e),n=0|s(1),s(0),o=n,e=G(t),h[r>>3]=e,d(+e),n=0|s(1),s(0),c=n),n=1,o=i[(u=(a=(c&o)>-1)?r+8|0:r)+4>>2],c=i[(a=a?r:r+8|0)+4>>2],(0|o)>(0|c))break e;if((0|o)<(0|c)){n=-1;break e}if(u=i[u>>2],a=i[a>>2],u>>>0>a>>>0)break e;if(n=-1,u>>>0<a>>>0)break e}n=0}return M=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return d(+(e=+e)),t=0|s(1),s(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return d(+(e=+e)),a=0|s(1),r=0|s(0),d(+t),n=0|s(1),0|(a=(0|r)==(0|s(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return d(+(e=+e)),t=0|s(1),s(0),2146435072==(2146435072&t)?(i[594]=1,-1):+G(e)},Mathpack_Sqrt:function(e){return e=+e,h[296]=e,ie(),+h[296]},Mathpack_Exp:function(e){return e=+e,h[296]=e,ce(),+h[296]},Mathpack_Ln:function(e){return e=+e,h[296]=e,ee(),+h[296]},Mathpack_Log:function(e){return e=+e,h[296]=e,function(){var e,t;e=+k(+h[296]),h[296]=e,d(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[594]=8)}(),+h[296]},Mathpack_Sin:function(e){return e=+e,h[296]=e,function(){var e=0,t=0;d(+(t=h[296])),e=0|s(1),s(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+R(+t),h[296]=t,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[594]=8)}(),+h[296]},Mathpack_Cos:function(e){return e=+e,h[296]=e,function(){var e=0,t=0;d(+(t=h[296])),e=0|s(1),s(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),h[296]=t,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[594]=8)}(),+h[296]},Mathpack_Tan:function(e){return e=+e,h[296]=e,function(){var e=0,t=0,r=0;r=8,d(+(t=h[296])),e=0|s(1),s(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+T(+t),h[296]=t,r=4,d(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[594]=r)}(),+h[296]},Mathpack_Asin:function(e){return+U(e=+e,0)},Mathpack_Acos:function(e){return+U(e=+e,1)},Mathpack_Atan:function(e){return e=+e,h[296]=e,oe(),+h[296]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,u=0,c=0;h[296]=e;e:{if(d(+e),r=0|s(1),s(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[594]=1}h[296]=t;t:{if(d(+t),r=0|s(1),s(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[594]=1}return V(4),0}return $((0|n)<1?-1:1),X(h[270]),h[296]=z(h[296],h[272]),h[296]}e:if((0|r)<=-1){d(+t),r=0|s(1),s(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[594]=1;a=h[270];break e}d(+(a=h[270])),r=0|s(1),n=0|s(0),o=-2147483648^r,l(0,0|n),l(1,0|o),u=+f(),c=a,a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?u:c}else a=h[275];return ve(t,e),oe(),K(a),h[296]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,c=0,l=0;return d(+(e=+e)),r=0|s(1),o=0|s(0),2146435072==(2146435072&r)?(i[594]=1,-1):(h[296]=e,c=2304,(n=-65536&(l=r))&&(2146435072!=(2146435072&l)?(c=2304,(0|n)>0||(l>>>0>=65536&&(i[593]=-2147483648^l),c=2304,!o&-2147483648==(0|r)||(a[1152]=45,c=2306))):(i[594]=1,c=2304)),l=c,t=(0|t)<21?t:21,t=function(e,t,r,n){var o;M=o=M-16|0,e=0|pe[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else le(h[296],o+8|0,t),t=function(e,t,r,n,o,c){var s,l,f,d=0,h=0,p=0,m=0,g=0;M=l=M-16|0,s=(t<<1)+e|0,f=l+12|0;t:{r:{n:{a:if(!(p=(0|r)<5&(h=o?n:1)+3>>>0<8)){i:if(!((0|h)>(0|r))){if((0|(n=r+h|0))>=3){if((0|r)<5|(0|h)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(m=1,n=1,(0|r)<7)break n;n=r-(h+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,h))&&(n=r-((0|h)<(0|r)?(0|h)<1?2-h|0:1:0)|0)}n:{if((0|n)<(0|o)){d=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(u[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(u[(n<<1)+e>>1]<=52)break i;for(;;){if(g=u[(d=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[d>>1]=g,58!=(65535&g))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,d=h+1|0;break a}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);d=h}if((-1^p)&(0|d)>(0|r)|m)break n;break r}if(d=h,!m)break r}if(i[f>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=s>>>0?n=r:(o=o+-1|0,i[f>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&(_(1),E()),L(e,r,o<<1),a[r>>1]=c),n>>>0<s>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=s>>>0?o=n:(o=n+2|0,(0|d)<=0?(a[n>>1]=45,d=1-d|0):(a[n>>1]=43,d=d+-1|0)),(0|d)<100|o>>>0>=s>>>0||(e=(d>>>0)/100|0,a[o>>1]=e+48,d=d-v(e,100)|0,o=o+2|0),o>>>0<s>>>0&&(a[o>>1]=48+((0|d)/10|0),o=o+2|0),o>>>0>=s>>>0)break t;a[o>>1]=48+((0|d)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|d))if(r=o-d|0,i[f>>2]=r,(0|d)>=1){if(!((r=(n=((p=(r=(h=(0|d)>(0|t)?t:d)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=s>>>0))for(;a[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=p>>>0;);(0|d)<(0|t)&&(a[p>>1]=c),o=p+(((0|(e=s-p>>1))>(0|(t=o-h|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(d<<1)|0)+(o<<1)|0)|0)>>>0>=s>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<s>>>0&&(a[e>>1]=c,e=e+2|0),n=s-e>>1,d&&(t=(0|n)<(0|(t=0-d|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|d)>(0|t)?t:d)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return M=l+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return M=o+16|0,t}(i[256],l,2348-l>>1,(0|t)>0?t:0),i[592]=0,i[593]=0,t-2304>>1)},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,M=o=M-48|0,n[o+39|0]=0,L(o+8|0,2304,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,se(i[256],o,o+8|0)&&(i[594]=1),M=o+48|0,+h[o>>3]},_start:w,__errno_location:function(){return 2392},setThrew:function(e,t){e|=0,t|=0,i[596]||(i[597]=t,i[596]=e)},stackSave:function(){return 0|M},stackAlloc:function(e){return M=e=M-(e|=0)&-16,0|e},stackRestore:function(e){M=e|=0},__growWasmMemory:function(e){return 0,0|E()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit},v),g=m.memory;t.memory=g;var C=m.Base_StrBuf;t.Base_StrBuf=C;var S=m.Base_StrBufSize;t.Base_StrBufSize=S;var E=m.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=E;var y=m.Dtr_FromNum;t.Dtr_FromNum=y;var O=m.Dtr_Yr;t.Dtr_Yr=O;var A=m.Dtr_Mon;t.Dtr_Mon=A;var k=m.Dtr_DOM;t.Dtr_DOM=k;var b=m.Dtr_Hour;t.Dtr_Hour=b;var R=m.Dtr_Min;t.Dtr_Min=R;var I=m.Dtr_Sec;t.Dtr_Sec=I;var T=m.Dtr_Wdy;t.Dtr_Wdy=T;var N=m.Dtr_FracSec;t.Dtr_FracSec=N;var F=m.Dtr_ToNum;t.Dtr_ToNum=F;var _=m.Mathpack_Zero;t.Mathpack_Zero=_;var M=m.Mathpack_One;t.Mathpack_One=M;var w=m.Mathpack_Pi;t.Mathpack_Pi=w;var L=m.Mathpack_Div;t.Mathpack_Div=L;var D=m.Mathpack_Mul;t.Mathpack_Mul=D;var U=m.Mathpack_Sub;t.Mathpack_Sub=U;var x=m.Mathpack_Add;t.Mathpack_Add=x;var P=m.Mathpack_Power;t.Mathpack_Power=P;var G=m.Mathpack_Cond;t.Mathpack_Cond=G;var V=m.Mathpack_Cond2;t.Mathpack_Cond2=V;var B=m.Mathpack_TakeMathError;t.Mathpack_TakeMathError=B;var W=m.Mathpack_Trunc;t.Mathpack_Trunc=W;var j=m.Mathpack_Ceil;t.Mathpack_Ceil=j;var H=m.Mathpack_Floor;t.Mathpack_Floor=H;var K=m.Mathpack_Abs;t.Mathpack_Abs=K;var q=m.Mathpack_Neg;t.Mathpack_Neg=q;var J=m.Mathpack_Float;t.Mathpack_Float=J;var Q=m.Mathpack_SFloat;t.Mathpack_SFloat=Q;var X=m.Mathpack_Fix;t.Mathpack_Fix=X;var Y=m.Mathpack_LFix;t.Mathpack_LFix=Y;var z=m.Mathpack_SFix;t.Mathpack_SFix=z;var Z=m.Mathpack_Round;t.Mathpack_Round=Z;var $=m.Mathpack_RoundUp;t.Mathpack_RoundUp=$;var ee=m.Mathpack_RoundDown;t.Mathpack_RoundDown=ee;var te=m.Mathpack_Compare;t.Mathpack_Compare=te;var re=m.Mathpack_GetExp32;t.Mathpack_GetExp32=re;var ne=m.Mathpack_Equal;t.Mathpack_Equal=ne;var ae=m.Mathpack_ViewRound;t.Mathpack_ViewRound=ae;var ie=m.Mathpack_Sqrt;t.Mathpack_Sqrt=ie;var oe=m.Mathpack_Exp;t.Mathpack_Exp=oe;var ue=m.Mathpack_Ln;t.Mathpack_Ln=ue;var ce=m.Mathpack_Log;t.Mathpack_Log=ce;var se=m.Mathpack_Sin;t.Mathpack_Sin=se;var le=m.Mathpack_Cos;t.Mathpack_Cos=le;var fe=m.Mathpack_Tan;t.Mathpack_Tan=fe;var de=m.Mathpack_Asin;t.Mathpack_Asin=de;var he=m.Mathpack_Acos;t.Mathpack_Acos=he;var ve=m.Mathpack_Atan;t.Mathpack_Atan=ve;var pe=m.Mathpack_Atan2;t.Mathpack_Atan2=pe;var me=m.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=me;var ge=m.Mathpack_Pack;t.Mathpack_Pack=ge;var Ce=m._start;t._start=Ce;var Se=m.__errno_location;t.__errno_location=Se;var Ee=m.setThrew;t.setThrew=Ee;var ye=m.stackSave;t.stackSave=ye;var Oe=m.stackAlloc;t.stackAlloc=Oe;var Ae=m.stackRestore;t.stackRestore=Ae;var ke=m.__growWasmMemory;t.__growWasmMemory=ke},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var a,i=r(4),o=r(6);function u(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(a=t.MathErrorNum||(t.MathErrorNum={}));var c=((n={})[a.Over]=u(a.Over),n[a.Under]=u(a.Under),n[a.DivBy0]=u(a.DivBy0),n[a.Trans]=u(a.Trans),n);function s(e){var t;return null!=(t=c[e])?t:u(e)}function l(e){return function(t){var r=e(t),n=i.Mathpack_TakeMathError();return n===a.None?r:s(n)}}function f(e){return function(t,r){var n=e(t,r),o=i.Mathpack_TakeMathError();return o===a.None?n:s(o)}}t.mathError=s,t.zero=i.Mathpack_Zero,t.one=i.Mathpack_One,t.pi=i.Mathpack_Pi,t.exp32=i.Mathpack_GetExp32,t.equal=function(e,t){return 0!==i.Mathpack_Equal(e,t)},t.trunc=i.Mathpack_Trunc,t.ceil=l(i.Mathpack_Ceil),t.floor=l(i.Mathpack_Floor),t.abs=i.Mathpack_Abs,t.neg=i.Mathpack_Neg,t.float=function(e){return e<0?i.Mathpack_SFloat(e):i.Mathpack_Float(e)},t.fix=function(e){return i.Mathpack_Fix(e)>>>0},t.lfix=i.Mathpack_LFix,t.sfix=l(i.Mathpack_SFix),t.round=f(i.Mathpack_Round),t.roundUp=f(i.Mathpack_RoundUp),t.roundDown=f(i.Mathpack_RoundDown),t.compare=i.Mathpack_Compare,t.div=f(i.Mathpack_Div),t.mul=f(i.Mathpack_Mul),t.sub=f(i.Mathpack_Sub),t.add=f(i.Mathpack_Add),t.power=f(i.Mathpack_Power),t.cond=function(e){var t=i.Mathpack_Cond(e),r=i.Mathpack_TakeMathError();return r===a.None?t:s(r)},t.cond2=i.Mathpack_Cond2,t.viewRound=l(i.Mathpack_ViewRound),t.sqrt=l(i.Mathpack_Sqrt),t.exp=l(i.Mathpack_Exp),t.ln=l(i.Mathpack_Ln),t.log=l(i.Mathpack_Log),t.sin=l(i.Mathpack_Sin),t.cos=l(i.Mathpack_Cos),t.tan=l(i.Mathpack_Tan),t.asin=l(i.Mathpack_Asin),t.acos=l(i.Mathpack_Acos),t.atan=l(i.Mathpack_Atan),t.atan2=f(i.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{o.setLocale(e);var n=i.Mathpack_FormatGeneral(t,r);return n<0?s(i.Mathpack_TakeMathError()):o.pxcharToStr(i.Base_StrBuf(),n)}finally{o.setLocale(void 0)}},t.pack=function(e,t,r,n){try{o.setLocale(e);var u=o.fastMin(n.length,i.Base_StrBufSize());o.strToPxchar(i.Base_StrBuf(),n.substring(0,u));var c=i.Mathpack_Pack(!!t,r,u),l=i.Mathpack_TakeMathError();return l!==a.None?s(l):isNaN(c)?s(a.Over):c}finally{o.setLocale(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),a=void 0;t.setLocale=function(e){a=e};t.Base_LocaleIsNumeral=function(e){return a.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return a.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=a.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.pxcharToStr=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a="",i=0;i<t;i+=1)a+=String.fromCharCode(r[e+(i<<1)>>1]);return a},t.strToPxchar=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a=0;a<t.length;a+=1)r[e+(a<<1)>>1]=t.charCodeAt(a)}},function(e,t,r){r(8),e.exports=r(21)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,a=void 0,i=function(e,t){d[r]=e,d[r+1]=t,2===(r+=2)&&(a?a(h):C())},o="undefined"!=typeof window?window:void 0,u=o||{},c=u.MutationObserver||u.WebKitMutationObserver,s="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(h,1)}}var d=new Array(1e3);function h(){for(var e=0;e<r;e+=2)(0,d[e])(d[e+1]),d[e]=void 0,d[e+1]=void 0;r=0}var v,p,m,g,C=void 0;function S(e,t){var r=this,n=new this.constructor(O);void 0===n[y]&&M(n);var a=r._state;if(a){var o=arguments[a-1];i((function(){return F(a,n,o,r._result)}))}else T(r,n,e,t);return n}function E(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(O);return k(t,e),t}s?C=function(){return process.nextTick(h)}:c?(p=0,m=new c(h),g=document.createTextNode(""),m.observe(g,{characterData:!0}),C=function(){g.data=p=++p%2}):l?((v=new MessageChannel).port1.onmessage=h,C=function(){return v.port2.postMessage(0)}):C=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(h)}:f()}catch(e){return f()}}():f();var y=Math.random().toString(36).substring(2);function O(){}function A(t,r,n){r.constructor===t.constructor&&n===S&&r.constructor.resolve===E?function(e,t){1===t._state?R(e,t._result):2===t._state?I(e,t._result):T(t,void 0,(function(t){return k(e,t)}),(function(t){return I(e,t)}))}(t,r):void 0===n?R(t,r):e(n)?function(e,t,r){i((function(e){var n=!1,a=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?k(e,r):R(e,r))}),(function(t){n||(n=!0,I(e,t))}),e._label);!n&&a&&(n=!0,I(e,a))}),e)}(t,r,n):R(t,r)}function k(e,t){if(e===t)I(e,new TypeError("You cannot resolve a promise with itself"));else if(a=typeof(n=t),null===n||"object"!==a&&"function"!==a)R(e,t);else{var r=void 0;try{r=t.then}catch(t){return void I(e,t)}A(e,t,r)}var n,a}function b(e){e._onerror&&e._onerror(e._result),N(e)}function R(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&i(N,e))}function I(e,t){void 0===e._state&&(e._state=2,e._result=t,i(b,e))}function T(e,t,r,n){var a=e._subscribers,o=a.length;e._onerror=null,a[o]=t,a[o+1]=r,a[o+2]=n,0===o&&e._state&&i(N,e)}function N(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,a=void 0,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?F(r,n,a,i):a(i);e._subscribers.length=0}}function F(t,r,n,a){var i=e(n),o=void 0,u=void 0,c=!0;if(i){try{o=n(a)}catch(e){c=!1,u=e}if(r===o)return void I(r,new TypeError("A promises callback cannot return that same promise."))}else o=a;void 0!==r._state||(i&&c?k(r,o):!1===c?I(r,u):1===t?R(r,o):2===t&&I(r,o))}var _=0;function M(e){e[y]=_++,e._state=void 0,e._result=void 0,e._subscribers=[]}var w=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(O),this.promise[y]||M(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&R(this.promise,this._result))):I(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===E){var a=void 0,i=void 0,o=!1;try{a=e.then}catch(e){o=!0,i=e}if(a===S&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===L){var u=new r(O);o?I(u,i):A(u,e,a),this._willSettleAt(u,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?I(n,r):this._result[t]=r),0===this._remaining&&R(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;T(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),L=function(){function t(e){this[y]=_++,this._result=this._state=void 0,this._subscribers=[],O!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){k(e,t)}),(function(t){I(e,t)}))}catch(t){I(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return L.prototype.then=S,L.all=function(e){return new w(this,e).promise},L.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var a=e.length,i=0;i<a;i++)r.resolve(e[i]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},L.resolve=E,L.reject=function(e){var t=new this(O);return I(t,e),t},L._setScheduler=function(e){a=e},L._setAsap=function(e){i=e},L._asap=i,L.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=L},L.Promise=L,L.polyfill(),L},e.exports=n()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a=Object.getPrototypeOf(t);a&&"object"==typeof a&&Object.keys(a).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i={};return Object.keys(n).forEach((function(t){i[t]=e(n[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},a=1;a<=t;a+=1)n(a);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var a=e[n];r=r.catch((function(){return t(a)}))},a=1;a<e.length;a+=1)n(a);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t){var r=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(a=document.caretPositionFromPoint(e,t))&&(r=a.offset,n=null!=a.offsetNode&&null!=a.offsetNode.parentElement&&"SPAN"===a.offsetNode.parentElement.nodeName?a.offsetNode.parentElement:a.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(a=document.caretRangeFromPoint(e,t))&&(r=a.startOffset,n=null!=a.startContainer&&null!=a.startContainer.parentElement&&"SPAN"===a.startContainer.parentElement.nodeName?a.startContainer.parentElement:a.startContainer)}else try{var a;n=document.elementFromPoint(e,t),(a=document.body.createTextRange()).moveToPoint(e,t);var i=document.body.createTextRange();i.moveToElementText(n),i.setEndPoint("EndToStart",a),r=i.text.length}catch(e){return r}for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(r+=n.textContent.length);return r},t.getBoundingRectForText=function(e,t,r){function n(e,t,r){if(!e||!e.textContent)return t;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var a=e.childNodes,i=0;i<a.length&&t>=0;i+=1)t=n(a[i],t,r);return t}var a=document.createRange();return n(e,t,(function(e,t){return a.setStart(e,t)})),n(e,r,(function(e,t){return a.setEnd(e,t)})),a.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,a){return t.traceTag(e,r,n,a)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,a){return t.debugTraceTag(e,r,n,a)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,a){return t.assertTag(e,r,n,a)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,a){return t.shipAssertTag(e,r,n,a)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function a(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,i=t,o={},u=function(e,t,n){return function(e,t,r,n,i,o){a(e,"end",r);var u={sessionName:t,result:n?"success":"failure",message:o,marks:e},c=JSON.stringify(u);i(c)}(o,r,i,e,t,n)};return o.start=0,{mark:function(e){return function(e){return a(o,e,i)}(e)},end:function(e){return u(!0,e)},success:function(e,t){return u(!0,e,t)},failure:function(e,t){return u(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var a=n(),i=r;return{reset:function(e){null!=e&&(i=e),a=n()},stop:function(r){var o=n()-a,u=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:r});e(u)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,a=window.performance;try{a&&a.now&&a.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var i=0;i<e.length;i+=1){try{if(n){t.perfNow=!0;var o=Math.floor(100*a.now())%10;(o<0||o>9)&&(o=0);for(var u=0;u<o;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),t.Math_atan=t.Math_tan=t.Math_cos=t.Math_sin=t.Math_exp=t.Math_log=t.Math_log10=t.Math_sqrt=void 0;var n=r(6);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const u=Math.exp;t.Math_exp=u;const c=Math.sin;t.Math_sin=c;const s=Math.cos;t.Math_cos=s;const l=Math.tan;t.Math_tan=l;const f=Math.atan;t.Math_atan=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),a=r(5);function i(e,t,r,n,a,i,o,u){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:u}}t.daysPerMonth=function(e,t,r){return n.Dtr_DaysPerMonth(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=i,t.fromNum=function(e,t,r,a){var o=t;return 0===n.Dtr_FromNum(e,o,r?1:0,a?1:0)&&i(n.Dtr_Yr(),n.Dtr_Mon(),n.Dtr_DOM(),n.Dtr_Hour(),n.Dtr_Min(),n.Dtr_Sec(),n.Dtr_Wdy(),n.Dtr_FracSec())},t.toNum=function(e,t,r,i){var o=t,u=n.Dtr_ToNum(e.yr,e.mon,e.dom,e.hour,e.min,e.sec,e.fracSec,o,r?1:0,i?1:0),c=n.Mathpack_TakeMathError();return c===a.MathErrorNum.None?u:a.mathError(c)}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"createParseGlobals",(function(){return yi})),r.d(n,"ReasonKind",(function(){return Ai})),r.d(n,"parseLocals",(function(){return Oi})),r.d(n,"formatLocalsGrid",(function(){return ki})),r.d(n,"formatLocalsName",(function(){return bi})),r.d(n,"notImplemented",(function(){return Ei})),r.d(n,"notFormulaString",(function(){return Ri})),r.d(n,"createParser",(function(){return ms})),r.d(n,"parseResultHelper",(function(){return Is}));var a={};r.r(a),r.d(a,"SyntaxError",(function(){return bs})),r.d(a,"TypeError",(function(){return Rs})),r.d(a,"baseErrors",(function(){return Ts})),r.d(a,"formatDiagnostic",(function(){return Ns}));var i={};r.r(i),r.d(i,"MachineCallKind",(function(){return Xl})),r.d(i,"machineCall",(function(){return $l})),r.d(i,"isMachineCall",(function(){return ef})),r.d(i,"ArrayMachine",(function(){return tf})),r.d(i,"TransitionKind",(function(){return Ul})),r.d(i,"nextTransition",(function(){return Kl})),r.d(i,"callMachineTransition",(function(){return ql})),r.d(i,"nextOnSuccessReceiver",(function(){return Ql})),r.d(i,"MachineCycle",(function(){return Yl})),r.d(i,"MachineRuntime",(function(){return zl})),r.d(i,"AllMachine",(function(){return Zl}));var o={};r.r(o),r.d(o,"analyzeLocalsGrid",(function(){return Vs})),r.d(o,"analyzeLocalsName",(function(){return Bs})),r.d(o,"analyzeFormatLocalsGrid",(function(){return Ws})),r.d(o,"diagnostics",(function(){return a})),r.d(o,"summarizeFormulaDiagnostics",(function(){return Ps})),r.d(o,"createAnalyzeGlobals",(function(){return Gs})),r.d(o,"createAnalyzer",(function(){return dh}));var u={};r.r(u),r.d(u,"createCompiler",(function(){return Zh})),r.d(u,"createEvaluator",(function(){return Fp})),r.d(u,"ReasonKind",(function(){return Ol})),r.d(u,"interval",(function(){return Tl})),r.d(u,"CellKind",(function(){return bl})),r.d(u,"Interrupt",(function(){return Rl})),r.d(u,"notImplemented",(function(){return El})),r.d(u,"finalValue",(function(){return Fl})),r.d(u,"pendingValue",(function(){return _l})),r.d(u,"cellFormula",(function(){return Ml})),r.d(u,"userDefinedFunc",(function(){return Ll})),r.d(u,"unavailable",(function(){return yl})),r.d(u,"stopped",(function(){return wl})),r.d(u,"nameCycle",(function(){return Pl})),r.d(u,"cellCycle",(function(){return Gl})),r.d(u,"paused",(function(){return Wl})),r.d(u,"previousFailure",(function(){return Vl})),r.d(u,"evalGlobals",(function(){return Dl})),r.d(u,"evalLocals",(function(){return xl})),r.d(u,"compileLocals",(function(){return kl})),r.d(u,"getEvalFailureReason",(function(){return jl})),r.d(u,"illFormedFormula",(function(){return Nl})),r.d(u,"createCompileGlobals",(function(){return Al})),r.d(u,"limitExceeded",(function(){return Bl})),r.d(u,"LimitKind",(function(){return Il})),r.d(u,"extractResultValue",(function(){return gf})),r.d(u,"evalToCellValue",(function(){return Cf})),r.d(u,"extension",(function(){return kp}));var c={};r.r(c),r.d(c,"WorkerKind",(function(){return vm})),r.d(c,"ErrorKind",(function(){return pm})),r.d(c,"isWorkerSupported",(function(){return $m})),r.d(c,"createWorker",(function(){return tg})),r.d(c,"tryCreateWorker",(function(){return rg})),r.d(c,"dedicatedWorkerInsideInit",(function(){return ag})),r.d(c,"runSmokeTest",(function(){return hg})),r.d(c,"cancelSmokeTest",(function(){return fg})),r.d(c,"smokeTestInsideInit",(function(){return cg})),r.d(c,"smokeTestInsideDef",(function(){return vg}));var s={};r.r(s),r.d(s,"getWorksheetFunc",(function(){return bb}));var l={};r.r(l),r.d(l,"worksheetFunctionName",(function(){return _p})),r.d(l,"errorTypeName",(function(){return Mp})),r.d(l,"localeData",(function(){return wp})),r.d(l,"numberFormat",(function(){return Lp})),r.d(l,"sheetName",(function(){return Dp})),r.d(l,"blankValue",(function(){return Up})),r.d(l,"errorValue",(function(){return xp})),r.d(l,"richValue",(function(){return Pp})),r.d(l,"getCellValueKind",(function(){return Gp})),r.d(l,"cellLocation",(function(){return Vp})),r.d(l,"rangeLocation",(function(){return Bp})),r.d(l,"sheetRangeLocation",(function(){return Wp})),r.d(l,"cellData",(function(){return jp})),r.d(l,"cellFormulaCellData",(function(){return Hp})),r.d(l,"arrayFormulaCellData",(function(){return Kp})),r.d(l,"valueCellData",(function(){return qp})),r.d(l,"rangeUpdate",(function(){return Jp})),r.d(l,"rangeWrite",(function(){return Qp})),r.d(l,"rangePromote",(function(){return Xp})),r.d(l,"arrayData",(function(){return Yp})),r.d(l,"arrayUpdate",(function(){return zp})),r.d(l,"arrayWrite",(function(){return Zp})),r.d(l,"arrayPromote",(function(){return $p})),r.d(l,"unusedCellsUpdate",(function(){return em})),r.d(l,"namedValueData",(function(){return tm})),r.d(l,"namedFormulaData",(function(){return rm})),r.d(l,"namedRangeData",(function(){return nm})),r.d(l,"namedFailureData",(function(){return am})),r.d(l,"namedObject",(function(){return im})),r.d(l,"namedObjectsUpdate",(function(){return om})),r.d(l,"namedObjectsWrite",(function(){return um})),r.d(l,"undefinedNamesWrite",(function(){return cm})),r.d(l,"namedObjectsPromote",(function(){return sm})),r.d(l,"rangeFormulaEdit",(function(){return lm})),r.d(l,"cellFormulaRangeFormulaEdit",(function(){return fm})),r.d(l,"valueRangeFormulaEdit",(function(){return dm})),r.d(l,"inferredRangeFormulaEdit",(function(){return hm})),r.d(l,"arrayFormulaEdit",(function(){return Cm})),r.d(l,"inferredFormat",(function(){return Sm})),r.d(l,"cellDataDelta",(function(){return Em})),r.d(l,"rangeDelta",(function(){return ym})),r.d(l,"arrayDelta",(function(){return Om})),r.d(l,"rangeFailure",(function(){return Am})),r.d(l,"recalcResults",(function(){return km})),r.d(l,"updateRequest",(function(){return bm})),r.d(l,"runExperiment",(function(){return Rm})),r.d(l,"recalcServiceConfig",(function(){return Im})),r.d(l,"createRecalcService",(function(){return uR})),r.d(l,"RecalcServiceCreateMode",(function(){return oR})),r.d(l,"recalcServiceInsideDef",(function(){return iR}));var f=r(1);function d(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function h(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t}function v(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t}function p(e){if(null==e||"object"!=typeof e)return"<not object>";var t=e,r=String(t.message);if(null!=t.stack){var n=String(t.stack);return n.indexOf(r)>=0?n:"Error: "+r+"\n"+n}return r}function m(e){return e}function g(e,t){if("string"==typeof t&&null!=S[t])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),n=void 0!==r?y[r]:void 0;return void 0===n&&(n=E[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(e instanceof Array)return"Array"}return t}(e)]),void 0!==n?n(e,t):"<unexpected>"}function C(e){try{return JSON.stringify(g(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var S={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},E={boolean:m,symbol:m,undefined:m,null:m,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function "+t+">":"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=g(e[r],r));return t},Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(g):"<unexpected>"}},y=Object.create(null),O={ULS:new(function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){if(!r)throw new Error("shipAssertTag "+e+" "+t+" "+n)},e.prototype.assertTag=function(e,t,r,n){if(!r)throw new Error("assertTag "+e+" "+t+" "+n)},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}())};function A(e,t){var r=e+": code should be unreachable because a value has type 'never'; given "+C(t);return O.ULS.assertTag(595980872,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}function k(e){return O.ULS.assertTag(595980873,f.LogCategory.msoulscat_ES_EWAJS,!1,e)}function b(e,t){t||k(e+": expected condition to be true")}function R(e,t){(!d(t)||t<0)&&k(e+": expected natural number; given "+C(t))}function I(e,t){(!d(t)||t<=0)&&k(e+": expected positive integer; given "+C(t))}function T(e,t,r){(!d(t)||t<0||t>=r)&&k(e+": expected natural number less than "+C(r)+"; given "+C(t))}function N(e,t,r){(!d(t)||t<=0||t>r)&&k(e+": expected positive integer at most "+C(r)+"; given "+C(t))}var F,_,M,w,L,D,U,x,P,G,V,B,W,j=r(0);function H(e){return void 0===e&&(e=0),{kind:_.Error,isQuoted:!1,label:e}}function K(e){return void 0===e&&(e=0),{kind:_.Relative,isQuoted:!1,label:e}}function q(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:_.Document,isQuoted:r,label:n,document:e,path:t}}function J(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:_.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function Q(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:_.Ident,isQuoted:t,label:r,name:e}}function X(e,t,r,n,a){return void 0===n&&(n=!1),void 0===a&&(a=0),{kind:_.SheetRange,isQuoted:n,label:a,sheet1:e,sheet2:t,document:r}}function Y(e,t){return{kind:e,index:t}}function z(e){return void 0===e&&(e=0),{kind:M.Error,label:e}}function Z(e,t,r){return void 0===r&&(r=0),{kind:M.Single,label:r,row:e,col:t}}function $(e,t,r){return void 0===r&&(r=0),{kind:M.Range,label:r,ref1:e,ref2:t}}function ee(e,t,r){return void 0===r&&(r=0),{kind:M.Row,label:r,row1:e,row2:t}}function te(e,t,r){return void 0===r&&(r=0),{kind:M.Col,label:r,col1:e,col2:t}}function re(e,t,r){return{node:e,spans:t,annotations:r}}function ne(e,t,r,n){var a,i;return R("calc.lang.formulaSpan",e),a="calc.lang.formulaSpan",d(i=t)||k(a+": expected integer; given "+C(i)),t<e&&k("calc.lang.formulaSpan: expected end >= "+e+"; given "+t),{start:e,end:t,pre:r,post:n}}function ae(e){return{kind:L.WorksheetFuncName,id:e}}function ie(e){return{kind:L.LocalName,name:e}}function oe(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:D.Literal,label:r,oper:e,isClosed:t}}function ue(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:D.Array,label:r,nodes:e,isClosed:t}}function ce(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:D.App,label:n,head:e,args:t,isClosed:r}}function se(e,t){return void 0===t&&(t=0),{kind:D.Operator,label:t,id:e}}function le(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:D.Paren,label:r,node:e,isClosed:t}}function fe(e,t,r){return void 0===r&&(r=0),{kind:D.Name,label:r,whole:e,qualifier:t}}function de(e,t,r){return void 0===r&&(r=0),{kind:D.CellRef,label:r,ref:e,qualifier:t}}function he(e,t,r){return void 0===r&&(r=0),{kind:D.Bad,label:r,type:e,contents:t}}function ve(e,t,r,n,a,i,o){(R("calc.lang.functionType",e),0===r.length?0!==n.length:n.length>=r.length)&&k("calc.lang.functionType: expected tailTypes.length < restTypes.length; given "+JSON.stringify(n));0===r.length&&t.length+n.length<e&&k("calc.lang.functionType: expected headTypes.length + tailTypes.length >= "+e+"; given "+JSON.stringify(t));return{minArgs:e,headTypes:t,restTypes:r,tailTypes:n,returnType:a,staticPrecs:i,flags:o}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(F||(F={})),function(e){e.Error="QualError",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(_||(_={})),function(e){e.Error="RefError",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(M||(M={})),function(e){e.Abs="Abs",e.Rel="Rel"}(w||(w={})),function(e){e.WorksheetFuncName="WorksheetFuncName",e.LocalName="LocalName"}(L||(L={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(D||(D={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(U||(U={})),function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(P||(P={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(G||(G={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(V||(V={})),function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(W||(W={}));var pe,me;function ge(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function Ce(e){var t=Ne[e];return void 0!==t?t:Te(e)}!function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(pe||(pe={})),function(e){e[e.First=1]="First",e[e.Last=13]="Last"}(me||(me={}));var Se=Te(pe.NULL),Ee=Te(pe.DIV0),ye=Te(pe.VALUE),Oe=Te(pe.REF),Ae=Te(pe.NAME),ke=Te(pe.NUM),be=Te(pe.NA),Re=Te(pe.GETTING_DATA),Ie=Te(pe.FIELD);function Te(e){return{kind:x.Error,type:e}}var Ne=v(((B={})[pe.NULL]=Se,B[pe.DIV0]=Ee,B[pe.VALUE]=ye,B[pe.REF]=Oe,B[pe.NAME]=Ae,B[pe.NUM]=ke,B[pe.NA]=be,B[pe.GETTING_DATA]=Re,B[pe.FIELD]=Ie,B));function Fe(e,t,r){return R("calc.lang.arrayOper",e),R("calc.lang.arrayOper",t),r.length!==e?k("calc.lang.arrayOper: Inconsistent row number"):{kind:x.Array,rows:e,cols:t,opers:r}}function _e(e,t){return I("calc.lang.rangeSeqOper",t.length),{kind:x.Range,sheets:e,ranges:t}}function Me(e,t){return{kind:x.Range,sheets:e,ranges:[t]}}var we,Le={kind:x.Missing},De={kind:x.Blank};!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.SUBARRAY=634]="SUBARRAY",e[e.APPENDROWS=635]="APPENDROWS",e[e.APPENDCOLUMNS=636]="APPENDCOLUMNS",e[e.SELECTROW=637]="SELECTROW",e[e.SELECTCOLUMN=638]="SELECTCOLUMN",e[e.LET=639]="LET",e[e.FUN=640]="FUN",e[e.ARRAYMAKE=641]="ARRAYMAKE",e[e.APPLY=642]="APPLY",e[e.ISFUN=643]="ISFUN",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.RECORD=646]="RECORD",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.TESTFUNCTIONBEGIN=649]="TESTFUNCTIONBEGIN",e[e.IMAGE=650]="IMAGE",e[e.GRF=651]="GRF",e[e.UNIT=652]="UNIT",e[e.RICHERROR=653]="RICHERROR",e[e.COUNTER=654]="COUNTER",e[e.BROKENRECORD=655]="BROKENRECORD",e[e.FORMULABYTES=656]="FORMULABYTES",e[e.FORMULACODE=657]="FORMULACODE",e[e.FORMULAHTML=658]="FORMULAHTML",e[e.STREAM=659]="STREAM",e[e.FORMATTEDNUMBER=660]="FORMATTEDNUMBER",e[e.LETREC=680]="LETREC"}(we||(we={}));var Ue,xe=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[637,"SelectRow"],[638,"SelectColumn"],[641,"ARRAY.MAKE"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]),Pe=[],Ge=[[1,Pe,[57],Pe,1,0,16],[1,[36,831,831],Pe,Pe,823,0,0],[1,[15],Pe,Pe,4,0,0],[1,[15],Pe,Pe,4,0,0],[1,Pe,[305],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[0,[16],Pe,Pe,33,0,0],[0,[16],Pe,Pe,33,0,0],[0,Pe,Pe,Pe,3,0,16],[2,[1],[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,[1,1],Pe,Pe,2,0,0],[1,[1,65,4],Pe,Pe,2,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[263,48,48],Pe,Pe,263,0,0],[2,[48,1,1,1],Pe,Pe,311,0,0],[2,[2,1],Pe,Pe,2,0,0],[3,[2,1,1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[1,[7],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,4,0,16],[0,Pe,Pe,Pe,4,0,16],[1,Pe,[52],Pe,4,0,16],[1,Pe,[52],Pe,4,0,16],[1,[4],Pe,Pe,4,0,16],[2,[1,1],Pe,Pe,1,0,0],[3,[16,83,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[1,Pe,[49],Pe,1,0,16],[3,[16,19,18],Pe,Pe,1,0,0],[2,[7,2],Pe,Pe,2,0,0],[1,[48,112,84,84],Pe,Pe,32,0,0],[1,[48,112,112,84],Pe,Pe,32,0,0],[1,[48,112,84,84],Pe,Pe,32,0,0],[1,[48,112,112,84],Pe,Pe,32,0,0],[1,[16],Pe,Pe,512,0,2],[0,[4],Pe,Pe,512,0,2],[0,[575],Pe,Pe,512,0,2],[3,[1,1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1,1,1,1],Pe,Pe,1,0,0],[3,[48,1,1],Pe,Pe,1,0,16],[1,[48,1],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,1,16383,0],[2,[263,305,17],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,1,16383,0],[1,[16],Pe,Pe,1,0,0],[1,[48],Pe,Pe,1,0,0],[1,[48],Pe,Pe,1,0,0],[3,[16,65,65,65,65],Pe,Pe,16,16383,0],[2,[2,16],Pe,Pe,16,0,2],[2,[16,16],Pe,Pe,2,0,2],[0,[66,81,16],Pe,Pe,4,0,2],[2,[2,2,1],Pe,Pe,1,0,0],[1,[39],Pe,Pe,32,0,0],[0,[1,24],Pe,Pe,4,0,2],[0,Pe,Pe,Pe,4,0,2],[1,[303],Pe,Pe,1,0,0],[0,[4],Pe,Pe,4,0,2],[1,[2,63],Pe,Pe,4,0,2],[0,Pe,Pe,Pe,50,0,2],[1,[16],Pe,Pe,47,0,2],[0,[65,66],Pe,Pe,32,0,2],[4,[87,117,117,1,117],Pe,Pe,4,0,0],[0,[1,66],Pe,Pe,32,0,2],[0,Pe,Pe,Pe,16,0,2],[0,Pe,Pe,Pe,16,0,2],[0,[1],Pe,Pe,4,0,2],[2,[1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[33],[831],Pe,823,0,0],[3,[263,49,49,4],Pe,Pe,295,0,0],[3,[263,49,49,4],Pe,Pe,295,0,0],[0,[66,65],Pe,Pe,32,0,2],[1,[2,65,66,67,65,65,2],Pe,Pe,575,0,2],[1,[63],Pe,Pe,4,0,0],[1,[18],Pe,Pe,2,0,2],[1,[2,4],Pe,Pe,6,0,2],[2,[16,47],Pe,Pe,4,0,2],[1,[1,1],Pe,Pe,1,0,0],[1,[2,1,4,4],Pe,Pe,7,0,2],[1,[1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,2,0,0],[1,[2],Pe,Pe,2,0,0],[1,[2],Pe,Pe,2,0,0],[1,[2,9],Pe,Pe,2,0,0],[1,[2,9],Pe,Pe,2,0,0],[2,[2,2],Pe,Pe,4,0,0],[1,[2],Pe,Pe,2,0,0],[4,[2,1,1,2],Pe,Pe,2,0,0],[3,[2,2,2,2],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[0,[66,65,66],Pe,Pe,32,0,2],[0,[2],Pe,Pe,2,0,2],[2,[2,2,1],Pe,Pe,1,0,0],[1,[2,16],Pe,Pe,303,16383,0],[1,[15],Pe,Pe,4,0,0],[1,[143],Pe,Pe,4,0,0],[1,[143],Pe,Pe,4,0,0],[1,[143],Pe,Pe,4,0,0],[1,[23],Pe,Pe,2,0,0],[1,[23],Pe,Pe,1,0,0],[1,[2,1],Pe,Pe,1,0,2],[1,[1],Pe,Pe,1,0,2],[1,[1],Pe,Pe,1,0,2],[1,[1],Pe,Pe,2,0,2],[2,[1,1],Pe,Pe,2,0,2],[2,[1,2],Pe,Pe,1,0,2],[2,[1,2],Pe,Pe,1,0,2],[1,[1,1],Pe,Pe,1,0,2],[1,[3],Pe,Pe,1,0,0],[1,[3],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,1,1],Pe,Pe,1,0,0],[1,[2,66,65],Pe,Pe,2,0,2],[1,[16,4],Pe,Pe,2,0,2],[1,[2,4],Pe,Pe,16,0,2],[1,[2,4],Pe,Pe,16,16383,0],[1,[2,3,66,66,66,65,67,66,67],[66],Pe,3,0,2],[1,[3],[127],Pe,575,0,2],[0,[3],Pe,Pe,1,0,2],[2,[3,115,83,3],Pe,Pe,1,0,2],[3,[3,83,115,83,3],Pe,Pe,1,0,2],[4,[3,3,3,4,3],Pe,Pe,4,0,2],[4,[3,3,3,4,3],Pe,Pe,4,0,2],[4,[3,3,3,3,3],Pe,Pe,4,0,2],[0,[3],Pe,Pe,4,0,2],[2,[3,3,3],Pe,Pe,4,0,2],[3,[3,3,3,3],Pe,Pe,4,0,2],[1,[1,67,66],Pe,Pe,1,0,2],[1,[52],Pe,Pe,36,0,2],[1,[2],Pe,Pe,2,0,0],[1,[32],Pe,Pe,1,0,0],[1,[32],Pe,Pe,32,0,0],[2,[32,32],Pe,Pe,32,0,0],[0,[2,2],Pe,Pe,32,0,2],[4,[1,1,1,1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,1,1,1],Pe,Pe,1,0,0],[1,Pe,[121],Pe,1,0,16],[0,[1,16],Pe,Pe,4,0,2],[3,[2,1,1,1],Pe,Pe,512,0,2],[1,[4],Pe,Pe,512,0,2],[0,Pe,Pe,Pe,512,0,2],[0,Pe,Pe,Pe,512,0,2],[2,[2,2],Pe,Pe,1,0,2],[2,[1,2],Pe,Pe,32,0,2],[3,[1,18,18],Pe,Pe,4,0,2],[2,[1,2],Pe,Pe,4,0,2],[1,[1],Pe,Pe,4,0,2],[0,[1],Pe,Pe,512,0,2],[0,[2],Pe,Pe,4,0,2],[0,[3,3,3,3],Pe,Pe,3,0,2],[1,Pe,[113],Pe,1,0,16],[1,[1],Pe,Pe,1,0,0],[1,[1,16],Pe,Pe,47,0,2],[1,[1],Pe,Pe,47,0,2],[1,[1,2],Pe,Pe,47,0,2],[1,[1,2],Pe,Pe,63,0,2],[3,[16,19,18],Pe,Pe,1,0,0],[1,[143],Pe,Pe,4,0,0],[0,[82,65,65],Pe,Pe,2,0,2],[0,[66,82,17,17],Pe,Pe,1,0,2],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[3,[16,19,18],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,1,0,0],[1,[1,1],Pe,Pe,1,0,0],[1,[143],Pe,Pe,4,0,0],[3,[16,83,18],Pe,Pe,1,0,0],[1,[3],Pe,Pe,4,0,2],[1,[3],Pe,Pe,4,0,2],void 0,void 0,[1,[1,1],Pe,Pe,2,0,0],[2,[2,2,1],Pe,Pe,1,0,0],[2,[2,2,1],Pe,Pe,1,0,0],[4,[2,1,1,2],Pe,Pe,2,0,0],[1,[2,9],Pe,Pe,2,0,0],[1,[2,9],Pe,Pe,2,0,0],[3,[2,1,1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[1,[2],Pe,Pe,2,0,0],[1,[2],Pe,Pe,2,0,0],[2,[1,16,4],Pe,Pe,1,0,16],void 0,void 0,[2,[1,65,65,68,66],Pe,Pe,2,0,0],[2,[1,1,4],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,1,16383,0],[5,[1,1,1,1,1,1,4],Pe,Pe,1,0,0],[0,Pe,Pe,Pe,512,0,2],[1,[12],Pe,Pe,512,0,2],[0,Pe,Pe,Pe,512,0,2],[1,[2,82,84],Pe,Pe,512,0,2],[1,Pe,[49],Pe,1,0,16],[1,Pe,[32],Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[16,19,18],Pe,Pe,263,0,0],[2,[1,18,17,17,18,17,17,115,84,21,17],Pe,Pe,2,0,2],[0,[4],Pe,Pe,4,0,2],[0,Pe,Pe,Pe,16,0,2],[0,[2,2],Pe,Pe,4,0,2],[0,[2,2,2],Pe,Pe,4,0,2],[2,[2,23,23,23,23],Pe,Pe,2,0,2],[2,[2,1,1,2],Pe,Pe,1,0,2],[1,[2,66,65,65],Pe,Pe,1,0,2],[1,[2],Pe,Pe,3,16383,0],[0,Pe,Pe,Pe,2,0,2],[1,[1,2,1,1,1],Pe,Pe,47,0,2],[4,[1,1,1,1,1],Pe,Pe,1,0,0],[0,[4],Pe,Pe,512,0,2],void 0,void 0,[0,[1],Pe,Pe,512,0,2],[2,[48,48],Pe,Pe,32,0,16],[0,[66,96],Pe,Pe,2,0,2],[1,[2],Pe,Pe,4,0,2],[1,[17],[127],Pe,575,0,0],[1,[3],Pe,Pe,4,0,2],[1,[2],Pe,Pe,63,0,2],[1,[1,3],Pe,Pe,47,0,2],[1,[1,3,1],Pe,Pe,47,0,2],[1,[2,66,4],Pe,Pe,4,0,2],[1,[15],Pe,Pe,1,0,0],[0,[2],Pe,Pe,4,0,2],[0,[2],Pe,Pe,4,0,2],[0,[99,66],Pe,Pe,4,0,2],[3,[3,1,4],Pe,Pe,4,0,2],[3,[3,1,4],Pe,Pe,4,0,2],[2,[2,3,66],Pe,Pe,1,0,2],[1,[1,2],Pe,Pe,35,0,2],[1,Pe,[49],Pe,1,0,16],[3,[1,1,1,65,65],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,1,65,65],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[4,[1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[3,[1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[3,[1,32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[4,[32,32,1,1],Pe,Pe,1,0,0],[3,[32,32,1,65],Pe,Pe,1,0,0],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[2,[49,1,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1,65],Pe,Pe,1,0,16],[1,Pe,[32],Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[1,1],Pe,Pe,1,0,0],void 0,[3,[2,1,1,1],Pe,Pe,1,0,2],[2,[2,1,1],Pe,Pe,1,0,2],[1,Pe,[2],Pe,2,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[66,2,66,65,65,65,66,66,66],Pe,Pe,2,0,2],[1,[1,2],Pe,Pe,35,0,2],[1,[1,66,2],Pe,Pe,35,0,2],[1,[1,66,66,2],Pe,Pe,7,0,2],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[2,[1],[16],Pe,1,0,0],[2,[16,15,16],Pe,Pe,1,0,0],[2,[16,15],Pe,Pe,1,0,0],[1,[16],Pe,Pe,1,0,0],[1,[1,2],Pe,Pe,19,0,2],[1,[33],Pe,Pe,33,0,2],[4,[1,1,1,1],Pe,Pe,1,0,0],[3,[1,1,2],Pe,Pe,1,0,0],[1,[1],Pe,Pe,2,0,0],[2,[1,1],Pe,Pe,2,0,0],[1,[1,5],Pe,Pe,2,0,0],[0,[66,66,66,65],Pe,Pe,6,0,2],[0,[66,66,66,66,65],Pe,Pe,6,0,2],[1,[1,2],Pe,Pe,19,0,2],[2,[18,18],[2,79],Pe,15,0,0],[1,[2,39],Pe,Pe,39,0,0],[1,[16],Pe,Pe,2,0,0],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,[1],Pe,Pe,2,0,0],[1,[1],Pe,Pe,2,0,0],[1,[3],Pe,Pe,2,0,0],[1,[1],Pe,Pe,2,0,0],[1,[1],Pe,Pe,2,0,0],[1,[1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[1,[2],Pe,Pe,4,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,Pe,[2],Pe,2,0,0],[1,[2],[50],Pe,15,0,0],[2,[2,50,2],Pe,Pe,10,0,0],[3,[2,2,2],Pe,Pe,15,0,0],[3,[2,2,1,2],Pe,Pe,10,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[95,95,95],Pe,Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[4,[95,95,95,127],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[1,[95,95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[127,127,95],Pe,Pe,9,0,0],[3,[95,127,127],Pe,Pe,9,0,0],[5,[95,95,95,95,95,95],Pe,Pe,9,0,0],[5,[95,95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95],Pe,Pe,9,0,0],[3,[95,95,95],Pe,Pe,9,0,0],[3,[95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,0,0],[2,[95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95,95],Pe,Pe,9,0,0],[5,[95,95,95,95,95,95],Pe,Pe,9,0,0],[5,[95,95,95,95,95,95],Pe,Pe,9,0,0],[7,[95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[7,[95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[8,[95,95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[2,[95,95],Pe,Pe,9,16383,0],[1,[95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95],Pe,Pe,9,0,0],[3,[95,95,95],Pe,Pe,9,0,0],[6,[95,95,95,95,95,95,95,95],Pe,Pe,9,0,0],[4,[95,95,95,95,95],Pe,Pe,9,0,0],[2,[95,95,127],Pe,Pe,9,0,0],[2,[95,95,127],Pe,Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[1,Pe,[127],Pe,9,0,0],[2,[95,127],Pe,Pe,9,0,0],[3,[2,2,1,2],Pe,Pe,10,0,0],[2,[2,50,2,1,2],Pe,Pe,10,0,0],[1,[2],Pe,Pe,9,0,0],[2,[47,575],Pe,Pe,303,0,0],[2,Pe,[16,15],Pe,1,0,0],[3,[16],[16,15],Pe,1,0,0],[2,[16,15,16],Pe,Pe,1,0,0],[3,[16],[16,15],Pe,1,0,0],[3,[1,1,48,17],[16],Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[2,[32,32],Pe,Pe,1,0,0],[3,[1,1,4],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,Pe,[32],Pe,32,0,16],[1,Pe,[32],Pe,1,0,16],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1,65],Pe,Pe,1,0,16],[2,[49,1,65],Pe,Pe,1,0,16],[3,[1,1,4],Pe,Pe,1,0,0],[2,[49,1],Pe,Pe,1,0,16],[2,[49,1],Pe,Pe,1,0,16],[2,[1,16,4],Pe,Pe,1,0,16],[2,[1,16,4],Pe,Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[3,[1,1,4],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[1,Pe,[49],Pe,1,0,16],[1,Pe,[49],Pe,1,0,16],[4,[1,1,1,4],Pe,Pe,1,0,0],[2,[95,95,75,127],Pe,Pe,9,0,0],[2,[95,95,75,127],Pe,Pe,9,0,0],[2,[1,1],Pe,Pe,1,0,0],[1,[1,65],Pe,Pe,1,0,0],void 0,[4,[1,1,1,4,65,65],Pe,Pe,1,0,0],[3,[1,1,1,65,65],Pe,Pe,1,0,0],[3,[1,1,4],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[5,[1,1,1,1,4],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[4,[1,1,1,4],Pe,Pe,1,0,0],[2,[1,4],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[4,[32,32,1,1],Pe,Pe,1,0,0],[2,[49,1,1],Pe,Pe,1,0,16],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1,65],Pe,Pe,1,0,0],[1,[1,65],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[2,[1,1],Pe,Pe,1,0,0],[1,Pe,[52],Pe,4,0,16],[3,[1,1,1],Pe,Pe,1,0,0],[2,[1,1,65],Pe,Pe,2,0,0],[2,[2,1],Pe,Pe,1,0,0],[2,[3,3],Pe,Pe,1,0,0],[3,[1,1,1,65],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,Pe,[49],Pe,1,0,16],[1,[1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[3,[1,1,1],Pe,Pe,1,0,0],[1,[1],Pe,Pe,2,0,0],[1,[2],Pe,Pe,1,0,0],[1,[1],Pe,Pe,32,0,0],[1,[2],Pe,Pe,1,0,0],[1,[1],Pe,Pe,1,0,0],[1,[2,66,66],Pe,Pe,1,0,0],[0,[50],Pe,Pe,1,16383,16],[0,[48],Pe,Pe,1,16383,16],[1,[16],Pe,Pe,2,16383,0],[1,[16],Pe,Pe,4,0,0],[2,[47,575],Pe,Pe,303,0,0],[1,[1,65,65],Pe,Pe,1,0,0],[1,[1,65,65],Pe,Pe,1,0,0],[1,[95],Pe,Pe,9,0,0],[1,[95],Pe,Pe,9,0,0],[2,[2,2],Pe,Pe,47,0,0],[1,[2],Pe,Pe,10,0,0],[1,[2],Pe,Pe,10,0,0],[3,[1,48,48,65,65,65],Pe,Pe,1,0,0],[3,[1,48,48,65,65,65,65],Pe,Pe,1,0,0],[2,[48,48,65,65],Pe,Pe,1,0,0],[3,[1,32,32],Pe,Pe,1,0,0],[3,[48,48,1,65,65,65],Pe,Pe,1,0,0],[3,[16],[16,15],Pe,1,0,0],[3,[16],[16,15],Pe,1,0,0],[3,[114,68],[114],Pe,2,0,16],[1,Pe,[114],Pe,2,0,16],[2,Pe,[44,575],Pe,831,0,0],[3,[47],[575,575],[575],831,0,0],[1,[1399],Pe,Pe,1375,0,17],[2,Pe,[113,113],Pe,1,0,17],[1,[16],Pe,Pe,48,0,21],[2,[271,2,4],Pe,Pe,303,0,21],[2,[271,2],Pe,Pe,303,0,17],[2,[48,48,111],Pe,Pe,303,0,1],[1,[160,96,96,4],Pe,Pe,32,0,1],[1,[160,4,4],Pe,Pe,32,0,1],[2,[2,256],Pe,Pe,1,0,8],[3,[2,49,1],Pe,Pe,1,0,25],[3,[2,49,1],Pe,Pe,1,0,25],[2,[2],[49],Pe,1,0,25],[2,[2,2,65,68,68],Pe,Pe,1,0,1],[1,[2,65,65],Pe,Pe,2,0,1],[2,[2,2,65,68],Pe,Pe,2,0,1],[2,[2,2,65,68],Pe,Pe,2,0,1],[2,[2,98,98,68],Pe,Pe,32,0,1],[1,[32,96,96,4],Pe,Pe,32,0,9],[2,[4,16],Pe,Pe,32,0,25],[2,[391,48,65,65],Pe,Pe,1,0,1],[3,[391,48,48,511,65,65],Pe,Pe,319,0,1],[2,[160],[160,65],Pe,32,0,1],[0,[65,65,65,65,68],Pe,Pe,32,16383,1],[1,[65,65,65,65],Pe,Pe,32,0,1],[2,[258,1,65,65,68],[65],Pe,32,0,17],[1,[48,65,65,65,65],Pe,Pe,48,0,1],[1,[48],[48],Pe,32,0,1],[1,[48],[48],Pe,32,0,1],[1,[48,33],[33],Pe,32,0,1],[1,[48,33],[33],Pe,32,0,1],[3,Pe,[319,319],[319],319,0,1],[1,Pe,[319],Pe,319,0,1],[3,[1,1,319],Pe,Pe,32,0,1],[1,Pe,[319],Pe,319,0,1],[1,[319],Pe,Pe,4,0,1],[1,[319],Pe,Pe,9,0,1],[0,Pe,Pe,Pe,319,0,1],[3,[15],[2,47],Pe,303,0,17],[1,[399,1],Pe,Pe,2,0,1],[1,[32,1],Pe,Pe,2,0,1],[0,Pe,Pe,Pe,1,0,1],[1,[2],Pe,Pe,258,0,1],[1,[287,2],Pe,Pe,288,0,17],[2,[15,2],Pe,Pe,271,0,17],[1,[1],Pe,Pe,10,0,17],[0,Pe,Pe,Pe,1,0,1],[3,[47],[2,47],Pe,47,0,17],[1,[16],Pe,Pe,2,16383,1],[1,[16],Pe,Pe,2,16383,1],[1,[16],Pe,Pe,2,16383,1],[0,[1],Pe,Pe,1,0,1],[2,[1,1],Pe,Pe,265,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,Pe,[319,319],[319],319,0,1]].map((function(e){return void 0===e?void 0:ve.apply(void 0,e)})),Ve=ve(0,[],[P.All],[],P.All,G.All,V.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot",e[e.At=25]="At",e[e.Pound=26]="Pound"}(Ue||(Ue={}));var Be,We,je=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,".","@","#"],He=x.Number|x.String|x.Boolean|x.Blank,Ke=x.Number|x.String|x.Boolean|x.Blank,qe=ve(2,[x.Number,x.Number],[],[],x.Number,G.None,V.None),Je=ve(1,[x.Number],[],[],x.Number,G.None,V.None),Qe=ve(1,[He],[],[],He,G.None,V.None),Xe=ve(2,[x.String,x.String],[],[],x.String,G.None,V.None),Ye=ve(2,[Ke,Ke],[],[],x.Boolean,G.None,V.None),ze=ve(2,[x.Range,x.Range],[],[],x.Range,G.AllCells,V.None),Ze=ve(2,[x.Range,x.Range],[],[],x.Range,G.None,V.None),$e=ve(2,[x.Boolean,x.Boolean],[],[],x.Boolean,G.None,V.None),et=[];function tt(e){var t=et[e];return null!=t?t:Ve}function rt(e){var t=Ge[e];return null!=t?t:Ve}function nt(e,t){var r=Ge[e];null!=r&&(r.staticPrecs=t)}function at(e){return{kind:Be.Success,value:e}}function it(e){return{kind:Be.Failure,reason:e}}function ot(e){return e.kind===Be.Success}function ut(e){return{kind:We.JavaScriptError,error:e}}function ct(e){return e.index===e.index2}function st(e){return e.isWellFormed}function lt(e){return 1===e.rows&&1===e.cols}function ft(e){return ct(e.sheet)}function dt(e){return lt(e.range)}function ht(e,t){if(lt(e))return t(e,0,0);for(var r=e.row,n=e.rows,a=e.col,i=e.cols,o=0;o<n;o+=1)for(var u=0;u<i;u+=1)if(!t(Zt(r+o,a+u),o,u))return!1;return!0}function vt(e,t){return e===t||e.name===t.name&&e.path===t.path}function pt(e,t){return vt(e.document,t.document)&&e.index===t.index}function mt(e,t){return e.row===t.row&&e.col===t.col}function gt(e,t){return pt(e.sheet,t.sheet)&&mt(e.range,t.range)}function Ct(e){return lt(e)?e:Yt(e.row,e.col,1,1)}function St(e){return dt(e)?e:rr(e.sheet,Ct(e.range))}function Et(e,t){var r=e.row,n=e.col,a=t.row,i=t.col;return Yt(Math.min(r,a),Math.min(n,i),Math.abs(a-r)+1,Math.abs(i-n)+1)}function yt(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,a=!0;a;)switch(a=!1,n.kind){case D.Array:for(var i=n.nodes,o=i.length-1;!a&&o>=0;o-=1)for(var u=i[o],c=u.length-1;!a&&c>=0;c-=1){r(l=u[c])&&(n=l,a=!0)}break;case D.App:var s=n.args;for(c=s.length-1;!a&&c>=0;c-=1){r(l=s[c])&&(n=l,a=!0)}break;case D.Paren:var l;r(l=n.node)&&(n=l,a=!0);break;case D.Bad:case D.Name:case D.CellRef:case D.Literal:break;default:A("getSubExpressionFromPosition",n)}return n}et[Ue.Add]=qe,et[Ue.Sub]=qe,et[Ue.Mul]=qe,et[Ue.Div]=qe,et[Ue.Pow]=qe,et[Ue.Percent]=Je,et[Ue.Neg]=Je,et[Ue.At]=Ge[we.SINGLE],et[Ue.Pound]=Ge[we.ANCHORARRAY],et[Ue.Pos]=Qe,et[Ue.Concat]=Xe,et[Ue.Eq]=Ye,et[Ue.Ne]=Ye,et[Ue.Lt]=Ye,et[Ue.Le]=Ye,et[Ue.Gt]=Ye,et[Ue.Ge]=Ye,et[Ue.Range]=ze,et[Ue.Isect]=Ze,et[Ue.Union]=Ze,et[Ue.And]=$e,et[Ue.Or]=$e,et[Ue.Xor]=$e,et[Ue.Min]=qe,et[Ue.Max]=qe,et[Ue.Dot]=Ge[we._FV],nt(we.ROW,G.OwnRow),nt(we.COLUMN,G.OwnCol),nt(we.SHEET,G.OwnDocSheets),nt(we.SHEETS,G.OwnDocSheets),nt(we.OFFSET,G.AllCells),nt(we.INDIRECT,G.AllCells),nt(we.SUMIF,G.AllCells),nt(we.AVERAGEIF,G.AllCells),nt(we.LOOKUP,G.AllCells),nt(we.ADDRESS,G.RefStyle),nt(we.FORMULATEXT,G.RefStyle),nt(we.NOW,G.Time),nt(we.TODAY,G.Time),nt(we.RAND,G.Calc),nt(we.RANDBETWEEN,G.Calc),nt(we.RANDARRAY,G.Calc),nt(we.SUBTOTAL,G.CellProps),nt(we.CELL,G.CellProps|G.AllCells),nt(we.INFO,G.None),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(Be||(Be={})),function(e){e.JavaScriptError="JavaScriptError"}(We||(We={}));var Ot,At=[];function kt(e){return 0===function(e){if(1===e.args.length){var t=e.args[0];if(t.kind===D.Literal&&Nt(t.oper)===x.Missing)return 0}return e.args.length}(e)?At:e.args}function bt(e){return e.kind===D.Operator}function Rt(e){return e.kind===D.Name&&void 0===e.qualifier}function It(e,t,r){var n=e.headTypes,a=e.restTypes,i=e.tailTypes;if(I("calc.runtime.getArgType: n",r),T("calc.runtime.getArgType: i",t,r),t<n.length)return n[t];if(0===a.length)return P.None;var o=(r-n.length)%a.length;return o>i.length?P.None:t>=r-o?i[t-(r-o)]:a[(t-n.length)%a.length]}function Tt(e,t){var r=e.minArgs,n=e.headTypes,a=e.restTypes,i=e.tailTypes;return!(t<r)&&(t<=n.length||0!==a.length&&(t-n.length)%a.length<=i.length)}function Nt(e){switch(typeof e){case"number":return x.Number;case"string":return x.String;case"boolean":return x.Boolean;default:return e.kind}}function Ft(e){return"number"==typeof e&&isFinite(e)}function _t(e,t,r){if(typeof t!=typeof e)return!1;if("object"!=typeof t||"object"!=typeof e)return t===e;if(t.kind!==e.kind)return!1;switch(t.kind){case x.Error:return t.type===e.type;case x.Rich:return r;case x.Array:var n=e;if(t.cols!==n.cols||t.rows!==n.rows)return!1;for(var a=0;a<t.rows;a+=1)for(var i=t.opers[a],o=n.opers[a],u=0;u<t.cols;u+=1)if(!_t(o[u],i[u],r))return!1;return!0;case x.Blank:return!0;default:return A("calc.lang.readOperEq",t)}}!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(Ot||(Ot={}));var Mt=Object(j.a)(Object(j.a)({},We),Ot);function wt(e){return{kind:Mt.NotImplemented,features:e}}function Lt(e){return 0===e.length&&k("calc.lang.unavailable: expected nonempty array"),{kind:Mt.Unavailable,objects:e}}function Dt(e){return{kind:Mt.Internal,message:e}}var Ut=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};(Ut.prototype=Object.create(Error.prototype)).constructor=Ut;var xt="_xlfn.",Pt="_xlws.";function Gt(e,t){var r=t;return r.length>xt.length&&0===e.stringCompareCI(r.substr(0,xt.length),xt)&&(r=r.substr(xt.length)).length>Pt.length&&0===e.stringCompareCI(r.substr(0,Pt.length),Pt)&&(r=r.substr(Pt.length)),e.getWorksheetFuncId(r)}var Vt;function Bt(e){return{kind:Vt.Cell,range:e}}function Wt(e){return{kind:Vt.Range,range:e}}function jt(e,t){switch(e){case Vt.Cell:return dt(t)?Bt(t):k("calc.lang.lexicalSourceGrid: expected cell");case Vt.Range:return Wt(t)}}function Ht(e){return{kind:Vt.NameManager,name:e}}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.Other=7]="Other"}(Vt||(Vt={}));function Kt(e,t){return{path:e,name:t}}function qt(e,t,r){return{document:e,index:t,index2:r}}function Jt(e,t){return qt(e,t,t)}function Qt(e){return{document:e,index:void 0,index2:void 0}}function Xt(e,t){return{sheets:e,position:t}}function Yt(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function zt(e,t,r,n){return T("calc.lang.gridRange",e,1<<20),T("calc.lang.gridRange",t,16384),N("calc.lang.gridRange",r,(1<<20)-e),N("calc.lang.gridRange",n,16384-t),Yt(e,t,r,n)}function Zt(e,t){return T("calc.lang.gridCell",e,1<<20),T("calc.lang.gridCell",t,16384),Yt(e,t,1,1)}function $t(e,t){return{sheet:e,range:t}}var er=$t,tr=$t,rr=$t,nr=$t;function ar(e){return{document:e,index:void 0}}function ir(e,t){return void 0===t?ar(e):Jt(e,t)}function or(e,t){return{scope:e,name:t}}function ur(e,t){return{document:e,id:t}}function cr(e,t){return{wrap:e,unwrap:t}}function sr(e){return e}function lr(e){return null!=e}function fr(e){return null==e}function dr(e,t){return lr(e)?e:t}function hr(e,t){return[e,t]}function vr(e,t){return e<t?e:t}function pr(e,t){return e<t?t:e}function mr(e){return e<0?-e:e}function gr(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}var Cr="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};function Sr(e){return 32===e||10===e}function Er(e,t,r,n){T("calc.parse.parseUint",t,16);for(var a=0,i=n,o=r.length;i<o;i+=1){var u=r.charCodeAt(i);if(!e.isNumeral(u))break;var c=e.getOrdinal(u);0===a&&0!==c&&(o=vr(o,i+t)),a=10*a+c}return i===o&&i<r.length&&e.isNumeral(r.charCodeAt(i))?[0,n]:[a,i]}var yr=43,Or=45;function Ar(e,t,r,n){var a=n,i=0,o="";if(h(r,e.decimalSeparator,n)||r.length>n&&e.isNumeral(r.charCodeAt(n))){for(;a<r.length;a+=1){var u=r.charCodeAt(a);if(!e.isNumeral(u))break;if(0!==e.getOrdinal(u))break}for(var c=a;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break;i+=1}o+=r.substring(c,a);var s=!1;if(h(r,e.decimalSeparator,a)&&(s=a===n,a+=e.decimalSeparator.length),0===i)for(;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break;if(0!==e.getOrdinal(u))break;i-=1}for(c=a;a<r.length;a+=1){u=r.charCodeAt(a);if(!e.isNumeral(u))break}if(o+=r.substring(c,a),!(s&&a<=n+e.decimalSeparator.length)){var l=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(n+1<t.length&&"**"===t.substring(n,n+2)))return[0,r];n+=2}var a=!1;if(n<t.length){var i=t.charCodeAt(n);((a=i===Or)||i===yr)&&(n+=1)}if(n>=t.length||!e.isNumeral(t.charCodeAt(n)))return!1;var o=Er(e,10,t,n),u=o[0],c=o[1];return c!==n&&(!(u>2147483647)&&[a?-u:u,c])}(e,r,a);if(!1!==l)i+=l[0],a=l[1];return!1===l||mr(i)>=309?{value:void 0,i:a}:{value:t.parse(e,!0,i,o),i:a}}}}var kr=1<<20,br=kr.toString(10).length,Rr=16384,Ir=Rr.toString(26).length,Tr=Rr.toString(10).length;function Nr(e){return e>=97&&e<=122||e>=65&&e<=90}function Fr(e){return 1+(e>=97?e-97:e-65)}function _r(e,t,r){return function(n,a,i,o){var u=function(e,t){return"$"===e[t]?[w.Abs,t+1]:[w.Rel,t]}(i,o),c=u[0],s=u[1],l=e(n,r,i,s),f=l[0],d=l[1];if(d>s){if(f<1||f>t)return;return[Y(c,(c===w.Rel?f-a:f)-1),!1,d]}return[void 0,!1,o]}}function Mr(e,t,r){return Jr(e,t,r)-e}function wr(e,t,r,n){return function(a,i,o,u){var c=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(u>=o.length||0!==a.stringCompareCI(c,o[u]))return[void 0,!1,u];var s=u+1,l=Er(a,n,o,s),f=l[0],d=l[1];if(d>s){if(f<1||f>r)return;return[Y(w.Abs,f-1),!1,d]}if(o[s]===a.leftBracket){if(o[s+=1]===a.rightBracket)return[Y(w.Rel,Mr(i,0,r)),!0,s+1];var h=1;"+"===o[s]?s+=1:"-"===o[s]&&(h=-1,s+=1);var v=Er(a,n,o,s),p=v[0],m=v[1];if(m>s&&p<r&&o[m]===a.rightBracket)return[Y(w.Rel,Mr(i,p*h,r)),!0,m+1]}return[!1,!1,d]}}function Lr(e,t,r,n,a,i,o){var u=n(e,t,i,o);if(null==u)return[void 0,void 0,o];var c=u[0],s=u[1],l=u[2];if(l>o){var f=a(e,r,i,l);if(null==f)return s?[c,void 0,l]:[void 0,void 0,o];var d=f[0],h=f[2];return h>l?[c,d,h]:[c,void 0,l]}var v=a(e,r,i,o);if(null==v)return[void 0,void 0,o];var p=v[0],m=v[2];return m>o?[void 0,p,m]:[void 0,void 0,o]}var Dr=_r(Er,kr,br),Ur=_r((function(e,t,r,n){return function(e,t,r){for(var n=0,a=r,i=Math.min(t.length,r+e);a<i;a+=1){var o=t.charCodeAt(a);if(!Nr(o))break;n=26*n+Fr(o)}return a===i&&Nr(t.charCodeAt(a))?[0,r]:[n,a]}(t,r,n)}),Rr,Ir),xr=wr(!1,!0,kr,br),Pr=wr(!1,!1,Rr,Tr),Gr=wr(!0,!0,kr,br),Vr=wr(!0,!1,Rr,Tr);function Br(e,t,r,n,a){var i,o=r.col,u=r.row;if(t===F.A1){var c=Lr(e,o,u,Ur,Dr,n,a),s=c[0],l=c[1],f=c[2];if(null!=l&&null!=s||null!=l&&l.kind===w.Abs||null!=s&&s.kind===w.Abs||(null!=l||null!=s)&&(":"===n[a-1]||":"===n[f])){if(f>=n.length||!e.isIdentContinue(n.charCodeAt(f)))return{refStyle:F.A1,row:l,col:s,i:f};if("."===n[f])return}}var d=!1,h=Lr(e,u,o,xr,Pr,n,a),v=h[0],p=h[1],m=h[2];if(null!=v||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(d=!0,v=(i=Lr(e,u,o,Gr,Vr,n,a))[0],p=i[1],m=i[2]),null!=v||null!=p){var g=null!=v&&!1!==v||null!=p&&!1!==p;if(m>=n.length||g||!e.isIdentContinue(n.charCodeAt(m)))return{refStyle:F.R1C1,row:v,col:p,i:m,enLocale:d}}}function Wr(e,t){var r=Lr(e,0,0,Ur,Dr,t,0),n=r[0],a=r[1],i=r[2];return void 0!==n&&void 0!==a&&i===t.length?Zt(a.index,n.index):void 0}function jr(e,t){var r=Lr(e,0,0,Ur,Dr,t,0),n=r[0],a=r[1],i=r[2];if(void 0!==n&&void 0!==a){if(i===t.length)return Zt(a.index,n.index);if(":"===t[i]){var o=Lr(e,0,0,Ur,Dr,t,i+1),u=o[0],c=o[1],s=o[2];if(void 0!==u&&void 0!==c&&s===t.length){var l=vr(a.index,c.index),f=vr(n.index,u.index);return zt(l,f,pr(a.index,c.index)+1-l,pr(n.index,u.index)+1-f)}}}}var Hr=Y(w.Abs,0),Kr=Y(w.Abs,1048575);function qr(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r}function Jr(e,t,r){return e+t&r-1}function Qr(e,t,r,n){if(t.kind===w.Abs)return t.index;if(n)return Jr(e,t.index,r);var a=e+t.index;return 0<=a&&a<r?a:void 0}function Xr(e,t,r,n,a,i){var o=Qr(r,n,a,i);if(void 0!==o){if(n.kind===w.Abs)return t+(o+1).toFixed();var u=o-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function Yr(e,t,r,n,a){return t===F.A1?function(e,t,r){var n=Qr(e,t,1<<20,r);if(void 0!==n){var a=(n+1).toFixed();return t.kind===w.Abs?"$"+a:a}}(r,n,a):Xr(e,e.rowLetter,r,n,1<<20,a)}function zr(e,t,r,n,a){return t===F.A1?function(e,t,r){var n=Qr(e,t,16384,r);if(void 0!==n){var a=qr(n);return t.kind===w.Abs?"$"+a:a}}(r,n,a):Xr(e,e.columnLetter,r,n,16384,a)}function Zr(e,t,r,n){if(r.kind===w.Abs)return r;var a=Qr(t,r,e,n);if(void 0!==a){var i=a-t;return i===r.index?r:Y(w.Rel,i)}}Zr.bind(void 0,1<<20),Zr.bind(void 0,16384);function $r(e,t,r,n,a){var i=Qr(e,t,n,a),o=Qr(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function en(e,t,r,n,a,i,o,u,c){var s=$r(i,o,u,r,c);if(void 0!==s){var l=s[0],f=s[1],d=s[2],h=s[3];if(void 0!==t&&0===d&&h===r-1&&o.kind===u.kind)return t(n,a,c);var v=e(n,a,i,l,c);if(void 0!==v){if(a===F.R1C1&&l.kind===f.kind&&l.index===f.index)return v;var p=e(n,a,i,f,c);if(void 0!==p)return v+":"+p}}}var tn=en.bind(void 0,Yr,void 0,1<<20),rn=en.bind(void 0,zr,(function(e,t,r){return tn(e,t,0,Hr,Kr,r)}),16384);function nn(e,t,r,n,a,i){var o=$r(r,n,a,t,i);if(void 0!==o){var u=o[0],c=o[1],s=o[2],l=o[3];if(void 0!==e&&0===s&&l===t-1&&n.kind===a.kind)return e;var f=Zr(t,r,u,i),d=Zr(t,r,c,i);if(void 0!==f&&void 0!==d)return[!1,f,d]}}nn.bind(void 0,void 0,1<<20),nn.bind(void 0,[!0,Hr,Kr],16384);function an(e,t,r,n,a,i){var o=Yr(e,t,r.row,n,i),u=zr(e,t,r.col,a,i);if(void 0!==o&&void 0!==u)return t===F.A1?u+o:o+u}function on(e,t,r,n,a,i,o,u){var c=$r(r.row,n,i,1<<20,u),s=$r(r.col,a,o,16384,u);if(void 0!==c&&void 0!==s){var l=c[0],f=c[1],d=c[2],h=c[3],v=s[0],p=s[1],m=s[2],g=s[3];if(0===m&&16383===g&&a.kind===o.kind)return tn(e,t,r.row,l,f,u);if(0===d&&1048575===h&&n.kind===i.kind)return rn(e,t,r.col,v,p,u);var C=an(e,t,r,l,v,u),S=an(e,t,r,f,p,u);if(void 0!==C&&void 0!==S)return C+":"+S}}var un=/'/g;function cn(e,t){if(0===t.length)return!1;if(!e.isIdentStart(t.charCodeAt(0)))return!1;for(var r=1;r<t.length;r+=1)if(!e.isIdentContinue(t.charCodeAt(r)))return!1;return!0}var sn=Zt(0,0);function ln(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=Br(e,t,sn,r,0);if(void 0!==n){var a=n.refStyle,i=n.i;if(a!==F.A1)return!0;if(void 0===e.getWorksheetFuncId(r.substring(0,i)))return!0}return!cn(e,r)&&(!function(e,t){var r=0;if(t.substring(r,r+e.leftBracket.length)!==e.leftBracket)return!1;if((r+=e.leftBracket.length)===t.length||!e.isIdentContinue(t.charCodeAt(r)))return!1;for(r+=1;;){if(t.substring(r,r+e.rightBracket.length)===e.rightBracket){r+=e.rightBracket.length;break}if(r===t.length||!e.isIdentContinue(t.charCodeAt(r)))return!1;r+=1}var n=t.indexOf(":",r);return n<0?cn(e,t.substring(r)):cn(e,t.substring(r,n))&&cn(e,t.substring(n+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&cn(e,t.substring(r,t.length-n))))}(e,r))}function fn(e,t,r){return ln(e,t,r)?"'"+r.replace(un,"''")+"'":r}function dn(e,t,r){var n=1===t.cols&&1===t.rows?an(e,F.A1,Zt(0,0),Y(w.Rel,t.row),Y(w.Rel,t.col),!1):on(e,F.A1,Zt(0,0),Y(w.Rel,t.row),Y(w.Rel,t.col),Y(w.Rel,t.row+t.rows-1),Y(w.Rel,t.col+t.cols-1),!1);return b("calc.lang.formatGridRangeA1",void 0!==n),void 0===r?n:fn(e,F.A1,r)+"!"+n}var hn,vn=r(3),pn={ULS:new f.NulLogger},mn=Object(f.initStopwatchFactory)((function(e){return pn.ULS.traceTag(595948114,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,e)}));function gn(e,t){return Object(j.b)(this,void 0,void 0,(function(){var r;return Object(j.d)(this,(function(n){switch(n.label){case 0:r=mn(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,t()];case 2:return[2,n.sent()];case 3:return r.stop(),[7];case 4:return[2]}}))}))}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcDynamicArrayOperators="CalcDynamicArrayOperators",e.CalcExcelMath="CalcExcelMath",e.CalcClosingParen="CalcClosingParen",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcLetFunction="CalcLetFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcFunFunctions="CalcFunFunctions",e.CalcWebWorkerTest="CalcWebWorkerTest",e["OfficeVSO:3852168_CalcCGIFS"]="OfficeVSO:3852168_CalcCGIFS",e["OfficeVSO:3852168_CalcCGSWITCH"]="OfficeVSO:3852168_CalcCGSWITCH",e["OfficeVSO:3852168_CalcCGAVERAGEIF"]="OfficeVSO:3852168_CalcCGAVERAGEIF",e["OfficeVSO:3852168_CalcCGAVERAGEIFS"]="OfficeVSO:3852168_CalcCGAVERAGEIFS",e["OfficeVSO:3852168_CalcCGCOUNT"]="OfficeVSO:3852168_CalcCGCOUNT",e["OfficeVSO:3852168_CalcCGCOUNTIF"]="OfficeVSO:3852168_CalcCGCOUNTIF",e["OfficeVSO:3852168_CalcCGCOUNTIFS"]="OfficeVSO:3852168_CalcCGCOUNTIFS",e["OfficeVSO:3852168_CalcCGMEDIAN"]="OfficeVSO:3852168_CalcCGMEDIAN",e["OfficeVSO:3852168_CalcCGSUMSQ"]="OfficeVSO:3852168_CalcCGSUMSQ",e["OfficeVSO:3852168_CalcCGSUMIF"]="OfficeVSO:3852168_CalcCGSUMIF",e["OfficeVSO:3852168_CalcCGSUMIFS"]="OfficeVSO:3852168_CalcCGSUMIFS",e["OfficeVSO:3852168_CalcCGROWS"]="OfficeVSO:3852168_CalcCGROWS",e["OfficeVSO:3852168_CalcCGCOLUMNS"]="OfficeVSO:3852168_CalcCGCOLUMNS",e["OfficeVSO:3852168_CalcCGINDEX"]="OfficeVSO:3852168_CalcCGINDEX",e["OfficeVSO:3852168_CalcCGMATCH"]="OfficeVSO:3852168_CalcCGMATCH",e["OfficeVSO:3852168_CalcCGLOOKUP"]="OfficeVSO:3852168_CalcCGLOOKUP",e["OfficeVSO:3852168_CalcCGHLOOKUP"]="OfficeVSO:3852168_CalcCGHLOOKUP",e["OfficeVSO:3852168_CalcCGVLOOKUP"]="OfficeVSO:3852168_CalcCGVLOOKUP",e["OfficeVSO:3852168_CalcCGLARGE"]="OfficeVSO:3852168_CalcCGLARGE",e["OfficeVSO:3852168_CalcCGSMALL"]="OfficeVSO:3852168_CalcCGSMALL",e["OfficeVSO:3852168_CalcCGPERCENTILE"]="OfficeVSO:3852168_CalcCGPERCENTILE",e["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"]="OfficeVSO:3852168_CalcCGPERCENTILE_EXC",e["OfficeVSO:3852168_CalcCGQUARTILE"]="OfficeVSO:3852168_CalcCGQUARTILE",e["OfficeVSO:3852168_CalcCGQUARTILE_EXC"]="OfficeVSO:3852168_CalcCGQUARTILE_EXC",e["OfficeVSO:3852168_CalcCGRANK"]="OfficeVSO:3852168_CalcCGRANK",e["OfficeVSO:3852168_CalcCGRANK_AVG"]="OfficeVSO:3852168_CalcCGRANK_AVG",e["OfficeVSO:3852168_CalcCGTRIMMEAN"]="OfficeVSO:3852168_CalcCGTRIMMEAN",e["OfficeVSO:3852168_CalcCGTRUE"]="OfficeVSO:3852168_CalcCGTRUE",e["OfficeVSO:3852168_CalcCGFALSE"]="OfficeVSO:3852168_CalcCGFALSE",e["OfficeVSO:3852168_CalcCGNOT"]="OfficeVSO:3852168_CalcCGNOT",e["OfficeVSO:3852168_CalcCGNA"]="OfficeVSO:3852168_CalcCGNA",e["OfficeVSO:3852168_CalcCGAVERAGEA"]="OfficeVSO:3852168_CalcCGAVERAGEA",e["OfficeVSO:3852168_CalcCGMAXA"]="OfficeVSO:3852168_CalcCGMAXA",e["OfficeVSO:3852168_CalcCGMINA"]="OfficeVSO:3852168_CalcCGMINA",e["OfficeVSO:3852168_CalcCGMAXIFS"]="OfficeVSO:3852168_CalcCGMAXIFS",e["OfficeVSO:3852168_CalcCGMINIFS"]="OfficeVSO:3852168_CalcCGMINIFS",e["OfficeVSO:3852168_CalcCGXOR"]="OfficeVSO:3852168_CalcCGXOR",e["OfficeVSO:3852168_CalcCGT"]="OfficeVSO:3852168_CalcCGT",e["OfficeVSO:3852168_CalcCGN"]="OfficeVSO:3852168_CalcCGN",e["OfficeVSO:3852168_CalcCGHYPERLINK"]="OfficeVSO:3852168_CalcCGHYPERLINK",e["OfficeVSO:3852168_CalcCGAGGREGATE"]="OfficeVSO:3852168_CalcCGAGGREGATE",e["OfficeVSO:3852168_CalcCGSUBTOTAL"]="OfficeVSO:3852168_CalcCGSUBTOTAL",e["OfficeVSO:3852168_CalcCGVAR"]="OfficeVSO:3852168_CalcCGSVAR",e["OfficeVSO:3852168_CalcCGVARP"]="OfficeVSO:3852168_CalcCGVARP",e["OfficeVSO:3852168_CalcCGSTDEV"]="OfficeVSO:3852168_CalcCGSTDEV",e["OfficeVSO:3852168_CalcCGSTDEVP"]="OfficeVSO:3852168_CalcCGSTDEVP",e["OfficeVSO:3852168_CalcCGVARA"]="OfficeVSO:3852168_CalcCGSVARA",e["OfficeVSO:3852168_CalcCGVARPA"]="OfficeVSO:3852168_CalcCGVARPA",e["OfficeVSO:3852168_CalcCGSTDEVA"]="OfficeVSO:3852168_CalcCGSTDEVA",e["OfficeVSO:3852168_CalcCGSTDEVPA"]="OfficeVSO:3852168_CalcCGSTDEVPA",e["OfficeVSO:3852168_CalcCGAVEDEV"]="OfficeVSO:3852168_CalcCGAVEDEV",e["OfficeVSO:3852168_CalcCGDEVSQ"]="OfficeVSO:3852168_CalcCGDEVSQ",e["OfficeVSO:3852168_CalcCGMODE"]="OfficeVSO:3852168_CalcCGMODE",e["OfficeVSO:3852168_CalcCGMODE_MULT"]="OfficeVSO:3852168_CalcCGMODE_MULT",e["OfficeVSO:3852168_CalcCGTYPE"]="OfficeVSO:3852168_CalcCGTYPE",e["OfficeVSO:3852168_CalcCGERROR_TYPE"]="OfficeVSO:3852168_CalcCGERROR_TYPE",e["OfficeVSO:3852168_CalcCGAREAS"]="OfficeVSO:3852168_CalcCGAREAS",e["OfficeVSO:3852168_CalcCGSHEETS"]="OfficeVSO:3852168_CalcCGSHEETS",e["OfficeVSO:3852168_CalcCGROW"]="OfficeVSO:3852168_CalcCGROW",e["OfficeVSO:3852168_CalcCGCOLUMN"]="OfficeVSO:3852168_CalcCGCOLUMN",e["OfficeVSO:3852168_CalcCGSHEET"]="OfficeVSO:3852168_CalcCGSHEET",e["OfficeVSO:3852168_CalcCGOFFSET"]="OfficeVSO:3852168_CalcCGOFFSET",e["OfficeVSO:3852168_CalcCGEXACT"]="OfficeVSO:3852168_CalcCGEXACT",e["OfficeVSO:3852168_CalcCGREPT"]="OfficeVSO:3852168_CalcCGREPT",e["OfficeVSO:3852168_CalcCGTRIM"]="OfficeVSO:3852168_CalcCGTRIM",e["OfficeVSO:3852168_CalcCGCLEAN"]="OfficeVSO:3852168_CalcCGCLEAN",e["OfficeVSO:3852168_CalcCGCHAR"]="OfficeVSO:3852168_CalcCGCHAR",e["OfficeVSO:3852168_CalcCGUNICHAR"]="OfficeVSO:3852168_CalcCGUNICHAR",e["OfficeVSO:3852168_CalcCGCODE"]="OfficeVSO:3852168_CalcCGCODE",e["OfficeVSO:3852168_CalcCGUNICODE"]="OfficeVSO:3852168_CalcCGUNICODE",e["OfficeVSO:3852168_CalcCGLOWER"]="OfficeVSO:3852168_CalcCGLOWER",e["OfficeVSO:3852168_CalcCGUPPER"]="OfficeVSO:3852168_CalcCGUPPER",e["OfficeVSO:3852168_CalcCGPROPER"]="OfficeVSO:3852168_CalcCGPROPER",e["OfficeVSO:3852168_CalcCGFIND"]="OfficeVSO:3852168_CalcCGFIND",e["OfficeVSO:3852168_CalcCGSEARCH"]="OfficeVSO:3852168_CalcCGSEARCH",e["OfficeVSO:3852168_CalcCGREPLACE"]="OfficeVSO:3852168_CalcCGREPLACE",e["OfficeVSO:3852168_CalcCGSUBSTITUTE"]="OfficeVSO:3852168_CalcCGSUBSTITUTE",e["OfficeVSO:3852168_CalcCGISFORMULA"]="OfficeVSO:3852168_CalcCGISFORMULA",e["OfficeVSO:3852168_CalcCGFORMULATEXT"]="OfficeVSO:3852168_CalcCGFORMULATEXT",e["OfficeVSO:3852168_CalcCGINFO"]="OfficeVSO:3852168_CalcCGINFO",e["OfficeVSO:3852168_CalcCGDELTA"]="OfficeVSO:3852168_CalcCGDELTA",e["OfficeVSO:3852168_CalcCGGESTEP"]="OfficeVSO:3852168_CalcCGGESTEP",e["OfficeVSO:3852168_CalcCGTRANSPOSE"]="OfficeVSO:3852168_CalcCGTRANSPOSE",e["OfficeVSO:3852168_CalcCGADDRESS"]="OfficeVSO:3852168_CalcCGADDRESS",e["OfficeVSO:3852168_CalcCGINDIRECT"]="OfficeVSO:3852168_CalcCGINDIRECT",e["OfficeVSO:3852168_CalcCGTEXTJOIN"]="OfficeVSO:3852168_CalcCGTEXTJOIN",e["OfficeVSO:3852168_CalcCGCHOOSE"]="OfficeVSO:3852168_CalcCGCHOOSE",e["OfficeVSO:3852168_CalcCGSQRTPI"]="OfficeVSO:3852168_CalcCGSQRTPI",e["OfficeVSO:3852168_CalcCGFACTDOUBLE"]="OfficeVSO:3852168_CalcCGFACTDOUBLE",e["OfficeVSO:3852168_CalcCGINT"]="OfficeVSO:3852168_CalcCGINT",e["OfficeVSO:3852168_CalcCGTRUNC"]="OfficeVSO:3852168_CalcCGTRUNC",e["OfficeVSO:3852168_CalcCGODD"]="OfficeVSO:3852168_CalcCGODD",e["OfficeVSO:3852168_CalcCGMROUND"]="OfficeVSO:3852168_CalcCGMROUND",e["OfficeVSO:3852168_CalcCGQUOTIENT"]="OfficeVSO:3852168_CalcCGQUOTIENT",e["OfficeVSO:3852168_CalcCGFLOOR.MATH"]="OfficeVSO:3852168_CalcCGFLOOR.MATH",e["OfficeVSO:3852168_CalcCGFLOOR.PRECISE"]="OfficeVSO:3852168_CalcCGFLOOR.PRECISE",e["OfficeVSO:3852168_CalcCGCEILING.MATH"]="OfficeVSO:3852168_CalcCGCEILING.MATH",e["OfficeVSO:3852168_CalcCGCEILING.PRECISE"]="OfficeVSO:3852168_CalcCGCEILING.PRECISE"}(hn||(hn={}));var Cn,Sn=function(e){return!1},En={};function yn(e){return void 0===En[e]&&(En[e]=Sn(e)),En[e]}function On(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],a=e[r+1],i=n;i<a;i+=1)t(i,n,a)}!function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(Cn||(Cn={}));var An=function(e,t,r){var n;function a(e){n[e]|=Cn.IdentStartClass}function i(e){n[e]|=Cn.IdentContinueClass}function o(e,t){n[e]|=Cn.DigitClass,n[e]|=e-t}return function(u){if(void 0===n){var c=pr(e[e.length-1],pr(t[t.length-1],r[r.length-1]));n=new Uint8Array(c),On(e,a),On(t,i),On(r,o);for(var s=4969;s<4978;s+=1)o(s,4968)}var l=n[u];return void 0!==l?l:0}}([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2238,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3333,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12731,12784,12800,13312,19894,19968,40944,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42951,42999,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43880,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[46,47,48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2238,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3332,3333,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6847,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11160,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12731,12736,12772,12784,12831,12832,19894,19904,40944,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42951,42999,43052,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43880,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]);function kn(e,t){return{key:e,value:t}}var bn=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([e,t])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return kn(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.keys.map((function(t,r){return[t,e.values[r],r]})),a=n.length;t.forEach((function(e,t){var r=e[0],i=e[1];return n.push([r,i,t+a])})),n.sort((function(t,r){var n=t[0],a=t[2],i=r[0],o=r[2],u=e.keyCompare(n,i);return 0!==u?u:a-o}));for(var i=[],o=void 0,u=0;u<n.length;u+=1){var c=n[u],s=c[0],l=c[1];void 0===o||0!==this.keyCompare(s,o)?(i.push([s,l]),o=s):i[i.length-1]=[s,l]}return this.ofSequence(i)},e.prototype.getKeyIndex=function(e){for(var t=Rn;t>=0&&t<this.keys.length;){var r=this.keyCompare(e,this.keys[t]);if(0===r)return t;r<0?t=In(t):r>0&&(t=Tn(t))}},e.prototype.ofSequence=function(t){var r=this,n=t.slice();n.sort((function(e,t){var n=e[0],a=t[0];return r.keyCompare(n,a)}));for(var a=new Array(n.length),i=new Array(n.length),o=function(e){var t=new Array(e);return function e(t,r,n,a){if(t>=r.length)return;var i=function(e){var t=function(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}(e);if(t/2-1<=e-t)return t-1;return e-t/2}(a);r[t]=n+i,e(In(t),r,n,i),e(Tn(t),r,n+i+1,a-i-1)}(Rn,t,0,e),t}(n.length),u=0;u<n.length;u+=1){var c=n[o[u]],s=c[0],l=c[1];a[u]=s,i[u]=l}return new e(this.keyCompare,a,i)},e}(),Rn=0;function In(e){return 2*e+1}function Tn(e){return 2*e+2}function Nn(e){return isFinite(e)?e:ke}function Fn(e,t){return e<t?-1:e>t?1:0}var _n=["0","1","2","3","4","5","6","7","8","9"];var Mn={zero:0,one:1,pi:Math.PI,add:function(e,t){return Nn(e+t)},sub:function(e,t){return Nn(e-t)},mul:function(e,t){return Nn(e*t)},div:function(e,t){return 0===t?Ee:Nn(e/t)},power:function(e,t){var r=Math.pow(e,t);return isFinite(r)?r:isNaN(r)?Ee:ke},percent:function(e){return e/100},neg:function(e){return-e},compare:Fn,formatGeneral:function(e,t,r){var n=e.decimalSeparator,a=String(t).replace("e","E");return"."!==n&&(a=a.replace(".",n)),a},parse:function(e,t,r,n){return Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",a=0;a<t.length;a+=1)n+=_n[r(t.charCodeAt(a))];return n}(e,n)+"E"+r)},trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)},ceil:Math.ceil.bind(Math),floor:Math.floor.bind(Math),abs:Math.abs.bind(Math),cond:function(e){return Fn(e,0)},cond2:Fn,fromNumber:sr,toNumber:sr,sqrt:function(e){return Nn(Math.sqrt(e))},exp:function(e){return Nn(Math.exp(e))},ln:function(e){return Nn(Math.log(e))},log:function(e){return Nn(Math.log(e)/Math.LN10)},sin:Math.sin.bind(Math),cos:Math.cos.bind(Math),tan:Math.tan.bind(Math),asin:function(e){return Nn(Math.asin(e))},acos:function(e){return Nn(Math.acos(e))},atan:function(e){return Nn(Math.atan(e))},atan2:function(e,t){return Math.atan2(t,e)},round:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.substring(r.indexOf("e")+1),a=parseInt(n,10),i=Mn.trunc(t)+a+1;if(0===i){var o=parseFloat("5e"+n);if(Math.abs(e)>=o)return Nn((e<0?-1:1)*parseFloat("10e"+n))}return i<1?0:i>21?e:Nn(parseFloat(e.toExponential(i-1)))},roundUp:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Mn.trunc(t)+u+1;return c<1?Nn(parseFloat(a+"10e"+(u-c))):c>21?e:Nn(parseFloat(a+function(e,t){var r=e.replace(".","");if(r.length<=t)return e;for(var n=r.substring(0,t),a=0,i=n.length-1;i>=0&&n.charCodeAt(i)-48==9;i-=1)a+=1;if(a===n.length)return"10";var o=n.substring(0,n.length-a-1)+String.fromCharCode(n.charCodeAt(n.length-a-1)+1);return o.substring(0,1)+"."+o.substring(1)}(i,c)+"e"+o))},roundDown:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Mn.trunc(t)+u+1;if(c<1)return 0;if(c>21)return e;var s=i.substring(0,c+1);return Nn(parseFloat(a+s+"e"+o))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=Math.abs(e);return t>=4294967296?4294967295:Math.floor(t)},lfix:function(e){var t=Mn.trunc(e);return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=Mn.floor(e);return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:sr},wn=r(2),Ln=wn.mathpack.zero(),Dn=wn.mathpack.one(),Un=wn.mathpack.pi();function xn(e){return 0!=(e.num&wn.mathpack.MathErrorNum.DivBy0)?Ee:ke}function Pn(e){return function(t){return k("calc.runtime."+e+": error "+JSON.stringify(t))}}function Gn(e,t){return function(r){var n=e(r);return"number"==typeof n?n:t(n)}}function Vn(e,t){return function(r,n){var a=e(r,n);return"number"==typeof a?a:t(a)}}var Bn=Vn((function(e,t){return wn.mathpack.equal(t,2)?wn.mathpack.mul(e,e):wn.mathpack.power(e,t)}),xn),Wn=Gn((function(e){return wn.mathpack.div(e,100)}),Pn("xlPercent"));var jn=Gn(wn.mathpack.ceil,Pn("xlCeil")),Hn=Gn(wn.mathpack.floor,Pn("xlFloor")),Kn=Gn(wn.mathpack.cond,Pn("xlCond")),qn=Vn(wn.mathpack.cond2,Pn("xlCond2"));var Jn=Gn(wn.mathpack.sfix,Pn("xlSfix")),Qn=Gn(wn.mathpack.viewRound,Pn("xlViewRound"));var Xn={zero:Ln,one:Dn,pi:Un,add:Vn(wn.mathpack.add,xn),sub:Vn(wn.mathpack.sub,xn),mul:Vn(wn.mathpack.mul,xn),div:Vn(wn.mathpack.div,xn),power:Bn,percent:Wn,neg:function(e){return 0!==Kn(e)?wn.mathpack.neg(e):e},compare:wn.mathpack.compare,formatGeneral:function(e,t,r){var n=wn.mathpack.formatGeneral(e,t,r);return"string"!=typeof n?k("calc.runtime.xlFormatGeneral: error "+JSON.stringify(n)):n},parse:function(e,t,r,n){var a=wn.mathpack.pack(e,t,r,n);return"number"!=typeof a?k("calc.runtime.xlParse: error "+JSON.stringify(a)):a},trunc:wn.mathpack.trunc,ceil:jn,floor:Hn,abs:wn.mathpack.abs,cond:Kn,cond2:qn,fromNumber:function(e){return b("calc.runtime.xlFromNumber",isFinite(e)),e},toNumber:function(e){return b("calc.runtime.xlToNumber",isFinite(e)),e},sqrt:Gn(wn.mathpack.sqrt,xn),exp:Gn(wn.mathpack.exp,xn),ln:Gn(wn.mathpack.ln,xn),log:Gn(wn.mathpack.log,xn),sin:Gn(wn.mathpack.sin,xn),cos:Gn(wn.mathpack.cos,xn),tan:Gn(wn.mathpack.tan,xn),asin:Gn(wn.mathpack.asin,xn),acos:Gn(wn.mathpack.acos,xn),atan:Gn(wn.mathpack.atan,xn),atan2:Vn(wn.mathpack.atan2,xn),round:Vn(wn.mathpack.round,xn),roundUp:Vn(wn.mathpack.roundUp,xn),roundDown:Vn(wn.mathpack.roundDown,xn),checkAlmostCancellation:function(e,t){return wn.mathpack.exp32(e)-wn.mathpack.exp32(t)>=52428800?Ln:t},fix:wn.mathpack.fix,lfix:wn.mathpack.lfix,sfix:Jn,viewRound:Qn},Yn=Math.pow(2,-52),zn=Math.pow(2,-1022);function Zn(e){return Math.abs(e)<zn?0:e}function $n(e){return isFinite(e)?Zn(e):ke}var ea=Math.pow(2,32)-2;function ta(e,t){var r=Math.pow(e,t);return isFinite(r)?Zn(r):t<0?Ee:ke}var ra=Mn.fix,na=Mn.lfix;var aa,ia={zero:0,one:1,pi:Math.PI,add:function(e,t){var r=e+t;return isFinite(r)?Zn(r):ke},sub:function(e,t){var r=e-t;return isFinite(r)?Zn(r):ke},mul:function(e,t){return $n(e*t)},div:function(e,t){return 0===Zn(t)?Ee:$n(e/t)},power:function(e,t){return 0===t?0===e?ke:1:0===e?t<0?Ee:0:e>0?ta(e,t):function(e){if(e<-ea||e>ea)return!1;if(e===Math.floor(e))return!0;var t=Math.abs(e);return 1+-22.5*Yn<=t&&t<=1+2*Yn}(t)?ta(e,Math.round(t)):ke},percent:function(e){return Zn(e/100)},neg:Mn.neg,compare:Mn.compare,formatGeneral:Mn.formatGeneral,parse:Mn.parse,trunc:Mn.trunc,ceil:Mn.ceil,floor:Mn.floor,abs:Mn.abs,cond:Mn.cond,cond2:Mn.cond2,fromNumber:sr,toNumber:sr,sqrt:function(e){return $n(Math.sqrt(e))},exp:function(e){return $n(Math.exp(e))},ln:function(e){return $n(Math.log(e))},log:function(e){return $n(Math.log(e)/Math.LN10)},sin:function(e){return Math.abs(e)<Math.pow(2,27)?$n(Math.sin(e)):ke},cos:function(e){return Math.abs(e)<Math.pow(2,27)?$n(Math.cos(e)):ke},tan:function(e){return Math.abs(e)<Math.pow(2,27)?$n(Math.tan(e)):ke},asin:function(e){return $n(Math.asin(e))},acos:function(e){return $n(Math.acos(e))},atan:function(e){return $n(Math.atan(e))},atan2:function(e,t){return 0===e&&0===t?Ee:Zn(Math.atan2(t,e))},round:function(e,t){if(0===e)return 0;var r=e.toExponential(),n=r.indexOf("e"),a="-"===r.substring(0,1)?"-":"",i=r.substring(a.length,n),o=r.substring(n+1),u=parseInt(o,10),c=Mn.trunc(t)+u+1;return 0===c&&i.charCodeAt(0)-48>=5?$n(parseFloat(a+"10e"+o)):c<1?0:c>21?e:$n(parseFloat(a+function(e,t){var r=e.replace(".","");if(r.length<=t)return e;if(r.charCodeAt(t)-48>=5){for(var n=r.substring(0,t),a=0,i=n.length-1;i>=0&&n.charCodeAt(i)-48==9;i-=1)a+=1;if(a===n.length)return"10";var o=n.substring(0,n.length-a-1)+String.fromCharCode(n.charCodeAt(n.length-a-1)+1);return o.substring(0,1)+"."+o.substring(1)}return e.substring(0,t+1)}(i,c)+"e"+o))},roundUp:Mn.roundUp,roundDown:Mn.roundDown,checkAlmostCancellation:function(e,t){return t},fix:ra,lfix:na,sfix:function(e){var t=e+1048576+2146435072;return t<0?-2147483648:ra(t)-2147483648},viewRound:sr};function oa(){return yn(hn.CalcExcelMath)?Xn:ia}function ua(e,t,r){return void 0===t&&(t=F.A1),void 0===r&&(r=oa()),{localeInfo:e,refStyle:t,mathpack:r}}var ca=!1,sa=void 0,la=/^(https)|(http)|(file):\/\//;function fa(e,t,r){if(ca){O.ULS.traceTag(595910878,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{var n;if(function(e){O.ULS=e}(e),function(e){pn.ULS=e}(e),"function"==typeof(n=t)&&(Sn=n),null!=r){if(!la.test(r)){var a="calc.config.initCalc: calcAbsUrl is not absolute: "+r;O.ULS.traceTag(595910879,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a)}vn.setConfig({onWorkerError:function(e){var t,r=Object(j.a)(Object(j.a)({},e.info),{error:void 0}),n={error:e.message,info:r,innerError:null===(t=e.info.error)||void 0===t?void 0:t.message},a="calc.onWorkerError: "+JSON.stringify(n);O.ULS.traceTag(593335298,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a)},onCreateWorker:function(e){var t="calc.onCreateWorker: "+JSON.stringify(e);O.ULS.traceTag(593335299,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,t)}})}sa=r,ca=!0;O.ULS.traceTag(594642132,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.config.initCalc: Calc version 13.1.1 (production) initialized")}}function da(){return ca}function ha(){return sa}function va(e,t,r,n,a,i,o,u,c,s,l,f,d,h,v,p,m,g,C,S,E,y){function O(e){return 92===e||95===e||u(String.fromCharCode(e))}return pa(e,r,n,(function(e){return a(String.fromCharCode(e))}),(function(e){return i(String.fromCharCode(e))}),O,(function(e){return O(e)||46===e||63===e||a(String.fromCharCode(e))}),c,s,l,f,d,h,v,p,m,g,C,S,E,y)}function pa(e,t,r,n,a,i,o,u,c,s,l,f,d,h,v,p,m,g,C,S,E){return{parseNumber:e,getWorksheetFuncId:function(e){return t(e.toLocaleUpperCase())},getWorksheetFuncName:r,isNumeral:n,getOrdinal:a,isIdentStart:i,isIdentContinue:o,stringCompareCI:u,errorNames:c,trueName:s,falseName:l,rowLetter:f,columnLetter:d,leftBrace:h,rightBrace:v,leftBracket:p,rightBracket:m,decimalSeparator:g,listSeparator:C,columnSeparator:S,rowSeparator:E}}function ma(e){return function(t){for(var r=0;r<t.length&&Sr(t.charCodeAt(r));)r+=1;var n=!1;if(r<t.length){var a=t.charCodeAt(r);if(43===a||45===a)for(n=45===a,r+=1;r<t.length&&Sr(t.charCodeAt(r));)r+=1}var i=Ar(this,e,t,r);if(void 0!==i&&void 0!==i.value){for(r=i.i;r<t.length&&Sr(t.charCodeAt(r));)r+=1;if(r===t.length)return n?e.neg(i.value):i.value}}}function ga(e){return 0!=(An(e)&Cn.DigitClass)}function Ca(e){var t=An(e);return 0==(t&Cn.DigitClass)?k("calc.config.getOrdinal: expected numeral; given "+C(e)):t&Cn.Ordinal}function Sa(e){return 0!=(An(e)&Cn.IdentStartClass)}function Ea(e){return 0!=(An(e)&Cn.IdentContinueClass)}var ya=v(((aa={})[pe.NULL]="#NULL!",aa[pe.DIV0]="#DIV/0!",aa[pe.VALUE]="#VALUE!",aa[pe.REF]="#REF!",aa[pe.NAME]="#NAME?",aa[pe.NUM]="#NUM!",aa[pe.NA]="#N/A",aa[pe.GETTING_DATA]="#GETTING_DATA",aa[pe.FIELD]="#FIELD",aa)),Oa=void 0;function Aa(e){var t=Ra()[e];return void 0===t?"wsf:"+e:t}function ka(e){if(e===Ue.Isect)return" ";if(e===Ue.Union)return",";var t=je[e];return void 0===t?"op:"+e:t}var ba=/_/g;function Ra(){if(null==Oa)for(var e in Oa=[],we){var t=Number(e);if(!isNaN(t)){var r=xe[t],n=null!=r?r:we[e].replace(ba,".");Oa[t]=n}}return Oa}function Ia(e,t){var r=function(e,t){var r,n=[];return t.forEach((function(e,t){null!=e&&n.push([e,t])})),(r=bn.create(e)).setValues.apply(r,n)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?k("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}var Ta,Na=void 0;function Fa(){var e,t,r,n,a;return null==Na&&(e=Ra(),t=gr("en-US"),r=Ia(t,e),n=r.getWorksheetFuncId,a=r.getWorksheetFuncName,Na=pa(ma(oa()),n,a,ga,Ca,Sa,Ea,t,ya,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")),Na}function _a(e){return{kind:Ta.NoOriginSheet,origin:e}}function Ma(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case Mt.NotImplemented:case Mt.Unavailable:case Ta.NoOriginSheet:return!0}return!1}function wa(e,t,r){return function(n,a){return void 0===a?t(n):Ma(a)?r(a,n):e(a)}}function La(e,t,r){var n=Qr(e.row,t.row,1<<20,r),a=Qr(e.col,t.col,16384,r);return void 0!==n&&void 0!==a?Zt(n,a):void 0}function Da(e,t){if(t.kind!==M.Error){var r=e.originGridCell;if(!ot(r))return r.reason;var n=r.value,a=e.wrapCellReferences;switch(t.kind){case M.Single:return La(n,t,a);case M.Range:var i=La(n,t.ref1,a),o=La(n,t.ref2,a);return void 0!==i&&void 0!==o?Et(i,o):void 0;case M.Row:var u=Qr(n.row,t.row1,1<<20,a),c=Qr(n.row,t.row2,1<<20,a);return void 0!==u&&void 0!==c?Et(Zt(u,0),Zt(c,16383)):void 0;case M.Col:var s=Qr(n.col,t.col1,16384,a),l=Qr(n.col,t.col2,16384,a);return void 0!==s&&void 0!==l?Et(Zt(0,s),Zt(1048575,l)):void 0;default:return A("calc.runtime.resolverService.resolveGridRef",t)}}}function Ua(e){function t(t,r){var n;if(void 0===r){var a=t.originSheet;return ot(a)?[r,a.value.document]:[r,a.reason]}var i=e.getDocumentLoc(r.path,r.document);if(!ot(i))return[r,i.reason];var o=null==r.path?void 0:fr(i.value)?r.path:i.value.path;return[q(fr(i.value)?r.document:i.value.name,o,r.isQuoted,r.label),(n=i.value,null!=n?n:void 0)]}function r(t,r){if(Ma(r))return[t,r];var n=e.getSheetIndex(r,t);if(!ot(n))return[t,n.reason];if(null==n.value)return[t,void 0];var a=e.getSheetName(r,n.value);return ot(a)?[a.value,Jt(r,n.value)]:[t,a.reason]}function n(e,n){var a=t(e,n.document),i=a[0],o=a[1],u=r(n.sheet,o),c=u[0],s=u[1];return[J(c,i,n.isQuoted,n.label),s]}function a(a,i){switch(i.kind){case _.Error:return[i,void 0];case _.Sheet:return n(a,i);case _.SheetRange:return function(n,a){var i,o=t(n,a.document),u=o[0],c=o[1],s=r(a.sheet1,c),l=s[0],f=s[1],d=r(a.sheet2,c),h=d[0],v=d[1],p=l,m=h;if(Ma(c))i=c;else if(Ma(f))i=f;else if(Ma(v))i=v;else{if(pt(f,v))return[J(p,u,a.isQuoted,a.label),Jt(c,f.index)];var g=e.getSheetRangeIndexes(f),C=e.getSheetRangeIndexes(v);ot(g)?ot(C)?C.value.position<g.value.position&&(p=h,m=l):i=C.reason:i=g.reason,i=qt(c,f.index,v.index)}return[X(p,m,u,a.isQuoted,a.label),i]}(a,i);default:return A("calc.runtime.resolverService.resolveCellRefQualifier",i)}}return{resolveName:function(r,a){var i,o,u,c=a.qualifier,s=a.whole;if(void 0===c||c.kind===_.Relative){var l=r.originSheet;if(!ot(l))return[a,l.reason];var f=l.value;if(void 0===f.index)return[a,_a(f)];var d=e.getNameLoc(f,s);if(!ot(d))return[a,d.reason];if(!fr(d.value))return[fe(d.value.name,c,a.label),d.value];o=c,u=ar(f.document)}else o=(i=function(e,r){switch(r.kind){case _.Document:var a=t(e,r);return[s=a[0],Ma(l=a[1])?l:ar(l)];case _.Sheet:return n(e,r);case _.Ident:var i=n(e,J(r.name,void 0)),o=i[0],u=i[1];if(void 0!==u)return Ma(u)?[r,u]:[Q(o.sheet,r.isQuoted,r.label),u];var c=t(e,q(r.name)),s=c[0],l=c[1];return[Q(s.document,r.isQuoted,r.label),Ma(l)?l:ar(l)];default:return A("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,c))[0],u=i[1];var h,v=s;if(Ma(u))h=u;else{var p=e.getNameLoc(u,s);ot(p)?fr(p.value)||(v=p.value.name,h=p.value):h=p.reason}return[fe(v,o,a.label),h]},resolveGridRef:Da,resolveCellRef:function(e,t){var r,n,i,o,u=t.qualifier,c=t.ref,s=Da(e,c);if(void 0===u||u.kind===_.Relative){n=u;var l=e.originSheet;if(ot(l)){var f=l.value;i=void 0===f.index?_a(f):f}else i=l.reason}else n=(r=a(e,u))[0],i=r[1];return o=Ma(s)?s:Ma(i)?i:er(i,s),[de(c,n,t.label),o]},resolveUserDefinedFunc:function(r,n){var a,i,o,u,c,s,l=n.qualifier,f=n.whole,d=null!=(o=null===(i=r.config)||void 0===i?void 0:i.localeInfo)?o:e.config.localeInfo;if(void 0===l){var h=r.originSheet;if(!ot(h))return[n,h.reason];u=l,c=h.value.document}else u=(a=function(e,r){switch(r.kind){case _.Document:return t(e,r);case _.Ident:var n=t(e,q(r.name)),a=n[0],i=n[1];return[Q(a.document,r.isQuoted,r.label),i];default:return A("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,l))[0],c=a[1];if(Ma(c))s=c;else{var v=function(e,t,r,n){var a=n;return a.length>"_xludf.".length&&0===t.stringCompareCI(a.substr(0,"_xludf.".length),"_xludf.")&&(a=a.substr("_xludf.".length)),e.getUserDefinedFuncLoc(r,a)}(e,d,c,f);ot(v)?0!==v.value.length&&(s=v.value):s=v.reason}return[fe(f,u,n.label),s]}}}!function(e){e.NoOriginSheet="NoOriginSheet"}(Ta||(Ta={}));function xa(e,t,r){return void 0===r&&(r=100),t.maxDepth=r,t.level=0,Pa(e,t)}function Pa(e,t){if(t.level===t.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+t.level;var r;switch(t.level+=1,e.kind){case D.Literal:r=function(e,t){if("boolean"==typeof e)return t.visitBoolean(e);if("number"==typeof e)return t.visitNumber(e);if("string"==typeof e)return t.visitString(e);if(e.kind===x.Missing)return t.visitMissing(e);if(e.kind===x.Error)return t.visitError(e);throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,t.operVisitor);break;case D.Array:r=t.visitArray(e);break;case D.App:r=t.visitApp(e);break;case D.Paren:r=t.visitParen(e);break;case D.Name:r=t.visitName(e);break;case D.CellRef:r=t.visitCellRef(e);break;case D.Bad:r=t.visitBad(e);break;case D.Operator:r=t.visitOperator(e);break;case M.Error:r=t.visitRefError(e);break;case M.Single:r=t.visitSingle(e);break;case M.Range:r=t.visitRange(e);break;case M.Row:r=t.visitRow(e);break;case M.Col:r=t.visitCol(e);break;case _.Error:r=t.visitNameError(e);break;case _.Relative:r=t.visitRelative(e);break;case _.Document:r=t.visitDocument(e);break;case _.Sheet:r=t.visitSheet(e);break;case _.Ident:r=t.visitIdent(e);break;case _.SheetRange:r=t.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return t.level-=1,r}function Ga(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitError:e}}function Va(e,t,r){return{level:0,operVisitor:e,visitArray:dr(r.vArray,t),visitApp:dr(r.vApp,t),visitParen:dr(r.vParen,t),visitName:dr(r.vName,t),visitCellRef:dr(r.vCellRef,t),visitBad:dr(r.vBad,t),visitOperator:dr(r.vOperator,t),visitRefError:dr(r.vRefError,t),visitSingle:dr(r.vSingle,t),visitRange:dr(r.vRange,t),visitRow:dr(r.vRow,t),visitCol:dr(r.vCol,t),visitNameError:dr(r.vNameError,t),visitRelative:dr(r.vRelative,t),visitDocument:dr(r.vDocument,t),visitSheet:dr(r.vSheet,t),visitIdent:dr(r.vIdent,t),visitSheetRange:dr(r.vSheetRange,t)}}var Ba,Wa=/"/g,ja=/'/g,Ha=rr(Jt(Kt(void 0,"Book1"),0),Zt(0,0)),Ka=wa((function(){}),(function(){}),(function(e){if(e.kind!==Ta.NoOriginSheet)throw new Ja(it(e))})),qa=function(){function e(e,t,r,n,a){var i,o,u,c,s,l;this.spans=r,this.annotations=n,this.anonymize=a,this.level=0,this.operVisitor=this,this.locals=t,this.localeInfo=null!=(u=null===(o=null===(i=t)||void 0===i?void 0:i.config)||void 0===o?void 0:o.localeInfo)?u:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!=(l=null===(s=null===(c=t)||void 0===c?void 0:c.config)||void 0===s?void 0:s.refStyle)?l:e.config.refStyle,this.resolver=Ua(e)}return e.prototype.anon=function(e){return this.anonymize?gi(e):e},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.pre)?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!=(n=null===(r=this.spans[e.label])||void 0===r?void 0:r.post)?n:t},e.prototype.visitString=function(e){return'"'+this.anon(e).replace(Wa,'""')+'"'},e.prototype.visitBoolean=function(e){return e?this.localeInfo.trueName:this.localeInfo.falseName},e.prototype.visitNumber=function(e){return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21))},e.prototype.visitMissing=function(e){return""},e.prototype.visitError=function(e){var t=this.localeInfo.errorNames[e.type];if(void 0===t)throw"No locale data for error oper";return t},e.prototype.visitArray=function(e){var t=this,r=[];return e.nodes.forEach((function(e){var n=[];e.forEach((function(e){n.push(Pa(e,t))})),r.push(n.join(t.localeInfo.columnSeparator))})),this.localeInfo.leftBrace+r.join(this.localeInfo.rowSeparator)+(e.isClosed?this.localeInfo.rightBrace:"")},e.prototype.visitApp=function(e){var t=this;if(bt(e.head)){var r=Pa(e.head,this);if(1===e.args.length){var n=Pa(e.args[0],this);switch(e.head.id){case Ue.Percent:return n+this.pre(e.head,"")+r;case Ue.Pound:return n+r;default:return r+this.post(e.head,"")+n}}if(2===e.args.length){var a=Pa(e.args[0],this),i=Pa(e.args[1],this);return a+this.pre(e.head," ")+r+this.post(e.head,e.head.id===Ue.Isect?"":" ")+i}throw"Tried to pretty print operator with 0 or more than 2 operators"}var o=e.args.map((function(e,r){return t.pre(e,0===r||function(e){return e.kind===D.Literal&&"object"==typeof e.oper&&e.oper.kind===x.Missing}(e)?"":" ")+Pa(e,t)}));return this.visitAppFormulaHead(e.head)+"("+o.join(this.localeInfo.listSeparator)+(0===e.args.length?"":this.post(e.args[e.args.length-1],""))+(e.isClosed?")":"")},e.prototype.visitParen=function(e){return"("+this.pre(e.node,"")+Pa(e.node,this)+this.post(e.node,"")+(e.isClosed?")":"")},e.prototype.visitName=function(e){return this.visitNameImpl(e,!1)},e.prototype.visitCellRef=function(e){var t="",r=this.resolver.resolveCellRef(this.locals,e),n=r[0],a=r[1];return Ka(void 0,a),void 0!==n.qualifier&&(t=Pa(n.qualifier,this)+"!"),t+Pa(e.ref,this)},e.prototype.visitBad=function(e){var t=this;if(e.type===U.Sequence){var r=[];return e.contents.forEach((function(e){r.push(t.pre(e,"")+Pa(e,t)+t.post(e,""))})),r.join("")}return this.pre(e,"")+this.anon(e.contents)+this.post(e,"")},e.prototype.visitOperator=function(e){switch(e.id){case Ue.Isect:return"";case Ue.Union:return this.localeInfo.listSeparator;default:var t=je[e.id];if(void 0===t)throw"Invalid operator";return t}},e.prototype.visitRefError=function(){var e=this.localeInfo.errorNames[pe.REF];if(void 0===e)throw"No locale data for #REF";return e},e.prototype.visitSingle=function(e){var t=an(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRange=function(e){var t=on(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.ref1.row,e.ref1.col,e.ref2.row,e.ref2.col,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitRow=function(e){var t=tn(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e.row1,e.row2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitCol=function(e){var t=rn(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e.col1,e.col2,this.locals.wrapCellReferences);return void 0!==t?this.anon(t):this.visitRefError()},e.prototype.visitNameError=function(e){var t=this.localeInfo.errorNames[pe.REF];if(void 0===t)throw"No locale data for #REF";return t.replace("!","")},e.prototype.visitRelative=function(e){return""},e.prototype.visitDocument=function(e){return fn(this.localeInfo,this.refStyle,this.anon(void 0!==e.path?e.path+"/"+e.document:e.document))},e.prototype.visitSheet=function(e){return fn(this.localeInfo,this.refStyle,this.anon(this.visitSheetDocument(e.document)+e.sheet))},e.prototype.visitIdent=function(e){return fn(this.localeInfo,this.refStyle,this.anon(e.name))},e.prototype.visitSheetRange=function(e){var t=this.anon(this.visitSheetDocument(e.document)+e.sheet1),r=this.anon(e.sheet2),n=t+":"+r;return ln(this.localeInfo,this.refStyle,t)||ln(this.localeInfo,this.refStyle,r)?"'"+n.replace(ja,"''")+"'":n},e.prototype.visitAppFormulaHead=function(e){var t,r,n=null===(t=this.annotations)||void 0===t?void 0:t[e.label];return(null===(r=n)||void 0===r?void 0:r.kind)===L.WorksheetFuncName?this.localeInfo.getWorksheetFuncName(n.id):e.kind===D.Name?this.visitNameImpl(e,!0):Pa(e,this)},e.prototype.visitNameImpl=function(e,t){var r,n=e;if(void 0!==this.annotations){var a=this.annotations[e.label];if(void 0===e.qualifier&&(null===(r=a)||void 0===r?void 0:r.kind)===L.LocalName)return this.anon(a.name);var i=this.resolver.resolveName(this.locals,e),o=i[0],u=i[1];if(Ka(void 0,u),n=o,void 0===u&&t&&(void 0===e.qualifier||e.qualifier.kind===_.Document||e.qualifier.kind===_.Ident)){e.qualifier;var c=this.resolver.resolveUserDefinedFunc(this.locals,e),s=c[0],l=c[1];Ka(void 0,l),n=s}}var f="";return void 0!==n.qualifier&&(f=Pa(n.qualifier,this)+"!"),f+this.anon(n.whole)},e.prototype.visitSheetDocument=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e}(),Ja=function(e){this.failure=e},Qa=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return at(Kt(e,t))},e.prototype.getSheetIndex=function(e,t){return at(t)},e.prototype.getSheetName=function(e,t){return at(t)},e.prototype.getNameLoc=function(e,t){return at(or(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return at([ur(e,t)])},e.prototype.getSheetRangeIndexes=function(e){return at(Xt([e.index],0))},e}();function Xa(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:at(t.range),originSheet:at(t.sheet),wrapCellReferences:!1}}function Ya(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:at(t.range),originSheet:at(t.sheet),wrapCellReferences:!0}}function za(e,t,r,n){void 0===n&&(n=!1);try{var a=new qa(e,t,r.spans,r.annotations,n);return at("="+a.pre(r.node,"")+xa(r.node,a))}catch(e){if(O.ULS.traceTag(595964180,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.lang.printFormula: Format failed: "+("string"==typeof e?e:p(e))),"string"==typeof e)return it(Dt("calc.lang.printFormula: "+e));if(e instanceof Ja)return e.failure;throw e}}function Za(){var e;return void 0===Ba&&(e=ua(Fa(),F.A1),Ba=new Qa(e)),Ba}function $a(e,t){try{var r=t.kind===Vt.Cell||t.kind===Vt.Range?Xa(t,St(t.range)):t.kind===Vt.NameManager?Ya(t,Ha):A("calc.lang.anonymizeFormula",t),n=za(Za(),r,e,!0);if(n.kind===Be.Success)return n.value}catch(e){}return C(e)}var ei,ti,ri,ni,ai,ii,oi,ui,ci,si,li,fi,di,hi,vi=new RegExp("[^=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\\sd]","g"),pi=/[0-9]/g,mi=/d/g;function gi(e){return e.toLowerCase().replace(mi,"w").replace(pi,"d").replace(vi,"w")}(ti=ei||(ei={})).LexicalKind=Vt,ti.sheetRows=1<<20,ti.sheetCols=16384,ti.lexicalSourceCell=Bt,ti.lexicalSourceRange=Wt,ti.lexicalSourceName=Ht,ti.documentLoc=Kt,ti.sheetIndex=Jt,ti.sheetRange=qt,ti.gridCell=Zt,ti.gridRange=zt,ti.allSheetsRange=Qt,ti.sheetRangeIndexes=Xt,ti.sheetGridCell=rr,ti.sheetGridRange=tr,ti.sheetGridCube=er,ti.originCell=nr,ti.documentScope=ar,ti.nameLoc=or,ti.nameScope=ir,ti.userDefinedFuncLoc=ur,(ni=ri||(ri={})).SpecialPrecs=G,ni.PrecsBound=W,ni.OperKind=x,ni.ErrorType=pe,ni.ErrorTypeBounds=me,ni.precedents=ge,ni.errorOper=Ce,ni.nullErrorOper=Se,ni.div0ErrorOper=Ee,ni.valueErrorOper=ye,ni.refErrorOper=Oe,ni.nameErrorOper=Ae,ni.numErrorOper=ke,ni.naErrorOper=be,ni.gettingDataErrorOper=Re,ni.fieldErrorOper=Ie,ni.arrayOper=Fe,ni.rangeSeqOper=_e,ni.range3DOper=Me,ni.missingOper=Le,ni.blankOper=De,(ii=ai||(ai={})).RefStyle=F,ii.QualifierKind=_,ii.CellRefKind=M,ii.PosKind=w,ii.NodeKind=D,ii.BadType=U,ii.errorQualifier=H,ii.relativeQualifier=K,ii.documentQualifier=q,ii.sheetQualifier=J,ii.identQualifier=Q,ii.sheetRangeQualifier=X,ii.pos=Y,ii.cellRefError=z,ii.cellRefSingle=Z,ii.cellRefRange=$,ii.cellRefRow=ee,ii.cellRefCol=te,ii.formula=re,ii.formulaSpan=ne,ii.literalNode=oe,ii.arrayNode=ue,ii.appNode=ce,ii.operatorNode=se,ii.parenNode=le,ii.nameNode=fe,ii.cellRefNode=de,ii.badNode=he,ii.AnnotationKind=L,ii.worksheetFuncNameAnnotation=ae,ii.localNameAnnotation=ie,(ui=oi||(oi={})).SignatureType=P,ui.FunctionFlags=V,ui.OperatorId=Ue,ui.WorksheetFuncId=we,ui.SpecialPrecs=G,ui.functionType=ve,ui.unknownFunctionType=Ve,ui.getOperatorType=tt,ui.getWorksheetFuncType=rt,(si=ci||(ci={})).isSheetIndex=ct,si.isSheetGridRange=ft,si.isGridCell=lt,si.isSheetGridCell=dt,si.isDocumentLocEqual=vt,si.isSheetIndexEqual=pt,si.isGridCellEqual=mt,si.isSheetGridCellEqual=gt,si.isWellFormed=st,si.isUnqualifiedNameNode=Rt,si.isOperatorNode=bt,si.gridRangeAnchor=Ct,si.sheetGridRangeAnchor=St,si.gridCellRange=Et,si.getArguments=kt,si.getArgType=It,si.isValidArgsLength=Tt,si.operKind=Nt,si.ResultKind=Be,si.success=at,si.failure=it,si.FailureError=Ut,si.isSuccess=ot,si.ReasonKind=Mt,si.notImplemented=wt,si.unavailable=Lt,si.internal=Dt,si.javaScriptError=ut,si.columnName=qr,si.formatRow=Yr,si.formatCol=zr,si.formatRowRange=tn,si.formatColRange=rn,si.formatCellPos=an,si.formatGridRangeA1=dn,si.parseGridCellA1=Wr,si.parseGridRangeA1=jr,si.getSubExpressionFromPosition=yt,si.ResolveReasonKind=Ta,si.noOriginSheet=_a,si.createResolver=Ua,si.createResolutionHandler=wa,si.defaultLiteralVisitor=Ga,si.defaultFormulaVisitor=Va,si.dispatch=Pa,si.startVisit=xa,si.printFormula=za,si.printLocalsGrid=Xa,si.printLocalsName=Ya,(fi=li||(li={})).LogCategory=f.LogCategory,fi.TraceLevel=f.TraceLevel,fi.localeInfo=va,fi.localeInfo2=pa,fi.calcConfig=ua,fi.initCalc=fa,fi.createSimpleLocaleInfo=Fa,fi.getEnglishLocaleInfo=Fa,fi.createWorksheetFuncNameCallbacks=Ia,fi.isCalcInit=da,fi.getCalcAbsUrl=ha,(hi=di||(di={})).ieeeMathpack=Mn,hi.xlMathpack=Xn;var Ci,Si=ci.ReasonKind,Ei=ci.notImplemented;function yi(e){return{config:e}}function Oi(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:at(t)}}!function(e){e.BadFormulaString="BadFormulaString"}(Ci||(Ci={}));var Ai=Object(j.a)(Object(j.a)({},Si),Ci),ki=Xa,bi=Ya;function Ri(e){return{kind:Ai.BadFormulaString,message:e}}function Ii(e,t){var r=t-1;return function(t){if(t<=r){var n=e+": internal error: no progress made at index "+t;return O.ULS.assertTag(595980821,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=t}}function Ti(e,t,r){for(var n=t;n<e.length&&r(e[n]);n+=1);return[e.substring(t,n),n]}function Ni(e,t,r,n,a){var i=e[t];return r(i)?1:i===n&&t+1<e.length&&a(e[t+1])?2:0}function Fi(e,t,r,n,a){for(var i=[],o=t,u=t;u<e.length;){var c=Ni(e,u,r,n,a);if(0===c)break;2===c&&(o!==u&&i.push(e.substring(o,u)),o=u+1),u+=c}return o!==u&&i.push(e.substring(o,u)),[i.join(""),u]}var _i,Mi,wi,Li,Di=oi.OperatorId;function Ui(e,t,r){return{kind:e,start:t,chars:r}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(_i||(_i={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Mi||(Mi={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(wi||(wi={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Li||(Li={}));var xi=function(e){return Ui(_i.End,e,"")},Pi=function(e,t){return Ui(_i.Spaces,e,t)};function Gi(e,t,r){return void 0===r&&(r=!1),{kind:_i.Unexpected,start:e,chars:t,isQualPart:r}}var Vi=function(e,t){return Ui(_i.Ident,e,t)};function Bi(e,t,r,n){return{kind:e,start:t,chars:r,value:n}}var Wi=function(e,t){return Bi(_i.Left,e,t,Mi.Bracket)},ji=function(e,t){return Bi(_i.Left,e,t,Mi.Brace)},Hi=function(e){return Bi(_i.Right,e,")",Mi.Paren)},Ki=function(e,t){return Bi(_i.Right,e,t,Mi.Bracket)},qi=function(e,t){return Bi(_i.Right,e,t,Mi.Brace)},Ji=function(e){return Bi(_i.Right,e,"'",Mi.SQuote)},Qi=function(e,t){return Bi(_i.Sep,e,t,wi.List)},Xi=function(e,t){return Bi(_i.Sep,e,t,wi.Col)},Yi=function(e,t){return Bi(_i.Sep,e,t,wi.Row)},zi=function(e){return Bi(_i.Sep,e,"!",wi.Qual)},Zi={"#ALL":function(e,t){return Bi(_i.SpecialRef,e,t,Li.All)},"#DATA":function(e,t){return Bi(_i.SpecialRef,e,t,Li.Data)},"#HEADERS":function(e,t){return Bi(_i.SpecialRef,e,t,Li.Headers)},"#TOTALS":function(e,t){return Bi(_i.SpecialRef,e,t,Li.Totals)},"#THIS ROW":function(e,t){return Bi(_i.SpecialRef,e,t,Li.ThisRow)}};function $i(e,t,r,n,a,i,o,u,c){return{kind:_i.CellRef,start:e,chars:t,row:r,col:n,refStyle:a,isName:i,isNumber:o,isQualPart:u,isBadLocale:c}}function eo(e){for(var t=0;t<e.length;t+=1)if("+"===e[t]||"-"===e[t]||"*"===e[t]||" "===e[t]||"/"===e[t])return!1;return!0}function to(e,t,r,n){void 0===n&&(n=!0);var a="number"==typeof r&&eo(t);return{kind:_i.Literal,start:e,chars:t,oper:r,hasRight:n,isQualPart:a}}function ro(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?to(t,r,!1):0===e.stringCompareCI(e.trueName,r)?to(t,r,!0):Vi(t,r)}function no(e){var t=je[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return function(r){return{kind:_i.Operator,start:r,chars:t,value:e}}}var ao=no(Di.Add),io=no(Di.Sub),oo=no(Di.Mul),uo=no(Di.Div),co=no(Di.Pow),so=no(Di.Percent),lo=no(Di.Concat),fo=no(Di.Eq),ho=no(Di.Lt),vo=no(Di.Gt),po=no(Di.Ne),mo=no(Di.Le),go=no(Di.Ge),Co=no(Di.Range),So=(no(Di.And),no(Di.Or),no(Di.Xor),no(Di.Dot),no(Di.At)),Eo=no(Di.Pound);function yo(e,t,r){return r.push(t),t.start+e}var Oo=ai.RefStyle,Ao="+-*/^%&=<>:",ko=!1;function bo(e){return!ko&&yn(hn.CalcDynamicArrayOperators)&&(Ao+="@#",ko=!0),Ao.indexOf(e)>=0}var Ro={"+":ao,"-":io,"*":oo,"/":uo,"^":co,"%":so,"&":lo,"=":fo,"<":ho,">":vo,":":Co,"@":So,"#":Eo},Io={"<>":po,"<=":mo,">=":go};function To(e,t,r){if(t<e.length-1){var n=Io[e.substr(t,2)];if(null!=n)return yo(2,n(t),r)}var a=Ro[e[t]];if(null!=a)return yo(1,a(t),r);return O.ULS.assertTag(595980822,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function No(e,t,r,n,a){var i=Ar(e,t,r,n);if(void 0!==i){var o=i.value,u=i.i;if(void 0!==o)return yo(u-n,to(n,r.substring(n,u),o,!0),a),u;if(e.isNumeral(r.charCodeAt(n))){var c=r.substring(n,u);return yo(u-n,Gi(n,c,eo(c)),a),u}}}function Fo(e,t,r){var n=Fi(e,t+1,(function(e){return'"'!==e}),'"',(function(e){return'"'===e})),a=n[0],i=n[1],o=e.substring(t,i+1);return i<e.length?yo(i+1-t,to(t,o,a,!0),r):yo(i-t,to(t,o,a,!1),r)}function _o(e,t,r,n){for(var a=1;a<e.errorNames.length;a+=1){var i=e.errorNames[a];if(void 0!==i){var o=t.substr(r,i.length);if(0===e.stringCompareCI(i,o))return yo(i.length,to(r,o,Ce(a)),n)}}}var Mo=Object.getOwnPropertyNames(Zi);function wo(e,t,r,n){for(var a=0;a<Mo.length;a+=1){var i=Mo[a],o=t.substr(r,i.length);if(0===e.stringCompareCI(i,o))return yo(i.length,Zi[i](r,o),n)}}function Lo(e,t){return"'"!==t&&"#"!==t&&t!==e.leftBracket&&t!==e.rightBracket}function Do(e,t,r,n){var a=yo(1,Wi(r,t[r]),n);"#"===t[a]&&(null!=(s=wo(e,t,a,n))&&(a=s));for(var i=function(t){return Lo(e,t)},o=function(t){return!Lo(e,t)},u=Ii("calc.parse.tokenizeBracketedColRef",a);a<t.length;){u(a);var c=t[a];if(c===e.rightBracket)return yo(1,Ki(a,c),n);if(Ni(t,a,i,"'",o)>0){var s,l=Fi(t,a,i,"'",o),f=l[0];a=yo((s=l[1])-a,Vi(a,f),n)}else a=yo(1,Gi(a,c),n)}return a}function Uo(e,t){return!Sr(t.charCodeAt(0))&&"'"!==t&&"#"!==t&&":"!==t&&t!==e.listSeparator&&t!==e.leftBracket&&t!==e.rightBracket}function xo(e,t,r,n){var a=yo(1,Wi(r,t[r]),n);"#"===t[a]&&(null!=(f=wo(e,t,a,n))&&(a=f));for(var i=function(t){return Uo(e,t)},o=function(t){return!Uo(e,t)},u=Ii("calc.parse.tokenizeBracketedRef",a);a<t.length;){u(a);var c=t[a];if(c===e.rightBracket)return yo(1,Ki(a,c),n);if(Ni(t,a,i,"'",o)>0){var s=Fi(t,a,i,"'",o),l=s[0];a=yo((f=s[1])-a,Vi(a,l),n)}else if(Sr(c.charCodeAt(0))){var f,d=Ti(t,a,(function(e){return Sr(e.charCodeAt(0))}));l=d[0];a=yo((f=d[1])-a,Pi(a,l),n)}else a=":"!==c?c!==e.listSeparator?c!==e.leftBracket?yo(1,Gi(a,c),n):Do(e,t,a,n):yo(1,Qi(a,c),n):yo(1,Co(a),n)}return a}var Po;function Go(e,t,r,n){for(var a,i=yo(1,(a=r,Bi(_i.Left,a,"'",Mi.SQuote)),n),o=function(t){return function(e,t){return"':*?".indexOf(t)<0&&t!==e.leftBracket&&t!==e.rightBracket}(e,t)},u=function(e){return"'"===e},c=Ii("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){c(i);var s=t[i];if("'"===s&&"'"!==t[i+1])return yo(1,Ji(i),n);if(":"!==s)if(s!==e.leftBracket)if(Ni(t,i,o,"'",u)>0){var l=Fi(t,i,o,"'",u),f=l[0];i=yo(l[1]-i,Vi(i,f),n)}else i=yo(1,Gi(i,s),n);else i=xo(e,t,i,n);else i=yo(1,Co(i),n)}return i}function Vo(e,t,r,n,a,i){var o,u,c,s,l,f,d,h=Br(e,t,r,n,a);if(null!=h){var v=h.i,p=n.substring(v,a);return yo(v-a,h.refStyle===Oo.A1?(o=a,u=p,c=h.row,s=h.col,l=null==c&&null!=s&&s.kind===ai.PosKind.Rel,f=null==s&&null!=c&&c.kind===ai.PosKind.Rel,d=!(null!=c&&c.kind!==ai.PosKind.Rel||null!=s&&s.kind!==ai.PosKind.Rel),$i(o,u,c,s,ai.RefStyle.A1,l,f,d,!1)):function(e,t,r,n,a){void 0===a&&(a=!1);var i=!(!1!==r&&null!=r&&r.kind!==ai.PosKind.Abs||!1!==n&&null!=n&&n.kind!==ai.PosKind.Abs);return $i(e,t,!1===r?ai.pos(ai.PosKind.Rel,0):r,!1===n?ai.pos(ai.PosKind.Rel,0):n,ai.RefStyle.R1C1,!1,!1,i,a)}(a,p,h.row,h.col,h.enLocale),i)}}function Bo(e,t,r,n){for(var a=e[t],i=t+1;i<e.length;i+=1){var o=e[i];if(o.kind!==r)break;a=n(a,o)}return[a,i]}function Wo(e,t,r,n,a,i){for(var o=function(e,t,r,n,a,i){for(var o,u=[],c=[],s=Po.Decimal,l=i,d=Ii("calc.parse.tokenize",l);l<a.length;){d(l);var h=Vo(e,r,n,a,l,u);if(null==h){var v=a[l];if(s===Po.Decimal&&v===e.decimalSeparator||e.isNumeral(v.charCodeAt(0))){var p=No(e,t,a,l,u);if(null!=p){l=p,s=Po.FieldAccess;continue}if(v!==e.decimalSeparator){var m="calc.parse.tokenize: failed to tokenize numeral at "+l;return O.ULS.assertTag(595980823,f.LogCategory.msoulscat_ES_EWAJS,!1,m)}}if('"'!==v)if(e.isIdentStart(v.charCodeAt(0))){var g=Ti(a,l,(function(t){return e.isIdentContinue(t.charCodeAt(0))})),C=g[0];l=yo(g[1]-l,ro(e,l,C),u),s=Po.FieldAccess}else if("#"!==v)if(bo(v))l=To(a,l,u),s=Po.Decimal;else if(Sr(v.charCodeAt(0))){var S=Ti(a,l,(function(e){return Sr(e.charCodeAt(0))}));C=S[0];l=yo(S[1]-l,Pi(l,C),u),s=Po.Decimal}else if("("!==v)if(")"!==v)if(v!==e.leftBrace)if(v!==e.rightBrace)if(v!==e.leftBracket)if(v!==e.rightBracket){if(c.length>0&&c[c.length-1]===Mi.Brace){if(v===e.columnSeparator){l=yo(1,Xi(l,v),u),s=Po.Decimal;continue}if(v===e.rowSeparator){l=yo(1,Yi(l,v),u),s=Po.Decimal;continue}}v!==e.listSeparator?"!"!==v?"'"!==v?(l=yo(1,Gi(l,v),u),s=Po.Decimal):(l=Go(e,a,l,u),s=Po.Decimal):(l=yo(1,zi(l),u),s=Po.Decimal):(l=yo(1,Qi(l,v),u),s=Po.Decimal)}else l=yo(1,Ki(l,v),u),s=Po.FieldAccess;else l=xo(e,a,l,u),s=Po.FieldAccess;else c.length>0&&c[c.length-1]===Mi.Brace&&c.pop(),l=yo(1,qi(l,v),u),s=Po.FieldAccess;else c.push(Mi.Brace),l=yo(1,ji(l,v),u),s=Po.Decimal;else c.length>0&&c[c.length-1]===Mi.Paren&&c.pop(),l=yo(1,Hi(l),u),s=Po.FieldAccess;else c.push(Mi.Paren),l=yo(1,(o=l,Bi(_i.Left,o,"(",Mi.Paren)),u),s=Po.Decimal;else{var E=_o(e,a,l,u);if(null!=E){l=E,s=Po.FieldAccess;continue}yn(hn.CalcDynamicArrayOperators)?(l=To(a,l,u),s=Po.Decimal):(l=yo(1,Gi(l,v),u),s=Po.Decimal)}else l=Fo(a,l,u),s=Po.FieldAccess}else l=h,s=Po.FieldAccess}return u}(e,t,r,n,a,i),u=[],c=0;c<o.length;){var s=o[c];if(s.kind!==_i.Unexpected)u.push(s),c+=1;else{var l=Bo(o,c,_i.Unexpected,(function(e,t){var r=e,n=t;return Gi(r.start,r.chars+n.chars,r.isQualPart&&n.isQualPart)})),d=l[0],h=l[1];u.push(d),c=h}}return u.push(xi(a.length)),u}function jo(e,t,r,n){var a=void 0;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,n,(function(e,t){a=[e,t]}),(function(){a=!1}))),null==a){var i="calc.parse.runParser: internal error: parser did not call resolve or reject on "+C(t);return O.ULS.assertTag(595980827,f.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function Ho(){var e={impl:function(e,t,r,n,a){return O.ULS.assertTag(595980828,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(t,r,n,a,i){return function(){return e.impl(t,r,n,a,i)}}};return e}function Ko(e){return function(t,r,n,a,i){return a(e,r)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(Po||(Po={}));var qo,Jo=function(e,t,r,n,a){return a};function Qo(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,n){return t(a,e)(r,n,a,i,o)}),o)}}function Xo(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return t(r,n,a,i,o)}))}}function Yo(e){return 0===e.length?Jo:e.reduce(Xo)}function zo(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return i(t,n)}))}}function Zo(e,t){return function(r,n,a,i,o){var u=r[n];if(null==u)return o;var c=e(a,u);return null==c?o:i(c,n+t)}}function $o(e){return Zo(e,1)}function eu(e){return Zo(e,0)}function tu(e){return function(t,r,n,a,i){var o=t[r],u=t[r+1];if(null==o||null==u)return i;var c=e(n,o,u);return null==c?i:a(c,r+1)}}function ru(e,t,r){return function(n,a,i,o,u){var c=r,s=a;function l(){return e(n,s,i,d,h)}function d(e,r){if(r<=s){var a=C(n),o="calc.parse.reduce: internal error: no progress made at index "+s+" on "+a;return O.ULS.assertTag(595980829,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return c=t(i,e,c),s=r,l}function h(){return o(c,s)}return l}}function nu(e,t){return ru(e,(function(e,t,r){return r.push(t),r}),t)}function au(e){return function(t,r,n,a,i){return nu(e,[])(t,r,n,a,i)}}function iu(e,t){return Qo(e,(function(e,r){return nu(t,[r])}))}function ou(e){var t=e.length;return function(r,n,a,i,o){var u=n,c=[];function s(){return e[c.length](r,u,a,l,o)}function l(e,r){return u=r,c.push(e),c.length<t?s:i(c,u)}return s}}function uu(e,t){return ou([e,t])}function cu(e,t,r,n,a){return ou([e,t,r,n,a])}function su(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){return i(t(a,e),r)}),o)}}function lu(e,t,r){return su(ou([e,t]),(function(e,t){return r(e,t[0],t[1])}))}function fu(e,t,r,n){return su(ou([e,t,r]),(function(e,t){return n(e,t[0],t[1],t[2])}))}function du(e,t,r,n,a){return su(ou([e,t,r,n]),(function(e,t){return a(e,t[0],t[1],t[2],t[3])}))}function hu(e,t,r,n,a,i){return su(ou([e,t,r,n,a]),(function(e,t){return i(e,t[0],t[1],t[2],t[3],t[4])}))}function vu(e,t){return lu(e,t,(function(e,t,r){return t}))}function pu(e,t){return lu(e,t,(function(e,t,r){return r}))}function mu(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+C(t);return O.ULS.assertTag(595980824,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function gu(e,t,r,n,a){var i=e.label;return e.label+=1,e.spans[i]=ai.formulaSpan(t,r,n,a),i}function Cu(e,t,r,n){var a=mu(e,r);return a.pre=t,a.post=n,r}function Su(e,t,r){return function(n,a,i,o,u){var c=i.leftDelim,s=i.listSep;return i.leftDelim=e,i.listSep=t,r(n,a,i,(function(e,t){return i.leftDelim=c,i.listSep=s,o(e,t)}),(function(){return i.leftDelim=c,i.listSep=s,u}))}}function Eu(e,t){return t.kind===_i.Spaces||t.kind===_i.End?t.start:mu(e,t).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(qo||(qo={}));var yu=zo($o((function(e,t){return t.kind===_i.Spaces?t.chars:void 0})),""),Ou=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected term at "+t+" in "+C(e);return O.ULS.assertTag(595980864,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(Eu(r,i),t)};function Au(e){return fu(yu,$o(e),yu,Cu)}function ku(e){return lu(yu,$o(e),(function(e,t,r){return Cu(e,t,r,"")}))}function bu(e){return lu($o(e),yu,(function(e,t,r){return Cu(e,"",t,r)}))}var Ru=Au((function(e,t){return t.kind!==ai.NodeKind.Operator||t.id!==oi.OperatorId.Add&&t.id!==oi.OperatorId.Sub?void 0:t})),Iu=bu((function(e,t){if(t.kind===ai.NodeKind.Operator){if(t.id===oi.OperatorId.Add)return ai.operatorNode(oi.OperatorId.Pos,t.label);if(t.id===oi.OperatorId.Sub)return ai.operatorNode(oi.OperatorId.Neg,t.label)}}));function Tu(e,t){if(t.kind===ai.NodeKind.Operator&&t.id===oi.OperatorId.At)return ai.operatorNode(oi.OperatorId.At,t.label)}var Nu=bu(Tu),Fu=ku((function(e,t){return t.kind===ai.NodeKind.Operator&&t.id===oi.OperatorId.Pound?t:void 0})),_u=Au((function(e,t){return t.kind!==ai.NodeKind.Operator||t.id!==oi.OperatorId.Mul&&t.id!==oi.OperatorId.Div?void 0:t})),Mu=Au((function(e,t){return t.kind===ai.NodeKind.Operator&&t.id===oi.OperatorId.Pow?t:void 0})),wu=ku((function(e,t){return t.kind===ai.NodeKind.Operator&&t.id===oi.OperatorId.Percent?t:void 0})),Lu=Au((function(e,t){return t.kind===ai.NodeKind.Operator&&t.id===oi.OperatorId.Concat?t:void 0})),Du=Au((function(e,t){return t.kind===ai.NodeKind.Operator&&t.id>=oi.OperatorId.Eq&&t.id<=oi.OperatorId.Ge?t:void 0})),Uu=Au((function(e,t){return t.kind===ai.NodeKind.Operator&&t.id===oi.OperatorId.Range?t:void 0})),xu=Au((function(e,t){return t.kind===ai.NodeKind.Operator&&t.id===oi.OperatorId.Union?t:void 0})),Pu=tu((function(e,t,r){if(t.kind===_i.Spaces&&r.kind!==_i.End&&(r.kind!==ai.NodeKind.Operator||r.id===oi.OperatorId.At)){var n=gu(e,t.start,Eu(e,r),t.chars,"");return ai.operatorNode(oi.OperatorId.Isect,n)}}));function Gu(e,t,r,n){return void 0===n&&(n=e),lu(n,au(uu(t,e)),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function Vu(e,t,r){return lu(au(t),e,(function(e,t,n){return 0===t.length?n:t.reduceRight(r(e),n)}))}function Bu(e,t,r){return lu(e,au(t),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function Wu(e){return function(t,r){var n=r[0],a=r[1],i=mu(e,t).start,o=mu(e,a).end,u=gu(e,i,o,"","");return ai.appNode(n,[t,a],!0,u)}}function ju(e){return function(t,r){var n=mu(e,t).start,a=mu(e,r).end,i=gu(e,n,a,"","");return ai.appNode(r,[t],!0,i)}}function Hu(e){var t=!0;return function(r,n){var a=mu(e,n).start,i=mu(e,r).end,o=gu(e,a,i,"","");if(t&&(t=!1,r.kind===ai.NodeKind.Literal&&"number"==typeof r.oper&&""===mu(e,n).post)){var u=n.id===oi.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return ai.literalNode(u,!0,o)}return ai.appNode(n,[r],!0,o)}}function Ku(e){return function(t,r){var n=mu(e,r).start,a=mu(e,t).end,i=gu(e,n,a,"","");return ai.appNode(r,[t],!0,i)}}var qu,Ju,Qu,Xu,Yu,zu,Zu,$u,ec,tc,rc,nc,ac,ic,oc=$o((function(e,t){return t.kind!==ai.NodeKind.Operator&&t.kind!==_i.Spaces&&t.kind!==_i.End?t:void 0}));function uc(e,t){var r=gu(e,mu(e,t[0]).start,mu(e,t[t.length-1]).end,"","");return ai.badNode(ai.BadType.Sequence,t,r)}var cc=!1;function sc(e,t){!function(){if(!cc){if(yn(hn.CalcDynamicArrayOperators)){qu=lu(Ou,au(oc),(function(e,t,r){return 0===r.length?ai.literalNode(ri.missingOper,!0,gu(e,t,t,"","")):1===r.length?r[0]:uc(e,r)})),Ju=Bu(qu,Fu,ju);var e=Ho(),t=pu(eu(Tu),e.parser);Qu=Gu(Xo(t,Ju),Uu,Wu,Ju),Xu=Gu(Xo(t,Qu),Pu,Wu,Qu),Yu=Vu(Xu,Nu,Ku),e.impl=Yu,zu=Gu(Yu,xu,Wu),Zu=Vu(zu,Iu,Hu),$u=Bu(Zu,wu,ju),ec=Gu($u,Mu,Wu),tc=Gu(ec,_u,Wu),rc=Gu(tc,Ru,Wu),nc=Gu(rc,Lu,Wu),ac=Gu(nc,Du,Wu)}else Qu=lu(Ou,au(oc),(function(e,t,r){return 0===r.length?ai.literalNode(ri.missingOper,!0,gu(e,t,t,"","")):1===r.length?r[0]:uc(e,r)})),Xu=Gu(Qu,Uu,Wu),Yu=Gu(Xu,Pu,Wu),zu=Gu(Yu,xu,Wu),Zu=Vu(zu,Iu,Hu),$u=Bu(Zu,wu,ju),ec=Gu($u,Mu,Wu),tc=Gu(ec,_u,Wu),rc=Gu(tc,Ru,Wu),nc=Gu(rc,Lu,Wu),ac=Gu(nc,Du,Wu);ic=lu(ac,au(pu(eu((function(e,t){return t.kind===_i.End?void 0:t})),ac)),(function(e,t,r){return 0===r.length?t:uc(e,[t].concat(r))})),cc=!0}}();var r=e.length-1;if(r<0){var n="calc.parse.parseTerms: internal error: expected at least 1 term";return O.ULS.assertTag(595980865,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[0].kind===_i.Spaces){n="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+C(e);return O.ULS.assertTag(595980866,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&e[r-1].kind===_i.Spaces){n="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+C(e);return O.ULS.assertTag(595980867,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[r].kind!==_i.End){n="calc.parse.parseTerms: internal error: array[n].kind !== End in "+C(e);return O.ULS.assertTag(595980868,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=jo(ic,e,0,t);if(!1===a){n="calc.parse.parseTerms: internal error: failed to parse "+C(e);return O.ULS.assertTag(595980869,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i=a[0],o=a[1];if(o<r){n="calc.parse.parseTerms: internal error: consumed "+o+" out of "+r+" in "+C(e);return O.ULS.assertTag(595980870,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}return i}var lc=zo($o((function(e,t){return t.kind===_i.Spaces?t.chars:void 0})),""),fc=function(e,t,r,n,a){var i=e[t];if(null==i){var o="calc.parse.pStart: internal error: expected token at "+t+" in "+C(e);return O.ULS.assertTag(595980830,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(i.start,t)};function dc(e){return $o((function(t,r){return r.kind===_i.Sep&&r.value===e||void 0}))}function hc(e){return $o((function(t,r){return r.kind===_i.Left&&r.value===e?r.start:void 0}))}function vc(e){return $o((function(t,r){return r.kind===_i.Right&&r.value===e||void 0}))}var pc=dc(wi.List),mc=dc(wi.Row),gc=dc(wi.Col),Cc=dc(wi.Qual),Sc=hc(Mi.Paren),Ec=vc(Mi.Paren),yc=hc(Mi.Brace),Oc=vc(Mi.Brace),Ac=hc(Mi.SQuote),kc=vc(Mi.SQuote),bc=$o((function(e,t){return t.kind===_i.Operator&&t.value===oi.OperatorId.Range||void 0})),Rc=Ho(),Ic=fu(lc,Rc.parser,lc,Cu),Tc=du(Sc,Su(Mi.Paren,qo.Union,Ic),zo(Ec,!1),fc,(function(e,t,r,n,a){var i=gu(e,t,a,"","");return ai.parenNode(r,n,i)})),Nc=iu(Ic,pu(gc,Ic)),Fc=iu(Nc,pu(mc,Nc)),_c=du(yc,Su(Mi.Brace,qo.Union,Fc),zo(Oc,!1),fc,(function(e,t,r,n,a){var i=gu(e,t,a,"","");return ai.arrayNode(r,n,i)})),Mc=function(e){return e.kind===_i.Ident||e.kind===_i.CellRef&&e.isQualPart||e.kind===_i.Literal&&e.isQualPart||e.kind===_i.Unexpected&&e.isQualPart||e.kind===_i.Operator&&e.value===oi.OperatorId.Dot},wc=iu($o((function(e,t){return Mc(t)&&t.chars.length>0&&46!==t.chars.charCodeAt(0)?t.chars:void 0})),$o((function(e,t){return Mc(t)?t.chars:void 0}))),Lc=$o((function(e,t){return t.kind===_i.Ident?t.chars:void 0}));function Dc(e){return e.kind===_i.Literal&&"object"==typeof e.oper&&e.oper.kind===ri.OperKind.Error&&e.oper.type===ri.ErrorType.REF}function Uc(e,t,r,n){return null==t?[ai.identQualifier(e,r,n),r?"'"+e.replace(/'/g,"")+"'":e]:[ai.sheetRangeQualifier(e,t,void 0,r,n),r?"'"+e.replace(/'/g,"")+":"+t.replace(/'/g,"")+"'":e+":"+t]}var xc=du(fc,wc,zo(pu(bc,wc),void 0),fc,(function(e,t,r,n,a){var i=gu(e,t,a,"","");return Uc(r.join(""),null!=n?n.join(""):void 0,!1,i)})),Pc=hu(Ac,Lc,zo(pu(bc,Lc),void 0),kc,fc,(function(e,t,r,n,a,i){return Uc(r,n,!0,gu(e,t,i,"",""))})),Gc=du(Ac,au($o((function(e,t){return t.kind===_i.End||t.kind===_i.Right&&t.value===Mi.SQuote?void 0:t.chars}))),zo(uu(kc,zo(vu(Cc,lc),!1)),[!1,!1]),fc,(function(e,t,r,n,a){var i=n[0],o=n[1],u="'"+r.join("")+(i?"'":"")+(o?"!":""),c=gu(e,t,a,"","");return[ai.badNode(ai.BadType.Qualifier,u,c),u]})),Vc=tu((function(e,t,r){if(Dc(t)){var n=gu(e,t.start,r.start,"","");return[ai.errorQualifier(n),t.chars]}})),Bc=lu(Yo([xc,Pc,eu((function(e,t){var r=gu(e,t.start,t.start,"","");return[ai.relativeQualifier(r),""]}))]),vu(Cc,lc),(function(e,t,r){return[t[0],t[1]+"!"]})),Wc=Yo([Vc,Bc,Gc]);function jc(e,t){return t.kind===_i.CellRef&&e.refStyle===t.refStyle&&!t.isBadLocale}var Hc=tu((function(e,t,r){return jc(e,t)?[t,r.start]:void 0}));function Kc(e,t){if(null!=e.row&&null!=e.col)return ai.cellRefSingle(e.row,e.col,t);if(null!=e.row)return ai.cellRefRow(e.row,e.row,t);if(null!=e.col)return ai.cellRefCol(e.col,e.col,t);var r="calc.parse.cellRefToken2cellRef: bad token "+C(e);return O.ULS.assertTag(595980831,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var qc=tu((function(e,t,r){if(jc(e,t)&&(t.refStyle!==ai.RefStyle.A1||null!=t.row&&null!=t.col))return Kc(t,n=gu(e,t.start,r.start,"",""));if(Dc(t)){var n=gu(e,t.start,r.start,"","");return ai.cellRefError(n)}})),Jc=Xo(Qo(cu(Hc,lc,bc,lc,Hc),(function(e,t){var r=t[0],n=r[0],a=r[1],i=t[1],o=(t[2],t[3]),u=t[4],c=u[0],s=u[1],l=gu(e,n.start,a,"",i),f=gu(e,c.start,s,o,""),d=Kc(n,l),h=Kc(c,f),v=void 0;if(d.kind===ai.CellRefKind.Single&&h.kind===ai.CellRefKind.Single){var p=gu(e,n.start,s,"","");v=ai.cellRefRange(d,h,p)}else if(0===i.length&&0===o.length)if(d.kind===ai.CellRefKind.Row&&h.kind===ai.CellRefKind.Row){p=gu(e,n.start,s,"","");v=ai.cellRefRow(d.row1,h.row1,p)}else if(d.kind===ai.CellRefKind.Col&&h.kind===ai.CellRefKind.Col){p=gu(e,n.start,s,"","");v=ai.cellRefCol(d.col1,h.col1,p)}return null==v?Jo:n.isQualPart&&c.isQualPart?eu((function(e,t){return t.kind===_i.Sep&&t.value===wi.Qual?void 0:v})):Ko(v)})),qc),Qc=$o((function(e,t){return t.kind===_i.Ident||t.kind===_i.CellRef&&t.isName?t.chars:void 0})),Xc=Qo(cu(fc,Wc,fc,zo(Xo(Jc,Qc),void 0),fc),(function(e,t){var r=t[0],n=t[1],a=n[0],i=n[1],o=t[2],u=t[3],c=t[4];if(null==u)return a.kind!==ai.QualifierKind.SheetRange||a.isQuoted?a.kind===ai.QualifierKind.Error?Ko(ai.literalNode(ri.refErrorOper,!0,a.label)):Ko(a.kind===ai.NodeKind.Bad?a:ai.badNode(ai.BadType.Qualifier,i,a.label)):Jo;if("string"==typeof u){if(a.kind===ai.QualifierKind.SheetRange&&!a.isQuoted)return Jo;var s=gu(e,r,c,"","");if(a.kind===ai.NodeKind.Bad||a.kind===ai.QualifierKind.Error||a.kind===ai.QualifierKind.SheetRange){var l=a.kind===ai.NodeKind.Bad?a:ai.badNode(ai.BadType.Qualifier,i,a.label),f=ai.nameNode(u,void 0,gu(e,o,c,"",""));return Ko(ai.badNode(ai.BadType.Sequence,[l,f],s))}return Ko(ai.nameNode(u,a,s))}var d=gu(e,r,c,"","");if(a.kind===ai.NodeKind.Bad||a.kind===ai.QualifierKind.Document){var h=a.kind===ai.NodeKind.Bad?a:ai.badNode(ai.BadType.Qualifier,i,a.label);f=ai.cellRefNode(u,void 0,gu(e,o,c,"",""));return Ko(ai.badNode(ai.BadType.Sequence,[h,f],d))}var v=a.kind===ai.QualifierKind.Ident?ai.sheetQualifier(a.name,void 0,a.isQuoted,a.label):a;return Ko(ai.cellRefNode(u,v,d))})),Yc=fu(fc,Xo(Jc,Qc),fc,(function(e,t,r,n){var a=gu(e,t,n,"","");return"string"==typeof r?ai.nameNode(r,void 0,a):r.kind===ai.CellRefKind.Error?ai.literalNode(ri.refErrorOper,!0,a):ai.cellRefNode(r,void 0,a)})),zc=tu((function(e,t,r){if(t.kind===_i.Literal)return ai.literalNode(t.oper,t.hasRight,gu(e,t.start,r.start,"",""));if(t.kind===_i.CellRef&&t.isNumber&&"object"==typeof t.row){var n=t.row.index+e.origin.row+1;return ai.literalNode(e.mathpack.fromNumber(n),!0,gu(e,t.start,r.start,"",""))}}));function Zc(e){return tu((function(t,r,n){if(e(r)){var a=gu(t,r.start,n.start,"","");return ai.badNode(ai.BadType.Unexpected,r.chars,a)}}))}var $c=Zc((function(e){return e.kind===_i.Left&&e.value===Mi.Bracket})),es=Zc((function(e){return e.kind===_i.Right&&e.value===Mi.Bracket})),ts=hu(fc,$c,Su(Mi.Bracket,qo.Union,Ic),zo(es,void 0),fc,(function(e,t,r,n,a,i){var o=[r,n];null!=a&&o.push(a);var u=gu(e,t,i,"","");return ai.badNode(ai.BadType.Sequence,o,u)})),rs=tu((function(e,t,r){switch(t.kind){case _i.End:case _i.Operator:case _i.Spaces:return;case _i.Sep:if(t.value!==wi.Qual&&(e.leftDelim===Mi.Brace||t.value!==wi.Col&&t.value!==wi.Row))return;break;case _i.Right:if(t.value===e.leftDelim)return}var n=t.kind===_i.CellRef?ai.BadType.CellRef:ai.BadType.Unexpected,a=gu(e,t.start,r.start,"","");return ai.badNode(n,t.chars,a)})),ns=tu((function(e,t,r){if((t.kind===_i.Ident||t.kind===_i.CellRef||t.kind===_i.Literal&&"boolean"==typeof t.oper)&&r.kind===_i.Left&&r.value===Mi.Paren&&null!=Gt(e.localeInfo,t.chars)){var n=gu(e,t.start,r.start,"","");return ai.nameNode(t.chars,void 0,n)}})),as=du(Sc,Su(Mi.Paren,qo.Arg,iu(Ic,pu(pc,Ic))),zo(Ec,!1),fc,(function(e,t,r,n,a){return[r,n,a]})),is=lu(ns,as,(function(e,t,r){var n=r[0],a=r[1],i=r[2],o=gu(e,mu(e,t).start,i,"","");return ai.appNode(t,n,a,o)})),os=lu(Yo([is,Xc,Yc,zc,Tc,_c,ts,rs]),au(as),(function(e,t,r){var n=mu(e,t).start;return r.reduce((function(t,r){var a=r[0],i=r[1],o=r[2],u=gu(e,n,o,"","");return ai.appNode(t,a,i,u)}),t)})),us=tu((function(e,t,r){var n=void 0;if(t.kind===_i.Operator&&(n=t.value),t.kind===_i.Sep&&t.value===wi.List&&e.listSep===qo.Union&&(n=oi.OperatorId.Union),null!=n){var a=gu(e,t.start,r.start,"","");return ai.operatorNode(n,a)}})),cs=$o((function(e,t){return t.kind===_i.Spaces?t:void 0})),ss=Xo(os,us),ls=Qo(ss,(function(e,t){return ru(uu(zo(cs,void 0),ss),(function(e,t,r){var n=t[0],a=t[1];return null!=n&&r.push(n),r.push(a),r}),[t])})),fs=lu(zo(ls,void 0),fc,(function(e,t,r){if(null==t){var n=gu(e,r,r,"","");return ai.literalNode(ri.missingOper,!0,n)}if(1===t.length){var a=t[0];if(a.kind!==ai.NodeKind.Operator&&a.kind!==_i.Spaces)return a}return t.push(xi(r)),sc(t,e)}));function ds(e,t,r,n,a,i){var o=i.length-1;if(o<0){var u="calc.parse.parseTokens: internal error: expected at least 1 token";return O.ULS.assertTag(595980832,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}if(i[o].kind!==_i.End){u="calc.parse.parseTokens: internal error: array[n] !== End in "+C(i);return O.ULS.assertTag(595980833,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}var c=function(e,t,r,n,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:n,origin:a,leftDelim:void 0,listSep:qo.Union,label:1,spans:[]}}(e,t,r,n,a),s=jo(Ic,i,0,c);if(!1===s){u="calc.parse.parseTokens: internal error: failed to parse "+C(i);return O.ULS.assertTag(595980834,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}var l=s[0],d=s[1];if(d<o){u="calc.parse.parseTokens: internal error: consumed "+d+" out of "+o+" in "+C(i);return O.ULS.assertTag(595980835,f.LogCategory.msoulscat_ES_EWAJS,!1,u)}return ai.formula(l,c.spans)}Rc.impl=fs;var hs={getDocumentLoc:function(){return it(Lt(["defaultPrintGlobals getDocumentLoc"]))},getSheetIndex:function(){return it(Lt(["defaultPrintGlobals getSheetIndex"]))},getSheetName:function(){return it(Lt(["defaultPrintGlobals getSheetName"]))},getNameLoc:function(){return it(Lt(["defaultPrintGlobals getNameLoc"]))},getUserDefinedFuncLoc:function(){return it(Lt(["defaultPrintGlobals getUserDefinedFuncLoc"]))},getSheetRangeIndexes:function(){return it(Lt(["defaultPrintGlobals getSheetRangeIndexes"]))}};var vs={"=":1,"+":0,"-":0,"@":-1};function ps(e,t,r){var n,a,i,o,u=r[0],c=null!=u?vs[u]:void 0;if(null==c)return ci.failure(Ri("first character is not '=', '+', '-' or '@'"));if(c<0)return ci.failure(Ei(["Lotus 1-2-3 syntax"]));var s=null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,l=null!=(o=null===(i=t.config)||void 0===i?void 0:i.refStyle)?o:e.config.refStyle,f=e.config.mathpack,d=Wo(s,f,l,t.originGridCell.value,r,c),h=ds(s,f,l,t.lexicalKind,t.originGridCell.value,d);return ci.success(h)}function ms(e){return{parseFormula:function(t,r,n,a){if("number"==typeof t){if(null==r){return O.ULS.assertTag(595980825,f.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: expected range to be defined")}var i=t,o=r;return ps(e,Oi(n,ci.gridRangeAnchor(function(e){return void 0===e.range}(o)?o:o.range),{refStyle:i}),a)}return ps(e,t,r)},formatFormula:function(t,r){return ci.printFormula(function(e){var t,r,n,a,i,o,u,c,s,l,f,d;return{config:e.config,getDocumentLoc:(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e),null!=r?r:hs.getDocumentLoc),getSheetIndex:(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e),null!=a?a:hs.getSheetIndex),getSheetName:(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e),null!=o?o:hs.getSheetName),getNameLoc:(c=null===(u=e.getNameLoc)||void 0===u?void 0:u.bind(e),null!=c?c:hs.getNameLoc),getUserDefinedFuncLoc:(l=null===(s=e.getUserDefinedFuncLoc)||void 0===s?void 0:s.bind(e),null!=l?l:hs.getUserDefinedFuncLoc),getSheetRangeIndexes:(d=null===(f=e.getSheetRangeIndexes)||void 0===f?void 0:f.bind(e),null!=d?d:hs.getSheetRangeIndexes)}}(e),t,r)}}}var gs=ai.QualifierKind,Cs=ai.CellRefKind,Ss=ai.NodeKind,Es=ci.ResultKind;function ys(e){return e.kind===Es.Success}function Os(e,t){var r=e[t];return null==r?k("ParseResultHelper.getFormulaSpan: expected span for label "+t+" to be defined"):r}function As(e,t,r){return!!ys(e)&&(function(e,t,r){if(null==e||null==r)return;var n={};null!=t?t.forEach((function(e){n[e]=!0})):n["*"]=!0;var a=[];a.push(e.node);for(;a.length>0;){var i=a.pop();if(null!=i)switch(i.kind){case Ss.Literal:c("literal")&&r("literal",{label:i.label,value:i});break;case Ss.Array:i.nodes.map((function(e){return e.map((function(e){a.push(e)}))}));break;case Ss.App:if("object"!=typeof i.head)c("literal")&&r("literal",{label:i.label,value:i.head});else{var o=i.head;switch(o.kind){case Ss.Operator:c("operator")&&r("operator",{label:i.label,value:o.id});break;case Ss.Name:c("function")&&r("function",{label:i.label,name:o.whole,isClosed:i.isClosed,args:i.args});break;default:a.push(o)}}i.args.map((function(e){a.push(e)}));break;case Ss.Paren:a.push(i.node);break;case Ss.Name:if(c("namedRange")){var u=i.whole.split(".");r("namedRange",{label:i.label,name:u[0],names:u.slice(1),qualifier:s(i)})}break;case Ss.CellRef:c("range")&&l(i);break;case Ss.Bad:break;default:return A("calc.parse.traverseFormula",i)}}function c(e){return n[e]||n["*"]}function s(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case gs.Sheet:var r=e.qualifier;t.type=gs.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case gs.SheetRange:var n=e.qualifier;t.type=gs.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case gs.Ident:var a=e.qualifier;t.type=gs.Ident,t.name=a.name;break;case gs.Document:var i=e.qualifier;t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}function l(t){if(null!=e&&null!=r)switch(t.ref.kind){case Cs.Error:break;case Cs.Col:var n=t.ref;r("range",{label:t.label,type:"col",startIndex:n.col1,endIndex:n.col2,span:Os(e.spans,n.label),qualifier:s(t)});break;case Cs.Row:var a=t.ref;r("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:Os(e.spans,a.label),qualifier:s(t)});break;case Cs.Single:var i=t.ref;r("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:Os(e.spans,i.label),qualifier:s(t)});break;case Cs.Range:var o=t.ref;r("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:Os(e.spans,o.ref1.label),bottomRightSpan:Os(e.spans,o.ref2.label),qualifier:s(t)})}}}(e.value,t,r),!0)}var ks,bs,Rs,Is={isSuccess:ys,traverse:As,extractReferences:function(e){if(ys(e)){var t=[];return As(e,["range","namedRange"],(function(r,n){var a={kind:r,ref:n,span:Os(e.value.spans,n.label)};t.push(a)})),t.sort((function(e,t){return e.span.start-t.span.start})),t}}};!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_argument_for_operator",e.Bad_node="Bad_node",e.Invalid_binder="Invalid_binder",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unsupported_struct_ref="Unsupported_struct_ref",e.Unsupported_doc_qual="Unsupported_doc_qual"}(bs||(bs={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_arguments_for_operator",e.Excess_function_arguments="Excess_arguments_for_function",e.Insufficient_function_arguments="Insufficient_arguments_for_function"}(Rs||(Rs={}));var Ts=((ks={})[bs.Unclosed_application]={kind:bs.Unclosed_application},ks[bs.Unclosed_paren]={kind:bs.Unclosed_paren},ks[bs.Unclosed_array]={kind:bs.Unclosed_array},ks[bs.Unclosed_literal]={kind:bs.Unclosed_literal},ks[bs.Illegal_array_literal_element]={kind:bs.Illegal_array_literal_element},ks[bs.Empty_array_literal]={kind:bs.Empty_array_literal},ks[bs.Irregular_array_shape]={kind:bs.Irregular_array_shape},ks[bs.Empty_parenthesis]={kind:bs.Empty_parenthesis},ks[bs.Bad_node]={kind:bs.Bad_node},ks[bs.Invalid_binder]={kind:bs.Invalid_binder},ks[bs.Empty_formula]={kind:bs.Empty_formula},ks[bs.Invalid_rel_sheet_qualifier_in_cell]={kind:bs.Invalid_rel_sheet_qualifier_in_cell},ks[bs.Invalid_rel_sheet_qualifier_in_name]={kind:bs.Invalid_rel_sheet_qualifier_in_name},ks[bs.Invalid_unqualified_cell]={kind:bs.Invalid_unqualified_cell},ks[bs.Unexpected_closing_paren]={kind:bs.Unexpected_closing_paren},ks[bs.Unexpected_closing_brace]={kind:bs.Unexpected_closing_brace},ks[bs.Unexpected_closing_bracket]={kind:bs.Unexpected_closing_bracket},ks[bs.Unsupported_struct_ref]={kind:bs.Unsupported_struct_ref},ks[bs.Unsupported_doc_qual]={kind:bs.Unsupported_doc_qual},ks[Rs.Types_not_related]={kind:Rs.Types_not_related},ks[Rs.Unexpected_application_head]={kind:Rs.Unexpected_application_head},ks[Rs.Unexpected_application_head_with_fix]={kind:Rs.Unexpected_application_head_with_fix},ks);function Ns(e){switch(e.kind){case Rs.Insufficient_function_arguments:case Rs.Excess_function_arguments:return e.kind+": "+Aa(e.funcId);case bs.Missing_operation_argument:case Rs.Incorrect_number_of_operator_arguments:return e.kind+": "+ka(e.opId);case bs.Unexpected_character:return e.kind+": "+gi(e.text);default:return e.kind}}var Fs,_s,Ms=ci.ReasonKind,ws=ci.FailureError;!function(e){e[e.General=0]="General",e[e.CurrencyDec=11]="CurrencyDec",e[e.CoCurrencyDec=12]="CoCurrencyDec",e[e.Percentage0=13]="Percentage0",e[e.Percentage=14]="Percentage",e[e.MMDDYY=19]="MMDDYY",e[e.HHMMAP=23]="HHMMAP",e[e.MDYHMS=27]="MDYHMS",e[e.AbsHMMSS=31]="AbsHMMSS"}(Fs||(Fs={})),function(e){e.BadOperation="BadOperation",e.BadFormula="BadFormula"}(_s||(_s={}));var Ls,Ds,Us=Object(j.a)(Object(j.a)({},Ms),_s),xs=ws;function Ps(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=Ns(e);t[n]=(null!=(r=t[n])?r:0)+1}))})),t}}function Gs(e,t,r,n,a,i){return{config:e,getDocumentLoc:t,getSheetIndex:r,getCellFormat:n,getKnownFormat:a,getSheetName:i}}function Vs(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:at(t.range),originSheet:at(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0}}function Bs(e,t){return{config:null!=t?t:void 0,lexicalKind:Vt.NameManager,originGridCell:at(e.range),originSheet:at(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1}}function Ws(e,t){var r=St(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:at(r.range),originSheet:at(r.sheet),wrapCellReferences:!1}}!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(Ls||(Ls={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(Ds||(Ds={}));var js=Ls.Red,Hs=Ls.Black,Ks=Ds.DoubleBlack,qs={c:Hs,l:void 0,r:void 0},Js={c:Ks,l:void 0,r:void 0};function Qs(e){return void 0===e.l}function Xs(e){return e.c===js}function Ys(e){return e.c===Hs&&void 0!==e.l}function zs(e){return e.c===Hs&&void 0===e.l}var Zs=qs;function $s(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function el(e,t){return $s(e,t.l,t.key,t.value,t.r)}function tl(e){return Qs(e)?qs:el(Hs,e)}function rl(e,t,r){if(!Qs(r)){var n=e.keyCompare(t,r.key);return n<0?rl(e,t,r.l):n>0?rl(e,t,r.r):r}}function nl(e,t){return!!Qs(t)||!!nl(e,t.l)&&(!!e(t.key,t.value)&&nl(e,t.r))}function al(e,t,r,n,a){if(e===Hs){if(Xs(t)&&Xs(t.l))return $s(js,el(Hs,t.l),t.key,t.value,$s(Hs,t.r,r,n,a));if(Xs(a)&&Xs(a.r))return $s(js,$s(Hs,t,r,n,a.l),a.key,a.value,el(Hs,a.r));if(Xs(t)&&Xs(t.r))return $s(js,$s(Hs,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,$s(Hs,t.r.r,r,n,a));if(Xs(a)&&Xs(a.l))return $s(js,$s(Hs,t,r,n,a.l.l),a.l.key,a.l.value,$s(Hs,a.l.r,a.key,a.value,a.r))}if(e===Ks){if(Xs(a)&&Xs(a.l))return $s(Hs,$s(Hs,t,r,n,a.l.l),a.l.key,a.l.value,$s(Hs,a.l.r,a.key,a.value,a.r));if(Xs(t)&&Xs(t.r))return $s(Hs,$s(Hs,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,$s(Hs,t.r.r,r,n,a))}return $s(e,t,r,n,a)}function il(e,t,r,n,a){return e===js&&t.c===Ks&&Ys(a)?al(Hs,$s(js,tl(t),r,n,a.l),a.key,a.value,a.r):e===js&&Ys(t)&&a.c===Ks?al(Hs,t.l,t.key,t.value,$s(js,t.r,r,n,tl(a))):e===Hs&&t.c===Ks&&Ys(a)?al(Ks,$s(js,tl(t),r,n,a.l),a.key,a.value,a.r):e===Hs&&Ys(t)&&a.c===Ks?al(Ks,t.l,t.key,t.value,$s(js,t.r,r,n,tl(a))):e===Hs&&t.c===Ks&&Xs(a)&&Ys(a.l)?$s(Hs,al(Hs,$s(js,tl(t),r,n,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===Hs&&Xs(t)&&Ys(t.r)&&a.c===Ks?$s(Hs,t.l,t.key,t.value,al(Hs,t.r.l,t.r.key,t.r.value,$s(js,t.r.r,r,n,tl(a)))):(b("calc.common.rbTree.rotate: expected R|B",t.c!==Ks&&a.c!==Ks),$s(e,t,r,n,a))}function ol(e,t,r,n){return function(e){return!Xs(e)||e.l.c!==js&&e.r.c!==js?e:el(Hs,e)}(function e(t,r,n,a){if(Qs(a))return $s(js,qs,r,n,qs);var i=t.keyCompare(r,a.key);return i<0?al(a.c,e(t,r,n,a.l),a.key,a.value,a.r):i>0?al(a.c,a.l,a.key,a.value,e(t,r,n,a.r)):$s(a.c,a.l,r,n,a.r)}(e,t,r,n))}function ul(e,t,r){if(Qs(r))return r;if(r.c===js&&zs(r.l)&&zs(r.r))return 0===e.keyCompare(t,r.key)?qs:r;if(r.c===Hs&&zs(r.l)&&zs(r.r))return 0===e.keyCompare(t,r.key)?Js:r;if(r.c===Hs&&Xs(r.l)&&zs(r.l.l)&&zs(r.l.r)&&zs(r.r)){var n=e.keyCompare(t,r.key);return n<0?$s(Hs,ul(e,t,r.l),r.key,r.value,qs):n>0?r:$s(Hs,qs,r.l.key,r.l.value,qs)}var a=e.keyCompare(t,r.key);if(a<0)return il(r.c,ul(e,t,r.l),r.key,r.value,r.r);if(a>0)return il(r.c,r.l,r.key,r.value,ul(e,t,r.r));b("calc.common.rbTree.rem: expected node",!Qs(r.r));var i=function e(t){if(t.c===js&&zs(t.l)&&zs(t.r))return[t.key,t.value,qs];if(t.c===Hs&&zs(t.l)&&zs(t.r))return[t.key,t.value,Js];if(t.c===Hs&&zs(t.l)&&Xs(t.r))return[t.key,t.value,el(Hs,t.r)];b("calc.common.rbTree.remMin: expected node",!Qs(t.l));var r=e(t.l),n=r[0],a=r[1],i=r[2];return[n,a,il(t.c,i,t.key,t.value,t.r)]}(r.r),o=i[0],u=i[1],c=i[2];return il(r.c,r.l,o,u,c)}function cl(e,t,r){var n=ul(e,t,function(e){return Ys(e)&&e.l.c===Hs&&e.r.c===Hs?el(js,e):e}(r));return b("calc.common.rbTree.remove: expected R|B",n.c===js||n.c===Hs),n}var sl=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(Zs,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t;return null===(t=rl(this,e,this.root))||void 0===t?void 0:t.value},e.prototype.getEntry=function(e){return rl(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return nl(e,this.root)},e.prototype.setValue=function(t,r){return new e(ol(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e(cl(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var n=this.getValue(t);if(void 0!==n)return[this,n];var a=r();return[new e(ol(this,t,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(t){var r=this,n=Zs,a=0;return this.forEach((function(e,i){return t(e,i)&&(n=ol(r,e,i,n),a+=1),!1})),new e(n,a,this.keyCompare)},e}(),ll=function(){function e(e,t,r){R("calc.common.StrictArray2D",e),R("calc.common.StrictArray2D",t);var n=r.length;n<e&&k("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var a=0;a<n;a+=1){var i=r[a].length;i<t&&k("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+i)}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return T("calc.common.StrictArray2D.get",e,this.rows),T("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new dl(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();var fl=function(){function e(e,t,r,n,a,i){R("calc.common.StrictSparseArray2D",e),R("calc.common.StrictSparseArray2D",t),T("calc.common.StrictSparseArray2D",r,e+1),T("calc.common.StrictSparseArray2D",n,t+1);var o=a.length;o<r&&k("calc.common.StrictSparseArray2D: expected elements.length >= "+r+"; given "+o);for(var u=0;u<o;u+=1){var c=a[u].length;c<n&&k("calc.common.StrictSparseArray2D: expected elements["+u+"].length >= "+n+"; given "+c)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseElements=a,this.sparseElement=i}return e.prototype.get=function(e,t){return T("calc.common.StrictSparseArray2D.get",e,this.rows),T("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new hl(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),dl=function(){function e(e,t,r){R("calc.common.NonstrictArray2D",e),R("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return T("calc.common.NonstrictArray2D.get",e,this.rows),T("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=vl(this.rows,this.cols,this.func);return new ll(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),hl=function(){function e(e,t,r,n,a,i){R("calc.common.NonstrictSparseArray2D",e),R("calc.common.NonstrictSparseArray2D",t),T("calc.common.NonstrictSparseArray2D",r,e+1),T("calc.common.NonstrictSparseArray2D",n,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseFunc=a,this.sparseFunc=i}return e.prototype.get=function(e,t){return T("calc.common.NonstrictSparseArray2D.get",e,this.rows),T("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=vl(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new fl(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function vl(e,t,r){for(var n=[],a=0;a<e;a+=1){for(var i=[],o=0;o<t;o+=1)i[o]=r(a,o);n[a]=i}return n}function pl(e,t,r){for(var n=[],a=[],i=0;i<t;i+=1)a[i]=r;for(var o=0;o<e;o+=1)n[o]=a;return n}function ml(e,t,r){return new dl(e,t,(function(e,t){return r}))}var gl,Cl=ci.ResultKind,Sl=ci.ReasonKind,El=ci.notImplemented,yl=ci.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(gl||(gl={}));var Ol=Object(j.a)(Object(j.a)({},Sl),gl);function Al(e){return{config:e}}function kl(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:at(t)}}var bl,Rl,Il,Tl=function(e,t){return I("calc.runtime.interval: end",t),T("calc.runtime.interval: start",e,t),{start:e,end:t}};function Nl(e,t,r){return{kind:Ol.IllFormedFormula,message:e,mode:t,diagnostics:r}}function Fl(e){return{kind:bl.FinalValue,oper:e}}function _l(e){return{kind:bl.PendingValue,anchor:e}}function Ml(e,t){return{kind:bl.Formula,source:e,formula:t}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(bl||(bl={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(Rl||(Rl={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(Il||(Il={}));var wl={kind:Ol.Stopped};function Ll(e,t){return{arity:e,func:t}}function Dl(e,t,r,n,a,i,o,u,c,s,l,f,d,h,v,p,m,g,C,S,E,y){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:i,getUserDefinedFuncLoc:o,getCellValue:u,getCellValues:c,getWorksheetFunc:s,getUserDefinedFunc:l,getNameFormula:f,getCellFormula:d,getUsedRange:h,interruptToken:[Rl.Continue],getHiddenRows:v,isInFilterMode:p,schedulerConfig:null!=E?E:{},limits:null!=y?y:{},setCellValue:m,setCellValues:g,setCellFailure:C,setDynamicPrecs:S}}var Ul,xl=function(e,t,r,n,a,i,o,u,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,wrapCellReferences:u,followHyperlinks:c}};function Pl(e){return{kind:Ol.NameCycle,names:e}}function Gl(e){return{kind:Ol.CellCycle,cells:e}}function Vl(e){return{kind:Ol.PreviousFailure,range:e}}function Bl(e){return{kind:Ol.LimitExceeded,limit:e}}function Wl(e){return{kind:Cl.Paused,reason:Ol.Timeout,resume:e}}function jl(e){if(e.kind===Cl.Failure)return e.reason.kind}function Hl(e,t,r){return{kind:e,machine:t,receiver:r}}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine"}(Ul||(Ul={}));var Kl=Hl(Ul.Next,void 0,void 0);function ql(e,t){return Hl(Ul.CallMachine,e,t)}var Jl={receiveResult:function(e){return ot(e)?Kl:e}};function Ql(){return Jl}var Xl,Yl=function(e){function t(t,r){var n=this.constructor,a=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;a.machine=t,a.stackDepth=r;var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return Object(j.c)(t,e),t}(Error),zl=function(){function e(e){this.numSteps=0,this.stack=[],this.pushFrame(ql(e,{receiveResult:function(e){return e}})),this.transition=Kl}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(n.isRunning)throw e.numCycles+=1,new Yl(n,r);n.isRunning=!0,this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case Ul.Next:return void(this.transition=this.stack[this.stack.length-1].machine.next());case Ul.CallMachine:return this.pushFrame(e),void(this.transition=e.machine.next());default:var t=this.stack.pop();return t?(t.machine.isRunning=!1,void(this.transition=t.receiver.receiveResult(e))):e}}catch(e){return void(this.transition=it(ut(e)))}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r)return this.result=r;if(t())return void(e.numPauses+=1)}}catch(e){return this.result=it(ut(e))}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),Zl=function(){function e(e){this.machines=e,this.isRunning=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?ql(this.machines[this.values.length],this):at(this.values)},e.prototype.receiveResult=function(e){return ot(e)?(this.values.push(e.value),this.next()):e},e}();function $l(e){return{kind:Xl.MachineCall,machine:e}}function ef(e){return"object"==typeof e&&e.kind===Xl.MachineCall}!function(e){e.MachineCall="MachineCall"}(Xl||(Xl={}));var tf=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.isRunning=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.context.coerceOper(kf(this.context,this.toDeref,!0),sf);b("calc.runtime.ArrayMachine.next",!vf(t)&&!pf(t)),hf(t)&&(t=t.opers[0][0]),this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return at(Fe(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return ef(r)?ql(r.machine,this):(this.toDeref=r,Kl)}catch(t){return null!=(e=this.context.handleEvaluationError(t))?e:it(ut(t))}},e.prototype.receiveResult=function(e){return ot(e)?(this.toDeref=e.value,this.next()):e},e}(),rf=ei.gridCell,nf=ri.arrayOper,af=ri.naErrorOper,of=ri.OperKind,uf=of.Number|of.String|of.Boolean|of.Error|of.Rich|of.Array,cf=of.Number|of.String|of.Boolean|of.Error|of.Blank|of.Rich,sf=cf|of.Array;function lf(e,t,r){var n=e+": generated Excel error, type "+t+"; "+r;O.ULS.traceTag(596120270,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Verbose,n)}function ff(e){return"object"==typeof e&&e.kind===of.Error}function df(e){return"object"==typeof e&&e.kind===of.Blank}function hf(e){return"object"==typeof e&&e.kind===of.Array}function vf(e){return"object"==typeof e&&e.kind===of.Missing}function pf(e){return"object"==typeof e&&e.kind===of.Range}function mf(e){return"object"==typeof e&&e.kind===of.Rich}function gf(e){return e.kind===Be.Success?e.value:void 0}function Cf(e,t){switch(e.kind){case Be.Success:return at(Fl(e.value));case Be.Failure:return it(Vl(t))}}function Sf(e,t,r){var n=hf(r)?function(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return pl(r,n,void 0===a[0]?i:a[0][0]);var o,u=[];o=1===e?function(e,r){return r<t?a[0][r]:i}:1===t?function(t,r){return t<e?a[t][0]:i}:function(r,n){return r<e&&n<t?a[r][n]:i};for(var c=0;c<r;c+=1){u.push([]);for(var s=0;s<n;s+=1)u[c][s]=o(c,s)}return u}(r.rows,r.cols,e,t,r.opers,af):pl(e,t,r);return nf(e,t,n)}function Ef(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols,l=vr(r,o),f=vr(n,u);return Yt(l,f,pr(r+a,o+c)-l,pr(n+i,u+s)-f)}function yf(e){return 0===e.length&&k("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(Ef)}function Of(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols,l=pr(r,o),f=pr(n,u),d=vr(r+a,o+c)-l,h=vr(n+i,u+s)-f;if(!(d<=0||h<=0))return Yt(l,f,d,h)}function Af(e){return e.rows*e.cols}function kf(e,t,r){if(!pf(t))return t;if(!ct(t.sheets))return ye;if(!r)return 1===t.ranges.length&&lt(t.ranges[0])?e.dereferenceOper(t,P.All&~of.Range):e.dereferenceOper(t,of.Array);var n=e.dereferenceOper(t,P.All&~(of.Range|of.Array));return hf(n)?af:n}function bf(e){var t=function(e){return e&~(of.Array|of.Range)};return ve(e.minArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)}function Rf(e,t,r,n,a){if("object"!=typeof n)return ml(t,r,n);switch(n.kind){case of.Missing:case of.Blank:return ml(t,r,e.zero);case of.Array:return 0!=(a&of.Array)?ml(t,r,n):function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?ml(e,t,r.get(0,0)):1===r.rows?new dl(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new dl(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new dl(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}(t,r,new ll(n.rows,n.cols,n.opers),af);case of.Range:default:return ml(t,r,n)}}function If(e,t,r,n){for(var a=0,i=0,o=0;o<n.length;o+=1){var u=n[o];hf(u)&&0==(It(t,o,n.length)&of.Array)?(a=pr(a,u.rows),i=pr(i,u.cols)):(a=pr(a,1),i=pr(i,1))}var c=n.map((function(r,n,o){return Rf(e.mathpack,a,i,r,It(t,n,o.length))}));return $l(new tf(e,a,i,(function(e,t){return r(c.map((function(r){return r.get(e,t)})))})))}var Tf=ai.NodeKind,Nf=ai.QualifierKind,Ff=ai.BadType,_f=ri.OperKind,Mf=ri.ErrorType,wf=oi.SignatureType,Lf=oi.SpecialPrecs,Df=oi.getOperatorType,Uf=oi.WorksheetFuncId,xf=oi.getWorksheetFuncType,Pf=ci.operKind,Gf=ci.getArguments,Vf=ci.getArgType,Bf=ci.defaultLiteralVisitor,Wf=ci.defaultFormulaVisitor,jf=ci.dispatch,Hf=ci.startVisit,Kf=ci.isUnqualifiedNameNode,qf={};function Jf(e,t){return{context:e,result:t}}function Qf(e){return function(t){return t.kind===Tf.Literal&&e(t.oper)}}var Xf=Qf((function(e){return Pf(e)===_f.Missing})),Yf=Qf((function(e){return 0!=(Pf(e)&(_f.String|_f.Error|_f.Boolean))}));function zf(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function Zf(e,t){return t!==_f.Range||0!=(e&_f.Range)}function $f(e,t){switch(t.type){case Ff.Sequence:if(i=e.localeInfo,2===(o=t.contents).length&&Kf(o[0])&&ld(i,o[1]))return zf(e,t,Ts.Unsupported_struct_ref);if(null!=function(e,t){if(2!==t.length)return;var r=t[0],n=t[1];if(ld(e,r))return function(e){return e.kind===Tf.Name&&null!=e.qualifier&&e.qualifier.kind===Nf.Ident}(n)?Tf.Name:function(e){return e.kind===Tf.CellRef&&null!=e.qualifier&&e.qualifier.kind===Nf.Sheet&&null==e.qualifier.document}(n)?Tf.CellRef:void 0;if(function(e,t){return t.kind===Tf.Bad&&t.type===Ff.Qualifier&&t.contents.indexOf(e.leftBracket)>=0}(e,r))return Kf(n)?Tf.Name:function(e){return e.kind===Tf.CellRef&&null==e.qualifier}(n)?Tf.CellRef:void 0;return}(e.localeInfo,t.contents))return zf(e,t,Ts.Unsupported_doc_qual);for(var r=0,n=t.contents;r<n.length;r++){var a=n[r];if(a.kind===Tf.Bad)return $f(e,a)}return zf(e,t,Ts.Bad_node);case Ff.Unexpected:switch(t.contents){case")":return zf(e,t,Ts.Unexpected_closing_paren);case e.localeInfo.rightBrace:return zf(e,t,Ts.Unexpected_closing_brace);case e.localeInfo.rightBracket:return zf(e,t,Ts.Unexpected_closing_bracket);default:return zf(e,t,{kind:bs.Unexpected_character,text:t.contents})}case Ff.CellRef:case Ff.Qualifier:return zf(e,t,Ts.Bad_node)}var i,o}function ed(e,t){if(t.kind===Tf.Literal)switch(zf(e,t,Ts.Unclosed_literal,t.isClosed),Pf(t.oper)){case _f.Number:case _f.Boolean:case _f.String:case _f.Error:return;default:return void zf(e,t,Ts.Illegal_array_literal_element)}zf(e,t,Ts.Illegal_array_literal_element)}function td(e,t,r){zf(e,t,Ts.Types_not_related,Zf(_f.Array,r)),zf(e,t,Ts.Unclosed_array,t.isClosed);var n=t.nodes.length>0;if(zf(e,t,Ts.Empty_array_literal,n),!n)return Jf(e,r);for(var a=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var o=t.nodes[i],u=o.length;zf(e,t,Ts.Irregular_array_shape,u===a);for(var c=0;c<u;c+=1)ed(e,o[c])}return Jf(e,r)}function rd(e,t,r){if(e.earlyExit&&!e.isOk())throw qf;switch(t.kind){case Tf.Array:return td(e,t,r);case Tf.Paren:return zf(e,t,Ts.Unclosed_paren,t.isClosed),zf(e,t,Ts.Empty_parenthesis,!Xf(t.node)),rd(e,t.node,r);case Tf.Bad:case Tf.Name:case Tf.CellRef:case Tf.App:case Tf.Literal:var n=od(e,t);return zf(e,t,Ts.Types_not_related,Zf(n.result,r)),n.result=r,n;default:return A("calc.analyze.checker.check: unhandled formula case",t)}}function nd(e,t,r){return Kf(r)?(zf(e,r,Ts.Invalid_binder,!t.contains(r.whole)),t.setValue(r.whole,!0)):(zf(e,r,Ts.Invalid_binder),t)}function ad(e,t,r){var n,a=xf(t),i=a.minArgs,o=a.headTypes,u=a.restTypes,c=a.tailTypes,s=r.args,l=s.length,f=Gf(r),d=f.length;d<i&&zf(e,void 0===(n=s[l-1])?r:n,{kind:Rs.Insufficient_function_arguments,funcId:t});0===u.length&&d>o.length&&zf(e,void 0===(n=s[l-1])?r:n,{kind:Rs.Excess_function_arguments,funcId:t});u.length>1&&d>o.length&&((d-o.length)%u.length>c.length&&zf(e,void 0===(n=s[l-1])?r:n,{kind:Rs.Insufficient_function_arguments,funcId:t}));for(var h=0;h<d;h+=1)rd(e,f[h],Vf(a,h,d));return e.specialDependencies|=a.staticPrecs,function(e,t,r){switch(t){case Uf.LET:case Uf.LETREC:if(!yn(t===Uf.LET?hn.CalcLetFunction:hn.CalcLetRecFunction))return;r.length>=3&&r.length%2!=1&&zf(e,r[r.length-1],{kind:Rs.Insufficient_function_arguments,funcId:t});for(var n=e.localeInfo,a=sl.create(n.stringCompareCI),i=0;i+1<r.length;i+=2)a=nd(e,a,r[i]);return;case Uf.FUN:if(!yn(hn.CalcFunFunctions))return;for(n=e.localeInfo,a=sl.create(n.stringCompareCI),i=0;i<r.length-1;i+=1)a=nd(e,a,r[i])}}(e,t,s),Jf(e,a.returnType)}function id(e,t){zf(e,t,Ts.Unclosed_application,t.isClosed);var r=t.args;if(bt(t.head))return function(e,t,r){var n=Df(t.id),a=r.length,i=a===n.minArgs;zf(e,t,{kind:Rs.Incorrect_number_of_operator_arguments,opId:t.id},i);for(var o=0;o<a;o+=1){var u=r[o];Xf(u)&&(i=!1,zf(e,u,{kind:bs.Missing_operation_argument,opId:t.id})),rd(e,u,Vf(n,o,a))}return i?(e.specialDependencies|=n.staticPrecs,Jf(e,n.returnType)):Jf(e,wf.All)}(e,t.head,r);if(Kf(t.head)){var n=Gt(e.localeInfo,t.head.whole);if(void 0!==n)return ad(e,n,t)}for(var a=0;a<r.length;a+=1)rd(e,r[a],wf.All);var i=t.head,o=od(e,i);return Zf(o.result,_f.Range)||0!=(o.result&(_f.Array|_f.Rich))||zf(e,i,Yf(i)||i.kind===Tf.Array?Ts.Unexpected_application_head:Ts.Unexpected_application_head_with_fix),Jf(e,wf.All)}function od(e,t){if(e.earlyExit&&!e.isOk())throw qf;switch(t.kind){case Tf.App:return id(e,t);case Tf.Array:return td(e,t,_f.Array);case Tf.Bad:return $f(e,t),Jf(e,wf.All);case Tf.CellRef:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==Nf.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?Jf(e,_f.Range):(zf(e,t,Ts.Invalid_unqualified_cell),Jf(e,wf.All)):(zf(e,t,Ts.Invalid_rel_sheet_qualifier_in_cell),Jf(e,wf.All));case Tf.Literal:return zf(e,t,Ts.Unclosed_literal,t.isClosed),Jf(e,Pf(t.oper)|(ff(t.oper)&&t.oper.type===Mf.REF?_f.Range:0));case Tf.Name:return e.locals.allowRelativeQualifier||void 0===t.qualifier||t.qualifier.kind!==Nf.Relative||zf(e,t,Ts.Invalid_rel_sheet_qualifier_in_name),Jf(e,wf.All);case Tf.Paren:return zf(e,t,Ts.Unclosed_paren,t.isClosed),zf(e,t,Ts.Empty_parenthesis,!Xf(t.node)),od(e,t.node);default:return A("calc.analyze.checker.infer: unhandled formula case",t)}}var ud={ok:!0,isOk:sr,collect:function(e,t,r){return!1}};function cd(e,t,r,n){var a,i;void 0===n&&(n=!0);var o={globals:e,locals:t,localeInfo:(i=null===(a=t.config)||void 0===a?void 0:a.localeInfo,null!=i?i:e.config.localeInfo),reportError:r.collect,isOk:function(){return r.isOk(o.errorData)},earlyExit:n,specialDependencies:Lf.None,errorData:r.ok};return o}function sd(e,t){try{return zf(e,t.node,Ts.Empty_formula,!Xf(t.node)),rd(e,t.node,wf.All)}catch(t){return t!==qf&&O.ULS.traceTag(595952020,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.check.runChecker: Exception "+p(t)),Jf(e,wf.All)}}function ld(e,t){if(t.kind!==Tf.Bad||t.type!==Ff.Sequence||3!==t.contents.length)return!1;var r=t.contents[0],n=t.contents[2];return r.kind===Tf.Bad&&r.type===Ff.Unexpected&&r.contents===e.leftBracket&&(n.kind===Tf.Bad&&n.type===Ff.Unexpected&&n.contents===e.rightBracket)}function fd(e){if(e.kind===Tf.Literal&&e.isClosed)switch(Pf(e.oper)){case _f.Number:case _f.Boolean:case _f.String:case _f.Error:return!0;default:return!1}return!1}function dd(e,t,r){var n,a,i=r.head,o=i.kind!==Tf.Operator;if(!r.isClosed||r.args.some((function(r){return!hd(e,t,r,o)})))return!1;if(i.kind===Tf.Operator)return(c=Df(i.id)).minArgs===r.args.length;if(!hd(e,t,i,!1))return!1;if(Kf(i)){var u=Gt(null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,i.whole);if(void 0!==u){var c,s=(c=xf(u)).minArgs,l=c.headTypes,f=c.restTypes,d=c.tailTypes,h=Gf(r).length;if(h<s)return!1;if(0===f.length&&h>l.length)return!1;if(f.length>1&&h>l.length)if((h-l.length)%f.length>d.length)return!1;return function(e,t){switch(e){case Uf.LET:case Uf.LETREC:if(!yn(e===Uf.LET?hn.CalcLetFunction:hn.CalcLetRecFunction))return!0;if(t.length%2!=1)return!1;for(var r=0;r+1<t.length;r+=2)if(!Kf(t[r]))return!1;return!0;case Uf.FUN:return!yn(hn.CalcFunFunctions)||t.slice(0,t.length-1).every(Kf);default:return!0}}(u,r.args)}}return!0}function hd(e,t,r,n){switch(r.kind){case Tf.Literal:return r.isClosed&&(!!n||Pf(r.oper)!==_f.Missing);case Tf.Name:case Tf.CellRef:return t.allowRelativeQualifier||!(void 0!==r.qualifier&&r.qualifier.kind===Nf.Relative);case Tf.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every((function(e){return t=e,n=r.nodes[0].length,t.length===n&&t.every(fd);var t,n}));case Tf.App:return dd(e,t,r);case Tf.Paren:return r.isClosed&&hd(e,t,r.node,!1);case Tf.Bad:return!1;default:return A("calc.analyze.isWF",r)}}var vd=Wf(Bf((function(e){return 1})),(function(e){return 1}),{vArray:function(e){var t=-1;return e.nodes.forEach((function(e){e.forEach((function(e){var r=jf(e,vd);t=Math.max(t,r)}))})),1+t},vRange:function(e){var t=jf(e.ref1,vd),r=jf(e.ref2,vd);return 1+Math.max(t,r)},vBad:function(e){if(e.type===Ff.Sequence){var t=-1;return e.contents.forEach((function(e){var r=jf(e,vd);t=Math.max(t,r)})),1+t}return 1},vCellRef:function(e){var t=-1;if(void 0!==e.qualifier){var r=jf(e.qualifier,vd);t=Math.max(t,r)}return 1+Math.max(t,jf(e.ref,vd))},vParen:function(e){return 1+jf(e.node,vd)},vApp:function(e){var t=-1;return e.args.forEach((function(e){var r=jf(e,vd);t=Math.max(t,r)})),1+t}});var pd,md=[];function gd(e,t,r,n){if(yn(hn.CalcStrictFormulaChecking))if(md.length<10){var a=(i=r.node,Hf(i,vd,-1));md.push(a)}else O.ULS.traceTag(595957962,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+md.join("; ")),md=[];var i,o=function(e,t,r){var n=sd(cd(e,t,ud),r).context.errorData;return Object(j.a)(Object(j.a)({},r),{isWellFormed:n})}(e,t,r);if(!yn(hn.CalcStrictFormulaChecking)){var u=hd(e,t,r.node,!1);if(o.isWellFormed!==u){var c=rr(Jt(Kt(void 0,"Book1"),0),Zt(0,0));O.ULS.traceTag(592995977,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: old isWellFormed = "+u+", new isWellFormed = "+o.isWellFormed+"; operation: "+n+"; anonymize: "+$a(r,Bt(c)))}}return o}var Cd=ai.NodeKind,Sd=ri.OperKind,Ed=oi.OperatorId,yd=oi.getWorksheetFuncType,Od=oi.WorksheetFuncId,Ad=ci.success,kd=ci.failure,bd=ci.operKind,Rd=ci.isSuccess,Id=ci.getArguments,Td=ci.unavailable,Nd=ci.sheetGridRangeAnchor,Fd=ci.createResolutionHandler,_d=ci.createResolver,Md=ci.ResolveReasonKind,wd=ci.isSheetGridRange,Ld=ci.isValidArgsLength,Dd={kind:Us.BadOperation},Ud={kind:Us.BadFormula},xd={getDocumentLoc:function(){return kd(Td(["defaultInferenceGlobals getDocumentLoc"]))},getSheetIndex:function(){return kd(Td(["defaultInferenceGlobals getSheetIndex"]))},getSheetName:function(){return Ad("not used")},getNameLoc:function(){return kd(Td(["defaultInferenceGlobals getNameLoc"]))},getUserDefinedFuncLoc:function(){return kd(Td(["defaultInferenceGlobals getUserDefinedFuncLoc"]))},getSheetRangeIndexes:function(){return Ad(Xt([],0))},getCellFormat:function(){return kd(Td(["defaultInferenceGlobals getCellFormat"]))},getKnownFormat:function(){return kd(Td(["defaultInferenceGlobals getKnownFormat"]))}};function Pd(e){var t,r,n,a,i,o,u,c;return{config:e.config,getDocumentLoc:(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e),null!=r?r:xd.getDocumentLoc),getSheetIndex:(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e),null!=a?a:xd.getSheetIndex),getSheetName:xd.getSheetName,getNameLoc:(o=null===(i=e.getNameLoc)||void 0===i?void 0:i.bind(e),null!=o?o:xd.getNameLoc),getUserDefinedFuncLoc:(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e),null!=c?c:xd.getUserDefinedFuncLoc),getSheetRangeIndexes:xd.getSheetRangeIndexes}}function Gd(e){var t,r,n,a,i,o,u,c,s,l,f,d;return{getDocumentLoc:(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e),null!=r?r:xd.getDocumentLoc),getSheetIndex:(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e),null!=a?a:xd.getSheetIndex),getNameLoc:(o=null===(i=e.getNameLoc)||void 0===i?void 0:i.bind(e),null!=o?o:xd.getNameLoc),getUserDefinedFuncLoc:(c=null===(u=e.getUserDefinedFuncLoc)||void 0===u?void 0:u.bind(e),null!=c?c:xd.getUserDefinedFuncLoc),getCellFormat:(l=null===(s=e.getCellFormat)||void 0===s?void 0:s.bind(e),null!=l?l:xd.getCellFormat),getKnownFormat:(d=null===(f=e.getKnownFormat)||void 0===f?void 0:f.bind(e),null!=d?d:xd.getKnownFormat)}}function Vd(e,t,r,n){return{strongFormat:e,category:t,iformat:r,decimals:n}}var Bd,Wd={Number:1,Currency:2,Accounting:2,Percentage:3,Date:4,Time:5,Fraction:6,Scientific:7,Text:8,Custom:9,Special:9,General:0};!function(e){e[e.Propagate=-1]="Propagate",e[e.Ignore=-2]="Ignore"}(Bd||(Bd={}));var jd=((pd={})[Od.INT]=Bd.Propagate,pd[Od.MOD]=Bd.Propagate,pd[Od.ROUND]=Bd.Propagate,pd[Od.SUM]=Bd.Propagate,pd[Od.TRUNC]=Bd.Propagate,pd[Od.AVERAGE]=Bd.Propagate,pd[Od.MAX]=Bd.Propagate,pd[Od.MEDIAN]=Bd.Propagate,pd[Od.MIN]=Bd.Propagate,pd[Od.ROUNDUP]=Bd.Propagate,pd[Od.ROUNDDOWN]=Bd.Propagate,pd[Od.NPV]=Fs.CoCurrencyDec,pd[Od.PV]=Fs.CoCurrencyDec,pd[Od.FV]=Fs.CoCurrencyDec,pd[Od.PMT]=Fs.CoCurrencyDec,pd[Od.RATE]=Fs.Percentage0,pd[Od.MIRR]=Fs.Percentage0,pd[Od.IRR]=Fs.Percentage0,pd[Od.DATE]=Fs.MMDDYY,pd[Od.TIME]=Fs.HHMMAP,pd[Od.NOW]=Fs.MDYHMS,pd[Od.SLN]=Fs.CoCurrencyDec,pd[Od.SYD]=Fs.CoCurrencyDec,pd[Od.DDB]=Fs.CoCurrencyDec,pd[Od.IPMT]=Fs.CoCurrencyDec,pd[Od.PPMT]=Fs.CoCurrencyDec,pd[Od.TODAY]=Fs.MMDDYY,pd[Od.VDB]=Fs.CoCurrencyDec,pd[Od.DB]=Fs.CoCurrencyDec,pd);var Hd=[["General","Number","Currency","Percentage","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Percentage","Date","Time","Number","Scientific","Text","Custom"],["General","General","Currency","General","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","General","General","Percentage","Percentage","Text","Custom"],["General","General","General","General","General","Date","General","General","Text","Custom"],["General","General","General","General","General","Time","General","General","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]],Kd=[["General","Number","Currency","General","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Number","Date","Time","Fraction","Scientific","Text","Custom"],["General","General","General","Currency","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","Date","Time","Percentage","Scientific","Text","Custom"],["General","General","General","General","General","General","Date","Date","Text","Custom"],["General","General","General","General","General","General","Time","Time","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]];function qd(e,t,r){if(2===t.length)return r(e,eh(e,t[0]),eh(e,t[1]));throw new xs(Ud)}function Jd(e,t,r,n){var a=r.iformat,i=n.iformat,o=r.category,u=n.category,c=Wd[o],s=Wd[u],l=c<=s?t[c][s]:t[s][c],f=Wd[l],d=n.decimals>r.decimals?n.decimals:r.decimals;switch(f){case c:return Vd(!0,o,a,d);case s:return Vd(!0,u,i,d);default:return e.unitlessFormat}}function Qd(e,t,r){return Jd(e,Kd,t,r)}function Xd(e,t,r){var n=t.iformat,a=r.iformat,i=t.category,o=r.category;if(n===a&&i===o&&"Time"===i)return Vd(!0,i,n,0);if("Date"===i&&"Time"===o||"Time"===i&&"Date"===o){var u=e.globals.getKnownFormat(Fs.MDYHMS);if(!Rd(u))throw new xs(u.reason);return Vd(!0,u.value.category,u.value.iformat,u.value.decimals)}return Jd(e,Hd,t,r)}var Yd=function(e){return e.unitlessFormat};function zd(e,t,r){var n=t.iformat;return n===r.iformat?Vd(!0,t.category,n,t.decimals):e.unitlessFormat}function Zd(e,t){return Wd[t]===Wd[e.defaultFormat.category]}var $d=Fd(Ad,(function(e){return kd(Td([e]))}),(function(e,t){return e.kind===Md.NoOriginSheet?kd(Td([t])):kd(e)}));function eh(e,t){switch(t.kind){case Cd.App:var r=t.head;if(bt(r))return function(e,t,r){switch(t){case Ed.Mul:case Ed.Div:return e.multOrDivTainted=!0,qd(e,r.args,Qd);case Ed.Pow:return qd(e,r.args,Qd);case Ed.Add:case Ed.Sub:return qd(e,r.args,Xd);case Ed.Percent:if(1===r.args.length){var n=r.args[0];if(n.kind!==Cd.Literal||"number"!=typeof n.oper)return e.defaultFormat;var a=eh(e,n);return Vd(a.strongFormat,"Percentage",Fs.Percentage,a.decimals)}throw new xs(Ud);case Ed.Pound:case Ed.At:return e.defaultFormat;case Ed.Neg:case Ed.Pos:if(1===r.args.length)return eh(e,r.args[0]);throw new xs(Ud);case Ed.Lt:case Ed.Le:case Ed.Eq:case Ed.Ge:case Ed.Gt:case Ed.Ne:return qd(e,r.args,Yd);case Ed.Isect:case Ed.Union:case Ed.Range:case Ed.Concat:return qd(e,r.args,zd);case Ed.And:case Ed.Or:case Ed.Xor:case Ed.Min:case Ed.Max:case Ed.Dot:throw new xs(Dd);default:return A("calc.analyzer.inferFormat: unexpected operator id",t)}}(e,r.id,t);if(Rt(r)){var n=Gt(e.localeInfo,r.whole);if(void 0!==n){var a=dr(jd[n],Bd.Ignore),i=yd(n),o=Id(t);if(!Ld(i,o.length))throw new xs(Ud);if(n===Od.HYPERLINK&&(e.hyperlinkTainted=!0),a===Bd.Ignore)return e.defaultFormat;if(a===Bd.Propagate){if(0===o.length)return e.defaultFormat;var u=eh(e,o[0]),c=u.iformat,s=u.category,l=u.decimals,f=!Zd(e,s);if(!u.strongFormat&&f)return e.unitlessFormat;for(var d=f,h=1;h<o.length;h+=1){var v=eh(e,o[h]),p=!Zd(e,v.category);if(!v.strongFormat&&p)return e.unitlessFormat;d||(c=v.iformat,s=v.category,l=v.decimals,d=p)}return Vd(!0,s,c,l)}var m=e.globals.getKnownFormat(a);if(!Rd(m))throw new xs(m.reason);return Vd(!0,m.value.category,a,m.value.decimals)}}return eh(e,r);case Cd.Array:return e.defaultFormat;case Cd.CellRef:var g=e.resolver.resolveCellRef(e.locals,t)[1],C=$d(t.ref,g);if(!Rd(C))throw new xs(C.reason);var S=C.value;if(!wd(S))return e.unitlessFormat;var E=Nd(S),y=e.globals.getCellFormat(E);if(!Rd(y))throw new xs(y.reason);var O=y.value.iformat,k=y.value.category;return Vd(!0,k,O,"Date"!==k&&"Time"!==k&&"Text"!==k&&"Custom"!==k&&"Special"!==k?y.value.decimals:0);case Cd.Literal:var b=bd(t.oper);switch(b){case Sd.String:case Sd.Boolean:case Sd.Error:case Sd.Missing:return e.defaultFormat;case Sd.Number:var R=e.mathpack.formatGeneral(e.localeInfo,t.oper,21),I=R.indexOf(".");l=I>=0?R.length-I-1:0;return Vd(!1,e.defaultFormat.category,e.defaultFormat.iformat,l);default:return A("calc.analyze.inferFormat: unexpected literal oper",b)}case Cd.Name:return e.defaultFormat;case Cd.Paren:return eh(e,t.node);case Cd.Bad:throw new xs(Ud);default:return A("calc.analyzer.inferFormat",t)}}function th(e,t,r){try{var n=function(e,t){var r,n;return{globals:Gd(e),locals:t,config:e.config,localeInfo:(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo,null!=n?n:e.config.localeInfo),mathpack:e.config.mathpack,defaultFormat:Vd(!1,"General",Fs.General,0),unitlessFormat:Vd(!0,"General",Fs.General,0),resolver:_d(Pd(e)),multOrDivTainted:!1,hyperlinkTainted:!1}}(e,t),a=eh(n,r);return O.ULS.traceTag(595948253,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Verbose,"calc.analyze.inferFormat: inferred format info = "+a),Ad(Object(j.a)(Object(j.a)({},a),{multOrDivTainted:n.multOrDivTainted,hyperlinkTainted:n.hyperlinkTainted}))}catch(e){return e instanceof xs?(O.ULS.traceTag(595948254,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.inferFormat: inference failed = "+C(e.reason)),e.reason):(O.ULS.traceTag(595948255,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.inferFormat: caught exception = "+p(e)),kd(ut(e)))}}var rh={getSheetName:function(){return it(Lt(["defaultCallbacks getSheetName"]))}};var nh=function(e){this.failure=e},ah=function(){function e(e,t){this.seenUnclosed=!1,this.seenParen=!1,this.seenMissing=!1,this.globals=function(e){var t,r;return{getSheetName:(r=null===(t=e.getSheetName)||void 0===t?void 0:t.bind(e),null!=r?r:rh.getSheetName)}}(e),this.locals=t}return e.prototype.autocorrect=function(e,t){var r=this;if(t>100)return e;switch(e.kind){case D.Literal:return e.isClosed||(this.seenUnclosed=!0),t>=2&&vf(e.oper)&&(this.seenMissing=!0),e;case D.Name:case D.Bad:return e;case D.Array:var n=e.nodes.map((function(e){return e.map((function(e){return r.autocorrect(e,t+1)}))}));return e.isClosed||(this.seenUnclosed=!0),ue(n,e.isClosed,e.label);case D.App:var a=e.head.kind===D.Operator?e.head:this.autocorrect(e.head,t+1),i=e.args.map((function(e){return r.autocorrect(e,t+1)})),o=e.isClosed;return bt(e.head)||e.isClosed||0!==t||this.seenParen||this.seenUnclosed||this.seenMissing||(o=!0),e.isClosed||(this.seenUnclosed=!0),bt(e.head)||(this.seenParen=!0),ce(a,i,o,e.label);case D.Paren:n=this.autocorrect(e.node,t+1);return e.isClosed||(this.seenUnclosed=!0),this.seenParen=!0,n===e.node?e:le(n,e.isClosed,e.label);case D.CellRef:if(this.locals.allowUnqualifiedCell||void 0!==e.qualifier)return e;var u=this.locals.originSheet;if(!ot(u))throw new nh(u);if(void 0===u.value.index)return e;var c=this.globals.getSheetName(u.value.document,u.value.index);if(!ot(c))throw new nh(c);return de(e.ref,J(c.value,void 0),e.label)}},e}();var ih,oh,uh,ch,sh=ri.SpecialPrecs,lh=ri.PrecsBound,fh=ri.precedents;function dh(e){return{checkFormula:function(t,r,n){return gd(e,t,r,null!=n?n:"undefined")},checkFormulaWithDiagnostics:function(t,r,n){return function(e,t,r,n){var a=sd(cd(e,t,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,a=null!=r?r:[];return(n=a[e.label],null!=n?n:a[e.label]=[]).push(t),a}},!1),r).context.errorData;if(!yn(hn.CalcStrictFormulaChecking)){var i=void 0===a,o=hd(e,t,r.node,!1);if(i!==o){var u=rr(Jt(Kt(void 0,"Book1"),0),Zt(0,0));O.ULS.traceTag(592995976,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.analyze.checkFormula: old isWellFormed = "+o+", new isWellFormed = "+i+", new diagnostics = "+JSON.stringify(a)+"; operation: "+n+"; anonymize: "+$a(r,Bt(u)))}}return[Object(j.a)(Object(j.a)({},r),{isWellFormed:void 0===a}),a]}(e,t,r,null!=n?n:"undefined")},autocorrectFormula:function(t,r){return function(e,t,r){try{var n=r.spans,a=r.annotations,i=r.node;return at(re(i=new ah(e,t).autocorrect(i,0),n,a))}catch(e){if(e instanceof nh)return e.failure;throw e}}(e,t,r)},findStaticPrecedents:function(e,t){return fh([],[],sh.All,lh.Upper)},findBestFormat:function(t,r){return th(e,t,r.node)}}}function hh(e){return{kind:ih.RangeValues,arrays:e}}!function(e){e.RangeValues="RangeValues"}(ih||(ih={})),function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.ReadClosure=-2147483640]="ReadClosure",e[e.Conditional=-2147483639]="Conditional",e[e.CallLambda=-2147483638]="CallLambda"}(ch||(ch={}));var vh,ph=(oh=cr(sr,sr)).wrap,mh=oh.unwrap,gh=(uh=cr((function(e){return-e}),(function(e){return-e}))).wrap,Ch=uh.unwrap;function Sh(e){return e>0}function Eh(e){return{kind:e,data:void 0,children:void 0}}function yh(e,t,r){var n=Eh(ch.Array);return n.children=r,n.data={rows:e,cols:t},n}function Oh(e,t,r,n){var a=Eh(ch.Fun);return a.children=n,a.data={arity:e,closureId:t,closedIdents:r},a}function Ah(e,t,r){var n=Eh(ch.Let);return n.children=Object(j.f)(e,[r]),n.data={rec:t},n}function kh(e,t,r,n){var a=Eh(ch.App);return a.children=n,a.data={funName:e,funType:t,isFormulaRoot:r},a}function bh(e,t,r){var n=Eh(ch.Name);return n.data={name:e,qualifier:t},n.children=r,n}function Rh(e,t,r){var n=Eh(ch.Udf);return n.data={name:e,qualifier:t},n.children=r,n}function Ih(e){var t=Eh(ch.ReadStack);return t.data=e,t}function Th(e,t,r,n,a){var i=Eh(ch.Conditional);return i.children=Object(j.f)([n],a),i.data={funName:e,funType:t,isFormulaRoot:r},i}function Nh(e){return"object"!=typeof e||e.kind>0}function Fh(e,t){for(var r,n=0;n<e.length;n+=1){var a=e[n],i=t(a);void 0===r?i!==a&&(r=e.slice(0,n)).push(i):r.push(i)}return void 0!==r?r:e}function _h(e,t){return Fh(e,function(e){return function(t){return Fh(t,e)}}(t))}function Mh(e,t){return t(function(e,t){if(Nh(e))return e;switch(e.kind){case ch.Let:var r=Fh(e.children,t);return r===e.children?e:Ah(r.slice(0,r.length-1),e.data.rec,r[r.length-1]);case ch.App:var n=Fh(e.children,t);return n===e.children?e:kh(e.data.funName,e.data.funType,e.data.isFormulaRoot,n);case ch.Conditional:var a=e.children,i=a[0],o=a.slice(1),u=t(i),c=Fh(o,t);return i===u&&o===c?e:Th(e.data.funName,e.data.funType,e.data.isFormulaRoot,u,c);case ch.Fun:var s=t(e.children);return s===e.children?e:Oh(e.data.arity,e.data.closureId,e.data.closedIdents,s);case ch.Array:var l=_h(e.children,t);return l===e.children?e:yh(e.data.rows,e.data.cols,l);case ch.Name:return(f=void 0===e.children?void 0:t(e.children))===e.children?e:bh(e.data.name,e.data.qualifier,f);case ch.Udf:var f;return(f=void 0===e.children?void 0:t(e.children))===e.children?e:Rh(e.data.name,e.data.qualifier,f);case ch.CellRef:case ch.ReadStack:case ch.ReadClosure:return e}}(e,(function(e){return Mh(e,t)})))}var wh=j.a,Lh=ai.NodeKind,Dh=ci.getArguments,Uh=ri.arrayOper,xh=oi.WorksheetFuncId,Ph=oi.OperatorId,Gh=ci.success,Vh=ve(1,[x.Number|x.String|x.Boolean|x.Rich|x.Error|x.Blank],[x.Number|x.String|x.Boolean|x.Rich|x.Error|x.Blank|x.Missing|x.Array|x.Range],[],P.All,G.None,V.Allow3dRef),Bh=bf(rt(xh.IF)),Wh=bf(rt(xh.CHOOSE));function jh(e){return"object"!=typeof e||Nh(e)&&("object"!=typeof(t=e)||t.kind===of.Error||t.kind===of.Array||t.kind===of.Rich);var t}var Hh=function(){function e(e){this.id=e,this.slots=[],this.idToSlot={}}return e.prototype.mapStackId=function(e){var t=this.idToSlot[e];return null!=t?t:this.idToSlot[e]=this.slots.push(e)-1},e}(),Kh=sl.create((function(e,t){return e-t}));function qh(e,t,r,n,a,i,o){switch(void 0===i&&(i=!1),void 0===o&&(o=!1),a.kind){case Lh.Array:var u=a.nodes.map((function(a){return a.map((function(a){return qh(e,t,r,n,a)}))}));return N=(T=u).length,F=void 0===T[0]?0:T[0].length,T.every((function(e){return e.every(jh)}))?Uh(N,F,T):yh(N,F,T);case Lh.App:var c=a.head;if(bt(c)){var s=Dh(a).map((function(a){return qh(e,t,r,n,a)})),l=oi.getOperatorType(c.id);return kh(ph(c.id),l,o,s)}if(Rt(c))if(null!=(S=Gt(e.localeInfo,c.whole))){var d=void 0;switch(S){case xh.LET:case xh.LETREC:if(!yn(S===xh.LET?hn.CalcLetFunction:hn.CalcLetRecFunction))break;d=function(e,t,r,n,a,i){if(a.args.length>=3&&a.args.length%2==1&&a.args.every((function(e,t,r){return t===r.length-1||t%2==1||Rt(e)}))){for(var o=t,u=a.args.length>>1,c=[],s=0;s+1<a.args.length;s+=2){var l=a.args[s].whole;e.annotations[a.args[s].label]=ie(l)}if(i){for(s=0;s+1<a.args.length;s+=2){l=a.args[s].whole;var f=r+s/2;o=o.setValue(l,[n.getCount(),f])}for(s=0;s+1<a.args.length;s+=2)c.push(qh(e,o,r+u,n,a.args[s+1]))}else for(s=0;s+1<a.args.length;s+=2){l=a.args[s].whole,f=r+s/2;c.push(qh(e,o,f,n,a.args[s+1])),o=o.setValue(l,[n.getCount(),f])}return Ah(c,i,qh(e,o,r+u,n,a.args[a.args.length-1]))}}(e,t,r,n,a,S===xh.LETREC);break;case xh.FUN:if(!yn(hn.CalcFunFunctions))break;d=function(e,t,r,n,a){var i=a.args.slice(0,a.args.length-1);if(a.args.length>0&&i.every(Rt)){var o=new Hh(n.getCount()+1),u=n.setValue(o.id,o),c=i.reduceRight((function(t,n,a){var i=n.whole;return e.annotations[n.label]=ie(i),t.setValue(i,[u.getCount(),r+a])}),t),s=qh(e,c,r+i.length,u,a.args[a.args.length-1]),l=o.slots.map((function(e){return r-e-1}));return Oh(i.length,o.id,l,s)}}(e,t,r,n,a);break;case xh.IF:d=function(e,t,r,n,a){var i=a.args;return 3===i.length?Th(gh(xh.IF),Bh,!1,qh(e,t,r,n,i[0]),[qh(e,t,r,n,i[1]),qh(e,t,r,n,i[2])]):2===i.length?Th(gh(xh.IF),Bh,!1,qh(e,t,r,n,i[0]),[qh(e,t,r,n,i[1]),!1]):void 0}(e,t,r,n,a);break;case xh.CHOOSE:if(yn(hn.CalcWorksheetFunctions)&&yn(hn["OfficeVSO:3852168_CalcCGCHOOSE"]))d=function(e,t,r,n,a){var i=a.args;if(i.length>=1)return Th(gh(xh.CHOOSE),Wh,!1,qh(e,t,r,n,i[0]),i.slice(1).map((function(a){return qh(e,t,r,n,a)})))}(e,t,r,n,a);else{var h=Dh(a).map((function(a){return qh(e,t,r,n,a)})),v=oi.getWorksheetFuncType(S);d=kh(gh(S),v,!1,h)}break;case xh.IFERROR:case xh.IFNA:d=function(e,t,r,n,a,i){var o=a.args;if(2===o.length){var u=Ih(0),c=Th(gh(xh.IF),Bh,!1,kh(gh(i),oi.getWorksheetFuncType(i),!1,[u]),[qh(e,t,r+1,n,o[1]),u]);return Ah([qh(e,t,r,n,o[0])],!1,c)}}(e,t,r,n,a,S===xh.IFERROR?xh.ISERROR:xh.ISNA);break;default:s=Dh(a).map((function(a){return qh(e,t,r,n,a)})),l=oi.getWorksheetFuncType(S);d=kh(gh(S),l,!1,s)}if(void 0!==d)return e.annotations[c.label]=ae(S),d}return function(e,t,r,n,a){var i=Dh(a).map((function(a){return qh(e,t,r,n,a)}));return kh(gh(xh._UDF),Vh,!1,[qh(e,t,r,n,a.head,!0)].concat(i))}(e,t,r,n,a);case Lh.Paren:return qh(e,t,r,n,a.node);case Lh.Name:if(null==a.qualifier){var p=t.getEntry(a.whole);if(void 0!==p){e.annotations[a.label]=ie(p.key);var m=p.value,g=m[0],S=m[1];if(g===n.getCount())return Ih(r-S-1);var E=n.getValue(g+1);return b("calc.runtime.formulaToTermIR: closure",void 0!==E),function(e,t){var r=Eh(ch.ReadClosure);return r.data=[e,t],r}(E.id,E.mapStackId(S))}}return function(e,t,r){return!t||void 0!==e.qualifier&&e.qualifier.kind!==_.Document&&e.qualifier.kind!==_.Ident||(r=Rh(e.whole,e.qualifier,r)),bh(e.whole,e.qualifier,r)}(a,i,void 0);case Lh.CellRef:return k=a.ref,R=a.qualifier,(I=Eh(ch.CellRef)).data={ref:k,qualifier:R},I;case Lh.Literal:return a.oper;case Lh.Bad:var y="calc.runtime.compile: unexpected bad node "+C(a);return O.ULS.assertTag(595980820,f.LogCategory.msoulscat_ES_EWAJS,!1,y);default:return A("calc.runtime.compile",a)}var k,R,I,T,N,F}var Jh=((vh={})[Ph.At]=xh.SINGLE,vh[Ph.Pound]=xh.ANCHORARRAY,vh[Ph.Dot]=xh._FV,vh);var Qh=function(e){if(!Nh(e)&&e.kind===ch.App&&Sh(e.data.funName)){var t=Jh[mh(e.data.funName)];if(void 0!==t)return kh(gh(t),oi.getWorksheetFuncType(t),e.data.isFormulaRoot,e.children)}return e};var Xh;function Yh(e,t){return function(e){return"__compiledFormulaBrand__"===e.kind}(t)?t.term:A(e+": expected known compiled formula type; given "+C(t),t)}function zh(e,t,r){var n,a,i=null!=(a=null===(n=t.config)||void 0===n?void 0:n.localeInfo)?a:e.config.localeInfo,o=sl.create(i.stringCompareCI),u=wh([],r.annotations),c=qh({globals:e,locals:t,localeInfo:i,annotations:u},o,0,Kh,r.node,void 0,!0),s=Mh(c,Qh);return Gh(function(e,t,r){return Object(j.a)(Object(j.a)({kind:"__compiledFormulaBrand__"},e),{annotations:t,term:r})}(r,u,s))}function Zh(e){return{compileFormula:function(t,r){return zh(e,t,r)}}}function $h(e){return 0===e.length&&k("calc.runtime.unevaluated: expected nonempty array"),{kind:Xh.Unevaluated,anchors:e}}!function(e){e.Unevaluated="Unevaluated"}(Xh||(Xh={}));var ev=Ut;function tv(e){throw new ev(e)}function rv(e,t,r){var n;switch(r.kind){case Xh.Unevaluated:if(t.map.getCount()+1>(null!=(n=e.globals.limits.maxCellChain)?n:1/0))return it(Bl(Il.CellChain));var a=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,t,r,!0)}));return ql(new Zl(a),Ql());default:return it(r)}}function nv(){return ge([],[],G.None,W.Lower)}function av(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function iv(e,t){return e<t?-1:e===t?0:1}function ov(e,t){return"string"==typeof e?"string"!=typeof t?1:iv(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function uv(e,t){var r;return 0!==(r=iv(e.name,t.name))?r:av(e.path,t.path,iv)}function cv(e,t){return{current:e,map:t}}var sv=cv(void 0,sl.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=ov(e.sheet.index,t.sheet.index))?r:uv(e.sheet.document,t.sheet.document)})));function lv(e,t){return{current:e,map:t}}var fv=lv(void 0,sl.create((function(e,t){var r;return 0!==(r=iv(e.name,t.name))||0!==(r=av(e.scope.index,t.scope.index,ov))?r:uv(e.scope.document,t.scope.document)})));var dv=function(){function e(e,t,r,n){this.context=e,this.previousVisitedCells=t,this.cell=r,this.isPrecedent=n,this.isRunning=!1,this.locals=void 0}return e.prototype.visitAnchor=function(e){var t=St(e.source.range),r=this.previousVisitedCells.map.getValue(t);if(null!=r){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+C(t)+"; given "+C(r));return O.ULS.assertTag(595980812,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.locals={cell:t,cycle:void 0,previous:this.previousVisitedCells.current,source:e.source,precedents:nv()},this.locals},e.prototype.unVisitAnchor=function(){var e=this.locals;return this.locals=void 0,e},e.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===Be.Failure)return e;var t=e.value;if(t.kind===bl.FinalValue)return at(t.oper);var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===Be.Failure){var n="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return O.ULS.assertTag(595980813,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=r.value;if(null==a){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+C(t.anchor)+") != null");return O.ULS.assertTag(595980814,f.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i,o,u,c,s,l,d=this.visitAnchor(a);return ql(this.context.createFormulaEvaluationMachine(this.context,(u=d.source,c=St(u.range),s=at(c.range),l=at(c.sheet),xl(u,s,l,u.kind===Vt.Range,s,l,u.kind===Vt.Cell,!1,at(!1))),d.precedents,(i=this.previousVisitedCells,b("calc.runtime.appendVisitedCell",(o=d).previous===i.current),cv(o,i.map.setValue(o.cell,o))),a.formula),this)},e.prototype.receiveResult=function(e){return ot(e)?this.receiveSuccess(e):this.receiveFailure(e)},e.prototype.receiveSuccess=function(e){var t=e.value;if("object"==typeof t&&(t.kind===x.Range||t.kind===x.Missing)){var r="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+C(t));return O.ULS.assertTag(595980815,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=this.unVisitAnchor();if(null==n){r="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return O.ULS.assertTag(595980816,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}return this.writeResult(n.source,e,n.precedents),e},e.prototype.receiveFailure=function(e){var t=e.reason;if(t.kind===Xh.Unevaluated){var r="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+C(t));return O.ULS.assertTag(595980817,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=this.unVisitAnchor();if(null==n){r="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return O.ULS.assertTag(595980818,f.LogCategory.msoulscat_ES_EWAJS,!1,r)}var a=t.kind===Ol.PreviousFailure&&void 0!==n.cycle?it(n.cycle):e;return this.writeResult(n.source,a,n.precedents),this.isPrecedent?it(Vl(n.source.range)):a},e.prototype.writeResult=function(e,t,r){switch(t.kind){case Be.Success:this.setCellValue(e,t.value,r);break;case Be.Failure:this.context.globals.setCellFailure(e.range,t.reason,r)}this.context.globals.setDynamicPrecs(e.range,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,a=df(t)?n:t;if(e.kind===Vt.Cell){if(hf(a)){var i=void 0===a.opers[0]?be:a.opers[0][0],o=df(i)?n:i;return this.context.globals.setCellValue(e.range,o,r)}return this.context.globals.setCellValue(e.range,a,r)}var u=e.range.range,c=Sf(u.rows,u.cols,a).opers,s=function(e){return df(e)?n:e},l=c.map((function(e){return e.map(s)}));return this.context.globals.setCellValues(e.range,l,r)},e}();function hv(e,t,r,n){return new dv(e,t,r,n)}function vv(e,t){for(var r=Cv(e),n=[],a=0;a<t.length;a+=1)n.push(hv(r.machineContext,sv,t[a],!1));return new Ev(r,n)}function pv(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Cr()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function mv(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=Cr()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:Math.min(e.endTimeMs,t)}}var gv={kind:Ol.Timeout};function Cv(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Cr()>=e}},machineContext:Sv(e)}}function Sv(e){return{globals:e,resolver:Ua(e),parser:ms(e),analyzer:dh(e),createCellEvaluationMachine:hv,createFormulaEvaluationMachine:Ip,createLambdaEvaluationMachine:Tp}}var Ev=function(){function e(e,t){I("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new zl(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===Rl.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(mv(e));return r instanceof Array?Promise.resolve(r):new Promise((function(r){return e.scheduleFunction((function(){return r(t.evaluateAsync(e))}))}))}catch(e){return Promise.reject(it(e))}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===Rl.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var a=t.evaluate(n);return a instanceof Array?a:Wl((function(t){return r(void 0!==t?t:mv(e))}))};return r(mv(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var n=this.machineRuntimes[this.results.length].run(r);if(!n)return gv;this.pushResult(n)}return this.results}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+p(e);return O.ULS.assertTag(595980807,f.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.pushResult=function(e){return this.results.push(e),Kl},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push(it(wl))},e}(),yv=ei.sheetIndex,Ov=ri.OperKind,Av=ri.rangeSeqOper,kv=ri.ErrorType,bv=ri.valueErrorOper,Rv=ri.nullErrorOper,Iv=oi.OperatorId,Tv=ci.operKind,Nv=ci.isSheetIndex,Fv=ci.isDocumentLocEqual;function _v(e,t){switch(e){case Iv.Eq:return 0===t;case Iv.Ne:return 0!==t;case Iv.Lt:return t<0;case Iv.Gt:return t>0;case Iv.Le:return t<=0;case Iv.Ge:return t>=0}}function Mv(e,t,r){return _v(e,t-r)}function wv(e,t,r,n){return _v(t,e.stringCompareCI(r,n))}function Lv(e,t,r,n){return _v(t,e.compare(r,n))}function Dv(e,t,r){if(Nv(t.sheets))if(Nv(r.sheets))if(Fv(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return yv(t.sheets.document,t.sheets.index);n="different sheet, range1 = "+C(t)+", range2 = "+C(r);lf(e,kv.VALUE,n)}else{var n="different document, range1 = "+C(t)+", range2 = "+C(r);lf(e,kv.VALUE,n)}else lf(e,kv.VALUE,"3D reference, range2 = "+C(r));else lf(e,kv.VALUE,"3D reference, range1 = "+C(t))}function Uv(e,t,r,n){void 0===n&&(n=!1);var a,i,o,u=e.config.mathpack;if(1===r.length){var c=r[0];switch(t){case Iv.Percent:return u.percent(c);case Iv.Neg:return u.neg(c);case Iv.Pos:return c;default:var s="calc.runtime.applyOperator: "+("bad application of "+t+" to 1 argument");return O.ULS.assertTag(593372496,f.LogCategory.msoulscat_ES_EWAJS,!1,s)}}if(2===r.length){c=r[0];var l=r[1];switch(t){case Iv.Add:var d=u.add(c,l);return n&&"number"==typeof d?u.checkAlmostCancellation(c,d):d;case Iv.Sub:d=u.sub(c,l);return n&&"number"==typeof d?u.checkAlmostCancellation(c,d):d;case Iv.Mul:return u.mul(c,l);case Iv.Div:return u.div(c,l);case Iv.Pow:return u.power(c,l);case Iv.Concat:return(c+l).substring(0,32767);case Iv.Eq:case Iv.Ne:case Iv.Lt:case Iv.Le:case Iv.Gt:case Iv.Ge:return function(e,t,r,n){var a=e.config,i=a.localeInfo,o=a.mathpack,u=Tv(r),c=Tv(n);if(u!==c){if(u===Ov.Blank)switch(c){case Ov.Number:return Lv(o,t,o.zero,n);case Ov.String:return wv(i,t,"",n);case Ov.Boolean:return Mv(t,!1,n)}if(c===Ov.Blank)switch(u){case Ov.Number:return Lv(o,t,r,o.zero);case Ov.String:return wv(i,t,r,"");case Ov.Boolean:return Mv(t,r,!1)}return _v(t,u-c)}switch(u){case Ov.Number:return Lv(o,t,r,n);case Ov.String:return wv(i,t,r,n);case Ov.Boolean:return Mv(t,r,n);case Ov.Blank:return _v(t,0);default:return!1}}(e,t,c,l);case Iv.Range:return function(e,t){var r=Dv("calc.runtime.applyRangeOp",e,t);if(null==r)return bv;var n=[Ef(yf(e.ranges),yf(t.ranges))];return Av(r,n)}(c,l);case Iv.Isect:return function(e,t){var r=Dv("calc.runtime.applyIsectOp",e,t);if(null==r)return bv;for(var n=[],a=0;a<e.ranges.length;a+=1)for(var i=0;i<t.ranges.length;i+=1){var o=Of(e.ranges[a],t.ranges[i]);null!=o&&n.push(o)}if(0===n.length){var u="empty intersection, range1 = "+C(e)+", range2 = "+C(t);return lf("calc.runtime.applyIsectOp",kv.NULL,u),Rv}return Av(r,n)}(c,l);case Iv.Union:return null==(o=Dv("calc.runtime.applyUnionOp",a=c,i=l))?bv:Av(o,a.ranges.concat(i.ranges));case Iv.And:return c&&l;case Iv.Or:return c||l;case Iv.Xor:return c!==l;case Iv.Min:return u.cond2(c,l)<=0?c:l;case Iv.Max:return u.cond2(c,l)>=0?c:l;default:var h="calc.runtime.applyOperator: "+("bad application of "+t+" to 2 arguments");return O.ULS.assertTag(593372497,f.LogCategory.msoulscat_ES_EWAJS,!1,h)}}var v="calc.runtime.applyOperator: "+("bad application of "+t+" to "+r.length+" arguments");return O.ULS.assertTag(593372498,f.LogCategory.msoulscat_ES_EWAJS,!1,v)}function xv(e,t,r,n){if(r.kind===w.Abs)return r;var a=Jr(e,r.index,n)-t;return a===r.index?r:Y(w.Rel,a)}function Pv(e,t,r){var n=xv(e.row,t.row,r.row,1<<20),a=xv(e.col,t.col,r.col,16384);return n===r.row&&a===r.col?r:Z(n,a,r.label)}function Gv(e,t,r){switch(r.kind){case M.Error:return r;case M.Single:return Pv(e,t,r);case M.Range:var n=Pv(e,t,r.ref1),a=Pv(e,t,r.ref2);return n===r.ref1&&a===r.ref2?r:$(n,a,r.label);case M.Row:var i=xv(e.row,t.row,r.row1,1<<20),o=xv(e.row,t.row,r.row2,1<<20);return i===r.row1&&o===r.row2?r:ee(i,o,r.label);case M.Col:var u=xv(e.col,t.col,r.col1,16384),c=xv(e.col,t.col,r.col2,16384);return u===r.col1&&c===r.col2?r:te(u,c,r.label)}}function Vv(e,t,r){if(mt(e,t))return r;var n,a,i=(n=r.node,a=Gv.bind(void 0,e,t),function e(t){switch(t.kind){case D.Name:case D.Literal:case D.Bad:return t;case D.Array:return ue(r=t.nodes.map((function(t){return t.map(e)})),t.isClosed,t.label);case D.App:return ce(t.head.kind===D.Operator?t.head:e(t.head),t.args.map(e),t.isClosed,t.label);case D.Paren:return(r=e(t.node))===t.node?t:le(r,t.isClosed,t.label);case D.CellRef:var r;return(r=a(t.ref))===t.ref?t:de(r,t.qualifier,t.label)}}(n));return i===r.node?r:Object(j.a)(Object(j.a)({},r),{node:i})}var Bv=ei.sheetGridCell,Wv=ei.sheetGridRange,jv=ri.OperKind,Hv=ri.ErrorType,Kv=ri.refErrorOper,qv=ri.valueErrorOper,Jv=ri.arrayOper,Qv=ci.ResultKind,Xv=ci.isGridCell,Yv=ci.isSheetIndex,zv=ci.getArgType;function Zv(e,t){var r=t.map.getValue(e);if(void 0!==r)return tv(function(e,t){for(var r=[],n=Gl(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n}(r,t.current))}function $v(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===Qv.Failure)return tv(n.reason);var a=n.value;if(a.kind===bl.FinalValue)return a.oper;Zv(a.anchor,e.visitedCells),r.push(a.anchor)}function ep(e,t,r,n){var a;if(e.precedents.cells.push(t),!n||Af(t.range)<=16)a=t;else{var i=e.globals.getUsedRange(t.sheet),o=void 0;ot(i)?o=null==i.value?void 0:i.value.range:tv(i.reason);var u=void 0===o?void 0:Of(t.range,zt(0,0,o.row+o.rows,o.col+o.cols));if(void 0===u)return new fl(t.range.rows,t.range.cols,0,0,[],De);a=Wv(t.sheet,u)}var c=e.globals.getCellValues(a);if(c.kind===Qv.Failure)return tv(c.reason);var s=r.length,l=function(e,t,r,n,a){var i=[],o=n.length,u=0;b("calc.runtime.deference: readIntoArray2D number of rows",o===r.rows);for(var c=0;c<o;c+=1){i.push([]);var s=n[c].length;b("calc.runtime.deference: readIntoArray2D number of cols",s===r.cols),u=0===c?s:vr(s,u);for(var l=0;l<s;l+=1){var f=n[c][l];bl.FinalValue===f.kind?i[c][l]=f.oper:(Zv(f.anchor,e.visitedCells),b("calc.runtime.deference: readIntoArray2D correct sheet",pt(f.anchor.sheet,t.sheet)),a.push(f.anchor),i[c][l]=Kv)}}return new fl(t.range.rows,t.range.cols,o,u,i,De)}(e,t,a.range,c.value,r);return s===r.length?l:void 0}function tp(e,t,r){var n,a=ep(e,t,r,!1);if(null!=a)return Jv(a.rows,a.cols,a.rows===a.denseRows&&a.cols===a.denseCols?a.denseElements:vl((n=a).rows,n.cols,n.get.bind(n)))}function rp(e,t,r,n){if(0!=(r&jv.Range))return t;if("object"!=typeof t||t.kind!==jv.Range)return t;var a=t.sheets;if(!Yv(a))return lf("calc.runtime.dereference",Hv.REF,"3D range, oper = "+C(t)),Kv;if(1!==t.ranges.length)return lf("calc.runtime.dereference",Hv.VALUE,"union range, oper = "+C(t)),qv;var i=t.ranges[0];if(0!=(r&cf)){if(Xv(i))return $v(e,Bv(a,i),n);if(e.locals.implicitIntersect&&!yn(hn.CalcSupportDynamicArrays)&&!yn(hn.CalcPreventSpillingHack)){var o=e.locals.originGridCell;if(!ot(o))return tv(o.reason);var u=function(e,t){var r=e.row,n=e.col,a=t.row,i=t.col,o=t.rows,u=t.cols,c=a<=r&&r<a+o,s=i<=n&&n<i+u;return c&&s?rf(r,n):c&&1===u?rf(r,i):s&&1===o?rf(a,n):void 0}(o.value,i);return null==u?(lf("calc.runtime.dereference",Hv.VALUE,"empty intersection, oper = "+C(t)),qv):$v(e,Bv(a,u),n)}return tp(e,Wv(a,i),n)}return 0!=(r&jv.Array)?tp(e,Wv(a,i),n):(lf("calc.runtime.dereference",Hv.VALUE,"bad target type "+r),qv)}function np(e,t,r){var n=[],a=rp(e,t,r,n);if(null==a){if(n.length>0)return tv($h(n));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+C(t);return O.ULS.assertTag(595980819,f.LogCategory.msoulscat_ES_EWAJS,!1,i)}return a}function ap(e,t,r){for(var n=[],a=0;a<t.length;a+=1){var i=rp(e,t[a],zv(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return tv($h(n))}var ip=ri.OperKind,op=ri.valueErrorOper,up=ri.arrayOper,cp=ci.operKind,sp=ci.notImplemented;function lp(e,t){return 0!=(t&ip.Number)?e.zero:0!=(t&ip.String)?"":0==(t&ip.Boolean)&&op}function fp(e,t,r){var n=function e(t,r,n){var a=t.config,i=a.localeInfo,o=a.mathpack;if("number"==typeof r){if(0!=(n&ip.Number))return r;if(0!=(n&ip.String)){return o.formatGeneral(i,r,20)}return 0!=(n&ip.Boolean)?0!==o.cond(r):0!=(n&ip.Array)?up(1,1,[[r]]):op}if("string"==typeof r){if(0!=(n&ip.String))return r;if(0!=(n&ip.Number)){if(0===r.length)return op;var u=i.parseNumber(r);if(Ft(u))return u;throw new ev(sp(["string -> number coercion: "+gi(r)]))}return 0!=(n&ip.Boolean)?0===i.stringCompareCI(r,i.trueName)||0!==i.stringCompareCI(r,i.falseName)&&op:0!=(n&ip.Array)?up(1,1,[[r]]):op}if("boolean"==typeof r)return 0!=(n&ip.Boolean)?r:0!=(n&ip.Number)?r?o.one:o.zero:0!=(n&ip.String)?r?i.trueName:i.falseName:0!=(n&ip.Array)?up(1,1,[[r]]):op;if(0!=(n&r.kind))return r;switch(r.kind){case ip.Error:return r;case ip.Missing:return 0!=(n&ip.Blank)?ri.blankOper:lp(o,n);case ip.Blank:return lp(o,n);case ip.Rich:return e(t,r.getFallback(),n);default:return op}}(e,t,r);return ff(n)&&!ff(t)&&lf("calc.runtime.coerceOper",n.type,"kind = "+cp(t)),n}var dp,hp=function(){function e(e,t){void 0===t&&(t=ye),this._fields=e,this._fallback=t,this.kind=x.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}(),vp=function(){function e(e,t,r,n){this.arity=e,this.kind=x.Rich,this.locals=t,this.env=r,this.term=n}return e.prototype.getFallback=function(){return ye},e.prototype.getField=function(e){},e}();function pp(e,t){return b("calc.runtime.lambdaCall",t.length===e.arity),{kind:dp.LambdaCall,lambda:e,args:t}}function mp(e){return"object"==typeof e&&e.kind===dp.LambdaCall}!function(e){e.LambdaCall="LambdaCall"}(dp||(dp={}));var gp=function(){function e(e){this.kind=x.Rich,this.arity=e.arity,this.func=e.func}return e.prototype.getFallback=function(){return k("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return k("calc.runtime.UdfOper.getField")},e}(),Cp=function(){function e(e,t,r,n,a,i){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.usage=i;var o=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return r.special|=G.RefStyle,o},mathpack:e.globals.config.mathpack},this.mathpack=this.config.mathpack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return ot(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return ot(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return ot(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return ot(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return ot(e)?e.value:tv(e.reason)},enumerable:!0,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=rt(e),n=t.some((function(e){return"object"==typeof e&&e.kind===x.Range}))?t.slice(0):t;return ap(this,n,r),this.handleLambda(this.dispatchFunction(gh(e),r,!1,n))},e.prototype.applyLambda=function(e,t){return this.handleLambda(pp(e,t))},e.prototype.handleEvaluationError=function(e){if(e instanceof ev)return rv(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if(Sh(e))return Uv(this.globals,mh(e),t,r);var n=Ch(e);if(n===we._UDF){if(t[0]instanceof vp){var a=t[0];return t.length-1!==a.arity?be:pp(a,t.slice(1))}if(t[0]instanceof gp){var i=t[0];if(t.length-1!==i.arity)return ye;var o=i.func(this,t.slice(1));if("object"==typeof o&&o.kind===x.Error){var u="UDF function return value";lf("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",o.type,u)}return o}return t.length>0&&ff(t[0])?t[0]:Oe}var c=this.globals.getWorksheetFunc(n);if(c.kind===Be.Failure)return tv(c.reason);var s=c.value;if(null==s){u="nonexistent worksheet function "+n;return lf("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",pe.NAME,u),Ae}var l=s(this,t);if("object"==typeof l&&l.kind===x.Error){u="worksheet function "+n+" return value";lf("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",l.type,u)}return l},e.prototype.handleLambda=function(e){return mp(e)?$l(this.context.createLambdaEvaluationMachine(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e.lambda,e.args)):e},e.prototype.dispatchFunction=function(e,t,r,n){var a=this;if(!Tt(t,n.length)){var i=JSON.stringify(t),o="calc.runtime.FunctionDispatcher.dispatchFunction: "+(m="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+i);return O.ULS.assertTag(593372499,f.LogCategory.msoulscat_ES_EWAJS,!1,o)}for(var u=n.length,c=P.None,s=0;s<u;s+=1){var l=n[s],d=Nt(l);0==(d&It(t,s,u))&&(c|=d),pf(l)&&0==(t.flags&V.Allow3dRef)&&!ct(l.sheets)&&(c|=d)}if(c===P.None)return this.applyOperatorOrFunction(e,n,r);if(0!=(c&x.Array)){return If(this,t,(function(r){return a.handleLambda(a.dispatchFunction(e,t,!1,r))}),n)}c&=~x.Array;var h=[];for(s=0;s<u;s+=1){var v=n[s];if(0!=(c&Nt(v))){var p=It(t,s,u);if(Nt(v=this.coerceOper(v,p))===x.Error&&0==(p&x.Error))return v;if(pf(v)&&0==(t.flags&V.Allow3dRef)&&!ct(v.sheets)){var m="3D reference, oper = "+C(v);return lf("calc.runtime.FunctionDispatcher.dispatchFunction",pe.VALUE,m),ye}}h[s]=v}return this.applyOperatorOrFunction(e,h,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return ot(t)?fr(t.value)?void 0:t.value:tv(t.reason)},e.prototype.getNameFormula=function(e,t){var r=this,n=wa((function(e){r.precedents.names.push(e);var t=r.globals.getNameFormula(e);return ot(t)?[e,t.value]:tv(t.reason)}),(function(e){}),(function(e,t){return e.kind===Ta.NoOriginSheet?void 0:tv(e)}))(e,this.context.resolver.resolveName(this.locals,fe(t,e))[1]);if(null!=n){var a=n[0],i=n[1];if(null!=i)return[a,i.node]}},e.prototype.getCellRef=function(e,t,r,n){var a={originGridCell:at(r.range),originSheet:at(r.sheet),wrapCellReferences:n};return wa((function(e){return Me(e.sheet,e.range)}),(function(e){}),(function(e,t){return e.kind===Ta.NoOriginSheet?void 0:tv(e)}))(e,this.context.resolver.resolveCellRef(a,de(t,e))[1])},e.prototype.dereferenceOper=function(e,t){return np(this,e,t)},e.prototype.dereferenceOpers=function(e,t){ap(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return ot(t)?this.getAvailableFormula(e):tv(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return ot(r)?(this.precedents.special|=G.OwnDocSheets,null==r.value?void 0:Jt(e,r.value)):tv(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=G.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return ot(t)?t.value.position:tv(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=G.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return ot(t)?t.value.sheets:tv(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var a=[],i=[],o=function(o){var c=e[o];if(!pf(c))return i.push(c),"continue";for(var s=[],l=function(e){var r=ep(n,e,a,!0);void 0!==r&&s.push(t(r,e))},f=u.getSheetRangeIndexes(c.sheets),d=function(e){for(var t=Jt(c.sheets.document,f[e]),n=function(e){var n=c.ranges[e];if(!r)return l(tr(t,n)),"continue";var a=u.globals.getHiddenRows(t,n.row,n.row+n.rows);if(!ot(a))return{value:tv(a.reason)};var i=a.value;if(0===i.length)return l(tr(t,n)),"continue";for(var o=function(e,r){var a=zt(e,n.col,r-e,n.cols);l(tr(t,a))},s=0;s<i.length;s+=1){var f=i[s],d=f.start,h=f.end,v=0===s?n.row:i[s-1].end;b("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",v<=d&&d<h&&h<=n.row+n.rows),v!==d&&o(v,d);var p=zt(d,n.col,h-d,n.cols);u.precedents.cells.push(tr(t,p))}var m=i[i.length-1].end;m!==n.row+n.rows&&o(m,n.row+n.rows)},a=0;a<c.ranges.length;a+=1){var i=n(a);if("object"==typeof i)return i}},h=0;h<f.length;h+=1){var v=d(h);if("object"==typeof v)return v}i.push({kind:ih.RangeValues,arrays:s})},u=this,c=0;c<e.length;c+=1){var s=o(c);if("object"==typeof s)return s.value}return a.length>0?tv($h(a)):i},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,sr,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new hl(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,a){var i=e.get(n,a),o=rr(t.sheet,Zt(t.range.row+n,t.range.col+a));return[i,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var a=this.context.parser.parseFormula(Oi(r.lexicalKind,t,{refStyle:e}),n);if(!ot(a))return a;var i=this.context.analyzer.checkFormula(r,a.value,"indirect");return st(i)?at(i):it(Nl("ill-formed indirect formula","indirect"))},e.prototype.coerceOper=function(e,t){return fp(this.globals,e,t)},e.prototype.getBinaryOperator=function(e){var t=this,r=tt(e),n=[!1,!1];return function(a,i){n[0]=a,n[1]=i,ap(t,n,r);var o=t.dispatchFunction(ph(e),r,!1,n);return b("calc.runtime.FunctionDispatcher.getBinaryOperator",!mp(o)&&!ef(o)),o}},e.prototype.getUnaryOperator=function(e){var t=this,r=tt(e),n=[!1];return function(a){n[0]=a,ap(t,n,r);var i=t.dispatchFunction(ph(e),r,!1,n);return b("calc.runtime.FunctionDispatcher.getUnaryOperator",!mp(i)&&!ef(i)),i}},e.prototype.isInFilterMode=function(e){this.precedents.special|=G.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if("object"==typeof n&&n.kind===x.Range)for(var a=0,i=this.getSheetRangeIndexes(n.sheets);a<i.length;a++){var o=i[a],u=this.globals.isInFilterMode(Jt(n.sheets.document,o));if(!ot(u))return tv(u.reason);if(u.value)return!0}}return!1},e.prototype.formatFormula=function(e,t){var r=rr(e.source.range.sheet,t),n=this.context.parser.formatFormula(ki(e.source,r,{refStyle:this.config.refStyle}),Vv(Ct(e.source.range.range),t,e.formula));return ot(n)?n.value:tv(n.reason)},e}(),Sp=[void 0,Ae],Ep=[void 0,Oe],yp=function(){function e(){}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?tv(El(["LETREC cycle"])):this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),e}(),Op=sl.create((function(e,t){return e-t})),Ap={kind:ch.CallLambda};var kp,bp,Rp=function(){function e(e,t,r,n,a,i,o,u,c,s,l){var f=this;this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.stackEnv=i,this.closureEnv=o,this.usage=u,this.target=c,this.isLambda=s,this.isRunning=!1,this.cellEvaluator=wa((function(e){return Me(e.sheet,e.range)}),(function(e){var t="error ref, qualifier = "+C(e.data.qualifier);return lf("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",pe.REF,t),Oe}),(function(e,t){if(e.kind===Ta.NoOriginSheet){var r="error ref, no sheet, qualifier = "+C(t.data.qualifier);return lf("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",pe.REF,r),Oe}return tv(e)})),this.udfEvaluator=function(e,t,r){return wa((function(e){if(e.length>1){return lf("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",pe.NAME,"UDF resolution, ambiguous name"),Ae}var t=f.globals.getUserDefinedFunc(e[0]);return ot(t)?new gp(t.value):tv(t.reason)}),void 0!==r?function(){return r}:function(e){var t="UDF resolution, qualifier = "+C(e.data.qualifier);return lf("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",pe.NAME,t),Ae},(function(e,t){return tv(e)}))(e,t)},this.term=l,this.continuation=[]}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!0,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof ev)return rv(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return ot(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if(Nh(this.term)){var e=this.continuation;if(0===e.length){var t=np(this,this.term,this.target),r=fp(this.globals,t,this.target);return this.precedents.bound=W.Exact,!yn(hn.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==Vt.Cell||!hf(r)||1===r.rows&&1===r.cols?at(r):it(El(["spilling"]))}var n=e[e.length-1];return this.applyContinuation(this.term,n)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case ch.App:var n=t.holeIndex,a=r.children.length;return(i=t.locals)[n]=e,n+1<a?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case ch.Conditional:var i;if(0===(n=t.holeIndex)){var o=Ch(r.data.funName),u=o===we.IF?x.Boolean:x.Number,c=np(this,e,u);if(hf(c))return t.locals=[c],this.nextHoleTransition(t,r.children[n+1]);if(mf(c))return it(El(["IF/CHOOSE with a rich value condition"]));if(c=fp(this.globals,c,u),o===we.IF&&"boolean"==typeof c)return this.popContextTransition(r.children[c?1:2]);if(o===we.CHOOSE&&"number"==typeof c){var s=this.context.globals.config.mathpack.fix(c);if(s<1||s>r.children.length-1){var l="CHOOSE; out of bounds option = "+C(s);return lf("calc.runtime.FormulaEvaluationMachine.applyContinuation",pe.VALUE,l),this.popContextTransition(ye)}return this.popContextTransition(r.children[s])}return b("calc.runtime.FormulaEvaluationMachine.applyContinuation",ff(c)),this.popContextTransition(c)}return(i=t.locals)[n]=e,n+1<r.children.length?this.nextHoleTransition(t,r.children[n+1]):this.dispatchFunction(i,i,r.data);case ch.Name:var f=this.popContextTransition(e),d=t.locals;return this.locals=d.locals,this.visitedNames=d.visitedNames,f;case ch.Let:n=t.holeIndex;var h=r.children.length-1;if(n>=h){f=this.popContextTransition(e),d=t.locals;return this.stackEnv.length=d.stackEnvLen,f}if(r.data.rec){var v=this.stackEnv.length-h+n;this.stackEnv[v].value=e,this.stackEnv[v]=e}else this.stackEnv.push(e);return this.nextHoleTransition(t,r.children[n+1]);case ch.Array:var p=np(this,e,uf),m=r.data,g=m.rows,S=m.cols,E=t.holeIndex,y=E%S,O=S===y+1,k=(E-y)/S,R=t.locals;if(R[k][y]=fp(this.globals,p,uf),g===k+1&&O)return this.popContextTransition(Fe(g,S,R));var I=O?k+1:k,T=O?0:y+1;return this.nextHoleTransition(t,r.children[I][T]);case ch.CallLambda:f=this.popContextTransition(e),d=t.locals;return this.locals=d.locals,this.stackEnv.length=d.stackEnvLen,this.closureEnv=d.closureEnv,this.usage.lambdaDepth-=1,f;default:return A("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},e.prototype.reduceFormula=function(e){var t=this;switch(e.kind){case ch.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case ch.App:var r=e.data.funName;if(!Sh(r)){var n=Ch(r);if(n!==we._UDF){var a=this.globals.getWorksheetFunc(n);if(a.kind===Be.Failure)return tv(a.reason)}}return 0===e.children.length?mp(i=new Cp(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(r,e.data.funType,e.data.isFormulaRoot,[]))?this.evaluateLambdaTransition(void 0,i):ef(i)?this.evaluateMachineTransition(void 0,i):this.updateTermTransition(i):this.pushContextTransition(e,e.children[0],[]);case ch.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case ch.Let:return this.evaluateLetTransition(e);case ch.Name:var i;if(void 0!==(i=this.evalNameTerm(e))[0]){var o=i[0],u=i[1],c=i[2],s=this.pushContextTransition(e,u,{locals:this.locals,visitedNames:this.visitedNames});return this.locals=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=at(n);else{var a=t.originSheet;if(!ot(a))return tv(a.reason);r=vt(a.value.document,n.document)?a:at(n)}var i=t.originGridCell;return xl(e,i,r,t.calcingArray,i,r,!1,!0,at(!1))}(Ht(o),this.locals),this.visitedNames=c,s}var l=i[1];return this.updateTermTransition(l);case ch.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case ch.ReadStack:return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(f=this.stackEnv[this.stackEnv.length-1-e.data])),this.updateTermTransition(f instanceof yp?f.value:f);case ch.ReadClosure:var f;return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(h=this.closureEnv.getValue(e.data[0]))),b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==(f=h[e.data[1]])),f instanceof yp&&(f=f.value,h[e.data[1]]=f),this.updateTermTransition(f);case ch.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case ch.Fun:var d=e.data.closedIdents.map((function(e){var r=t.stackEnv[t.stackEnv.length-1-e];return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",void 0!==r),r})),h=this.closureEnv.setValue(e.data.closureId,d);return this.updateTermTransition(new vp(e.data.arity,this.locals,h,e.children));default:return A("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=r.funName,a=r.funType,i=r.isFormulaRoot;ap(this,t,a);var o=new Cp(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,t);return mp(o)?this.evaluateLambdaTransition(e,o):ef(o)?this.evaluateMachineTransition(e,o):this.popContextTransition(o)},e.prototype.pushContextTransition=function(e,t,r){var n=function(e,t){return{context:e,holeIndex:0,locals:t}}(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),ql(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n,a,i,o,u=t.lambda,c=t.args,s=this.continuation[this.continuation.length-1-(void 0!==e?1:0)],l=(null===(n=s)||void 0===n?void 0:n.context.kind)===ch.CallLambda?s:void 0;return this.usage.lambdaCalls[0]+1>(null!=(a=this.globals.limits.maxLambdaCalls)?a:1/0)?tv(Bl(Il.LambdaCalls)):void 0===l&&this.usage.lambdaDepth+1>(null!=(i=this.globals.limits.maxLambdaDepth)?i:1/0)?tv(Bl(Il.LambdaDepth)):(void 0!==e&&this.continuation.pop(),void 0!==l?(o=this.updateTermTransition(u.term),this.stackEnv.length=l.locals.stackEnvLen):(o=this.pushContextTransition(Ap,u.term,{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv}),this.usage.lambdaDepth+=1),(r=this.stackEnv).push.apply(r,c),this.closureEnv=u.env,this.locals=function(e,t){return xl(e.locals.lexicalSource,e.locals.originGridCell,e.locals.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.locals.wrapCellReferences,at(!1))}(u,this.locals),this.usage.lambdaCalls[0]+=1,o)},e.prototype.evaluateLetTransition=function(e){var t=this.pushContextTransition(e,e.children[0],{stackEnvLen:this.stackEnv.length});if(e.data.rec)for(var r=e.children.length-1,n=0;n<r;n+=1)this.stackEnv.push(new yp);return t},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){return this.term=e,Kl},e.prototype.getNameFormulaAsTerm=function(e){this.precedents.names.push(e);var t=this.globals.getNameFormula(e);if(t.kind===Be.Failure)return tv(t.reason);var r=t.value;return null!=r?Yh("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",r):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);return void 0!==n?tv(function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),Pl(r)}(n,r.current)):this.visitedNames.map.getCount()+1>(null!=(t=this.globals.limits.maxNameChain)?t:1/0)?tv(Bl(Il.NameChain)):function(e,t){var r={name:t,previous:e.current};return lv(r,e.map.setValue(t,r))}(this.visitedNames,e)},e.prototype.nameEvaluator=function(e,t,r){var n=this,a=void 0!==r?function(){return[void 0,r]}:function(e){var t="name resolution; qualifier = "+C(e.data.qualifier);return lf("calc.runtime.FormulaEvaluationMachine.evalName",pe.NAME,t),Sp};return wa((function(t){var r=n.getNameFormulaAsTerm(t);return void 0===r?a(e):[t,r,n.checkForNameCycle(t)]}),a,(function(e,t){if(e.kind===Ta.NoOriginSheet){var r="name resolution, no sheet; qualifier = "+C(t.data.qualifier);return lf("calc.runtime.FormulaEvaluationMachine.evalName",pe.REF,r),Ep}return tv(e)}))(e,t)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,fe(e.data.name,e.data.qualifier))[1];return this.nameEvaluator(e,t,e.children)},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,de(e.data.ref,e.data.qualifier))[1];return this.cellEvaluator(e,t)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,fe(e.data.name,e.data.qualifier))[1];return this.udfEvaluator(e,t,e.children)},e}();function Ip(e,t,r,n,a){return new Rp(e,t,r,n,fv,[],Op,{lambdaCalls:[0],lambdaDepth:0},sf,!1,Yh("calc.runtime.createFormulaEvaluationMachine",a))}function Tp(e,t,r,n,a,i,o,u){return b("calc.runtime.createLambdaEvaluationMachine",u.length===o.arity),new Rp(e,t,r,n,a,Object(j.f)(u),o.env,i,P.All,!0,o.term)}function Np(e,t,r){var n,a=Cv(e),i=nv(),o=Ip(a.machineContext,t,i,sv,r),u=new Ev(a,[o]),c=pv(null!=(n=t.schedulerConfig)?n:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:Wl((function(r){return e(t.resume(r))}))}(u.evaluateSync(c))}function Fp(e){return{evalFormula:function(t,r){return Np(e,t,r)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=vv(e,t),n=pv(e.schedulerConfig);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=vv(e,t),n=pv(e.schedulerConfig);return r.evaluateAsync(n)}(e,t)}}}(bp=kp||(kp={})).DerefOperKind=ih,bp.machine=i;var _p=function(e,t){return{functionId:e,functionName:t}},Mp=function(e,t){return{errorType:e,errorName:t}},wp=function(e,t,r,n,a,i,o,u,c,s,l,f,d,h){var v=[];return t.forEach((function(e,t){"string"==typeof e?v.push(Mp(t,e)):lr(e)&&v.push(e)})),{worksheetFunctionNames:e,errorTypeNames:v,errorNames:[],trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:u,leftBracket:c,rightBracket:s,decimalSeparator:l,listSeparator:f,columnSeparator:d,rowSeparator:h}};function Lp(e,t,r,n){return"number"==typeof n&&"string"==typeof r?{iformat:e,category:r,decimals:n}:"number"==typeof r?{iformat:e,category:t,decimals:r}:k("calc.calc.numberFormat")}var Dp=function(e,t){return{sheetId:e,sheetName:t}},Up={kind:"Blank"},xp=function(e){return{kind:"Error",type:e}},Pp=function(e){return{kind:"Rich",fields:e}};function Gp(e){return"object"==typeof e?e.kind:typeof e}var Vp=function(e,t){return{row:e,column:t}},Bp=function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}},Wp=function(e,t,r,n,a){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}},jp=function(e,t,r,n,a){return void 0===a&&(a="Inferred"),{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}};function Hp(e,t,r,n){return jp(e,t,r,n,"CellFormula")}function Kp(e,t,r){return jp(void 0,e,t,r,"ArrayFormula")}function qp(e,t,r,n){return jp(e,t,r,n,"Value")}var Jp=function(e,t,r,n,a){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}},Qp=function(e,t,r,n){return Jp(e,t,void 0,r,n)};function Xp(e,t,r,n){return Jp(e,void 0,t,r,n)}var Yp=function(e,t){return{isSpilled:e,formulaBarText:t}},zp=function(e,t,r){return{range:e,data:t,fromStateId:r}};function Zp(e,t){return zp(e,t,void 0)}function $p(e,t){return zp(e,void 0,t)}var em=function(e,t){return{sheetId:e,usedRange:t}},tm=function(e){return{kind:"NamedValue",value:e}},rm=function(e){return{kind:"NamedFormula",formulaBarText:e}},nm=function(e){return{kind:"NamedRange",range:e}},am=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},im=function(e,t){return{name:e,data:t}},om=function(e,t,r){return{scope:e,objects:t,fromStateId:r}};function um(e,t){return om(e,t,void 0)}function cm(e){return om(e,void 0,void 0)}function sm(e,t){return om(e,void 0,t)}var lm=function(e,t,r,n,a,i){return void 0===i&&(i="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}};function fm(e,t,r,n){return lm(e,t,void 0,r,n,"CellFormula")}function dm(e,t,r,n){return lm(e,t,r,void 0,n,"Value")}function hm(e,t,r,n){return lm(e,t,void 0,r,n,"Inferred")}var vm,pm,mm,gm,Cm=function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}},Sm=function(e,t,r,n,a){return{isExact:e,iformat:t,hasHyperlink:r,category:n,decimals:a}},Em=function(e,t,r){return{formulaBarText:e,value:t,format:r}},ym=function(e,t){return{range:e,data:t}},Om=function(e,t){return{range:e,data:t}},Am=function(e,t,r){return{range:e,task:t,reason:r}},km=function(e,t,r,n,a,i){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:[]}},bm=function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}},Rm=function(e,t){return{name:e,param:t}},Im=function(e,t,r,n,a,i,o,u,c,s){return{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:s,sampleRecalcStatisticsRate:u,sampleWorkbookStatisticsRate:n,rngSeed:r,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o,runExperiments:c}};function Tm(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function Nm(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]}function Fm(e,t){var r=Nm(),n=r[0],a=r[1],i=a[0],o=a[1],u=setTimeout(t,Math.max(0,e));return[n,[function(e){clearTimeout(u),i(e)},function(e){clearTimeout(u),o(e)}]]}function _m(e,t,r){var n=Fm(e,(function(){return s(t())})),a=n[0],i=n[1],o=i[0],u=i[1],c=!1;function s(e){u(e),c=!0}var l=Promise.resolve().then((function(e){return r(s,(function(){return c}))}));return Tm(Promise.race([a,l]),o)}function Mm(e,t){var r;return new Promise((function(n,a){Promise.resolve(t).then((function t(i){if(void 0!==i){r=i;try{Promise.resolve(e(r)).then(t,a)}catch(e){a(e)}}else n(r)}),a)}))}function wm(e,t){return{setMessageListeners:function(t){e.onmessage=function(e){return t.onMessage(e.data)},e.onmessageerror=function(e){return t.onMessageError(e.data)}},postMessage:e.postMessage.bind(e),close:t.bind(e)}}function Lm(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(vm||(vm={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(pm||(pm={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(mm||(mm={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(gm||(gm={}));var Dm,Um={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function xm(e){return[e.name,e.message,e.stack]}function Pm(e){var t,r=e[0],n=e[1],a=e[2],i=Um[r];return null!=i?t=new i(n):(t=new Error(n)).name=r,void 0!==a&&(t.stack=a),t}function Gm(e){return Lm(e)?[Dm.Error,xm(e)]:[Dm.Unknown,e]}function Vm(e,t,r,n){var a=new Error(e);return a.stack=e+"\n    at "+t+":"+r+":"+n,a}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(Dm||(Dm={}));function Bm(e){var t=e.message.indexOf("__START_ERROR__"),r=e.message.indexOf("__END_ERROR__");return t>=0&&r>=0?Pm(JSON.parse(e.message.substring(t+"__START_ERROR__".length,r))):null!=e.error?e.error:Vm(e.message,e.filename,e.lineno,e.colno)}function Wm(e,t,r,n){var a=e[t];null!=a&&(delete e[t],a[r](n))}function jm(e,t,r,n,a,i){var o={port:t,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==o)throw new Error("endpoint is closed");return o}function c(e,t,r,n,a){var i;try{i=u()}catch(e){return Promise.reject(e)}var o=i.lastAppId+1,c=[mm.App,o,e,t,r,a],s=Fm(n,(function(){l(c,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),f=s[0],d=s[1];i.callbacks[o]=d,i.lastAppId=o;try{i.port.postMessage(c)}catch(e){l(c,e)}return f}function s(e,t,r,n){var a=u(),i=[mm.App,-1,e,t,r,n];try{a.port.postMessage(i)}catch(e){l(i,e)}}function l(e,t){var r=e[1],n=e[5];null!=o&&(r>=0&&Wm(o.callbacks,r,gm.Rejected,t),n?g(r>=0?pm.PostCallError:pm.PostNotifyError,t,!0):(r<0&&g(pm.PostNotifyError,t,!1),c("","",[],Math.max(C.callTimeout,C.initTimeout),!0).catch((function(e){}))))}function f(e){var t=e[1],r=e[2],n=e[3],a=e[4],i=e[5];if(null!=o)if(""!==r||""!==n){var u=Promise.resolve().then((function(e){if(null!=o){var t=r,i=n,u=o.modules[t],c=null!=u?u[i]:void 0;if(null==c)throw new Error("method "+t+"."+i+" has not been exported");return c.apply(u,a)}}));t>=0?u.then((function(e){return d(t,gm.Fulfilled,e,i)}),(function(e){return d(t,gm.Rejected,e,i)})):u.catch((function(e){g(pm.UnhandledNotifyError,function(e,t,r){var n=t+"."+r+".notify: ";if(Lm(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var a=new Error(n+e);return a.stack=void 0,a}(e,r,n),!1)}))}else d(t,gm.Fulfilled,void 0,i)}function d(e,t,r,n){if(null!=o){var a=[mm.Result,e,t,Gm(r),n];try{o.port.postMessage(a)}catch(e){h(a,e)}}}function h(e,t){var r=e[1],n=e[4];null!=o&&(n?g(pm.PostResultError,t,!0):d(r,gm.Rejected,Gm(t),!0))}function v(e){var t=e[1],r=e[2],n=e[3];null!=o&&Wm(o.callbacks,t,r,function(e){return e[0]===Dm.Unknown?e[1]:Pm(e[1])}(n))}function m(e){if(void 0===e&&(e=!0),null!=o){var t=o.port,r=o.callbacks;if(o=void 0,e)try{t.postMessage([mm.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var a in r)Wm(r,Number(a),gm.Rejected,n);try{t.close()}catch(e){}if(null!=i)try{i(C)}catch(n){var u=p(n);console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function g(e,t,r){if(null!=o){var n=void 0;try{a(C,{kind:e,closing:r,error:t})||(n=[t])}catch(t){n=[t]}if(r&&m(),null!=n){var i=p(n[0]);console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+i)}}}var C={workerKind:e,initTimeout:r,callTimeout:n,setExports:function(e,t){return u().modules[e]=t},getImports:function(e,t){var r={};return t.forEach((function(t){return r[t]=function(e,t){var r={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var i=null!=r.callTimeout?r.callTimeout:C.callTimeout;return c(e,t,n,i,r.isCritical)},notify:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];s(e,t,n,r.isCritical)}};return r}(e,t)})),r},close:m,dispatchError:g};return o.port.setMessageListeners({onMessage:function(e){switch(e[0]){case mm.App:return f(e);case mm.Result:return v(e);case mm.Close:return m(!1);default:return A("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var t=new Error("failed to send "+e[0]+" message");switch(e[0]){case mm.App:return l(e,t);case mm.Result:return h(e,t);case mm.Close:return;default:return A("calc.worker.createPortEndpoint.onMessageError",e)}}}),C}function Hm(e,t,r){var n=this,a=null!=t.initTimeout?t.initTimeout:6e4,i=null!=t.callTimeout?t.callTimeout:3e4;return _m(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(o,u){return Object(j.b)(n,void 0,void 0,(function(){function n(e){return function(t,r){return s?null!=e.onError&&(e.onError(t,r),!0):(o(r.error),!0)}}function c(e){return function(t){s&&null!=e.onClosed&&e.onClosed(t)}}var s,l,f;return Object(j.d)(this,(function(o){switch(o.label){case 0:return s=!1,l=jm(e,r.outside,a,i,n(t.outside),c(t.outside)),f=jm(e,r.inside,a,i,n(t.inside),c(t.inside)),u()||null==t.inside.onInit?[3,2]:[4,t.inside.onInit(f)];case 1:o.sent(),o.label=2;case 2:return u()||null==t.outside.onInit?[3,4]:[4,t.outside.onInit(l)];case 3:o.sent(),o.label=4;case 4:return s=!0,[2,l]}}))}))}))}function Km(){return"undefined"!=typeof MessageChannel}var qm=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return k("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var Jm,Qm;function Xm(){if(null==li.getCalcAbsUrl()){return O.ULS.traceTag(595907587,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function Ym(e){setTimeout((function(){try{e.terminate()}catch(e){}}),100)}function zm(){var e={};for(var t in hn){var r=hn[t];null!=r&&(e[r]=yn(r))}return e}var Zm=((Jm={})[vm.FunctionCall]=function(){return!0},Jm[vm.MessageChannel]=Km,Jm[vm.Dedicated]=Xm,Jm);function $m(e){return Zm[e]()}var eg=((Qm={})[vm.FunctionCall]=function(e){return Hm(vm.FunctionCall,e,(t=new qm,r=new qm,t.open(r),{outside:t,inside:r}));var t,r},Qm[vm.MessageChannel]=function(e){if(!Km())return k("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var t=function(){var e=new MessageChannel;return{outside:wm(e.port1,e.port1.close.bind(e.port1)),inside:wm(e.port2,e.port2.close.bind(e.port1))}}();try{return Hm(vm.MessageChannel,e,t)}catch(e){try{t.outside.close()}catch(e){}throw e}},Qm[vm.Dedicated]=function(e){var t=this,r=e.outside,n=e.inside,a=e.initTimeout,i=e.callTimeout,o=n.scriptName;if(null==o)return k("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=li.getCalcAbsUrl();if(!Xm()||null==u)return k("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=a?a:6e4,s=null!=i?i:3e4;return _m(c,(function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")}),(function(e,n){return gn("calc.worker.createDedicatedWorker (total)",(function(){return Object(j.b)(t,void 0,void 0,(function(){function t(t){return Object(j.b)(this,void 0,void 0,(function(){function a(t,n){return o?null!=r.onError&&(r.onError(t,n),!0):(e(n.error),!0)}function i(e){o&&null!=r.onClosed&&r.onClosed(e)}var o,l,f,d,h;return Object(j.d)(this,(function(e){switch(e.label){case 0:o=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),l=new Worker(t),d=wm(l,(function(){return Ym(l)})),f=jm(vm.Dedicated,d,c,s,a,i),l.onerror=function(e){var r;e.preventDefault(),r=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+t):Bm(e),f.dispatchError(pm.UnhandledError,r,!o)},function(e,t){var r={shipAssertTag:function(e,r,n,a){try{t.ULS.shipAssertTag(e,r,n,a)}catch(e){}},assertTag:function(e,r,n,a){try{t.ULS.assertTag(e,r,n,a)}catch(e){}},traceTag:function(e,r,n,a){try{t.ULS.traceTag(e,r,n,a)}catch(e){}},debugTraceTag:function(e,r,n,a){try{t.ULS.debugTraceTag(e,r,n,a)}catch(e){}}};e.setExports("",r)}(f,O),n()?[3,3]:[4,gn("calc.worker.createDedicatedWorker (inside)",(function(){var e=f.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:s,calcAbsUrl:u,features:zm()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==r.onInit?[3,5]:[4,r.onInit(f)];case 4:e.sent(),e.label=5;case 5:return o=!0,[2,f];case 6:throw h=e.sent(),null!=f?f.close():null!=l&&Ym(l),h;case 7:return[2]}}))}))}var a,i,l,d;return Object(j.d)(this,(function(e){switch(e.label){case 0:n=o+(/\.min\.js$/.test(r=u)?".min.js":".js"),c=r.lastIndexOf("/"),a=r.substring(0,c+1)+n,i="calc.worker.createDedicatedWorker: workerUrl = "+a,O.ULS.traceTag(595907588,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,i),e.label=1;case 1:e.trys.push([1,6,,7]),l=new Blob(['importScripts("'+encodeURI(a)+'");'],{type:"application/javascript"}),d=URL.createObjectURL(l),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,t(d)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(d),[7];case 5:return[3,7];case 6:return e.sent(),O.ULS.traceTag(595881991,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+a+". Attempting with string url instead..."),[2,t(a)];case 7:return[2]}var r,n,c}))}))}))}))},Qm);function tg(e,t){return eg[e](t)}function rg(e,t){return Object(j.b)(this,void 0,void 0,(function(){var r,n,a,i,o;return Object(j.d)(this,(function(u){switch(u.label){case 0:r=0,u.label=1;case 1:if(!(r<e.length))return[3,6];if(!$m(n=e[r]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,tg(n,t)];case 3:return[2,u.sent()];case 4:return a=u.sent(),i=p(a),o="calc.worker.tryCreateWorker: starting "+n+" worker threw "+i,O.ULS.traceTag(595907598,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,o),[3,5];case 5:return r+=1,[3,1];case 6:return[2,void 0]}}))}))}function ng(){setTimeout((function(){try{self.close()}catch(e){}}),100)}function ag(e,t,r,n){var a=t.initTimeout,i=t.callTimeout,o=t.calcAbsUrl,u=t.features;return Object(j.b)(this,void 0,void 0,(function(){var t,c,s,l,f=this;return Object(j.d)(this,(function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,_m(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(e,t){return Object(j.b)(f,void 0,void 0,(function(){function c(t,r){return l?null!=n.onError&&(n.onError(t,r),!0):(e(r.error),!0)}function s(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,f,d,h,v,p;return Object(j.d)(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=wm(self,ng),f=jm(vm.Dedicated,d,a,i,c,s),h=function(e){var t=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);function r(e){return"["+(new Date).toISOString()+"] "+e}return{shipAssertTag:function(e,n,a,i){if(t.shipAssertTag.notify(e,n,a,r(i)),!a)throw new Error("shipAssertTag: "+e+" "+n+" "+i)},assertTag:function(e,n,a,i){if(t.assertTag.notify(e,n,a,r(i)),!a)throw new Error("assertTag: "+e+" "+n+" "+i)},traceTag:function(e,n,a,i){t.traceTag.notify(e,n,a,r(i))},debugTraceTag:function(e,n,a,i){t.debugTraceTag.notify(e,n,a,r(i))}}}(f),v=function(e){return!0===u[e]},r.config.initCalc(h,v,o),t()||null==n.onInit?[3,3]:[4,n.onInit(f)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw p=e.sent(),null!=f?f.close():ng(),p;case 5:return[2]}}))}))})).then((function(e){return[gm.Fulfilled,e]}),(function(e){return[gm.Rejected,e]}))];case 1:t=d.sent(),c=t[0],s=t[1],l=[mm.Result,e,c,Gm(s),!0];try{self.postMessage(l)}catch(e){throw ng(),e}return[2]}}))}))}var ig=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i")&&!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function og(){return ig.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function ug(){var e="object"==typeof performance?performance.memory:void 0;return null!=e?{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}:void 0}var cg=function(e){var t=e.config,r=e.connection;"Thread"===r.createMode&&vn.setConfig(t);var n=[];return vn.Endpoint.createInside(r,(function(){return{startMemoryTest:function(e){var t=ug(),r=0;try{for(;r<e;r+=1){var a=new Uint8Array(1024);a[0]=0,a[1023]=255,n.push(a)}}catch(e){}return[t,r,ug()]},endMemorytest:function(){n=[]},ping:function(e){return e+1},getMissingJSFeatures:og}}))},sg=!1,lg=void 0;function fg(){null!=lg&&lg.close(),sg=!1}var dg=Promise.resolve();function hg(e,t,r,n){return void 0===n&&(n=0),yn(hn.CalcWebWorkerTest)?(fg(),dg=dg.then((function(r){return function(e,t,r,n){return Object(j.b)(this,void 0,void 0,(function(){var r,a,i,o,u,c,s,l,d,h,v,p,m,g,C,S,E=this;return Object(j.d)(this,(function(y){switch(y.label){case 0:sg=!0,y.label=1;case 1:if(y.trys.push([1,8,9,10]),S="calc.twSmokeTest.runSmokeTest: starting; duration = "+e+" ms, pingInterval = "+t+" ms",O.ULS.traceTag(593335264,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),null==(r=ha()))throw new Error("initCalc was not passed calcAbsUrl");return[4,vn.createWorker({id:"SmokeTest",createMode:"ThreadOrLocal"},{local:cg,thread:{scriptUrl:r,insideInitName:"excelOnlineCalc.worker.smokeTestInsideInit"}})];case 2:if(lg=y.sent(),!sg)throw a="smoke test canceled during worker creation",O.ULS.traceTag(593335265,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a),new Error(a);return S="calc.twSmokeTest.runSmokeTest: worker created; outside.createMode = "+lg.createMode,O.ULS.traceTag(593335266,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),[4,lg.call.ping(-1)];case 3:if(0!==(i=y.sent()))throw new Error("expected 0; got "+i);return n>0&&"Thread"===lg.createMode?(o=ug(),[4,lg.call.startMemoryTest(n)]):[3,5];case 4:u=y.sent(),c=u[0],s=u[1],l=u[2],d=ug(),h={startMain:o,startThread:c,kb:s,endThread:l,endMain:d},v="calc.twSmokeTest.runSmokeTest: memory = "+JSON.stringify(h),O.ULS.traceTag(592488325,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,v),lg.post.endMemorytest(),y.label=5;case 5:return m={main:og()},[4,lg.call.getMissingJSFeatures()];case 6:return m.worker=y.sent(),p=m,S="calc.twSmokeTest.runSmokeTest: missing = "+JSON.stringify(p),O.ULS.traceTag(593335267,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),g=Date.now(),[4,Mm((function(r){return Object(j.b)(E,void 0,void 0,(function(){var n;return Object(j.d)(this,(function(a){switch(a.label){case 0:return Date.now()>=g+e||!lg||lg.hasBeenClosed()?[2,void 0]:r%1e3!=0?[3,2]:(n=mn("calc.twSmokeTest.runSmokeTest: ping call roundtrip"),[4,lg.call.ping(r)]);case 1:a.sent(),n.stop(),a.label=2;case 2:return[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 3:return a.sent(),lg.post.ping(r),[2,r+1]}}))}))}),0)];case 7:return y.sent(),S="calc.twSmokeTest.runSmokeTest: success",O.ULS.traceTag(593335296,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,S),[3,10];case 8:return C=y.sent(),sg&&(S="calc.twSmokeTest.runSmokeTest: failure: "+C.message,O.ULS.traceTag(593335297,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,S)),[3,10];case 9:return fg(),lg=void 0,[7];case 10:return[2]}}))}))}(e,t,0,n)}))):Promise.resolve()}var vg={onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});O.ULS.traceTag(595908699,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var t=e.getImports("talk",["ping"]);e.setExports("location",ei),e.setExports("talk",{start:function(e,r,n){return Object(j.b)(this,void 0,void 0,(function(){var a,i=this;return Object(j.d)(this,(function(o){switch(o.label){case 0:return a=Date.now(),[4,Mm((function(o){return Object(j.b)(i,void 0,void 0,(function(){return Object(j.d)(this,(function(i){switch(i.label){case 0:return Date.now()>=a+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 1:return i.sent(),t.ping.notify(o,n),[2,o+1]}}))}))}),0)];case 1:return o.sent(),[2]}}))}))},memoryTest:function(e){var t=[],r=0;try{for(;r<e;r+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,t.push(n)}}catch(e){}t=[];var a="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+r+"KB";O.ULS.traceTag(595906820,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a)},ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestInsideDef.ping: n = "+e;O.ULS.traceTag(595907656,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)}return e+1},logMessage:function(e,t){if(t){var r="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;O.ULS.traceTag(595714188,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"};function pg(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[vr(r,a),pr(n,i)]}function mg(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return[pr(r,a),vr(n,i)]}function gg(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return pr(r,a)<vr(n,i)}function Cg(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0}function Sg(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}var Eg,yg=j.a;function Og(e){var t,r,n,a=Object(j.a)(Object(j.a)({},e),{split:(t=e.split,r=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var a=t(e),i=e===r?0:e.depth;return void 0!==i&&i<n&&(e.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a})});return function(e){return Ag(a,xg(a,a.top,e))}}function Ag(e,t){return t===Dg||t===Lg?t:{setOperations:e,root:t}}function kg(e,t){return t===Dg?e:t===Lg||e===Dg?t:e===Lg?e:Ag(e.setOperations,bg(e.setOperations,e.setOperations.top,e.root,t.root))}function bg(e,t,r,n){if(n===Dg)return r;if(n===Lg)return n;if(r===Dg)return n;if(r===Lg)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key,o=e.compare(a,i);if(void 0!==o)return o<0?n:r;var u=e.union(a,i);if(void 0!==u){var c=e.compare(u,t);return void 0!==c&&0===c?Lg:Pg(e,t,u,!0)}return}(e,t,r,n);if(void 0!==a)return a}var i=Gg(e,t,r),o=Gg(e,t,n),u=e.split(t),c=u[0][0],s=u[1][0];return wg(e,c,s,bg(e,c,i.left,o.left),bg(e,s,i.right,o.right))}function Rg(e,t){return e===Dg?e:t===Dg||e===Lg?t:t===Lg?e:Ag(e.setOperations,Ig(e.setOperations,e.setOperations.top,e.root,t.root))}function Ig(e,t,r,n){if(r===Dg)return r;if(n===Dg)return n;if(r===Lg)return n;if(n===Lg)return r;if(r.isExact&&n.isExact){var a=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return Dg;var o=e.compare(a,i);if(void 0!==o)return o<0?r:n;var u=e.intersect(a,i);if(void 0!==u)return Pg(e,t,u,!0);return}(e,t,r,n);if(void 0!==a)return a}var i=Gg(e,t,r),o=Gg(e,t,n),u=e.split(t),c=u[0][0],s=u[1][0];return wg(e,c,s,Ig(e,c,i.left,o.left),Ig(e,s,i.right,o.right))}function Tg(e,t,r,n){if(r===Dg||n===Dg)return!1;if(r===Lg||n===Lg)return!0;if(r.isExact&&n.isExact)return e.meets(r.key,n.key);var a=Gg(e,t,r),i=Gg(e,t,n),o=e.split(t),u=o[0][0],c=o[1][0];return Tg(e,u,a.left,i.left)||Tg(e,c,a.right,i.right)}function Ng(e,t){return e===Dg||t===Dg?e:t===Lg?Dg:e===Lg?Ag(t.setOperations,Fg(t.setOperations,t.setOperations.top,e,t.root)):Ag(e.setOperations,Fg(e.setOperations,e.setOperations.top,e.root,t.root))}function Fg(e,t,r,n){if(r===Dg)return r;if(n===Dg)return r;if(n===Lg)return Dg;if(r===Lg){var a=Gg(e,t,n),i=e.split(t),o=i[0][0],u=i[1][0];return wg(e,o,u,Fg(e,o,Lg,a.left),Fg(e,u,Lg,a.right))}if(r.isExact&&n.isExact){var c=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return r;var o=e.except(a,i);if(void 0!==o)return Pg(e,t,o,!0);return}(e,t,r,n);if(void 0!==c)return c}var s=Gg(e,t,r),l=Gg(e,t,n),f=e.split(t),d=f[0][0],h=f[1][0];return wg(e,d,h,Fg(e,d,s.left,l.left),Fg(e,h,s.right,l.right))}function _g(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function Mg(e,t,r,n){if(r===n)return 0;if(r===Dg)return-1;if(n===Dg)return 1;if(r===Lg)return n===Lg?0:1;if(n===Lg)return-1;if(r.isExact&&n.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,r,n);var a=Gg(e,t,r),i=Gg(e,t,n),o=e.split(t),u=o[0][0],c=o[1][0],s=Mg(e,u,a.left,i.left);if(void 0!==s){var l=Mg(e,c,a.right,i.right);if(void 0!==l)return _g(s,l)}}function wg(e,t,r,n,a){return n===Dg?a===Dg?Dg:a===Lg?Ug(n,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):Ug(n,a,void 0,!1,a.infimum,a.supremum):a===Dg?n===Lg?Ug(n,a,void 0,!1,e.infimum(t,t),e.supremum(t,t)):Ug(n,a,void 0,!1,n.infimum,n.supremum):n===Lg?a===Lg?Lg:Ug(n,a,void 0,!1,e.combineInfima(e.infimum(t,t),a.infimum),e.combineSuprema(e.supremum(t,t),a.supremum)):a===Lg?Ug(n,a,void 0,!1,e.combineInfima(n.infimum,e.infimum(r,r)),e.combineSuprema(n.supremum,e.supremum(r,r))):Ug(n,a,void 0,!1,e.combineInfima(n.infimum,a.infimum),e.combineSuprema(n.supremum,a.supremum))}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(Eg||(Eg={}));var Lg=Eg.Dense,Dg=Eg.Empty;function Ug(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function xg(e,t,r){if(!e.meets(t,r))return Dg;var n=e.compare(t,r);if(void 0!==n)return n<=0?Lg:Pg(e,t,r,!0);var a=e.intersect(t,r);return void 0!==a?Pg(e,t,a,!0):Pg(e,t,r,!1)}function Pg(e,t,r,n){return Ug(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function Gg(e,t,r){if(void 0!==r.left)return r;var n=e.split(t),a=n[0][0],i=n[1][0],o=wg(e,a,i,xg(e,a,r.key),xg(e,i,r.key));if(o===Dg||o===Lg)throw new Error("incorrect set operations implementation");var u=o;return yg(r,{left:u.left,right:u.right})}function Vg(e){return e===Dg||e===Lg?0:function e(t){if(void 0===t||t===Dg||t===Lg)return 0;return e(t.left)+e(t.right)+1}(e.root)}function Bg(e,t){return e===Dg||function(e,t,r){return function t(n,a){if(a===Dg)return!0;if(a===Lg)return r(n);if(a.isExact)return r(a.key);var i=Gg(e,n,a),o=e.split(n),u=o[0][0],c=o[1][0];return t(u,i.left)&&t(c,i.right)}(e.top,t)}(e.setOperations,e.root,t)}function Wg(e,t,r){var n=function(e,t,r){var n=Math.pow(t,e),a=1-Math.pow(t/r,e),i=Math.pow(r,e),o=i*n,u=i-n,c=-1/e;return{cdf:1===e?function(e){return(1-n/e)/a}:function(t){return(1-n*Math.pow(t,-e))/a},invCdf:1===e?function(e){return 1/((i-e*u)/o)}:function(e){return Math.pow((i-e*u)/o,c)}}}(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],a=n.cdf(r),i=n.cdf(t+1),o=n.invCdf((a+i)/2),u=Math.min(Math.max(Math.round(o),t+1),r-1);return[[[t,u],n.cdf(u)-n.cdf(t+1)],[[u,r],n.cdf(r)-n.cdf(u)]]}}}function jg(e,t,r,n,a){var i=Wg(e,t,r);return{id:a,split:function(e){return i.split(e)},canSplit:function(e){return i.canSplit(e)},meets:gg,intersect:mg,union:function(e,t){return n=t,a=(r=e)[0],i=r[1],o=n[0],u=n[1],pr(a,o)<=vr(i,u)?pg(e,t):void 0;var r,n,a,i,o,u},except:Cg,compare:Sg,top:n,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return vr(e,t)},combineSuprema:function(e,t){return pr(e,t)}}}var Hg={},Kg=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t.push([a,e[a].id])}var i=JSON.stringify(t.sort()),o=Hg[i];return void 0===o&&(o={box:{},probabilities:{},depth:1},Hg[i]=o),o};function qg(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];if(Object.prototype.hasOwnProperty.call(e,a)){t=!1;break}}return t?Lg:{isSubspace:!0,bounds:e}}function Jg(e){return e.isSubspace?1:e.subspaceCount}var Qg=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:Jg(e)+Jg(t)}};function Xg(e,t){if(t===Lg)return t;if(t.isSubspace){for(var r=!1,n=0,a=Object.keys(t.bounds);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){r=!0;break}}if(!r)return Lg}return{productOperations:e,root:t}}function Yg(e){return void 0===e?Lg:e}var zg={unzip:function(e){for(var t={},r={},n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];if(o===Dg)return Dg;if(o===Lg)continue;t[i]=o.setOperations,r[i]=o.root}}return Xg(t,qg(r))},combineProduct:function(e,t,r,n){for(var a={},i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];if(Object.prototype.hasOwnProperty.call(e,u)){var c=n(e[u],e[u].top,Yg(t[u]),Yg(r[u]));if(c===Dg)return c;if(c===Lg)continue;a[u]=c}}return a},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},a=0,i=t;a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=e[o];n[o]=u}}return n},fromUntypedProduct:function(e,t,r){for(var n={},a=0,i=r;a<i.length;a++){var o=i[a],u=t[o];n[o]=Ag(e[o],void 0!==u?u:Lg)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=Lg}return t}},Zg=zg.unzip.bind(zg);function $g(e,t,r){var n=zg.combineProduct(e,t,r,bg);if(n===Dg)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function eC(e,t,r){for(var n=0,a=0,i=Object.keys(e);a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var u=Yg(t[o]),c=Yg(r[o]),s=e[o];if(void 0===(n=_g(n,Mg(s,s.top,u,c))))return}}return n}var tC,rC=(tC={},function(e,t,r){var n;if(t===tC.left&&r===tC.right)return tC.res;tC.left=t,tC.right=r;var a,i=eC(e,t.bounds,r.bounds);if(void 0!==i)return tC.res=i<=0?r:t;for(var o=0,u=Object.keys(e);o<u.length;o++){var c=u[o];if(Object.prototype.hasOwnProperty.call(e,c)&&0!==Mg(e[c],e[c].top,Yg(t.bounds[c]),Yg(r.bounds[c]))){if(void 0!==a)return tC.res=void 0;a=c}}if(void 0!==a){var s=bg(e[a],e[a].top,Yg(t.bounds[a]),Yg(r.bounds[a]));if(s===Dg)return tC.res=Dg;if(s===Lg){var l=t.bounds,f=a,d=(l[f],Object(j.e)(l,["symbol"==typeof f?f:f+""]));return tC.res=qg(d)}var h=Object(j.a)(Object(j.a)({},t.bounds),((n={})[a]=s,n));return tC.res=qg(h)}return tC.res=void 0});function nC(e,t,r){if(r===Dg)return t;if(r===Lg)return r;if(t===Dg)return r;if(t===Lg)return t;if(!t.isSubspace||!r.isSubspace)return Qg(t,r,$g(e,t.bounds,r.bounds));var n=rC(e,t,r);return void 0!==n?n:Qg(t,r,$g(e,t.bounds,r.bounds))}function aC(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=zg.restrict.apply(zg,Object(j.f)([t.bounds],r));if(t.isSubspace)return qg(a);var i=aC.apply(void 0,Object(j.f)([e,t.left],r));if(i===Lg)return Lg;var o=aC.apply(void 0,Object(j.f)([e,t.right],r));return nC(e,i,o)}function iC(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===Lg||e===Dg)return e;var n=zg.restrict.apply(zg,Object(j.f)([e.productOperations],t)),a=aC.apply(void 0,Object(j.f)([n,e.root],t));return a===Dg?a:Xg(n,a)}function oC(e,t){var r,n,a,i;if(void 0!==t.children)return t.children;for(var o,u,c=t.box,s=t.probabilities,l=0,f=0,d=Object.keys(e);f<d.length;f++){var h=d[f];if(Object.prototype.hasOwnProperty.call(e,h)){var v=s[h],p=e[h];if(void 0===v){o=h,u=p.top;break}if(v>l){var m=Yg(c[h]);if(m===Dg)throw new Error("the key split can never return empty");var g=p.top;if(m!==Lg){if(!m.isExact)throw new Error("the key can always be represented exactly");g=m.key}if(!p.canSplit(g))continue;o=h,l=v,u=g}}}if(void 0===o||void 0===u)throw new Error("there has to be at least one dimension");var C=e[o],S=C.split(u),E=S[0],y=E[0],O=E[1],A=S[1],k=A[0],b=A[1],R=[{box:Object(j.a)(Object(j.a)({},c),(r={},r[o]=xg(C,C.top,y),r)),probabilities:Object(j.a)(Object(j.a)({},s),(n={},n[o]=O,n)),depth:t.depth+1},{box:Object(j.a)(Object(j.a)({},c),(a={},a[o]=xg(C,C.top,k),a)),probabilities:Object(j.a)(Object(j.a)({},s),(i={},i[o]=b,i)),depth:t.depth+1}];return t.depth<10&&(t.children=R),R}var uC=function(e,t,r,n){return function e(t,r,n,a){if(r===Dg)return[Dg,Dg];if(r===Lg)return[qg(n),qg(a)];var i=eC(t,r.bounds,n);if(void 0!==i&&i<=0)return[r,Dg];var o=zg.combineProduct(t,r.bounds,n,Ig);if(o===Dg)return[Dg,r];var u=zg.combineProduct(t,r.bounds,a,Ig);if(r.isSubspace)return[qg(o),u===Dg?Dg:qg(u)];var c=e(t,r.left,n,a),s=c[0],l=c[1],f=e(t,r.right,n,a),d=f[0],h=f[1];return[nC(t,s,d),nC(t,l,h)]}(e,t,r.box,n.box)};function cC(e,t,r,n,a){var i=oC(e,n),o=i[0],u=i[1],c=uC(e,t,o,u),s=c[0],l=c[1],f=uC(e,r,o,u),d=f[0],h=f[1],v=a(e,s,d,o);return v===Lg?Lg:nC(e,v,a(e,l,h,u))}function sC(e,t,r,n){if(r===Dg)return t;if(t===Dg)return r;if(t===Lg)return t;if(r===Lg)return r;if(t.isSubspace&&r.isSubspace){var a=rC(e,t,r);if(void 0!==a)return a}return cC(e,t,r,n,sC)}function lC(e,t){if(t===Dg)return e;if(t===Lg)return t;if(e===Dg)return t;if(e===Lg)return e;var r=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations),n=sC(r,e.root,t.root,Kg(r));return n===Dg?n:Xg(r,n)}function fC(e,t,r,n){if(t===Dg||r===Dg)return Dg;if(t===Lg)return r;if(r===Lg)return t;if(t.isSubspace&&r.isSubspace){var a=zg.combineProduct(e,t.bounds,r.bounds,Ig);return a===Dg?Dg:qg(a)}return cC(e,t,r,n,fC)}function dC(e,t){if(e===Dg)return e;if(t===Dg)return t;if(e===Lg)return t;if(t===Lg)return e;var r=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations),n=fC(r,e.root,t.root,Kg(r));return n===Dg?n:Xg(r,n)}function hC(e,t,r,n){if(t===Dg)return t;if(r===Lg)return Dg;if(r===Dg)return t;if(t===Lg)return cC(e,t,r,n,hC);if(t.isSubspace&&r.isSubspace){var a=function(e,t,r){var n,a,i=eC(e,t.bounds,r.bounds);if(0===i||-1===i)return Dg;for(var o=0,u=Object.keys(e);o<u.length;o++){var c=u[o];if(Object.prototype.hasOwnProperty.call(e,c)){var s=Mg(e[c],e[c].top,Yg(t.bounds[c]),Yg(r.bounds[c]));if(void 0===s||s>0){if(void 0!==a)return;a=c}}}if(void 0!==a){var l=Fg(e[a],e[a].top,Yg(t.bounds[a]),Yg(r.bounds[a]));if(l===Dg)return Dg;if(l===Lg){var f=t.bounds,d=a;f[d];return qg(Object(j.e)(f,["symbol"==typeof d?d:d+""]))}return qg(Object(j.a)(Object(j.a)({},t.bounds),((n={})[a]=l,n)))}}(e,t,r);if(void 0!==a)return a}return cC(e,t,r,n,hC)}function vC(e,t){if(e===Dg)return e;if(t===Dg)return e;if(t===Lg)return Dg;if(e===Lg){var r=hC(t.productOperations,Lg,t.root,Kg(t.productOperations));return r===Dg?r:Xg(t.productOperations,r)}var n=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations),a=hC(n,e.root,t.root,Kg(n));return a===Dg?a:Xg(n,a)}function pC(e,t){if(e===t)return 0;if(e===Dg)return-1;if(t===Dg)return 1;if(e===Lg)return t===Lg?0:1;if(t===Lg)return-1;var r=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations);return function e(t,r,n,a){if(r===n)return 0;if(r===Dg)return-1;if(n===Dg)return 1;if(r===Lg)return n===Lg?0:1;if(n===Lg)return-1;if(r.isSubspace&&n.isSubspace)return eC(t,r.bounds,n.bounds);var i=oC(t,a),o=i[0],u=i[1],c=uC(t,r,o,u),s=c[0],l=c[1],f=uC(t,n,o,u),d=f[0],h=f[1],v=e(t,s,d,o);return void 0!==v?_g(v,e(t,l,h,u)):void 0}(r,e.root,t.root,Kg(r))}function mC(e,t,r,n){if(t===Dg||r===Dg)return!1;if(t===Lg||r===Lg)return!0;if(!function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(Object.prototype.hasOwnProperty.call(e,i)){var o=Yg(t[i]),u=Yg(r[i]),c=e[i];if(!Tg(c,c.top,o,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var a=oC(e,n),i=a[0],o=a[1],u=uC(e,t,i,o),c=u[0],s=u[1],l=uC(e,r,i,o),f=l[0],d=l[1];return mC(e,c,f,i)||mC(e,s,d,o)}function gC(e,t){if(e===Dg||t===Dg)return!1;if(e===Lg||t===Lg)return!0;var r=Object(j.a)(Object(j.a)({},e.productOperations),t.productOperations);return mC(r,e.root,t.root,Kg(r))}var CC;function SC(e){return e===Dg||e===Lg?0:Jg(e.root)}!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(CC||(CC={}));var EC=[CC.AvailableSet,CC.AvailableRead+1],yC=[0,1<<20],OC=[0,16384],AC={availability:jg(1,EC[0]+1,EC[1],EC,"Availability operations, alpha = 1"),row:jg(.2,yC[0]+1,yC[1],yC,"Row operations, alpha = 0.2"),col:jg(.35,OC[0]+1,OC[1],OC,"Col operations, alpha = 0.35")},kC={availability:Og(AC.availability),row:Og(AC.row),col:Og(AC.col)};function bC(e){return Zg({row:kC.row([e.row,e.row+e.rows]),col:kC.col([e.col,e.col+e.cols])})}function RC(e){if(e!==Dg){var t,r,n=e===Lg?void 0:e.root.bounds.row,a=e===Lg?void 0:e.root.bounds.col,i=void 0===n?AC.row.top:(t=Ag(AC.row,n),r=[],MC(t,(function(e){return r.push(e),!0})),r.reduce(pg)),o=i[0],u=i[1],c=void 0===a?AC.col.top:function(e){var t=[];return wC(e,(function(e){return t.push(e),!0})),t.reduce(pg)}(Ag(AC.col,a)),s=c[0];return zt(o,s,u-o,c[1]-s)}}var IC,TC,NC=Zg({availability:kC.availability([CC.AvailableSet,CC.AvailableSet+1])}),FC=Zg({availability:kC.availability([CC.AvailableRead,CC.AvailableRead+1])}),_C=Zg({availability:kC.availability([CC.AvailableSet,CC.AvailableRead+1])});function MC(e,t){return e!==Lg?Bg(e,t):t(AC.row.top)}function wC(e,t){return e!==Lg?Bg(e,t):t(AC.col.top)}function LC(e,t){return function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var a=iC.apply(void 0,Object(j.f)([e],r));if(a===Dg)return!0;if(a===Lg)return t(zg.denseProduct(r));var i=a.productOperations,o=a.root;function u(e){return e.isSubspace?t(zg.fromUntypedProduct(i,e.bounds,r)):u(e.left)&&u(e.right)}return u(o)}(e,(function(e){return MC(e.row,(function(r){var n=r[0],a=r[1];return wC(e.col,(function(e){var r=e[0],i=e[1];return t(zt(n,r,a-n,i-r))}))}))}),"row","col")}function DC(e,t){return LC(e,(function(e){return ht(e,t)}))}function UC(e,t){return{sheet:e,set:t}}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula"}(IC||(IC={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(TC||(TC={}));var xC,PC={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function GC(e,t){var r;return Object(j.a)(Object(j.a)({},e),((r={})[t]=(e[t]||0)+1,r))}function VC(e,t){switch(t.message){case xC.ChangedCell:return Object(j.a)(Object(j.a)({},e),{changedCellCount:GC(e.changedCellCount,t.cellKind),calculatedCellCount:GC(e.calculatedCellCount,t.cellKind)});case xC.UnchangedCell:return Object(j.a)(Object(j.a)({},e),{calculatedCellCount:GC(e.calculatedCellCount,t.cellKind)});case xC.ContinueComputation:return Object(j.a)(Object(j.a)({},e),{continueCount:e.continueCount+1});case xC.StateTimedOut:return Object(j.a)(Object(j.a)({},e),{stateTimedOut:!0});case xC.EditFinished:return Object(j.a)(Object(j.a)({},e),{editFinishedCount:e.editFinishedCount+1});case xC.RecalcFinished:return Object(j.a)(Object(j.a)({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return A("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function BC(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor(Math.log2(t))}function WC(e){switch(typeof e){case"number":return{kind:"n",magnitude:BC(e)};case"string":return{kind:"s"};case"boolean":return{kind:"b"};case"object":switch(e.kind){case x.Error:return{kind:"e",type:(t=e.type,r=ya[t],void 0===r?"error.type:"+t:r)};case x.Rich:return{kind:"r"};case x.Array:return{kind:"a"};case x.Blank:return{kind:"z"};default:return A("calc.calc.precisionValue",e)}}var t,r}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(xC||(xC={}));var jC={samples:[],failures:[]};function HC(e,t){return 0===t.length?e:0===e.length?t:e.concat(t)}var KC,qC,JC={samples:[],failures:[]};function QC(e,t){return{samples:HC(e.samples,t.samples),failures:HC(e.failures,t.failures)}}function XC(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var a=e.slice(0,-1);return t<e.length-1&&(a[t]=e[e.length-1]),a}function YC(e,t,r){return{kind:e,key:t,value:r}}function zC(e,t){return YC(1,e,t)}function ZC(e,t){return YC(2,e,t)}function $C(e,t){return YC(3,e,t)}!function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(KC||(KC={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.PrecisionEvalStatistics="PrecisionEvalStatistics",e.PrecisionPrintFormulaStatistics="PrecisionPrintFormulaStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(qC||(qC={}));var eS=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,a,i){void 0===i&&(i=2);var o=i>1?Math.ceil(i):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:a,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,n){var a=r.keyCompare(n.key,e);if(1===n.kind)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(var i=0,o=n.value;i<o.length;i++){var u=t(r,o[i]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:kn(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var a=oS(this.lattice,this.root,t,n,r);return void 0!==a?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,iS(this.lattice,this.root,zC(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==oS(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return tS(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return tS(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return tS(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return tS(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var n=[],a=this.lattice,i=function(e,r){var o=a.keyCompare(e.key,t);if(void 0===o||o<0)return hr(e,1);if(2===e.kind){for(var u=e.value,c=0;c<u.length;c+=1)if(0===a.keyCompare(u[c].key,t)){if((h=XC(u,c)).length<r){var s=ZC(e.key,h);return n.push(s),hr(s,3)}return hr(ZC(nS(a,h),h),2)}}else for(u=e.value,c=0;c<u.length;c+=1){var l=i(u[c],a.minChildren),f=l[0],d=l[1];if(3===d){var h;if((h=XC(u,c)).length>=r)return hr($C(nS(a,h),h),2);s=$C(e.key,h);return n.push(s),hr(s,3)}if(2===d)return hr($C(e.key,XC(u,c,f)),2)}return hr(e,1)},o=2===this.root.kind?1:2,u=i(this.root,o),c=u[0],s=u[1];if(c===this.root)return this;for(var l=3===s?void 0:c,f=0;f<n.length;f+=1)tS(n[f],(function(e,t){return l=iS(r.lattice,l,zC(e,t)),!0}));return new e(this.lattice,l,this.count-1)},e}();function tS(e,t,r,n){var a=void 0!==r?r:function(){return!0},i=void 0!==n?n:function(){return!0};if(null==e)return!0;var o=function(e){if(!a(e.key))return!0;if(2===e.kind)for(var r=e.value,n=0;n<r.length;n+=1){var u=r[n];if(i(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,n=0;n<r.length;n+=1)if(!o(r[n]))return!1;return!0};return o(e)}function rS(e,t){for(var r=function(e,t){for(var r=0,n=1,a=e.keyDistance(t[0].key,t[1].key),i=2;i<t.length;i+=1)for(var o=0;o<i;o+=1){var u=e.keyDistance(t[o].key,t[i].key);u>a&&(r=o,n=i,a=u)}return hr(r,n)}(e,t),n=r[0],a=r[1],i=t[n].key,o=t[a].key,u=[],c=0;c<t.length;c+=1){var s=t[c];u.push([s,e.keyDistance(i,s.key)-e.keyDistance(o,s.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var l=e.minChildren;l<t.length-e.minChildren&&u[l][1]<0;l+=1);var f=[],d=[];for(c=0;c<l;c+=1)f.push(u[c][0]);for(c=l;c<t.length;c+=1)d.push(u[c][0]);return hr(f,d)}function nS(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function aS(e,t,r){var n=rS(e,r),a=n[0],i=n[1];return hr(YC(t,nS(e,a),a),YC(t,nS(e,i),i))}function iS(e,t,r){if(null==t)return ZC(r.key,[r]);var n=function t(n){if(2===n.kind){var a=Object(j.f)(n.value,[r]);if(a.length>e.maxChildren){var i=aS(e,n.kind,a),o=i[0],u=i[1];return hr(ZC(o.key,o.value),u)}return hr(ZC(e.keyJoin(n.key,r.key),a),void 0)}var c=n.value.slice(),s=function(e,t,r){for(var n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length,o=1;o<t.length;o+=1){var u=t[o],c=e.keyDistance(u.key,r);(c<a||c===a&&u.value.length<i)&&(n=o,a=c,i=u.value.length)}return n}(e,c,r.key),l=t(c[s]),f=l[0],d=l[1];if(c[s]=f,null!=d&&(c.push(d),c.length>e.maxChildren)){var h=aS(e,n.kind,c),v=h[0];u=h[1];return hr($C(v.key,v.value),u)}return hr($C(e.keyJoin(n.key,r.key),c),void 0)}(t),a=n[0],i=n[1];return null!=i?$C(e.keyJoin(a.key,i.key),[a,i]):a}function oS(e,t,r,n,a){if(void 0!==t)return function t(n){if(2!==n.kind)for(a=0;a<n.value.length;a+=1){o=n.value[a];if(e.keyMeets(o.key,r))if(void 0!==(u=t(o)))return $C(n.key,XC(n.value,a,u))}else for(var a=0;a<n.value.length;a+=1){var o,u;if(void 0!==(u=i(o=n.value[a])))return ZC(n.key,XC(n.value,a,u))}}(t);function i(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&n(t.value)?zC(t.key,a):t}}function uS(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols;return pr(r,o)<vr(r+a,o+c)&&pr(n,u)<vr(n+i,u+s)}function cS(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=r+a,s=o+t.rows,l=n+i,f=u+t.cols;return r===o&&c===s&&n===u&&l===f?0:r<=o&&c>=s&&n<=u&&l>=f?1:r>=o&&c<=s&&n>=u&&l<=f?-1:void 0}function sS(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,u=t.col,c=t.rows,s=t.cols;return mr(r-o+.5*(a-c))+mr(n-u+.5*(i-s))}function lS(){return eS.create(Ef,uS,cS,sS)}function fS(e){return Array.isArray(e)}var dS=function(e,t,r,n){return{isExact:e,iformat:t,category:r,decimals:n}},hS=dS(!0,Fs.General,"General",0),vS=function(e,t){return e&&t===Fs.General},pS={fmla:"",lexicalKind:Vt.Cell,origin:Zt(0,0),compiledFmla:void 0},mS={fmla:"",lexicalKind:Vt.Range,origin:Zt(0,0),compiledFmla:void 0},gS=function(e,t){return""===e&&!t},CS={oper:De,clientFailure:void 0};function SS(e,t){return df(e)&&void 0===t}function ES(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!mt(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function yS(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===Vt.Cell?pS:mS;e=e.setValue(t,n)}return!0})),e}var OS={values:lS(),formats:lS(),formulae:lS(),dirty:Dg},AS={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0};var kS=zt(0,0,1<<20,16384);var bS,RS,IS=function(){function e(e){this.sheet=e,this.oldAvailabilities={},this.availabilityHistorySize=0,this.inFilterMode=!1,this.filterModeAvailable=!1,this.serverContents=this.editedContents=OS,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=Dg,this.editedTaint=this.recalcTaint=Dg,this.serverAvailability=this.editedAvailability=Dg,this.serverUsed=this.editedUsed=kS,this.hiddenRows=this.hiddenAvailability=Dg}return e.prototype.cloneServer=function(){var t=new e(this.sheet);return t.serverContents=this.serverContents,t.serverAvailability=this.serverAvailability,t.serverUsed=this.serverUsed,t},e.prototype.advanceState=function(e){this.editedContents=this.serverContents,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=Dg,this.editedTaint=this.recalcTaint=Dg,this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=this.editedAvailability=Dg,this.serverUsed=this.editedUsed=kS,this.hiddenRows=this.hiddenAvailability=Dg,this.inFilterMode=this.filterModeAvailable=!1},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=pC(t,dC(bC(e),FC));return void 0!==r&&r>=0},e.prototype.hasRecalcDirty=function(e){return gC(this.recalcDirty,bC(e))},e.prototype.hasRecalcFailure=function(e){return gC(this.recalcFailures,bC(e))},e.prototype.hasEditedEditTaint=function(e){return gC(this.editedTaint,bC(e))},e.prototype.hasRecalcEditTaint=function(e){return gC(this.recalcTaint,bC(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r,n,a=kC.row(hr(e,t)),i=(r=this.hiddenAvailability)===(n=a)?0:r===Dg?-1:n===Dg?1:r===Lg?n===Lg?0:1:n===Lg?-1:Mg(r.setOperations,r.setOperations.top,r.root,n.root);if(!(void 0!==i&&i>=0))return it({kind:Lb.HiddenRows});var o=[];return MC(Rg(this.hiddenRows,a),(function(e){var t=e[0],r=e[1];return o.push(Tl(t,r)),!0})),at(o)},e.prototype.setHiddenRows=function(e,t){var r=kC.row(hr(e.row,e.row+e.rows));this.hiddenRows=kg(Ng(this.hiddenRows,r),Rg(t,r)),this.hiddenAvailability=kg(this.hiddenAvailability,r)},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?at(this.inFilterMode):it({kind:Lb.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankCellInSet=function(e,t,r,n,a){var i=dC(e,n);return LC(dC(r,i),(function(e){return a.formulae.forEachMeets(e,(function(r,n){return!!gS(n.fmla,void 0!==n.compiledFmla)||ht(Of(e,r),t)}))}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankCellInSet(e,t,this.editedAvailability,NC,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankCellInSet(e,t,this.serverAvailability,FC,this.serverContents)},e.prototype.promoteServerAvailability=function(e,t){var r=dC(e,NC),n=this.oldAvailabilities[t];if(void 0===n)return!1;var a=pC(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,dC(e,_C)),this.unionTaint(!0,Dg),this.unionUsed(!0,RC(e)),!0)},e.prototype.extendServerUnused=function(e){var t=void 0===e?Dg:bC(e),r=vC(Lg,t),n=this.serverContents,a=n.values,i=n.formats,o=n.formulae,u=n.dirty;LC(r,(function(e){return a.forEachLe(e,(function(e,t){return SS(t.oper,t.clientFailure)||(a=a.setValue(e,CS)),!0})),i.forEachLe(e,(function(e,t){return"object"==typeof t&&vS(t.isExact,t.iformat)||(i=i.setValue(e,hS)),!0})),!0})),LC(r,(function(e){return o=yS(o,e),!0})),u=vC(u,r),this.setContents(!0,{values:a,formats:i,formulae:o,dirty:u});var c=this.serverAvailability;c=lC(c=dC(c,t),dC(r,FC)),this.serverAvailability=this.editedAvailability=c,this.editedTaint=this.recalcTaint=Dg;var s,l,f=this.serverUsed;l=e,f=void 0===(s=f)||void 0===l?void 0:Of(s,l),this.serverUsed=this.editedUsed=f},e.prototype.setRecalcFailure=function(e){this.recalcFailures=lC(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=lC(this.recalcTaint,e)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this;ht(e,(function(e,n,a){return r.editedContents=Object(j.a)(Object(j.a)({},r.editedContents),{values:r.editedContents.values.setValue(e,{oper:fS(t)?t[n][a]:t,clientFailure:void 0})}),!0})),this.recalcDirty=vC(this.recalcDirty,bC(e))},e.prototype.getRecalcValue=function(e){var t=this.editedContents.values.getValue(e);return void 0===t?CS:t},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return void 0===t?CS.oper:t.oper},e.prototype.getServerFormula=function(e){return this.serverContents.formulae.getValue(e)},e.prototype.setEditedFormat=function(e,t){this.editedContents=Object(j.a)(Object(j.a)({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return void 0!==t?t:hS},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return void 0!==t?t:hS},e.prototype.getEditedFormula=function(e){var t=void 0;return this.editedContents.formulae.forEachGe(e,(function(e,r){return!!gS(r.fmla,void 0!==r.compiledFmla)||(t=[e,r],!1)})),t},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=Dg},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=lC(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?Dg:lC(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r,n,a=e?this.serverUsed:this.editedUsed;n=t,a=void 0===(r=a)?n:void 0===n?r:Ef(r,n),e&&(this.serverUsed=a),this.editedUsed=a},e.prototype.setCellContents=function(e,t,r,n,a,i,o){this.setCommon(e,t,void 0,r,n,a,i,o)},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=bC(t);this.setCommon(e,o,t,r,n,void 0,a,i)},e.prototype.setCommon=function(e,t,r,n,a,i,o,u){var c=e?this.serverContents:this.editedContents,s=c.values,l=c.formats,f=c.formulae,d=c.dirty,h=void 0===n||void 0!==n.compiledFmla,v=n;void 0!==n&&(LC(t,(function(e){return f=yS(f,e),!0})),gS(n.fmla,void 0!==n.compiledFmla)&&(v=void 0));var p=void 0!==v&&void 0===r?n:void 0,m=void 0!==v&&void 0!==r?n:void 0,g=a;void 0!==a&&SS(a,i)&&(LC(t,(function(e){return s.forEachLe(e,(function(e,t){return SS(t.oper,t.clientFailure)||(s=s.setValue(e,CS)),!0})),!0})),d=vC(d,t),g=void 0);var C=void 0!==g?{oper:g,clientFailure:i}:void 0,S=o;"object"==typeof o&&vS(o.isExact,o.iformat)&&(LC(t,(function(e){return l.forEachLe(e,(function(e,t){return"object"==typeof t&&vS(t.isExact,t.iformat)||(l=l.setValue(e,hS)),!0})),!0})),S=void 0);var E=!1===S?void 0:S,y=!1===S?S:void 0,O=t;if(!e){var A=dC(t,NC);O=lC(iC(dC(this.editedAvailability,A),"row","col"),dC(t,void 0!==u?bC(u):Dg))}if(void 0===p&&void 0===E&&void 0===C||(DC(O,(function(e){return void 0!==p&&(f=ES(f,e,p)),void 0!==E&&(l=l.setValue(e,E)),void 0!==C&&(s=s.setValue(e,C)),!0})),void 0===p&&void 0===C||(d=h?lC(d,O):vC(d,O))),void 0!==m){f=ES(f,r,m);var k=bC(r);d=h?lC(d,k):vC(d,k)}void 0!==y&&(l=function(e,t,r){var n=dC(t,FC);return DC(vC(t,iC(dC(r,n),"row","col")),(function(t){return e=e.setValue(t,!1),!0})),e}(l,O,e?this.serverAvailability:this.editedAvailability));var b=void 0===a?Dg:O;this.setContents(e,{values:s,formats:l,formulae:f,dirty:d}),this.unionAvailability(e,dC(b,_C)),e||(this.editedAvailability=vC(this.editedAvailability,vC(t,O))),this.unionTaint(e,b),this.unionUsed(e,RC(t))},e.prototype.getDirtyEditedCells=function(){return dC(this.recalcDirty,this.editedTaint)},e.prototype.getDirtyDependentCells=function(){return vC(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,Dg),this.unionTaint(e,Dg),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:SC(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:SC(this.editedContents.dirty),recalcDirtySetSubspaceCount:SC(this.recalcDirty),recalcFailuresSetSubspaceCount:SC(this.recalcFailures),recalcTaintSetSubspaceCount:SC(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:SC(this.editedAvailability),hiddenRowsNodeCount:Vg(this.hiddenRows)+Vg(this.hiddenAvailability)}},e.prototype.collectGarbage=function(e){var t=Dg;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=lC(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function a(e){return gC(dC(bC(e),NC),t)}function i(e,t){return!gS(t.fmla,void 0!==t.compiledFmla)&&a(e)}function o(e,t){return("object"!=typeof t||!vS(t.isExact,t.iformat))&&a(e)}function u(e,t){return!SS(t.oper,t.clientFailure)&&a(e)}var c=iC(t,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),values:this.serverContents.values.filter(u),dirty:dC(this.serverContents.dirty,c)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),values:this.editedContents.values.filter(u),dirty:dC(this.editedContents.dirty,c)},this.recalcDirty=dC(this.recalcDirty,c)},e}();function TS(e,t){e[t]=(e[t]||0)+1}function NS(e,t,r){return e.push(t.join(".")+": expected "+r),!1}function FS(e,t,r){return void 0===r&&(r=!1),function(n,a,i){return lr(n)&&e(n)||NS(a,i,r?t+" (received "+n+")":t)}}function _S(e,t,r,n){for(var a=[],i=t(e,a,[n]),o=0,u=a;o<u.length;o++){TS(r,u[o])}return i}function MS(e,t,r,n){var a=n+".<index>";return e.filter((function(e){return _S(e,t,r,a)}))}function wS(e){return function(t,r,n){return!!fr(t)||e(t,r,n)}}function LS(e){return function(t,r,n){if(fr(t))return NS(r,n,"non-null object");var a=n.length;try{var i=!0;for(var o in e)n[a]=o,i=i&&e[o](t[o],r,n);return i}finally{n.length=a}}}function DS(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,a){return e&&a(t,r,n)}),!0)}}function US(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,a){return t.reduce((function(e,t){return e&&t(r)(r,n,a)}),e(r,n,a))}}function xS(e){return function(t,r,n){if(!Array.isArray(t))return NS(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,a){return t&&e(a,r,n)}),!0)}finally{n.pop()}}}function PS(e){var t="one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,a){if(fr(r))return NS(n,a,"non-null object");var i=a.length;try{var o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return fr(o)?(a.push("kind"),NS(n,a,t)):o(r,n,a)}finally{a.length=i}}}function GS(e){var t="typeof one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,a){var i=e[typeof r];return fr(i)?NS(n,a,t):i(r,n,a)}}function VS(e){return"number"==typeof e&&e>-1/0&&e<1/0}function BS(e){return(0|e)===e||Math.floor(e)===e}function WS(e,t,r){return void 0===t&&(t="natural < "+e),void 0===r&&(r=!1),FS((function(t){return"number"==typeof t&&t>=0&&t<e&&BS(t)}),t,r)}var jS=FS(VS,"finite number"),HS=FS((function(e){return VS(e)&&BS(e)}),"integer"),KS=WS(1/0,"natural"),qS=FS((function(e){return"string"==typeof e}),"string"),JS=FS((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),QS=FS((function(e){return"boolean"==typeof e}),"boolean"),XS=FS((function(e){return Array.isArray(e)}),"Array");function YS(e){return FS((function(t){return t===e}),JSON.stringify(e))}function zS(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var ZS=FS((function(e){return"string"==typeof e&&zS(e)}),"formula text"),$S=LS({functionId:KS,functionName:JS}),eE=LS({errorType:KS,errorName:FS((function(e){return"string"==typeof e&&e.length>1&&"#"===e[0]}),"error name")}),tE={General:!0,Number:!0,Currency:!0,Accounting:!0,Date:!0,Time:!0,Percentage:!0,Fraction:!0,Scientific:!0,Text:!0,Special:!0,Custom:!0,MaxCategory:!1},rE=LS({iformat:KS,category:FS((function(e){return"string"==typeof e&&!0===tE[e]}),"NumberFormatCategory"),decimals:KS}),nE=FS((function(e){return"string"==typeof e||VS(e)}),"string or finite number"),aE=LS({sheetId:nE,sheetName:qS}),iE=WS(1<<20,void 0,!0),oE=WS(16384,void 0,!0),uE=LS({row:iE,column:oE}),cE=DS(uE,LS({lastRow:wS(iE),lastColumn:wS(oE)})),sE=DS(cE,LS({sheetId:nE})),lE=LS({kind:YS("Blank")}),fE=LS({kind:YS("Error"),type:KS}),dE=GS({number:jS,string:qS,boolean:QS,object:PS({Blank:lE,Error:fE})}),hE=DS(LS({value:dE,iformat:KS,failureReason:wS(qS)}),PS({CellFormula:LS({formulaBarText:ZS}),ArrayFormula:LS({formulaBarText:wS(qS)}),Value:LS({formulaBarText:qS}),Inferred:LS({formulaBarText:wS(qS)})})),vE=LS({range:sE,excludeRows:wS(xS(iE)),excludeColumns:wS(xS(oE)),data:wS(hE),fromStateId:wS(HS)}),pE=LS({isSpilled:QS,formulaBarText:ZS}),mE=LS({range:sE,data:wS(pE),fromStateId:wS(HS)}),gE=LS({sheetId:nE,usedRange:wS(cE)}),CE=GS({number:jS,string:qS,boolean:QS,object:PS({Error:fE})}),SE=LS({kind:YS("NamedValue"),value:CE}),EE=LS({kind:YS("NamedFormula"),formulaBarText:ZS}),yE=LS({kind:YS("NamedRange"),range:sE}),OE=LS({kind:YS("NamedFailure"),failureReason:qS,objectKind:wS(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];r[i]=!0}var o="one of "+JSON.stringify(e);return FS((function(e){return"string"==typeof e&&!0===r[e]}),o)}("NamedValue","NamedFormula","NamedRange","NamedTable"))}),AE=LS({name:qS,data:wS(PS({NamedValue:SE,NamedFormula:EE,NamedRange:yE,NamedFailure:OE}))}),kE=LS({scope:wS(nE),objects:wS(XS),fromStateId:wS(HS)}),bE=LS({value:wS(dE)}),RE=LS({value:dE}),IE=FS((function(e){return e.length>0}),"a non-empty array"),TE=FS((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),NE=DS(LS({range:US(xS(sE),(function(e){return IE}),(function(e){return TE})),origin:wS(uE),viewport:wS(sE)}),PS({CellFormula:LS({formulaBarText:ZS,value:wS(dE)}),Value:LS({formulaBarText:qS,value:dE}),Inferred:US(LS({formulaBarText:qS}),(function(e){return t=zS(e.formulaBarText)?bE:RE,function(e,r,n){return t(e,r,n)};var t}))})),FE=LS({range:sE,formulaBarText:FS((function(e){return"string"==typeof e&&(0===e.length||zS(e))}),"empty string or text denoting formula"),origin:wS(uE),viewport:wS(sE)}),_E={number:!0,string:!0,boolean:!0},ME=((bS={})[x.Error]=!0,bS[x.Array]=!1,bS[x.Rich]=!1,bS),wE=((RS={})[x.Error]=!0,RS[x.Array]=!1,RS[x.Blank]=!0,RS[x.Rich]=!1,RS),LE=FS((function(e){return!("object"!=typeof e||!ME[e.kind])||!0===_E[typeof e]}),"supported WriteOper"),DE=FS((function(e){return!("object"!=typeof e||!wE[e.kind])||!0===_E[typeof e]}),"supported ReadOper"),UE=function(e){return{kind:"NamedValue",value:e}},xE=function(e){return{kind:"NamedFormula",fmla:e}},PE=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},GE={namesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};var VE,BE=function(){function e(e,t){this.names=e,this.allAvailable=t}return e.create=function(t){return new e(sl.create(t),!1)},e.prototype.update=function(t,r){return t!==this.names||r!==this.allAvailable?new e(t,r):this},e.prototype.getEntry=function(e,t){var r=this.names.getEntry(t);return void 0===r?this.allAvailable?at(void 0):it({kind:Lb.NameLoc,name:or(e,t)}):at(!1!==r.value?r:void 0)},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable)},e.prototype.setUndefined=function(){return this.update(this.names,!0)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.allAvailable?this.update(this.names.filter((function(e,t){return!1!==t})),!0):this},e.prototype.clearCompiledFormulas=function(){this.names.forEach((function(e,t){return!1!==t&&t.compiledFmla.reset(),!0}))},e}(),WE=function(){function e(e,t){this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=BE.create(e),this.emptyRecalcFailures=this.recalcFailures=bn.create(e)}return e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e){var t=this.contents.getEntry(this.scope,e);return ot(t)?at(void 0!==t.value?or(this.scope,t.value.key):void 0):t},e.prototype.getNameFormula=function(e){var t=this.contents.getEntry(this.scope,e);return ot(t)?at(void 0!==t.value?t.value.value:void 0):t},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.clearCompiledFormulas=function(){this.contents.clearCompiledFormulas(),this.oldContents!==this.contents&&this.oldContents.clearCompiledFormulas()},e.prototype.setNamedObject=function(e,t,r){this.contents=void 0===r?this.contents.remove(t):this.contents.setValue(t,r),this.isCurrent=this.isChanged=!0},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e){return!this.isChanged&&e===this.oldStateId&&(this.contents=this.oldContents,this.isCurrent=!0,!0)},e}(),jE=function(){function e(e,t,r,n,a,i){void 0===r&&(r={}),void 0===n&&(n=[]),this.document=e,this.stringCompareCI=t,this.sheets=r,this.sheetPosToId=n,this.sheetNameToId=void 0===a?bn.create(t):a,this.globalNames=void 0===i?new WE(t,ar(e)):i}return e.prototype.cloneServer=function(){for(var t=Object(j.a)({},this.sheets),r=0,n=this.sheetPosToId;r<n.length;r++){var a=n[r],i=t[a];t[a]=Object(j.a)(Object(j.a)({},i),{grid:i.grid.cloneServer()})}return new e(this.document,this.stringCompareCI,t,this.sheetPosToId,this.sheetNameToId,this.globalNames)},e.prototype.setRecalcFailure=function(e,t){var r=this.getSheetById(e);return r.kind===Be.Failure?r:at(r.value.grid.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getSheetById(e);return r.kind===Be.Failure?r:at(r.value.grid.setRecalcEditTaint(t))},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===Be.Failure?r:at(r.value.grid.setEditedAndRecalcValues(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===Be.Failure?r:at(r.value.grid.setEditedFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:at(n.value.grid.setHiddenRows(t,r))},e.prototype.setInFilterMode=function(e,t){var r=this.getSheetById(e);return r.kind===Be.Failure?r:at(r.value.grid.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,a,i,o){var u=this.getSheetById(t.sheet.index);if(u.kind===Be.Failure)return u;var c=void 0!==o&&pt(t.sheet,o.sheet)?o.range:void 0;return at(u.value.grid.setCellContents(e,t.set,r,n,a,i,c))},e.prototype.setRangeFormula=function(e,t,r,n,a,i){var o=this.getSheetById(t.sheet.index);if(o.kind===Be.Failure)return o;var u=void 0!==i&&pt(t.sheet,i.sheet)?i.range:void 0;return at(o.value.grid.setRangeFormula(e,t.range,r,n,a,u))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t){e.push(UC(t.grid.sheet,t.grid.getDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t){e.push(UC(t.grid.sheet,t.grid.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r){var n=this.getNameManager(t.scope.index);return n.kind===Be.Failure?n:at(n.value.setNamedObject(e,t.name,r))},e.prototype.setUndefinedNames=function(e){var t=this.getNameManager(e.index);return t.kind===Be.Failure?t:at(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNameManager(e.index);return r.kind===Be.Failure?r:at(r.value.promoteNamedObjects(t))},e.prototype.setSheetNames=function(t){for(var r,n=[],a={},i=[],o=0;o<t.length;o+=1){var u=t[o],c=u.sheetName,s=u.sheetId;n[o]=s,i.push([c,s]);var l=this.sheets[s];if(void 0===l){var f=Jt(this.document,s);a[s]={grid:new IS(f),names:new WE(this.stringCompareCI,f),pos:o,name:c}}else a[s]=Object(j.a)(Object(j.a)({},l),{pos:o})}var d=(r=bn.create(this.stringCompareCI)).setValues.apply(r,i);return new e(this.document,this.stringCompareCI,a,n,d,this.globalNames)},e.prototype.extendServerUnused=function(e,t){var r=this.getSheetById(e);return r.kind===Be.Failure?r:at(r.value.grid.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:at(n.value.grid.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t){var r=this.getNameManager(e);if(r.kind===Be.Failure)return r;var n=r.value.getNameLoc(t);return n.kind,Be.Failure,n},e.prototype.getNameFormula=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Be.Failure?t:t.value.getNameFormula(e.name)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Be.Failure?t:at(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNameManager(e.scope.index);return t.kind===Be.Failure?t:at(t.value.setRecalcFailure(e.name))},e.prototype.getNameManager=function(e){if(void 0===e)return at(this.globalNames);var t=this.getSheetById(e);return t.kind===Be.Failure?t:at(t.value.names)},e.prototype.getEditedFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getEditedFormula(e.range))},e.prototype.getEditedFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getEditedFormat(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getSheetById(e);return t.kind===Be.Failure?t:t.value.grid.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:n.value.grid.getHiddenRows(t,r)},e.prototype.getServerFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getServerFormat(e.range))},e.prototype.getRecalcValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getRecalcValue(e.range))},e.prototype.getServerValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.getServerFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getSheetById(e);return t.kind===Be.Failure?t:at(t.value.grid.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.allEditedAvailable(e.range))},e.prototype.hasRecalcDirty=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Be.Failure?t:at(t.value.grid.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:at(n.value.grid.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===Be.Failure?n:at(n.value.grid.forEachServerNonBlankCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.getSheetByName(e);return t.kind===Be.Failure||void 0===t.value?t:at(t.value.grid.sheet)},e.prototype.getSheetName=function(e){var t=this.getSheetById(e);return t.kind===Be.Failure?t:at(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getSheetById(e);return t.kind===Be.Failure?t:at(t.value.grid.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){var t,r;if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{var n=this.getSheetById(e.index);if(!ot(n))return n;var a=this.getSheetById(e.index2);if(!ot(a))return a;t=vr(n.value.pos,a.value.pos),r=pr(n.value.pos,a.value.pos)+1}for(var i=[],o=t;o<r;o+=1)i.push(this.sheetPosToId[o]);return at(Xt(i,t))},e.prototype.onCellModified=function(e){this.forEachSheet((function(t){t.grid.onCellModified(e),t.names.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t){t.grid.collectGarbage(e),t.names.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t){t.grid.advanceState(e),t.names.advanceState(e)})),this.globalNames.advanceState(e)},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e){e.grid.clearCompiledFormulas(),e.names.clearCompiledFormulas()})),this.globalNames.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){var e=AS;return this.forEachSheet((function(t){return r=e,n=t.grid.getStatistics(),e={serverFormulaeNodeCount:r.serverFormulaeNodeCount+n.serverFormulaeNodeCount,serverFormatsNodeCount:r.serverFormatsNodeCount+n.serverFormatsNodeCount,serverValuesNodeCount:r.serverValuesNodeCount+n.serverValuesNodeCount,serverDirtySetSubspaceCount:r.serverDirtySetSubspaceCount+n.serverDirtySetSubspaceCount,editedFormulaeNodeCount:r.editedFormulaeNodeCount+n.editedFormulaeNodeCount,editedFormatsNodeCount:r.editedFormatsNodeCount+n.editedFormatsNodeCount,editedValuesNodeCount:r.editedValuesNodeCount+n.editedValuesNodeCount,editedDirtySetSubspaceCount:r.editedDirtySetSubspaceCount+n.editedDirtySetSubspaceCount,recalcDirtySetSubspaceCount:r.recalcDirtySetSubspaceCount+n.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:r.recalcFailuresSetSubspaceCount+n.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:r.recalcTaintSetSubspaceCount+n.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:r.availabilitySetSubspaceCount+n.availabilitySetSubspaceCount,availabilityHistorySize:r.availabilityHistorySize+n.availabilityHistorySize,hiddenRowsNodeCount:r.hiddenRowsNodeCount+n.hiddenRowsNodeCount};var r,n})),e},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheet((function(t){return r=e,n=t.names.getStatistics(),e={namesCount:r.namesCount+n.namesCount,recalcFailuresCount:r.recalcFailuresCount+n.recalcFailuresCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.getAvailableCells=function(){for(var e=[],t=0,r=this.sheetPosToId;t<r.length;t++){var n=r[t],a=this.sheets[n],i=Jt(this.document,n);e.push({sheetIdx:i,availableCells:a.grid.getServerAvailability()})}return e},e.prototype.forEachSheet=function(e){for(var t in this.sheets){if(this.sheets.hasOwnProperty(t))e(this.sheets[t])}},e.prototype.getSheetById=function(e){var t=this.sheets[e];return void 0!==t?at(t):this.unavailableFailure({kind:Lb.SheetId,document:this.document,sheetId:e})},e.prototype.getSheetByName=function(e){var t=this.sheetNameToId.getValue(e);return void 0===t?at(void 0):this.getSheetById(t)},e.prototype.unavailableFailure=function(e){return it(e)},e}(),HE=function(){function e(e){this.valueCreationFunc=e}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}();!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(VE||(VE={}));var KE=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.bytecode=[],this.blocks=[];for(var n="",a=0;a<t.length;a+=1){var i=t.charCodeAt(a);if(126===i&&a+1<t.length){var o=t.charCodeAt(a+1);if(63===o||42===o){n+=t.charAt(a+1),a+=1;continue}}63!==i&&42!==i?n+=t.charAt(a):(this.pushBlock(n),n="",this.pushMeta(i))}this.pushBlock(n),r&&this.pushMeta(42)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(VE.OP_DOT)}},e.prototype.pushMeta=function(e){63===e?this.bytecode.push(VE.OP_DOT):this.bytecode.push(VE.OP_DOTSTAR)},e.prototype.test=function(e){var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(var a=0;a<n.length;a+=1){var i=Number(n[a]);if(i!==this.bytecode.length){var o=this.bytecode[i];switch(o){case VE.OP_DOT:this.addState(t,i+1);break;case VE.OP_DOTSTAR:this.addState(t,i);break;default:var u=this.blocks[o];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,i+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;var r=this.bytecode;t<r.length&&r[t]===VE.OP_DOTSTAR&&(e[t+1]=!0)},e}(),qE={"=":Ue.Eq,"<":Ue.Lt,">":Ue.Gt},JE={"<>":Ue.Ne,"<=":Ue.Le,">=":Ue.Ge};function QE(e,t){(function(e,t){for(var r=0;r<t.length;r+=1)if(e.isNumeral(t.charCodeAt(r)))return!0;return!1})(e,t)&&tv(wt(["potential string -> number coercion: "+gi(t)]))}function XE(e,t){if("string"!=typeof t)return t;var r,n,a=(r=t).length>=2&&void 0!==(n=JE[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=qE[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){if(0===e.stringCompareCI(t,e.trueName))return!0;if(0===e.stringCompareCI(t,e.falseName))return!1;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(void 0!==n&&0===e.stringCompareCI(n,t))return Ce(r)}var a=e.parseNumber(t);return Ft(a)?a:(QE(e,t),t)}(e,a[1])}}function YE(e,t,r,n){var a=function(e,t){var r="object"==typeof t&&"FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:Ue.Eq,operand:t},n=e.config,a=n.mathpack,i=n.localeInfo;if(r.operator===Ue.Ne&&""===r.operand)return function(e){return!df(e)};if(r.operator===Ue.Eq&&""===r.operand)return df;if(void 0!==r.operator&&""===r.operand)return function(e){return!1};if(void 0===r.operator&&""===r.operand)return function(e){return df(e)||""===e};var o,u,c=void 0===r.operator?Ue.Eq:r.operator;switch(typeof r.operand){case"number":return o=c,u=r.operand,function(e){var t=mf(e)?e.getFallback():e;if("number"==typeof t)return Lv(a,o,t,u);if("string"==typeof t&&o===Ue.Eq){var r=i.parseNumber(t);return Ft(r)?Lv(a,o,r,u):(QE(i,t),!1)}return o===Ue.Ne};case"boolean":return function(e,t){return function(r){var n=mf(r)?r.getFallback():r;return"boolean"==typeof n?Mv(e,n,t):e===Ue.Ne}}(c,r.operand);case"string":return function(e,t){switch(e){case Ue.Eq:case Ue.Ne:var r=new KE(i,t);return function(t){var n=mf(t)?t.getFallback():t;return"string"!=typeof n?e===Ue.Ne:r.test(n)===(e===Ue.Eq)};case Ue.Lt:case Ue.Gt:case Ue.Le:case Ue.Ge:return function(r){var n=mf(r)?r.getFallback():r;return"string"==typeof n&&wv(i,e,n,t)}}}(c,r.operand);case"object":return ff(r.operand)?function(e,t){return function(r){var n=mf(r)?r.getFallback():r;return ff(n)?_v(e,n.type-t.type):e===Ue.Ne}}(c,r.operand):A("calc.funcs.criteria.compileCriteria",r.operand)}return A("calc.funcs.criteria.compileCriteria",r.operand)}(e,XE(e.config.localeInfo,r)),i=t,o=void 0===n?i:n;return new hl(o.rows,o.cols,pr(i.denseRows,o.denseRows),pr(i.denseCols,o.denseCols),(function(e,t){var r=i.get(e,t);return a(r)?o.get(e,t):void 0}),(function(){var e=i.getSparse();return a(e)?o.getSparse():void 0}))}function zE(e,t,r,n,a){var i=function(n,i,u,c){if("object"==typeof i&&i.kind===x.Array){for(var s=new ll(i.rows,i.cols,i.opers),l=n,f=0;f<u;f+=1)l=o(l,s);return l}var d=(c&&void 0!==a?a:r)(e,i);return null==d?n:t(n,d,u)};function o(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var a=0;a<t.cols;a+=1){var o=t.get(n,a);void 0!==o&&(r=i(r,o,1,!0))}return r}function u(e,t){for(var r=e,n=t.getSparse(),a=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var u=0;u<t.denseCols;u+=1){var c=t.get(o,u);void 0!==c&&(r=i(r,c,1,!1))}a>0&&void 0!==n&&(r=i(r,n,a,!1))}var s=(t.rows-t.denseRows)*t.cols;return s>0&&void 0!==n&&(r=i(r,n,s,!1)),r}return n.reduce((function(e,t){return"object"==typeof t&&t.kind===ih.RangeValues?t.arrays.reduce(u,e):i(e,t,1,!1)}),void 0)}function ZE(e){return function(t,r){return e(t)(r[0])}}function $E(e){return function(t,r){return e(t)(r[0],r[1])}}var ey=function(e){return"number"==typeof e?e:k("calc.funcs.assertNumber")},ty=function(e){return"string"==typeof e?e:k("calc.funcs.assertString")};function ry(e,t){var r=kf(e,t,!1),n=mf(r)?r.getFallback():r;switch(typeof n){case"number":return n;case"boolean":return ye;case"string":var a=e.coerceOper(n,x.Number);return"number"==typeof a?a:ye;case"object":switch(n.kind){case x.Error:return n;case x.Array:return ye;case x.Missing:return be;case x.Blank:return e.mathpack.zero}}return A("calc.funcs.chkNumOper",n)}function ny(e,t){var r=mf(t)?t.getFallback():t;switch(typeof r){case"number":return r;case"object":break;default:return}switch(r.kind){case x.Error:return r;case x.Missing:case x.Blank:return;default:return A("calc.funcs.arithmeticOperationCoerce",r)}}function ay(e,t){var r=mf(t)?t.getFallback():t;switch(typeof r){case"boolean":return r?e.mathpack.one:e.mathpack.zero;case"number":return r;case"string":return e.mathpack.zero;case"object":break;default:return A("calc.funcs.arithmeticAOperationCoerce",r)}switch(r.kind){case x.Error:return r;case x.Missing:case x.Blank:return;default:return A("calc.funcs.arithmeticAOperationCoerce",r)}}function iy(e){return function(t,r,n){if(void 0!==t&&ff(t))return t;if(b("calc.funcs.numberReducer",void 0===t||"number"==typeof t),ff(r))return r;var a,i;b("calc.funcs.numberReducer","number"==typeof r),void 0===t?(a=r,i=n-1):(a=t,i=n);for(var o=0;o<i;o+=1){var u=e(a,r);if(ff(u))return u;a=u}return a}}function oy(e){return function(t,r,n){return e.count+=n,r}}function uy(e,t,r){if("number"!=typeof r)return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if("object"==typeof r&&r.kind===ih.RangeValues)for(var n=r.arrays.length-1;n>=0;n-=1){var a=r.arrays[n];if(a.rows>a.denseRows||a.cols>a.denseCols)if("number"==typeof(u=a.getSparse()))return u;for(var i=a.denseRows-1;i>=0;i-=1)for(var o=a.denseCols-1;o>=0;o-=1){var u;if("number"==typeof(u=a.get(i,o)))return u}}}}(t);return"number"!=typeof n?r:e.mathpack.checkAlmostCancellation(n,r)}function cy(e,t,r){var n=zE(t,iy(t.mathpack.add),ny,r);return null==n?t.mathpack.zero:(e&&(n=uy(t,r,n)),n)}var sy=cy.bind(void 0,!1),ly=cy.bind(void 0,!0);function fy(e,t){var r=e.dereferenceAllOpers(t),n=CO(ny),a=zE(e,iy(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a}function dy(e){return e.kind===x.Range&&1!==e.ranges.length}function hy(e,t,r){if(dy(t))return it(ye);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return at({values:n,valuesToFilter:n})}if(dy(r))return it(ye);var a=function(e,t){var r=e.ranges[0],n=t.ranges[0],a=vr(r.cols,16384-n.col),i=vr(r.rows,(1<<20)-n.row),o=zt(r.row,r.col,i,a),u=Me(e.sheets,o),c=zt(n.row,n.col,i,a),s=Me(t.sheets,c);return{actualEvalRange:u,actualFilterRange:s}}(t,r),i=a.actualEvalRange,o=a.actualFilterRange,u=i.ranges[0],c=o.ranges[0],s=e.dereferenceAllOpers([i])[0];return u.col===c.col&&u.row===c.row?at({values:s,valuesToFilter:s}):at({values:s,valuesToFilter:e.dereferenceAllOpers([o])[0]})}function vy(e,t){var r=t,n=r[0],a=r[1],i=hy(e,n,r[2]);if(!ot(i))return i.reason;var o=i.value,u=o.values,c=o.valuesToFilter,s=[hh([YE(e,u.arrays[0],a,c.arrays[0])])];return sy(e,s)}function py(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a,i,o=t[0];if(dy(o))return it(ye);if(r){var u=t[1],c=e.dereferenceAllOpers([o])[0];a=YE(e,c.arrays[0],u),i=2}else{a=e.dereferenceAllOpers([o])[0].arrays[0],i=1}for(var s=i;s<t.length;s+=2){var l=t[s],f=t[s+1];if(dy(l))return it(ye);if(l.ranges[0].cols!==o.ranges[0].cols||l.ranges[0].rows!==o.ranges[0].rows)return it(ye);c=e.dereferenceAllOpers([l])[0];a=YE(e,c.arrays[0],f,a)}return n&&(a=a.strict()),at(hh([a]))}function my(e,t){if(3===t.length)return vy(e,[t[1],t[2],t[0]]);var r=py(e,t);return ot(r)?sy(e,[r.value]):r.reason}function gy(e,t){var r=zE(e,iy(e.mathpack.mul),ny,t);return null==r?e.mathpack.zero:r}function Cy(e,t,r,n,a,i){var o=zE(a,iy(a.mathpack.add),e,i,t);if(null==o)return n;if(r&&(o=uy(a,i,o)),ff(o))return o;var u={count:0},c=zE(a,oy(u),e,i,t);b("calc.funcs.averageCoerceInner","number"==typeof o&&"number"==typeof c&&u.count>0);var s=a.mathpack.div(o,a.mathpack.fromNumber(u.count));return ff(s)?s:[s,u.count]}function Sy(e,t,r,n,a){var i=Cy(e,t,r,Ee,n,a);return Array.isArray(i)?i[0]:i}var Ey=Sy.bind(void 0,ny,void 0,!1),yy=Sy.bind(void 0,ny,void 0,!0),Oy=Sy.bind(void 0,ay,(function(e,t){var r=mf(t)?t.getFallback():t;return"string"==typeof r?e.mathpack.zero:ny(0,r)}),!0);function Ay(e,t){var r=t,n=r[0],a=r[1],i=hy(e,n,r[2]);if(!ot(i))return i.reason;var o=i.value,u=o.values,c=o.valuesToFilter,s=[hh([YE(e,u.arrays[0],a,c.arrays[0]).strict()])];return Ey(e,s)}function ky(e,t){if(3===t.length)return Ay(e,[t[1],t[2],t[0]]);var r=py(e,t,void 0,!0);return ot(r)?Ey(e,[r.value]):r.reason}function by(e,t){var r=e.dereferenceAllOpers(t);return Oy(e,r)}function Ry(e,t,r,n,a){for(var i=void 0,o=0,u="",c=function(e,t){return e.coerceOper(t,x.String)},s=function(e,n,a){if(void 0!==e&&ff(e))return e;for(var c=0;c<a;c+=1){if(void 0!==i&&t.length>0&&(!r||i.length>0)){var s=t[o];if(o=(o+1)%t.length,u.length+s.length>32767)return ye;u+=s}if(ff(n))return n;if("string"!=typeof n)return k("calc.funcs.concatInner: expected string in reducer");if(u.length+n.length>32767)return ye;if(u+=n,i=n,""===n&&(0===t.length||r))break}return n},l=0;l<a.length;l+=1){var f=n[l];if(pf(f)&&f.ranges.length>1)return ye;var d=zE(e,s,c,a.slice(l,l+1));if(void 0!==d&&ff(d))return d;b("calc.funcs.concatInner: expected string from reduce","string"==typeof d)}if(r&&""===i&&t.length>0&&u.length>0){var h=t[(o+t.length-1)%t.length];u=u.substring(0,u.length-h.length)}return u}function Iy(e,t){var r=t,n=r[0],a=r[1],i=r.slice(2),o=[];if(!vf(n)){if(pf(n)&&n.ranges.length>1)return ye;var u=zE(e,$y(o,ty),(function(e,t){return e.coerceOper(t,x.String)}),e.dereferenceAllOpers([n]));if(void 0!==u&&ff(u))return u;b("calc.funcs.textjoin: expected string from reduce","string"==typeof u)}return Ry(e,o,vf(a)||a,i,e.dereferenceAllOpers(i))}function Ty(e,t,r){var n={count:0};return zE(t,oy(n),e,r),t.mathpack.fromNumber(n.count)}var Ny=Ty.bind(void 0,(function(e,t){var r=mf(t)?t.getFallback():t;return"number"==typeof r?r:void 0}));function Fy(e,t){var r=e.dereferenceAllOpers(t);return Ny(e,r)}var _y=Ty.bind(void 0,(function(e,t){var r=mf(t)?t.getFallback():t;return df(r)||""===r?r:void 0}));var My=Ty.bind(void 0,(function(e,t){var r=mf(t)?t.getFallback():t;return"object"!=typeof r||r.kind===x.Error?r:void 0}));var wy=Ty.bind(void 0,(function(e,t){return t}));function Ly(e,t){var r=t,n=r[0],a=r[1];if(dy(n))return ye;var i=e.dereferenceAllOpers([n])[0],o=[hh([YE(e,i.arrays[0],a)])];return wy(e,o)}function Dy(e,t){if(2===t.length)return Ly(e,t);var r=py(e,t,!0);return ot(r)?wy(e,[r.value]):r.reason}var Uy=function(e,t,r){return e.mathpack.cond2(t,r)>0},xy=function(e,t,r){return e.mathpack.cond2(t,r)<0};function Py(e,t,r,n,a){var i=zE(n,(function(t,r,a){return void 0===t?r:ff(t)?t:(b("calc.funcs.minMaxCoerceInner","number"==typeof t),ff(r)?r:(b("calc.funcs.minMaxCoerceInner","number"==typeof r),e(n,t,r)?t:r))}),t,a,r);return null==i?n.mathpack.zero:i}var Gy=Py.bind(void 0,Uy,ny,void 0),Vy=Py.bind(void 0,xy,ny,void 0),By=Py.bind(void 0,Uy,ay,ny),Wy=Py.bind(void 0,xy,ay,ny);function jy(e,t){var r=e.dereferenceAllOpers(t);return By(e,r)}function Hy(e,t){var r=e.dereferenceAllOpers(t);return Wy(e,r)}function Ky(e,t){var r=py(e,t);return ot(r)?Gy(e,[r.value]):r.reason}function qy(e,t){var r=py(e,t);return ot(r)?Vy(e,[r.value]):r.reason}function Jy(e,t){var r=mf(t)?t.getFallback():t;switch(typeof r){case"boolean":return r;case"number":return 0!==e.mathpack.cond(r);case"object":break;default:return}switch(r.kind){case x.Error:return r;case x.Missing:case x.Blank:return;default:return A("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function Qy(e,t,r){var n=zE(t,(function(t,r,n){return void 0!==t&&ff(t)?t:ff(r)?r:(b("calc.funcs.booleanInner",(void 0===t||"boolean"==typeof t)&&"boolean"==typeof r),e(t,r,n))}),Jy,r);return null==n?ye:n}var Xy=Qy.bind(void 0,(function(e,t){return!1!==e&&t})),Yy=Qy.bind(void 0,(function(e,t){return!0===e||t})),zy=Qy.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function Zy(e,t){var r=e.dereferenceAllOpers(t);return zy(e,r)}function $y(e,t){return function(r,n,a){if(void 0!==r&&ff(r))return r;if(!ff(n))for(var i=t(n),o=0;o<a;o+=1)e.push(i);return n}}function eO(e,t,r,n){var a=[],i=zE(t,$y(a,ey),ny,[r]);if(null==i)return ke;if(ff(i))return i;var o=t.mathpack;if(o.cond2(n,o.one)<0)return ke;if(o.cond2(n,o.fromNumber(a.length))>0)return ke;var u=a.sort(o.cond2);if(e){var c=ey(o.add(ey(o.sub(o.fromNumber(a.length),n)),o.one));return u[o.lfix(c)-1]}return u[o.lfix(n)-1]}var tO=eO.bind(void 0,!0),rO=eO.bind(void 0,!1);function nO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return tO(e,n,a)}function aO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return rO(e,n,a)}function iO(e,t,r,n){var a=e.mathpack,i=[],o=zE(e,$y(i,ey),ny,t);if(null==o)return ke;if(ff(o))return o;if(ff(r))return r;if(a.cond(r)<0)return ke;if(a.cond2(r,a.one)>0)return ke;var u=i.sort(a.cond2),c=ey(a.sub(a.fromNumber(u.length),a.one)),s=ey(a.add(a.fromNumber(u.length),a.one)),l=ey(n?a.mul(c,r):a.sub(ey(a.mul(s,r)),a.one));if(a.cond(l)<0||a.cond2(l,c)>0)return ke;var f=a.lfix(l),d=ey(a.sub(l,a.fromNumber(f)));if(0===a.cond(d))return u[f];var h=a.sub(u[f+1],u[f]);return ff(h)?h:a.add(u[f],ey(a.mul(h,d)))}var oO=function(e,t,r){return iO(e,[t],r,!0)};function uO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return oO(e,n,a)}var cO=function(e,t,r){return iO(e,[t],r,!1)};function sO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return cO(e,n,a)}function lO(e,t){var r=e.mathpack;if(r.cond(t)<0)return ke;if(r.cond2(t,r.fromNumber(5))>=0)return ke;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}var fO=function(e,t,r){return iO(e,[t],lO(e,r),!0)};function dO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return fO(e,n,a)}var hO=function(e,t,r){return iO(e,[t],lO(e,r),!1)};function vO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return hO(e,n,a)}function pO(e,t){return iO(e,t,e.mathpack.fromNumber(.5),!0)}function mO(e,t){var r=e.dereferenceAllOpers(t);return pO(e,r)}function gO(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1],i=[],o=zE(e,$y(i,ey),ny,[n]);if(null==o)return ke;if(ff(o))return o;var u=e.mathpack;if(u.cond(a)<0)return ke;if(u.cond2(a,u.one)>=0)return ke;i=i.sort(u.cond2);var c=u.lfix(ey(u.div(ey(u.mul(u.fromNumber(i.length),a)),u.fromNumber(2))));b("calc.funcs.trimmean",c+c<i.length);var s=i[c],l=i[i.length-1-c],f=0,d=0,h=zE(e,iy(e.mathpack.add),(function(e,t){var r=ny(0,t);if(void 0===r)return r;b("calc.funcs.trimmean: unexpected error","number"==typeof r);var n=e.mathpack;if(n.cond2(r,s)<0)f+=1;else{if(!(n.cond2(r,l)>0))return r;d+=1}}),[n]);b("calc.funcs.trimmean: found no elements","number"==typeof h),b("calc.funcs.trimmean: trimmed too many",f<=c&&d<=c);for(var v=h;f<c;f+=1){if(ff(p=u.sub(v,s)))return p;v=p}for(;d<c;d+=1){var p;if(ff(p=u.sub(v,l)))return p;v=p}return u.div(v,u.fromNumber(i.length-c-c))}function CO(e){return function(t,r){var n=e(t,r);return"number"==typeof n?t.mathpack.mul(n,n):n}}function SO(e,t){return function(r,n){var a=e(r,n);if("number"!=typeof a)return a;var i=r.mathpack,o=i.sub(a,t);return ff(o)?o:i.mul(o,o)}}function EO(e,t,r,n){var a={count:0};if(null==zE(r,oy(a),e,n,t))return Ee;b("calc.funcs.varFirstPass: unexpected count type",a.count>=1);var i=iy(r.mathpack.add),o=zE(r,i,e,n,t),u=zE(r,i,CO(e),n,void 0===t?void 0:CO(t));if(b("calc.funcs.varFirstPass: unexpected sum type",null!=o),ff(o))return o;b("calc.funcs.varFirstPass: unexpected error","number"==typeof o&&"number"==typeof u);var c=r.mathpack,s=c.div(o,c.fromNumber(a.count));return ff(s)?s:[a.count,o,u,s]}function yO(e,t,r,n,a){var i=zE(r,iy(r.mathpack.add),SO(e,a),n,void 0===t?void 0:SO(t,a));return b("calc.funcs.varSecondPass: unexpected error","number"==typeof i),i}function OO(e,t,r,n){var a=EO(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],c=a[2],s=a[3];if(o<2)return Ee;var l=i.mul(u,u);if(ff(l))return l;var f=ey(i.div(l,i.fromNumber(o))),d=ey(i.sub(c,f));if(0===i.cond(s))return i.cond(d)<0?i.zero:i.div(d,i.fromNumber(o-1));if(i.cond(d)>=0){var h=ey(i.div(d,i.fromNumber(o-1)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var v=i.div(f,c),p=ff(v)?v:i.sub(v,i.one);if(!ff(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(s,h),g=ff(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!ff(g)&&i.cond(g)<0)return h}}}var C=yO(e,t,r,n,s);return i.cond(C)<0?i.zero:i.div(C,i.fromNumber(o-1))}function AO(e,t,r,n){var a=EO(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,o=a[0],u=a[1],c=a[2],s=a[3];if(o<1)return Ee;var l=i.mul(u,u);if(ff(l))return l;var f=i.mul(c,i.fromNumber(o));if(ff(f))return f;var d=ey(i.sub(f,l));if(0===i.cond(s))return i.cond(d)<0?i.zero:i.div(d,i.fromNumber(o*o));if(i.cond(d)>=0){var h=ey(i.div(d,i.fromNumber(o*o)));if(i.cond2(h,i.fromNumber(21219957905e-324))>0){var v=i.div(ey(i.div(l,i.fromNumber(o))),c),p=ff(v)?v:i.sub(v,i.one);if(!ff(p)&&i.cond2(i.abs(p),i.fromNumber(.01))>0){var m=i.div(s,h),g=ff(m)?m:i.sub(i.abs(m),i.fromNumber(1e3));if(!ff(g)&&i.cond(g)<0)return h}}}var C=yO(e,t,r,n,s);return i.cond(C)<0?i.zero:i.div(C,i.fromNumber(o))}var kO=OO.bind(void 0,ny,void 0),bO=AO.bind(void 0,ny,void 0),RO=OO.bind(void 0,ay,ny),IO=AO.bind(void 0,ay,ny);function TO(e){return function(t,r){var n=e(t,r);return"number"!=typeof n?n:t.mathpack.sqrt(n)}}var NO=TO(kO),FO=TO(bO),_O=TO(RO),MO=TO(IO);function wO(e,t){var r=e.dereferenceAllOpers(t);return NO(e,r)}function LO(e,t){var r=e.dereferenceAllOpers(t);return FO(e,r)}function DO(e,t){var r=e.dereferenceAllOpers(t);return _O(e,r)}function UO(e,t){var r=e.dereferenceAllOpers(t);return MO(e,r)}function xO(e,t){var r=e.dereferenceAllOpers(t);return kO(e,r)}function PO(e,t){var r=e.dereferenceAllOpers(t);return bO(e,r)}function GO(e,t){var r=e.dereferenceAllOpers(t);return RO(e,r)}function VO(e,t){var r=e.dereferenceAllOpers(t);return IO(e,r)}var BO=[yy,Ny,My,Gy,Vy,gy,NO,FO,ly,kO,bO];function WO(e,t){var r,n=[],a=zE(e,(r=n,function(e,t,n){if(void 0!==e&&ff(e))return e;if("number"==typeof t)for(var a=0;a<n;a+=1)r.push({value:t,index:r.length});return t}),ny,t);if(null==a)return be;if(ff(a))return a;var i=e.mathpack,o=n.sort((function(e,t){return i.cond2(e.value,t.value)})),u=1,c=0,s=1/0,l=[];function f(e){u=1,s=e.index}var d,h,v,p=function(e){var t=e.value;u>c?(c=u,l.length=0,l.push({value:t,index:s})):u===c&&l.push({value:t,index:s})};f(o[0]);for(var m=1;m<o.length;m+=1)h=o[m-1],v=o[m],0===i.cond2(h.value,v.value)?((d=o[m]).index<s&&(s=d.index),u+=1):(p(o[m-1]),f(o[m]));return p(o[o.length-1]),c<2?be:(b("calc.funcs.modeInner: unexpected error",0!==l.length),l.sort((function(e,t){return e.index-t.index})))}function jO(e,t){var r=WO(e,t);return Array.isArray(r)?r[0].value:r}function HO(e,t){var r=e.dereferenceAllOpers(t);return jO(e,r)}function KO(e,t){var r=e.dereferenceAllOpers(t),n=WO(e,r);return Array.isArray(n)?Fe(n.length,1,n.map((function(e){return[e.value]}))):n}function qO(e){return"object"!=typeof e||e.kind!==ih.RangeValues?e:hh(e.arrays.map((function(e){return e.map((function(e){var t=e[0],r=e[1];return void 0!==r&&function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(void 0!==r&&r.kind===L.WorksheetFuncName&&(r.id===we.SUBTOTAL||r.id===we.AGGREGATE))return!0}return!1}(r.formula.annotations)?void 0:t}))})))}function JO(e,t){var r=e.mathpack.sfix(t[0]),n=BO.length;if(!(r>=1&&r<=n||r>=101&&r<=n+100))return ye;var a=r>100||e.isInFilterMode(t.slice(1)),i=e.dereferenceAllOpersAndFormulae(t.slice(1),a).map(qO);return(0,BO[r%100-1])(e,i)}var QO=Object(j.f)(BO,[pO,jO]),XO=[tO,rO,oO,fO,cO,hO];function YO(e,t){var r=e.mathpack,n=r.sfix(t[0]),a=r.sfix(t[1]);if(!(n>=1&&n<=QO.length+XO.length&&a>=0&&a<=7))return ye;var i=1==(1&a),o=2==(2&a),u=!(4==(4&a));function c(t){var r=u?e.dereferenceAllOpersAndFormulae(t,i).map(qO):e.dereferenceAllOpers(t,i);return o&&(r=r.map((function(e){if("object"!=typeof e)return e;if(e.kind===ih.RangeValues)return hh(e.arrays.map((function(e){return e.map((function(e){return void 0===e||ff(e)?void 0:e}))})));if(e.kind===x.Array){var t=e.opers.map((function(e){return e.map((function(e){return void 0===e||ff(e)?void 0:e}))}));return function(e,t,r){return R("calc.runtime.coercedArrayOper",e),R("calc.runtime.coercedArrayOper",t),r.length!==e?k("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:x.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,t)}return e}))),r}if(n>QO.length){if(4!==t.length)return ye;var s=x.Number,l=e.coerceOper(e.dereferenceOper(t[3],s),s);if(ff(l))return ye;var f=t[2];if(f.kind===x.Range&&!ct(f.sheets))return ye;var d=c([f])[0],h=QO.length;return(0,XO[n-h-1])(e,d,l)}for(var v=2;v<t.length;v+=1){var p=t[v];if(!pf(p)||!ct(p.sheets))return ye}var m=c(t.slice(2));return b("calc.funcs.aggregate: requested non-array function with unexpected number",n>=1&&n<=QO.length),(0,QO[n-1])(e,m)}function zO(e,t){return $O(e,t,!1)}function ZO(e,t){return $O(e,t,!0)}function $O(e,t,r){var n=t[0],a=!0===t[2]?1:-1,i=0,o=0,u=e.mathpack,c=zE(e,(function(e,t,r){if(void 0!==e)return e;if(ff(t))return t;var c=u.cond2(n,ey(t));0===c?i+=r:c===a&&(o+=r)}),ny,e.dereferenceAllOpers([t[1]]));if(void 0!==c)return c;if(0===i)return be;var s=u.fromNumber(o+1);if(r){var l=u.div(u.fromNumber(i-1),u.fromNumber(2));return u.add(s,ey(l))}return s}function eA(e){return function(t,r){var n=e(t,r);return"number"==typeof n?t.mathpack.abs(n):n}}function tA(e,t,r){var n=Cy(ny,void 0,!0,ke,t,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1],o=zE(t,iy(t.mathpack.add),e(function(e,t){return function(r,n){var a=e(r,n);return"number"==typeof a?r.mathpack.sub(a,t):a}}(ny,a)),r);return b("calc.funcs.sumDevAndCount",void 0!==o),ff(o)?o:[ey(o),i]}function rA(e,t){var r=e.dereferenceAllOpers(t),n=tA(eA,e,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1];return e.mathpack.div(a,e.mathpack.fromNumber(i))}function nA(e,t){var r=e.dereferenceAllOpers(t),n=tA(CO,e,r);return Array.isArray(n)?n[0]:n}var aA=ri.numErrorOper;var iA=ZE((function(e){return e.mathpack.sqrt})),oA=ZE((function(e){return e.mathpack.exp})),uA=$E((function(e){return e.mathpack.power})),cA=ZE((function(e){return e.mathpack.ln})),sA=ZE((function(e){return e.mathpack.log}));var lA=ZE((function(e){return e.mathpack.sin})),fA=ZE((function(e){return e.mathpack.cos})),dA=ZE((function(e){return e.mathpack.tan})),hA=ZE((function(e){return e.mathpack.asin})),vA=ZE((function(e){return e.mathpack.acos})),pA=ZE((function(e){return e.mathpack.atan})),mA=$E((function(e){return e.mathpack.atan2}));function gA(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)}var CA=$E((function(e){return e.mathpack.round}));function SA(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack;return i.roundDown(n,null!=a?a:i.zero)}var EA=$E((function(e){return e.mathpack.roundUp})),yA=$E((function(e){return e.mathpack.roundDown}));function OA(e,t){var r=ry(e,t[0]);if(ff(r))return r;var n=ry(e,t[1]);if(ff(n))return n;var a=e.mathpack;if(0===a.cond(n))return a.zero;if(0!==a.cond(r)&&a.cond(r)<0!=a.cond(n)<0)return aA;var i=a.div(r,n);if(ff(i))return aA;var o=a.floor(i),u=ey(a.sub(i,o)),c=a.fromNumber(.5-5e-15);if(a.cond2(u,c)<0)return a.mul(o,n);var s=a.add(o,a.one);return ff(s)?s:a.mul(s,n)}function AA(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return aA;if(0===n||0===a)return e.zero;var i=e.div(t,r);return ff(i)?i:e.mul(e.ceil(e.viewRound(i)),r)}function kA(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return aA;if(0===n&&0===a)return t;var i=e.div(t,r);return ff(i)?i:e.mul(e.floor(e.viewRound(i)),r)}function bA(e,t){return AA(e.mathpack,t[0],t[1])}function RA(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=void 0===a||vf(a)?o.one:o.abs(a),c=void 0===i||vf(i)?o.zero:i;return 0!==o.cond(c)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:AA(o,n,u)}function IA(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack,o=void 0===a||vf(a)?i.one:i.abs(a);return 0===i.cond(o)?i.zero:AA(i,n,o)}function TA(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=void 0===a||vf(a)?o.one:o.abs(a),c=void 0===i||vf(i)?o.zero:i;return 0!==o.cond(c)&&o.cond(n)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:kA(o,n,u)}function NA(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack,o=void 0===a||vf(a)?i.one:i.abs(a);return 0===i.cond(o)?i.zero:kA(i,n,o)}function FA(e,t,r){var n=e.div(t,r);if(ff(n))return n;var a=e.mul(e.trunc(n),r);if(ff(a))return a;var i=e.sub(t,a);return!ff(i)&&e.cond(t)<0?e.abs(i):i}function _A(e,t,r){var n=r[0],a=t.mathpack;if(a.cond(n)>=0){var i=a.ceil(n);return 0===a.cond2(ey(FA(a,i,a.fromNumber(2))),a.one)===e?a.add(i,a.one):i}var o=a.floor(n);return 0===a.cond2(ey(FA(a,o,a.fromNumber(2))),a.one)===e?a.sub(o,a.one):o}var MA=_A.bind(void 0,!0),wA=_A.bind(void 0,!1),LA=ZE((function(e){return e.mathpack.abs}));function DA(e,t){var r=ry(e,t[0]);if(ff(r))return r;var n=ry(e,t[1]);if(ff(n))return n;var a=e.mathpack;if(0===a.cond(n))return Ee;var i=a.div(r,n);return ff(i)?aA:a.cond(i)>0?a.floor(i):a.ceil(i)}function UA(e,t){var r=ry(e,t[0]);if(ff(r))return r;var n=e.mathpack,a=n.floor(r);if(n.cond2(a,n.fromNumber(-1))<0||n.cond2(a,n.fromNumber(300))>0)return aA;for(var i=n.one,o=n.toNumber(a);o>1;o-=2){if(ff(i))return i;i=n.mul(n.fromNumber(o),i)}return i}function xA(e,t){var r=ry(e,t[0]);if(ff(r))return r;var n=e.mathpack;if(n.cond(r)<0)return aA;var a=n.mul(n.pi,r);return ff(a)?a:n.sqrt(a)}function PA(e,t){return kf(e,t[0],!0)instanceof vp}function GA(e,t){var r=ry(e,t[0]);if(ff(r))return r;var n=e.mathpack,a=ey(n.add(n.abs(r),n.fromNumber(1.0000000000000003e-10))),i=ey(n.div(n.floor(a),n.fromNumber(2)));return 0===n.cond2(i,n.floor(i))}function VA(e,t,r){var n=t[0];if(!ct(n.sheets))return ye;var a=n.ranges[0];if(e.calcingArray||!lt(a)){var i=n.sheets;return Fe(a.rows,a.cols,vl(a.rows,a.cols,(function(t,n){var o=rr(i,Zt(a.row+t,a.col+n));return r(e.getCellFormula(o),o)})))}var o=St(tr(n.sheets,a));return r(e.getCellFormula(o),o)}function BA(e,t){return VA(e,t,(function(e){return void 0!==e}))}function WA(e,t){return VA(e,t,(function(t,r){if(void 0===t)return be;var n=e.formatFormula(t,r.range);return t.source.kind===Vt.Cell?n:"{"+n+"}"}))}function jA(e){return 55296==(64512&e)}function HA(e){return 56320==(64512&e)}function KA(e){return 55296==(63488&e)}function qA(e,t){if(jA(e)&&HA(t))return 65536+((1023&e)<<10|1023&t)}function JA(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n>=e.length)return;jA(e.charCodeAt(n))&&n+1<e.length&&HA(e.charCodeAt(n+1))?n+=2:n+=1}return n}function QA(e,t,r){for(var n=0,a=t;a<r;n+=1){jA(e.charCodeAt(a))&&a+1<r&&HA(e.charCodeAt(a+1))?a+=2:a+=1}return n}var XA=ri.valueErrorOper;function YA(e,t){return void 0===t?1:e.cond(t)<0?XA:e.sfix(t)}function zA(e,t){var r=t;return r[0]===r[1]}function ZA(e,t){var r=t[0],n=t[1],a=e.mathpack,i=a.fix(n);return a.cond(n)<0||i>2147483647?XA:""===r?"":i*r.length>32767?XA:r.repeat(i)}function $A(e,t){for(var r=t[0],n="",a=0;a<r.length;){for(;a<r.length&&32===r.charCodeAt(a);)a+=1;for(var i=a;a<r.length;){var o=32===r.charCodeAt(a);if(a+=1,o)break}n+=r.substring(i,a)}return n.length>0&&32===n.charCodeAt(n.length-1)&&(n=n.substring(0,n.length-1)),n}function ek(e,t){for(var r=t[0],n="",a=0;a<r.length;a+=1){var i=r.charCodeAt(a);(i>=256||(127&i)>=32)&&(n+=r.charAt(a))}return n}function tk(e,t){var r=e.mathpack.sfix(t[0]);return r<1||r>255?XA:String.fromCharCode(r)}function rk(e,t){var r=t[0],n=e.mathpack,a=n.lfix(n.trunc(r));if(n.cond2(r,n.one)<0||a>=1114112)return XA;return a<=65535&&KA(a)||a>=64976&&a<=65007||(65535&a)>=65534?be:function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)}(a)}function nk(e,t){var r=t[0];if(0===r.length)return XA;var n=r.charCodeAt(0);return n>255?tv(El(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)}function ak(e,t){var r=t[0];if(0===r.length)return XA;var n=r.charCodeAt(0),a=e.mathpack;if(!KA(n))return a.fromNumber(n);if(1===r.length)return XA;var i=qA(n,r.charCodeAt(1));return void 0===i?XA:a.fromNumber(i)}function ik(e){return e>=65&&e<=90||e>=97&&e<=122}function ok(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():tv(El([t+" for non-ASCII input"]))}function uk(e,t){var r=t[0];return ok(r,"LOWER",r.toLowerCase.bind(r))}function ck(e,t){var r=t[0];return ok(r,"UPPER",r.toUpperCase.bind(r))}function sk(e,t){var r=t[0];return ok(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var a=n;n<e.length&&!ik(e.charCodeAt(n));)n+=1;if(t+=e.substring(a,n),n===e.length)break;var i=n;for(t+=e.charAt(n).toUpperCase(),n+=1;n<e.length&&ik(e.charCodeAt(n));)n+=1;t+=e.substring(i+1,n)}return t}))}function lk(e,t){var r,n=t,a=n[0],i=n[1],o=n[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return XA;var c=null!=(r=JA(i,0,u))?r:i.length,s=i.indexOf(a,c);return s>=0?e.mathpack.fromNumber(QA(i,0,s)+1):XA}function fk(e,t){var r,n,a=t,i=a[0],o=a[1],u=a[2],c=a[3],s=e.mathpack.sfix(o)-1;if(s<0||s>=32767)return XA;var l=e.mathpack.sfix(u);if(l<0||l>32767)return XA;var f=null!=(r=JA(i,0,s))?r:i.length,d=null!=(n=JA(i,f,l))?n:i.length,h=i.slice(0,f),v=i.slice(d);return h.length+c.length+v.length>32767?XA:h+c+v}function dk(e,t){var r,n=t,a=n[0],i=n[1],o=n[2],u=void 0!==o?e.mathpack.sfix(o)-1:0;if(u<0||u>=2147483647)return XA;for(var c=null!=(r=JA(i,0,u))?r:i.length,s=new KE(e.config.localeInfo,a,!0);c<i.length;c+=1)if(s.test(i.slice(c)))return e.mathpack.fromNumber(QA(i,0,c)+1);return XA}function hk(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=1/0;if(void 0!==o){var c=e.coerceOper(o,x.Number);if(ff(c))return c;if((u=e.mathpack.sfix(c))<1||u>2147483646)return XA}var s=a.length;if(s>0){for(var l="",f=0,d=0;u>=0&&-1!==(d=n.indexOf(a,d));)if((u-=1)===1/0||0===u){var h=n.slice(f,d);if(l.length+h.length+i.length>32767)return XA;l+=h,l+=i,f=d+=s}else d+=1;var v=n.slice(f);return l.length+v.length>32767?XA:l+=v}return n}function vk(e,t){var r=t[0],n=t[1];if(mf(r)){var a=r.getField(n);if(void 0!==a)return a}return Ie}function pk(e,t){for(var r=t[0],n=e.config.localeInfo,a=sl.create(n.stringCompareCI),i=1;i<t.length;i+=2){var o=t[i],u=t[i+1];a=a.setValue(o,u)}return new hp(a,r)}function mk(e,t){var r=t[0];return ct(r.sheets)?e.mathpack.fromNumber(r.ranges.length):ye}function gk(e,t){var r=t[0],n=e.mathpack;return hf(r)?n.fromNumber(r.rows):ct(r.sheets)?r.ranges.length>1?Oe:n.fromNumber(r.ranges[0].rows):ye}function Ck(e,t){var r=t[0],n=e.mathpack;return hf(r)?n.fromNumber(r.cols):ct(r.sheets)?r.ranges.length>1?Oe:n.fromNumber(r.ranges[0].cols):ye}function Sk(e,t){if(0===t.length)return[e.reflectionGridCell,!e.calcingArray];var r=t[0];if(!ct(r.sheets))return ye;if(r.ranges.length>1)return Oe;var n=r.ranges[0];return[n,lt(n)]}function Ek(e,t){var r=Sk(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.row+1):Fe(n.rows,1,vl(n.rows,1,(function(e){return i.fromNumber(n.row+e+1)})))}function yk(e,t){var r=Sk(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.col+1):Fe(1,n.cols,vl(1,n.cols,(function(e,t){return i.fromNumber(n.col+t+1)})))}function Ok(e,t){var r=e.mathpack;if(0===t.length)return r.fromNumber(e.getSheetRangeIndexes(Qt(e.reflectionSheet.document)).length);var n=t[0];return hf(n)?be:r.fromNumber(e.getSheetRangeIndexes(n.sheets).length)}function Ak(e,t){var r=e.mathpack;if(0===t.length){var n=e.reflectionSheet;return void 0===n.index?be:r.fromNumber(e.getSheetRangePosition(n)+1)}var a=t[0];if("string"==typeof a){var i=e.getSheetIndex(e.reflectionSheet.document,a);return void 0===i?be:r.fromNumber(e.getSheetRangePosition(i)+1)}return a.kind===x.Range?r.fromNumber(e.getSheetRangePosition(a.sheets)+1):a.kind===x.Array?be:A("calc.funcs.sheet",a)}function kk(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=r[4];if(!ct(n.sheets))return ye;if(1!==n.ranges.length)return ye;var c=e.mathpack,s=n.ranges[0],l=s.row,f=s.col,d=s.rows,h=s.cols,v=l;"number"==typeof a&&(v+=c.lfix(a));var p=f;"number"==typeof i&&(p+=c.lfix(i));var m=v+d-1;if("number"==typeof o){if(0===(C=c.cond(o)))return Oe;m=v+c.lfix(o)-(C>0?1:-1)}var g=p+h-1;if("number"==typeof u){var C;if(0===(C=c.cond(u)))return Oe;g=p+c.lfix(u)-(C>0?1:-1)}var S=vr(v,m),E=vr(p,g),y=pr(v,m)-S+1,O=pr(p,g)-E+1;return S<0||E<0||S+y>1<<20||E+O>16384?Oe:_e(n.sheets,[zt(S,E,y,O)])}function bk(e,t){var r=t[0];return hf(r)?Fe(r.cols,r.rows,vl(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r}function Rk(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],c=e.mathpack,s="number"!=typeof i?0:c.sfix(i)-1;if(s<0||s>3)return ye;var l=0!=(1&s),f=0!=(2&s),d="boolean"!=typeof o||o?F.A1:F.R1C1,h=function(e,t,r){return d===F.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},v=c.sfix(n);if(!h(f,1<<20,v))return ye;if("number"!=typeof a)return ye;var p=c.sfix(a);if(!h(l,16384,p))return ye;var m=Zt(v<0?1048575:0,p<0?16383:0),g=Y(f?w.Rel:w.Abs,d===F.R1C1&&f?v:v-1),C=Y(l?w.Rel:w.Abs,d===F.R1C1&&l?p:p-1),S=an(e.config.localeInfo,d,m,g,C,!1);return b("calc.funcs.address: cell wrapped",void 0!==S),"string"==typeof u?""===u?"!"+S:u.length>255?ye:fn(e.config.localeInfo,e.config.refStyle,u)+"!"+S:S}function Ik(e,t){var r=t,n=r[0],a=r[1],i="boolean"!=typeof a||a?F.A1:F.R1C1;if(n.length>255||n.length>0&&" "===n[0])return ye;var o=nr(e.originSheet,e.originGridCell),u={lexicalKind:Vt.Indirect,originGridCell:at(o.range),originSheet:at(o.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0},c=e.parseFormula(i,o.range,u,"="+n);if(!ot(c))return Oe;for(var s=c.value.node,l=!1,f=!1;;){if(!l&&s.kind===D.App&&s.head.kind===D.Operator&&s.head.id===Ue.Pound&&1===s.args.length&&yn(hn.CalcDynamicArrayOperators)&&(l=!0,s=s.args[0]),f||s.kind!==D.Name){if(s.kind===D.CellRef){var d=e.getCellRef(s.qualifier,s.ref,o,!0);return void 0===d?Oe:ct(d.sheets)?l?Uv(e,Ue.Pound,[d]):d:Oe}return Oe}var h=e.getNameFormula(s.qualifier,s.whole);if(void 0===h)return Oe;o=nr(o.sheet,Zt(0,0)),s=h[1],f=!0}}var Tk=bf(rt(we.IFS)),Nk=bf(rt(we.SWITCH));function Fk(e,t){var r=t[0];b("calc.funcs.choose","number"==typeof r);var n=e.mathpack.fix(r);return n<1||n>t.length-1?ye:t[n]}function _k(e,t,r,n){var a=n.slice();return e.dereferenceOpers(a,t),If(e,t,(function(n){for(var a=[],i=0;i<n.length;i+=1){var o=It(t,i,n.length);a[i]=e.coerceOper(n[i],o)}return r(e,a)}),a)}function Mk(e,t){for(var r=0;r<t.length;r+=2){var n=t[r];if(hf(n)){var a=t.slice(r);return _k(e,Tk,Mk,a)}if(ff(n))return n;if(b("calc.funcs.ifs","boolean"==typeof n),n)return t[r+1]}return be}function wk(e,t){var r=t[0];if(hf(r))return _k(e,Nk,wk,t);if(ff(r))return r;for(var n=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(typeof t){case"number":return function(e){return mf(e)?tv(wt(["SWITCH with a rich value case"])):"number"==typeof e&&0===r.compare(t,e)};case"string":return function(e){return mf(e)?tv(wt(["SWITCH with a rich value case"])):"string"==typeof e&&0===n.stringCompareCI(t,e)};case"boolean":return function(e){return mf(e)?tv(wt(["SWITCH with a rich value case"])):t===e};default:return mf(t)?tv(wt(["SWITCH with a rich value condition"])):A("calc.funcs.makeSwitchComparer",t)}}(e.config,r),a=1;a<t.length-1;a+=2){var i=x.Error|x.Rich|x.Number|x.Boolean|x.String|x.Array,o=e.coerceOper(e.dereferenceOper(t[a],i),i);if(hf(o))return _k(e,Nk,wk,t);if(ff(o))return o;if(n(o))return t[a+1]}return t.length%2==0?t[t.length-1]:be}function Lk(e,t){return!0}function Dk(e,t){return!1}function Uk(e,t){return!t[0]}function xk(e,t){var r=t,n=r[0],a=r[1];return e.followHyperlinks?n:void 0!==a?a:n}function Pk(e,t){return be}function Gk(e,t){if(pf(t)){if(ct(t.sheets)){var r=_e(t.sheets,[Ct(t.ranges[0])]);return e.dereferenceOper(r,sf)}return ye}return t}function Vk(e,t){var r=Gk(e,t[0]);return"string"==typeof r||ff(r)?r:""}function Bk(e,t){var r=Gk(e,t[0]);if("number"==typeof r||ff(r))return r;var n=e.mathpack;return"boolean"==typeof r&&r?n.one:n.zero}function Wk(e,t){var r=t[0],n=e.mathpack;switch(typeof r){case"number":return n.fromNumber(1);case"string":return n.fromNumber(2);case"boolean":return n.fromNumber(4)}switch(r.kind){case x.Error:return n.fromNumber(16);case x.Array:return n.fromNumber(64);case x.Rich:return n.fromNumber(128)}return A("calc.funcs.type",r)}function jk(e,t){var r=t[0];return ff(r)?e.mathpack.fromNumber(r.type):be}function Hk(e,t){return ye}function Kk(e,t){var r=t,n=r[0],a=r[1],i=void 0===a||vf(a)?e.mathpack.zero:ry(e,a);if(ff(i))return i;var o=ry(e,n);return ff(o)?o:[o,i]}function qk(e,t){var r=Kk(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return 0===i.cond2(n,a)?i.one:i.zero}function Jk(e,t){var r=Kk(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return i.cond2(n,a)>=0?i.one:i.zero}function Qk(e,t,r){var n=kf(e,t,!0);return n instanceof vp?void 0!==r&&n.arity!==r?be:n:ff(n)?n:Oe}function Xk(e,t){var r=t,n=r[0],a=r.slice(1),i=Qk(e,n,a.length);return ff(i)?i:e.applyLambda(i,a)}function Yk(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=Qk(e,i,2);if(ff(o))return o;var u=e.mathpack,c=u.fix(n),s=u.fix(a);if(c<1||s<1)return ye;if(c*s>1e6)return tv(wt(["ARRAY.MAKE with very large size"]));var l=[!1,!1];return $l(new tf(e,c,s,(function(t,r){var n=e.mathpack;return l[0]=n.fromNumber(t+1),l[1]=n.fromNumber(r+1),e.applyLambda(o,l)})))}function zk(e,t){var r=kf(e,t[0],!0);return r instanceof vp?e.mathpack.fromNumber(r.arity):be}var Zk=ri.OperKind,$k=ri.rangeSeqOper,eb=ri.valueErrorOper,tb=ri.refErrorOper,rb=ri.arrayOper,nb=ei.gridRange,ab=ci.isSheetIndex;function ib(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=r[3],u=e.mathpack,c=u.sfix(a);if(c<0)return eb;var s=void 0===i?void 0:u.sfix(i);if(void 0!==s&&s<0)return eb;var l,f,d=void 0===o?0:u.sfix(o)-1;if(d<0)return eb;switch(n.kind){case Zk.Range:if(!ab(n.sheets))return eb;if(d>=n.ranges.length)return tb;var h=n.ranges[d];if(void 0===s)if(1===h.rows)l=0,f=c-1;else{if(1!==h.cols)return tb;l=c-1,f=-1}else l=c-1,f=s-1;if(l>=h.rows||f>=h.cols)return tb;var v=nb(h.row+pr(l,0),h.col+pr(f,0),-1===l?h.rows:1,-1===f?h.cols:1);return $k(n.sheets,[v]);case Zk.Array:return d>0?tb:(void 0===s?1===n.rows?(l=0,f=c-1):(l=c-1,f=-1):(l=c-1,f=s-1),l>=n.rows||f>=n.cols?tb:-1===l&&-1===f?n:-1===l?rb(n.rows,1,n.opers.map((function(e){return[e[f]]}))):-1===f?rb(1,n.cols,[n.opers[l]]):n.opers[l][f]);default:return A("calc.funcs.lookupFuncs: INDEX",n)}}var ob=function(e){return e<0?Ue.Lt:e>0?Ue.Gt:Ue.Eq};function ub(e,t,r){void 0===r&&(r=!1);var n,a=e.config,i=a.localeInfo,o=a.mathpack;switch(typeof t){case"number":n=function(e){return{correctType:!0,sgnT:(r=o,n=e,a=t,ob(r.cond2(n,a)))};var r,n,a};break;case"string":if(r){var u=new KE(i,t);n=function(e){return{correctType:!0,sgnT:u.test(e)?Ue.Eq:Ue.Ne}}}else n=function(e){return{correctType:!0,sgnT:ob(i.stringCompareCI(e,t))}};break;case"boolean":n=function(e){return{correctType:!0,sgnT:(r=e,n=t,ob(r-n))};var r,n};break;case"object":return mf(t)?tv(wt(["lookup with rich value condition"])):A("calc.funcs.makeLookupComparer",t)}return function(e){var r=mf(e)?e.getFallback():e;return typeof t!=typeof r?{correctType:!1,sgnT:Ue.Ne}:n(r)}}function cb(e,t,r){for(var n=!1,a=r.length-1,i=Math.floor((0+a)/2),o=0,u=a,c=ub(e,t);;){var s=c(r.get(i)).sgnT;if(s===Ue.Ne){if(i<u)for(var l=i+1;l<=u;l+=1)if((s=c(r.get(l)).sgnT)!==Ue.Ne){i=l;break}s===Ue.Ne&&(i=Math.floor((o+u)/2),s=Ue.Gt)}if(s===Ue.Eq){if(i<a){n=!0,o=i+=1,u=i;continue}return i}if(s===Ue.Lt?o=i+1:u=i-1,!(o<=u)){if(n)i-=1;else if(s===Ue.Gt&&(i-=1)>=0){o=i,u=i;continue}return i}i=Math.floor((o+u)/2)}}function sb(e,t,r,n){for(var a=-1,i=ub(e,t,n===Ue.Eq),o=0;o<r.length;o+=1){var u=i(r.get(o)),c=u.correctType,s=u.sgnT;if(c){if(s===Ue.Eq)return o;if(s!==Ue.Ne&&s===n)return a;a=o}o===r.denseLength&&(o=pr(o,r.length-2))}return n!==Ue.Eq?a:r.length}function lb(e){if("number"==typeof e)return be;switch(e.kind){case Zk.Range:return ab(e.sheets)?e.ranges.length>1?be:e:eb;case Zk.Array:return e}}function fb(e,t){if("number"==typeof t)return t;var r;switch(t.kind){case ih.RangeValues:r=t.arrays[0].get(0,0);break;case Zk.Array:r=t.opers[0][0];break;default:return A("calc.funcs.lookupFuncs.getNumFromRef",t)}return ff(r=e.coerceOper(r,Zk.Number))?tb:r}function db(e){if("number"==typeof e)return be;switch(e.kind){case Zk.Rich:return be;case Zk.Range:if(!ab(e.sheets))return eb;if(e.ranges.length>1)return be;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?be:e;case Zk.Array:return 1!==e.rows&&1!==e.cols?be:e}}function hb(e){switch(e.kind){case ih.RangeValues:return e.arrays[0];case Zk.Array:return new fl(e.rows,e.cols,e.rows,e.cols,e.opers,De)}}function vb(e,t){switch(t.kind){case Zk.Range:var r=t.sheets,n=t.ranges[0];return new hl(n.rows,n.cols,n.rows,n.cols,(function(t,a){var i=Zt(n.row+t,n.col+a);return e.dereferenceAllOpers([$k(r,[i])])[0].arrays[0].get(0,0)}),(function(){return k("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case Zk.Array:return new fl(t.rows,t.cols,t.rows,t.cols,t.opers,De)}}function pb(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=e.mathpack,u=function(e){if("number"==typeof e)return e;switch(e.kind){case Zk.Range:if(!ab(e.sheets))return eb;if(e.ranges.length>1)return tb;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?tb:e}}(null!=i?i:o.one);if(ff(u))return u;var c=e.dereferenceAllOpers([u])[0],s=fb(e,c);if(ff(s))return s;var l=db(a);if(ff(l))return l;var f=hb(e.dereferenceAllOpers([l])[0]),d=yb(f,1===f.rows),h=-1;return(h=o.cond(s)>0?cb(e,n,d):0===o.cond(s)?sb(e,n,d,Ue.Eq):sb(e,n,d,Ue.Lt))<0||h>=d.length?be:e.mathpack.fromNumber(h+1)}function mb(e){if(pf(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function gb(e,t){var r=t,n=r[0],a=r[1],i=r[2],o=lb(a);if(ff(o))return o;var u=mb(o),c=Ob(o,u),s=yb(hb(e.dereferenceAllOpers([c])[0]),u),l=cb(e,n,s);if(l<0)return be;if(void 0!==i){var f=db(i);if(ff(f))return f;var d=mb(f),h=yb(vb(e,function(e,t,r){if(r.kind===Zk.Range){var n=r.ranges[0],a=nb(n.row,n.col,vr(t?1:e,(1<<20)-n.row),vr(t?e:1,16384-n.col));return Me(r.sheets,a)}return r}(s.length,d,f)),d);return l>=h.length?f.kind===Zk.Array?be:De:h.get(l)}var v=vb(e,o);return u?v.get(v.rows-1,l):v.get(l,v.cols-1)}function Cb(e,t,r){var n=t,a=n[0],i=n[1],o=n[2],u=n[3],c=lb(i);if(ff(c))return c;var s=Ob(c,r),l=yb(hb(e.dereferenceAllOpers([s])[0]),r),f=!(null==u||u)?sb(e,a,l,Ue.Eq):cb(e,a,l);if(f<0||f>=l.length)return be;var d=function(e,t){if("number"==typeof t)return t;switch(t.kind){case Zk.Range:if(!ab(t.sheets))return eb;if(t.ranges.length>1)return tb;var r=t.ranges;return e.calcingArray?tv(wt(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?tv(wt(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case Zk.Array:return tv(wt(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,o);if(ff(d))return d;var h=e.dereferenceAllOpers([d])[0],v=fb(e,h);if(ff(v))return v;var p=e.mathpack.sfix(v)-1,m=vb(e,c);return p<0?eb:p>=(r?m.rows:m.cols)?tb:r?m.get(p,f):m.get(f,p)}function Sb(e,t){return Cb(e,t,!0)}function Eb(e,t){return Cb(e,t,!1)}function yb(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function Ob(e,t){if(e.kind===Zk.Range){var r=e.ranges[0],n=nb(r.row,r.col,t?1:r.rows,t?r.cols:1);return $k(e.sheets,[n])}return e}var Ab={};Ab[oi.WorksheetFuncId.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return ly(e,r)},Ab[oi.WorksheetFuncId.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return gy(e,r)},Ab[oi.WorksheetFuncId.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return yy(e,r)},Ab[oi.WorksheetFuncId.COUNTBLANK]=function(e,t){var r=t[0];if(!pf(r)||!ct(r.sheets)||1!==r.ranges.length)return ye;var n=e.dereferenceAllOpers(t);return _y(e,n)},Ab[oi.WorksheetFuncId.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return Gy(e,r)},Ab[oi.WorksheetFuncId.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return Vy(e,r)},Ab[oi.WorksheetFuncId.AND]=function(e,t){var r=e.dereferenceAllOpers(t);return Xy(e,r)},Ab[oi.WorksheetFuncId.COUNTA]=function(e,t){var r=e.dereferenceAllOpers(t);return My(e,r)},Ab[oi.WorksheetFuncId.OR]=function(e,t){var r=e.dereferenceAllOpers(t);return Yy(e,r)},Ab[oi.WorksheetFuncId.CONCAT]=function(e,t){var r=t,n=e.dereferenceAllOpers(t);return Ry(e,[],!0,r,n)},Ab[oi.WorksheetFuncId.IF]=function(e,t){var r=t[0];return b("calc.funcs.if","boolean"==typeof r),t[r?1:2]},Ab[oi.WorksheetFuncId.ISERROR]=function(e,t){return ci.operKind(t[0])===ri.OperKind.Error},Ab[oi.WorksheetFuncId.ISERR]=function(e,t){var r=t[0];return ff(r)&&r.type!==ri.ErrorType.NA},Ab[oi.WorksheetFuncId.ISBLANK]=function(e,t){return ci.operKind(t[0])===ri.OperKind.Blank},Ab[oi.WorksheetFuncId.ISLOGICAL]=function(e,t){return ci.operKind(t[0])===ri.OperKind.Boolean},Ab[oi.WorksheetFuncId.ISNA]=function(e,t){var r=t[0];return ff(r)&&r.type===ri.ErrorType.NA},Ab[oi.WorksheetFuncId.ISNONTEXT]=function(e,t){return ci.operKind(t[0])!==ri.OperKind.String},Ab[oi.WorksheetFuncId.ISTEXT]=function(e,t){return ci.operKind(t[0])===ri.OperKind.String},Ab[oi.WorksheetFuncId.ISNUMBER]=function(e,t){return ci.operKind(t[0])===ri.OperKind.Number},Ab[oi.WorksheetFuncId.ISREF]=function(e,t){return ci.operKind(t[0])===ri.OperKind.Range},Ab[oi.WorksheetFuncId.ISEVEN]=GA,Ab[oi.WorksheetFuncId.ISODD]=function(e,t){var r=GA(e,t);return"boolean"==typeof r?!r:r},Ab[oi.WorksheetFuncId.ABS]=LA,Ab[oi.WorksheetFuncId.CEILING]=bA,Ab[oi.WorksheetFuncId.ECMA_CEILING]=bA,Ab[oi.WorksheetFuncId.DEGREES]=function(e,t){var r=e.mathpack,n=ey(r.div(r.fromNumber(180),r.pi));return r.mul(t[0],n)},Ab[oi.WorksheetFuncId.FLOOR]=function(e,t){return kA(e.mathpack,t[0],t[1])},Ab[oi.WorksheetFuncId.RADIANS]=function(e,t){var r=e.mathpack,n=ey(r.div(r.pi,r.fromNumber(180)));return r.mul(t[0],n)},Ab[oi.WorksheetFuncId.ROUND]=CA,Ab[oi.WorksheetFuncId.ROUNDUP]=EA,Ab[oi.WorksheetFuncId.ROUNDDOWN]=yA,Ab[oi.WorksheetFuncId.EVEN]=MA,Ab[oi.WorksheetFuncId.SIGN]=function(e,t){var r=e.mathpack;return r.fromNumber(r.cond(t[0]))},Ab[oi.WorksheetFuncId.PI]=function(e,t){return e.mathpack.pi},Ab[oi.WorksheetFuncId.SQRT]=iA,Ab[oi.WorksheetFuncId.EXP]=oA,Ab[oi.WorksheetFuncId.POWER]=uA,Ab[oi.WorksheetFuncId.LN]=cA,Ab[oi.WorksheetFuncId.LOG10]=sA,Ab[oi.WorksheetFuncId.LOG]=function(e,t){var r=t,n=r[0],a=r[1],i=e.mathpack;if(void 0===a)return i.log(n);var o=i.ln(n);if(ff(o))return o;var u=i.ln(a);return ff(u)?u:i.div(o,u)},Ab[oi.WorksheetFuncId.SIN]=lA,Ab[oi.WorksheetFuncId.COS]=fA,Ab[oi.WorksheetFuncId.TAN]=dA,Ab[oi.WorksheetFuncId.ASIN]=hA,Ab[oi.WorksheetFuncId.ACOS]=vA,Ab[oi.WorksheetFuncId.ATAN]=pA,Ab[oi.WorksheetFuncId.ATAN2]=mA,Ab[oi.WorksheetFuncId.FACT]=function(e,t){var r=t[0],n=e.mathpack,a=n.sfix(r);if(n.cond(r)<0||a>170)return aA;for(var i=n.one,o=a;o>0;o-=1){if(ff(i))return i;i=n.mul(n.fromNumber(o),i)}return i},Ab[oi.WorksheetFuncId.LEFT]=function(e,t){var r,n=t,a=n[0],i=n[1];if(void 0!==i&&ff(i))return i;var o=YA(e.mathpack,i);if(ff(o))return XA;var u=null!=(r=JA(a,0,o))?r:a.length;return a.substring(0,u)},Ab[oi.WorksheetFuncId.RIGHT]=function(e,t){var r,n=t,a=n[0],i=n[1];if(void 0!==i&&ff(i))return i;var o=YA(e.mathpack,i);if("number"!=typeof o&&ff(o))return XA;var u=null!=(r=function(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n-1<0)return;HA(e.charCodeAt(n-1))&&n-2>=0&&jA(e.charCodeAt(n-2))?n-=2:n-=1}return n}(a,a.length,o))?r:0;return a.substring(u)},Ab[oi.WorksheetFuncId.MID]=function(e,t){var r,n,a=t,i=a[0],o=a[1],u=a[2],c=e.mathpack,s=c.fix(o)-1,l=c.fix(u);if(c.cond(o)<0||s<0||c.cond(u)<0||l<0)return XA;var f=null!=(r=JA(i,0,s))?r:i.length,d=null!=(n=JA(i,f,l))?n:i.length;return i.substring(f,d)},Ab[oi.WorksheetFuncId.LEN]=function(e,t){var r=t[0];return e.mathpack.fromNumber(QA(r,0,r.length))},Ab[oi.WorksheetFuncId.CONCATENATE]=function(e,t){for(var r=t,n="",a=0;a<r.length;a+=1){var i=r[a];if(n.length+i.length>32767)return n+i.substring(0,32767-n.length);n+=i}return n};var kb=!1;function bb(e){return kb||(kb=!0,yn(hn.CalcWorksheetFunctions)&&(yn(hn["OfficeVSO:3852168_CalcCGIFS"])&&(Ab[oi.WorksheetFuncId.IFS]=Mk),yn(hn["OfficeVSO:3852168_CalcCGSWITCH"])&&(Ab[oi.WorksheetFuncId.SWITCH]=wk),yn(hn["OfficeVSO:3852168_CalcCGAVERAGEIF"])&&(Ab[oi.WorksheetFuncId.AVERAGEIF]=Ay),yn(hn["OfficeVSO:3852168_CalcCGAVERAGEIFS"])&&(Ab[oi.WorksheetFuncId.AVERAGEIFS]=ky),yn(hn["OfficeVSO:3852168_CalcCGCOUNT"])&&(Ab[oi.WorksheetFuncId.COUNT]=Fy),yn(hn["OfficeVSO:3852168_CalcCGCOUNTIF"])&&(Ab[oi.WorksheetFuncId.COUNTIF]=Ly),yn(hn["OfficeVSO:3852168_CalcCGCOUNTIFS"])&&(Ab[oi.WorksheetFuncId.COUNTIFS]=Dy),yn(hn["OfficeVSO:3852168_CalcCGMEDIAN"])&&(Ab[oi.WorksheetFuncId.MEDIAN]=mO),yn(hn["OfficeVSO:3852168_CalcCGSUMSQ"])&&(Ab[oi.WorksheetFuncId.SUMSQ]=fy),yn(hn["OfficeVSO:3852168_CalcCGSUMIF"])&&(Ab[oi.WorksheetFuncId.SUMIF]=vy),yn(hn["OfficeVSO:3852168_CalcCGSUMIFS"])&&(Ab[oi.WorksheetFuncId.SUMIFS]=my),yn(hn["OfficeVSO:3852168_CalcCGROWS"])&&(Ab[oi.WorksheetFuncId.ROWS]=gk),yn(hn["OfficeVSO:3852168_CalcCGCOLUMNS"])&&(Ab[oi.WorksheetFuncId.COLUMNS]=Ck),yn(hn["OfficeVSO:3852168_CalcCGINDEX"])&&(Ab[oi.WorksheetFuncId.INDEX]=ib),yn(hn["OfficeVSO:3852168_CalcCGMATCH"])&&(Ab[oi.WorksheetFuncId.MATCH]=pb),yn(hn["OfficeVSO:3852168_CalcCGLOOKUP"])&&(Ab[oi.WorksheetFuncId.LOOKUP]=gb),yn(hn["OfficeVSO:3852168_CalcCGHLOOKUP"])&&(Ab[oi.WorksheetFuncId.HLOOKUP]=Sb),yn(hn["OfficeVSO:3852168_CalcCGVLOOKUP"])&&(Ab[oi.WorksheetFuncId.VLOOKUP]=Eb),yn(hn["OfficeVSO:3852168_CalcCGLARGE"])&&(Ab[oi.WorksheetFuncId.LARGE]=nO),yn(hn["OfficeVSO:3852168_CalcCGSMALL"])&&(Ab[oi.WorksheetFuncId.SMALL]=aO),yn(hn["OfficeVSO:3852168_CalcCGRANK"])&&(Ab[oi.WorksheetFuncId.RANK]=zO,Ab[oi.WorksheetFuncId.RANK_EQ]=zO),yn(hn["OfficeVSO:3852168_CalcCGRANK_AVG"])&&(Ab[oi.WorksheetFuncId.RANK_AVG]=ZO),yn(hn["OfficeVSO:3852168_CalcCGPERCENTILE"])&&(Ab[oi.WorksheetFuncId.PERCENTILE]=uO,Ab[oi.WorksheetFuncId.PERCENTILE_INC]=uO),yn(hn["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"])&&(Ab[oi.WorksheetFuncId.PERCENTILE_EXC]=sO),yn(hn["OfficeVSO:3852168_CalcCGQUARTILE"])&&(Ab[oi.WorksheetFuncId.QUARTILE]=dO,Ab[oi.WorksheetFuncId.QUARTILE_INC]=dO),yn(hn["OfficeVSO:3852168_CalcCGQUARTILE_EXC"])&&(Ab[oi.WorksheetFuncId.QUARTILE_EXC]=vO),yn(hn["OfficeVSO:3852168_CalcCGTRIMMEAN"])&&(Ab[oi.WorksheetFuncId.TRIMMEAN]=gO),yn(hn["OfficeVSO:3852168_CalcCGTRUE"])&&(Ab[oi.WorksheetFuncId.TRUE]=Lk),yn(hn["OfficeVSO:3852168_CalcCGFALSE"])&&(Ab[oi.WorksheetFuncId.FALSE]=Dk),yn(hn["OfficeVSO:3852168_CalcCGNOT"])&&(Ab[oi.WorksheetFuncId.NOT]=Uk),yn(hn["OfficeVSO:3852168_CalcCGNA"])&&(Ab[oi.WorksheetFuncId.NA]=Pk),yn(hn["OfficeVSO:3852168_CalcCGAVERAGEA"])&&(Ab[oi.WorksheetFuncId.AVERAGEA]=by),yn(hn["OfficeVSO:3852168_CalcCGMAXA"])&&(Ab[oi.WorksheetFuncId.MAXA]=jy),yn(hn["OfficeVSO:3852168_CalcCGMINA"])&&(Ab[oi.WorksheetFuncId.MINA]=Hy),yn(hn["OfficeVSO:3852168_CalcCGMAXIFS"])&&(Ab[oi.WorksheetFuncId.MAXIFS]=Ky),yn(hn["OfficeVSO:3852168_CalcCGMINIFS"])&&(Ab[oi.WorksheetFuncId.MINIFS]=qy),yn(hn["OfficeVSO:3852168_CalcCGXOR"])&&(Ab[oi.WorksheetFuncId.XOR]=Zy),yn(hn["OfficeVSO:3852168_CalcCGT"])&&(Ab[oi.WorksheetFuncId.T]=Vk),yn(hn["OfficeVSO:3852168_CalcCGN"])&&(Ab[oi.WorksheetFuncId.N]=Bk),yn(hn["OfficeVSO:3852168_CalcCGHYPERLINK"])&&(Ab[oi.WorksheetFuncId.HYPERLINK]=xk),yn(hn["OfficeVSO:3852168_CalcCGAGGREGATE"])&&(Ab[oi.WorksheetFuncId.AGGREGATE]=YO),yn(hn["OfficeVSO:3852168_CalcCGSUBTOTAL"])&&(Ab[oi.WorksheetFuncId.SUBTOTAL]=JO),yn(hn["OfficeVSO:3852168_CalcCGVAR"])&&(Ab[oi.WorksheetFuncId.VAR]=xO,Ab[oi.WorksheetFuncId.VAR_S]=xO),yn(hn["OfficeVSO:3852168_CalcCGVARP"])&&(Ab[oi.WorksheetFuncId.VARP]=PO,Ab[oi.WorksheetFuncId.VAR_P]=PO),yn(hn["OfficeVSO:3852168_CalcCGSTDEV"])&&(Ab[oi.WorksheetFuncId.STDEV]=wO,Ab[oi.WorksheetFuncId.STDEV_S]=wO),yn(hn["OfficeVSO:3852168_CalcCGSTDEVP"])&&(Ab[oi.WorksheetFuncId.STDEVP]=LO,Ab[oi.WorksheetFuncId.STDEV_P]=LO),yn(hn["OfficeVSO:3852168_CalcCGVARA"])&&(Ab[oi.WorksheetFuncId.VARA]=GO),yn(hn["OfficeVSO:3852168_CalcCGVARPA"])&&(Ab[oi.WorksheetFuncId.VARPA]=VO),yn(hn["OfficeVSO:3852168_CalcCGSTDEVA"])&&(Ab[oi.WorksheetFuncId.STDEVA]=DO),yn(hn["OfficeVSO:3852168_CalcCGSTDEVPA"])&&(Ab[oi.WorksheetFuncId.STDEVPA]=UO),yn(hn["OfficeVSO:3852168_CalcCGAVEDEV"])&&(Ab[oi.WorksheetFuncId.AVEDEV]=rA),yn(hn["OfficeVSO:3852168_CalcCGDEVSQ"])&&(Ab[oi.WorksheetFuncId.DEVSQ]=nA),yn(hn["OfficeVSO:3852168_CalcCGMODE"])&&(Ab[oi.WorksheetFuncId.MODE]=HO,Ab[oi.WorksheetFuncId.MODE_SNGL]=HO),yn(hn["OfficeVSO:3852168_CalcCGMODE_MULT"])&&(Ab[oi.WorksheetFuncId.MODE_MULT]=KO),yn(hn["OfficeVSO:3852168_CalcCGTYPE"])&&(Ab[oi.WorksheetFuncId.TYPE]=Wk),yn(hn["OfficeVSO:3852168_CalcCGERROR_TYPE"])&&(Ab[oi.WorksheetFuncId.ERROR_TYPE]=jk),yn(hn["OfficeVSO:3852168_CalcCGAREAS"])&&(Ab[oi.WorksheetFuncId.AREAS]=mk),yn(hn["OfficeVSO:3852168_CalcCGSHEETS"])&&(Ab[oi.WorksheetFuncId.SHEETS]=Ok),yn(hn["OfficeVSO:3852168_CalcCGROW"])&&(Ab[oi.WorksheetFuncId.ROW]=Ek),yn(hn["OfficeVSO:3852168_CalcCGCOLUMN"])&&(Ab[oi.WorksheetFuncId.COLUMN]=yk),yn(hn["OfficeVSO:3852168_CalcCGSHEET"])&&(Ab[oi.WorksheetFuncId.SHEET]=Ak),yn(hn["OfficeVSO:3852168_CalcCGOFFSET"])&&(Ab[oi.WorksheetFuncId.OFFSET]=kk),yn(hn["OfficeVSO:3852168_CalcCGEXACT"])&&(Ab[oi.WorksheetFuncId.EXACT]=zA),yn(hn["OfficeVSO:3852168_CalcCGREPT"])&&(Ab[oi.WorksheetFuncId.REPT]=ZA),yn(hn["OfficeVSO:3852168_CalcCGTRIM"])&&(Ab[oi.WorksheetFuncId.TRIM]=$A),yn(hn["OfficeVSO:3852168_CalcCGCLEAN"])&&(Ab[oi.WorksheetFuncId.CLEAN]=ek),yn(hn["OfficeVSO:3852168_CalcCGCHAR"])&&(Ab[oi.WorksheetFuncId.CHAR]=tk),yn(hn["OfficeVSO:3852168_CalcCGUNICHAR"])&&(Ab[oi.WorksheetFuncId.UNICHAR]=rk),yn(hn["OfficeVSO:3852168_CalcCGCODE"])&&(Ab[oi.WorksheetFuncId.CODE]=nk),yn(hn["OfficeVSO:3852168_CalcCGUNICODE"])&&(Ab[oi.WorksheetFuncId.UNICODE]=ak),yn(hn["OfficeVSO:3852168_CalcCGLOWER"])&&(Ab[oi.WorksheetFuncId.LOWER]=uk),yn(hn["OfficeVSO:3852168_CalcCGUPPER"])&&(Ab[oi.WorksheetFuncId.UPPER]=ck),yn(hn["OfficeVSO:3852168_CalcCGPROPER"])&&(Ab[oi.WorksheetFuncId.PROPER]=sk),yn(hn["OfficeVSO:3852168_CalcCGFIND"])&&(Ab[oi.WorksheetFuncId.FIND]=lk),yn(hn["OfficeVSO:3852168_CalcCGREPLACE"])&&(Ab[oi.WorksheetFuncId.REPLACE]=fk),yn(hn["OfficeVSO:3852168_CalcCGSEARCH"])&&(Ab[oi.WorksheetFuncId.SEARCH]=dk),yn(hn["OfficeVSO:3852168_CalcCGSUBSTITUTE"])&&(Ab[oi.WorksheetFuncId.SUBSTITUTE]=hk),yn(hn["OfficeVSO:3852168_CalcCGISFORMULA"])&&(Ab[oi.WorksheetFuncId.ISFORMULA]=BA),yn(hn["OfficeVSO:3852168_CalcCGFORMULATEXT"])&&(Ab[oi.WorksheetFuncId.FORMULATEXT]=WA),yn(hn["OfficeVSO:3852168_CalcCGINFO"])&&(Ab[oi.WorksheetFuncId.INFO]=Hk),yn(hn["OfficeVSO:3852168_CalcCGDELTA"])&&(Ab[oi.WorksheetFuncId.DELTA]=qk),yn(hn["OfficeVSO:3852168_CalcCGGESTEP"])&&(Ab[oi.WorksheetFuncId.GESTEP]=Jk),yn(hn["OfficeVSO:3852168_CalcCGTRANSPOSE"])&&(Ab[oi.WorksheetFuncId.TRANSPOSE]=bk),yn(hn["OfficeVSO:3852168_CalcCGADDRESS"])&&(Ab[oi.WorksheetFuncId.ADDRESS]=Rk),yn(hn["OfficeVSO:3852168_CalcCGINDIRECT"])&&(Ab[oi.WorksheetFuncId.INDIRECT]=Ik),yn(hn["OfficeVSO:3852168_CalcCGTEXTJOIN"])&&(Ab[oi.WorksheetFuncId.TEXTJOIN]=Iy),yn(hn["OfficeVSO:3852168_CalcCGCHOOSE"])&&(Ab[oi.WorksheetFuncId.CHOOSE]=Fk),yn(hn["OfficeVSO:3852168_CalcCGSQRTPI"])&&(Ab[oi.WorksheetFuncId.SQRTPI]=xA),yn(hn["OfficeVSO:3852168_CalcCGFACTDOUBLE"])&&(Ab[oi.WorksheetFuncId.FACTDOUBLE]=UA),yn(hn["OfficeVSO:3852168_CalcCGINT"])&&(Ab[oi.WorksheetFuncId.INT]=gA),yn(hn["OfficeVSO:3852168_CalcCGTRUNC"])&&(Ab[oi.WorksheetFuncId.TRUNC]=SA,Ab[oi.WorksheetFuncId.ROUNDDOWN]=yA),yn(hn["OfficeVSO:3852168_CalcCGODD"])&&(Ab[oi.WorksheetFuncId.ODD]=wA),yn(hn["OfficeVSO:3852168_CalcCGMROUND"])&&(Ab[oi.WorksheetFuncId.MROUND]=OA),yn(hn["OfficeVSO:3852168_CalcCGQUOTIENT"])&&(Ab[oi.WorksheetFuncId.QUOTIENT]=DA),yn(hn["OfficeVSO:3852168_CalcCGFLOOR.MATH"])&&(Ab[oi.WorksheetFuncId.FLOOR_MATH]=TA),yn(hn["OfficeVSO:3852168_CalcCGFLOOR.PRECISE"])&&(Ab[oi.WorksheetFuncId.FLOOR_PRECISE]=NA),yn(hn["OfficeVSO:3852168_CalcCGCEILING.MATH"])&&(Ab[oi.WorksheetFuncId.CEILING_MATH]=RA),yn(hn["OfficeVSO:3852168_CalcCGCEILING.PRECISE"])&&(Ab[oi.WorksheetFuncId.CEILING_PRECISE]=IA,Ab[oi.WorksheetFuncId.ISO_CEILING]=IA)),yn(hn.CalcFieldValueFunction)&&(Ab[oi.WorksheetFuncId.FIELDVALUE]=vk,Ab[oi.WorksheetFuncId._FV]=vk),yn(hn.CalcRecordFunctions)&&(Ab[oi.WorksheetFuncId.RECORD]=pk),yn(hn.CalcFunFunctions)&&(Ab[oi.WorksheetFuncId.ARITY]=zk,Ab[oi.WorksheetFuncId.APPLY]=Xk,Ab[oi.WorksheetFuncId.ARRAYMAKE]=Yk,Ab[oi.WorksheetFuncId.ISFUN]=PA)),Ab[e]}var Rb=Zt(0,0);var Ib=ge([],[],G.None,W.Exact),Tb=function(){function e(e,t,r,n,a,i,o,u,c,s,l){this.onNameFailure=n,this.onRangeFailure=a,this.onUnavailableObject=i,this.onSetCellValue=o,this.onSetCellValues=u,this.schedulerConfig=c,this.limits=s,this.maxDereferenceCells=l,this.iformats=[],this.worksheetFuncOverrides={},this.interruptToken=[Rl.Continue],this.setDynamicPrecs=function(){},this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.config=ua(e,r,t),this.setLocaleInfo(e),this.setRefStyle(r),this.parser=ms(this),this.analyzer=dh(this),this.compiler=Zh(this),this.evaluator=Fp(this)}return e.prototype.reconfigure=function(e,t,r){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r},e.prototype.setLocaleInfo=function(e){this.stringCompareCI=e.stringCompareCI,this.config=Object(j.a)(Object(j.a)({},this.config),{localeInfo:e})},e.prototype.setRefStyle=function(e){this.config=Object(j.a)(Object(j.a)({},this.config),{refStyle:e})},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.stringCompareCI(t,r.name)?it(Gb([{kind:Lb.DocumentLoc,document:Kt(e,t)}])):at(r)},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getNameLoc=function(e,t){var r=this.getDocument(e.document);if(r.kind===Be.Failure)return it(Gb([r.reason]));var n=r.value.getNameLoc(e.index,t);return n.kind===Be.Failure?it(Gb([n.reason])):n},e.prototype.getUserDefinedFuncLoc=function(e,t){return it(wt(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===Be.Failure)return it(Gb([t.reason]));if(!t.value)return it(Gb([{kind:Lb.GridRange,range:e}]));var r=this.getEditedFormat(e);if(r.kind===Be.Failure)return it(Gb([r.reason]));if(!1===r.value)return it(Gb([{kind:Lb.CellFormat}]));var n=this.resolveIformat(r.value);return void 0===n.category||void 0===n.decimals?it(Gb([{kind:Lb.NumberFormat,iformat:n.iformat}])):at({iformat:n.iformat,category:n.category,decimals:n.decimals})},e.prototype.getNameFormula=function(e){var t=this.getDocument(e.scope.document);if(t.kind===Be.Failure)return it(Gb([t.reason]));var r=t.value.getNameFormula(e);if(r.kind===Be.Failure)return it(Gb([r.reason]));if(void 0===r.value)return at(void 0);var n=r.value.compiledFmla.getValue();if(ot(n))return n;var a=this.hasRecalcNameFailure(e);return ot(a)?a.value||this.setNameFailure(e,n.reason):this.onUnavailableObject(a.reason),it(function(e){return{kind:Ol.PreviousNameFailure,name:e}}(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===Be.Failure)return it(Gb([t.reason]));if(void 0===t.value)return at(void 0);var r=t.value,n=r[0],a=r[1];if(void 0===a.compiledFmla)return at(void 0);var i=tr(e.sheet,n),o=this.readCompiledFmla(i,a.compiledFmla);return ot(o)?at(Ml(jt(a.lexicalKind,i),o.value)):o},e.prototype.getKnownFormat=function(e){var t=this.iformats[e];return void 0===t?it(Gb([{kind:Lb.NumberFormat,iformat:e}])):at({iformat:e,category:t.category,decimals:t.decimals})},e.prototype.setCellValue=function(e,t,r){var n=this.hasRecalcValueChanged(e,t);if(n.kind===Be.Failure)return this.onUnavailableObject(n.reason);var a=this.setEditedAndRecalcValues(e,t);if(a.kind===Be.Failure)return this.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===Be.Failure)return this.onUnavailableObject(i.reason);this.onSetCellValue(e,t,r,i.value,this.evalParams,n.value)},e.prototype.setCellValues=function(e,t,r){var n=this.setEditedAndRecalcValues(e,t);if(n.kind===Be.Failure)return this.onUnavailableObject(n.reason);var a=this.propagateEditTaint(e,r);if(a.kind===Be.Failure)return this.onUnavailableObject(a.reason);this.onSetCellValues(e,t,r,a.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){if(0!=(rt(e).staticPrecs&(G.Time|G.Calc)))return it(Gb([{kind:Lb.VolatileFunction,name:Aa(e)}]));if(void 0!==this.worksheetFuncOverrides[e])return at(this.worksheetFuncOverrides[e]);var t=bb(e);return null!=t?at(t):it(wt([Aa(e)]))},e.prototype.getUserDefinedFunc=function(e){return it(wt(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){var t=this.getSheetRangeIds(e);return t.kind===Be.Failure?it(Gb([t.reason])):at(t.value)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,bC(e.range));if(n.kind===Be.Failure)return this.onUnavailableObject(n.reason);var a=this.setEditedAndRecalcValues(e,De);if(a.kind===Be.Failure)return this.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===Be.Failure)return this.onUnavailableObject(i.reason);this.onRangeFailure(e,t,r,i.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===Be.Failure?it(Gb([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===Be.Failure)return it(Gb([r.reason]));var n=r.value.getSheetName(t);return n.kind===Be.Failure?it(Gb([n.reason])):void 0===n.value?n:at(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===Be.Failure)return it(Gb([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===Be.Failure?it(Gb([n.reason])):void 0===n.value?n:at(n.value.index)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===Be.Failure)return it(Gb([n.reason]));var a=n.value.getHiddenRows(e.index,t,r);return a.kind===Be.Failure?it(Gb([a.reason])):a},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===Be.Failure)return it(Gb([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===Be.Failure?it(Gb([r.reason])):r},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return Array.isArray(a)?a:Wl((function(){return r.withEvalParams(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return a.kind!==Be.Paused?a:Wl((function(){return r.withEvalParamsEvalFormula(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t){var r=this;return this.withEvalParams({computeKind:e,computeCell:t},(function(){return r.evaluator.evalCells([t])}))},e.prototype.evalFormula=function(e,t){var r=this,n={lexicalKind:Vt.Other,originGridCell:at(Rb),originSheet:at(t),allowRelativeQualifier:!1,allowUnqualifiedCell:!0},a={lexicalSource:{kind:Vt.Other},originGridCell:at(Rb),originSheet:at(t),calcingArray:!1,reflectionGridCell:at(Rb),reflectionSheet:at(t),implicitIntersect:!1,wrapCellReferences:!1,followHyperlinks:at(!1)};return this.withEvalParamsEvalFormula({computeKind:IC.EvalFormula,computeCell:rr(t,Rb)},(function(){var t=r.parser.parseFormula(n,e),i=r.checkFormula(n,t,e,"eval-formula"),o=r.compileFormula(n,i);return ot(o)?r.evaluator.evalFormula(a,o.value):o}))},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===Be.Failure?r:(this.document=r.value.setSheetNames(t),at(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===Be.Failure?i:i.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():AS},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():GE},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getEditedFormula(e)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getEditedFormat(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getServerFormat(e)},e.prototype.getRecalcValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getRecalcValue(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.getServerValue(e)},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,a=this.getDocument(r.document);return a.kind===Be.Failure?a:a.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u,c){var s=this.getDocument(t.sheet.document);if(s.kind===Be.Failure)return s;var l=void 0===r?void 0:n?this.compileFmla(e,Vt.Cell,rr(t.sheet,a),void 0,r):""===r?pS:{fmla:r,lexicalKind:Vt.Cell,origin:a,compiledFmla:void 0};return s.value.setCellContents(e,t,l,i,o,u,c)},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o){var u=this.getDocument(t.sheet.document);if(u.kind===Be.Failure)return u;var c=""===r?mS:this.compileFmla(e,Vt.Range,rr(t.sheet,n),Ct(t.range),r);return u.value.setRangeFormula(e,t,c,a,i,o)},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);if(n.kind===Be.Failure)return n;var a=Ht(t),i=void 0===r?void 0:this.compileNamedObject(e,a,r);return n.value.setNamedObject(e,t,i)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===Be.Failure?t:t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[]),e.forEach((function(e){r.iformats[e.iformat]=e}))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===Be.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveIformat=function(e){if(e.isExact&&(void 0===e.category||void 0===e.decimals)){var t=this.iformats[e.iformat];void 0!==t&&(e.category=t.category,e.decimals=t.decimals)}return e},e.prototype.inferRangeFormat=function(e,t){var r,n=this,a=e,i=pC(bC(t.range),e);if(void 0!==i&&i<=0){var o=this.inferCellFormat(t);if(!ot(o)||void 0===o.value)return[];a=vC(a,bC(t.range)),r=o.value}else{var u=this.getEditedFormat(t);if(!ot(u))return[u.reason];if(!1===u.value)return[];r=this.resolveIformat(u.value)}r=Object(j.a)({},r);var c=[];return this.forEachEditedNonBlankCellInSet(t.sheet,a,(function(e){var a=rr(t.sheet,e),i=n.isFormatGeneral(a);if(!ot(i))return c.push(i.reason),!0;if(!i.value)return!0;var o=n.setEditedFormat(a,r);return ot(o)||c.push(o.reason),!0})),c},e.prototype.inferCellFormat=function(e){var t=this.isFormatGeneral(e);if(!ot(t))return t;if(!t.value)return at(void 0);var r=this.getEditedFormula(e);if(r.kind===Be.Failure)return r;if(void 0===r.value||void 0===r.value[1].compiledFmla)return at(void 0);var n=r.value[1].compiledFmla.getValue();if(!ot(n))return at(void 0);var a=jt(r.value[1].lexicalKind,tr(e.sheet,r.value[0])),i=n.value,o=this.analyzer.findBestFormat(Ws(a),i);if(!ot(o))return at(void 0);var u=o.value,c=u.category,s=u.iformat,l=u.decimals,f=this.iformats[s],d=void 0!==f&&c===f.category&&l===f.decimals,h=dS(d,s,c,l),v=this.setEditedFormat(e,h);return ot(v)?at(h):v},e.prototype.isFormatGeneral=function(e){var t=this.getEditedFormat(e);return t.kind===Be.Failure?t:!1===t.value?at(!1):at("General"===this.resolveIformat(t.value).category)},e.prototype.anonymizeFormula=function(e,t){var r,n,a,i,o=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==o&&ot(o)?[$a(o.value,e),(n=o.value,a=[],i=Va(Ga((function(){})),(function(){}),{vArray:function(e){e.nodes.forEach((function(e){return e.forEach((function(e){return Pa(e,i)}))}))},vApp:function(e){var t;if(bt(e.head))a.push(ka(e.head.id));else{var r=n.annotations[e.head.label];(null===(t=r)||void 0===t?void 0:t.kind)===L.WorksheetFuncName&&a.push(Aa(r.id))}for(var o=0,u=e.args;o<u.length;o++)Pa(u[o],i)},vParen:function(e){Pa(e.node,i)}}),xa(n.node,i),a)]:[gi(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,a){var i=this;return{fmla:a,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new HE((function(){var o=i.parser.parseFormula(Oi(t,r.range),a),u=e?o:i.autocorrectFormula(Vs(t,r),o),c=i.checkFormula(Vs(t,r),u,a,e?"server-cell-formula":"edit-cell-formula"),s=i.adjustFormulaOrigin(c,r.range,n);return i.compileFormula(kl(t,r.range),s)}))}},e.prototype.compileFormula=function(e,t){return ot(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.compileNamedObject=function(e,t,r){var n=this,a=e?"server-named-formula":"edit-named-formula";switch(r.kind){case"NamedFormula":return{obj:r,compiledFmla:new HE((function(){var t=r.fmla,i=n.parser.parseFormula(Oi(Vt.NameManager,Rb),t);b("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var o=Bs(nr(ar(n.documentLoc),Rb)),u=i,c=n.checkFormula(o,u,t,a);return n.compileFormula(kl(Vt.NameManager,Rb),c)}))};case"NamedValue":return{obj:r,compiledFmla:new HE((function(){var e,i;if(pf(r.value)){b("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",ct(r.value.sheets)&&1===r.value.ranges.length);var o=r.value.sheets,u=n.getDocument(o.document);if(!ot(u))return n.onUnavailableObject(u.reason),it(Gb([u.reason]));var c=u.value.getSheetName(o.index);if(!ot(c))return n.onUnavailableObject(c.reason),it(Gb([c.reason]));var s=r.value.ranges[0];e=re(de($(Z(Y(w.Abs,s.row),Y(w.Abs,s.col)),Z(Y(w.Abs,s.row+s.rows-1),Y(w.Abs,s.col+s.cols-1))),J(c.value,q(o.document.name,o.document.path))),[]),i=rr(o,Rb)}else e=re(oe(r.value,!0),[]),i=nr(ar(n.documentLoc),Rb);var l=n.analyzer.checkFormula(Bs(i),e,a);return st(l)?n.compileFormula(kl(Vt.NameManager,Rb),at(l)):k("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula "+$a(e,t))}))};case"NamedFailure":return{obj:r,compiledFmla:new HE((function(){return it(Gb([{kind:Lb.ClientFailure,reason:r.failureReason}]))}))};default:return A("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},e.prototype.checkFormula=function(e,t,r,n){if(!ot(t))return t;var a=this.analyzer.checkFormulaWithDiagnostics(e,t.value,n);return st(a[0])?at(a[0]):it(Nl("calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+gi(r),n,Ps(a[1])))},e.prototype.autocorrectFormula=function(e,t){return ot(t)&&yn(hn.CalcClosingParen)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){return ot(e)&&void 0!==r?at(Vv(t,r,e.value)):e},e.prototype.printFormulaBarText=function(e,t,r){return this.parser.formatFormula(ki(e,rr(e.range.sheet,t)),r)},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&vt(this.documentLoc,e)?at(this.document):this.unavailableFailure({kind:Lb.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new jE(e,this.stringCompareCI)),this.getDocument(e)},e.prototype.unavailableFailure=function(e){return it(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=new Array(e.rows);return ht(e,(function(a,i,o){var u=r.tryGetCellValue(a,t);return void 0!==u&&((void 0!==n[i]?n[i]:n[i]=new Array(e.cols))[o]=u,!0)}))?n:void 0},e.prototype.tryGetCellValue=function(e,t){var r=rr(t,e),n=this.getRecalcValue(r);if(n.kind!==Be.Failure){var a=n.value,i=a.oper,o=a.clientFailure;if(void 0===o){var u=this.hasRecalcDirty(r);if(ot(u)){if(!u.value)return Fl(i);var c=this.getEditedFormula(r);if(c.kind!==Be.Failure)if(void 0!==c.value){var s=c.value,l=s[0],f=s[1];if(void 0!==f.compiledFmla){if(ot(this.readCompiledFmla(tr(t,l),f.compiledFmla)))return _l(rr(t,Ct(l)))}else this.onUnavailableObject({kind:Lb.CellEvaluatingValue})}else this.setCellFailure(r,Gb([{kind:Lb.CellMissingFormula}]),Ib);else this.onUnavailableObject(c.reason)}else this.onUnavailableObject(u.reason)}else{var d={kind:Lb.ClientFailure,reason:o};this.setCellFailure(r,Gb([d]),Ib)}}else this.onUnavailableObject(n.reason)},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===Be.Failure)return it(Gb([n.reason]));if(!n.value)return it(Gb([{kind:Lb.GridRange,range:r}]));var a=t.hasRecalcFailure(r);if(a.kind===Be.Failure)return it(Gb([a.reason]));if(a.value)return it(Vl(r));if(Af(r.range)>t.maxDereferenceCells)return it(Gb([{kind:Lb.GridRangeSize,range:r}]));var i=e(r.range,r.sheet);return void 0===i?it(Vl(r)):at(i)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if(ot(r))return r;if(this.setCellFailure(e,r.reason,Ib),r.reason.kind===Mt.Unavailable){r.reason;return r}return it(Gb([{kind:Lb.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===Be.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===Be.Failure||void 0===r.value?r:at(tr(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===Be.Failure?t:t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.allEditedAvailable(e)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Be.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===Be.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.hasRecalcValueChanged=function(e,t){var r=this.hasRecalcFailure(e);if(r.kind===Be.Failure||r.value)return r;var n=this.getRecalcValue(e);return n.kind===Be.Failure?n:at(void 0!==n.value.clientFailure||!_t(n.value.oper,t,!1))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===Be.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===Be.Failure)return r;if(r.value)return at(TC.EditedCell);for(var n=0,a=t.cells;n<a.length;n++){var i=a[n],o=this.hasRecalcEditTaint(i);if(o.kind===Be.Failure)return o;if(o.value){var u=this.setRecalcEditTaint(e.sheet,bC(e.range));return u.kind===Be.Failure?u:at(TC.DependentCell)}}return t.bound===W.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===IC.EditedCell?at(TC.IndependentCell):at(TC.UnknownNonEditedCell)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===Be.Failure?r:r.value.setEditedAndRecalcValues(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===Be.Failure?t:t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===Be.Failure?t:t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===Be.Failure)return this.onUnavailableObject(r.reason);this.onNameFailure(e,t,this.evalParams)},e}(),Nb=function(e,t){return(e<<t|e>>>32-t)>>>0},Fb=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-Nb(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^Nb(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();function _b(e,t){return e&t-1}var Mb,wb=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[_b(this.front+t,r)]=this.values[_b(this.front+t,e)];this.values.length=r,this.front=_b(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[_b(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=_b(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[_b(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.popBack=function(){var e=_b(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=_b(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[_b(this.front+r,t)]))return!1}return!0},e}();!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(Mb||(Mb={}));var Lb,Db=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var n,a=null!=(n=this.taskDeqs[e])?n:this.taskDeqs[e]=new wb;t===Mb.Back?a.pushBack(r):a.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(){return this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}(),Ub=zt(0,0,1<<20,16384);!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.HiddenRows="HiddenRows",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.PrecisionIncorrect="PrecisionIncorrect",e.PrecisionUnknown="PrecisionUnknown"}(Lb||(Lb={}));var xb,Pb,Gb=yl;!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo"}(xb||(xb={})),function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalFormula=6]="ComputeEvalFormula",e[e.RecalcFinished=7]="RecalcFinished",e[e.MaybeCollectGarbage=8]="MaybeCollectGarbage",e[e.PrecisionComputeCellValue=9]="PrecisionComputeCellValue",e[e.PrecisionPrintFormula=10]="PrecisionPrintFormula",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(Pb||(Pb={}));var Vb=function(){function e(e,t,r,n){var a;void 0===n&&(n={}),this.scheduler=new Db,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.docs=new Tb(e,t,r,this.onNameFailure.bind(this),this.onRangeFailure.bind(this),this.logUnavailableObject.bind(this),this.onSetCellValue.bind(this),this.onSetCellValues.bind(this),n,n,null!=(a=n.maxDereferenceCells)?a:32768),this.reconfigure(n)}return e.prototype.reconfigure=function(e){var t;this.config=e,this.rng=new Fb(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!=(t=e.maxDereferenceCells)?t:32768)},e.prototype.onNameFailure=function(e,t,r){var n=r.computeKind;n!==IC.PrecisionTest&&n!==IC.EvalFormula&&this.outputMessageLog.push({kind:qC.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,a){var i=a,o=i.computeKind,u=i.computeCell;if(o!==IC.PrecisionTest)o!==IC.EvalFormula&&this.outputMessageLog.push({kind:qC.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t});else if(pt(e.sheet,u.sheet)&&uS(e.range,u.range)){var c={samples:[],failures:[t]};this.outputMessageLog.push({kind:qC.PrecisionEvalStatistics,stateId:this.stateId,stats:c})}},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.logUnavailableObject=function(e){var t=Gb([e]);this.outputMessageLog.push({kind:qC.UnhandledFailure,stateId:this.stateId,reason:t})},e.prototype.onSetCellValue=function(e,t,r,n,a,i){var o=a,u=o.computeKind,c=o.computeCell;if(u===IC.PrecisionTest)return this.setPrecisionResult(c,e,t,r);if(u!==IC.EvalFormula){var s=void 0,l=this.docs.getEditedFormat(e);if(l.kind===Be.Failure)return this.logUnavailableObject(l.reason);var f=this.docs.getServerFormat(e);if(f.kind===Be.Failure)return this.logUnavailableObject(f.reason);l.value!==f.value&&"object"==typeof l.value&&(s=this.docs.resolveIformat(l.value));var d=void 0;n===TC.EditedCell&&(d=this.predictFormulaBarText(e)),i||void 0!==s||void 0!==d?(this.outputMessageLog.push({kind:qC.RecalcStatistics,message:xC.ChangedCell,stateId:this.stateId,cellKind:n}),n!==TC.EditedCell&&n!==TC.DependentCell||this.outputMessageLog.push({kind:qC.CellWrite,stateId:this.stateId,cellKind:n,cell:e,value:t,format:s,formulaBarText:d})):this.outputMessageLog.push({kind:qC.RecalcStatistics,message:xC.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this,o=a,u=o.computeKind,c=o.computeCell;if(u!==IC.PrecisionTest){if(u!==IC.EvalFormula){var s=void 0;n===TC.EditedCell&&(s=this.predictFormulaBarText(e)),n!==TC.EditedCell&&n!==TC.DependentCell||this.outputMessageLog.push({kind:qC.RangeWrite,stateId:this.stateId,cellKind:n,range:e,values:t,formulaBarText:s})}}else ht(e.range,(function(n,a,o){return i.setPrecisionResult(c,rr(e.sheet,n),t[a][o],r),!0}))},e.prototype.predictFormulaBarText=function(e){var t=St(e),r=this.getAvailableFormula(t);if(ot(r)){var n=r.value,a=n[0],i=n[1],o=i.compiledFmla.getValue(),u=ot(o)?this.docs.printFormulaBarText(a,t.range,o.value):o;if(u.kind===Be.Success){if(!mt(i.origin,t.range)||u.value!==i.fmla)return u.value}else this.outputMessageLog.push({kind:qC.PrintFormulaFailure,stateId:this.stateId,range:e,reason:u.reason})}else this.logUnavailableObject(r.reason)},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(t.kind===Be.Failure)return t;if(void 0===t.value)return it({kind:Lb.CellMissingFormula});var r=t.value,n=r[0],a=r[1];return void 0===a.compiledFmla?it({kind:Lb.CellEvaluatingValue}):at([jt(a.lexicalKind,tr(e.sheet,n)),a])},e.prototype.setPrecisionResult=function(e,t,r,n){var a=this.docs.allServerAvailable(t);if(a.kind===Be.Failure)return this.logUnavailableObject(a.reason);if(gt(e,t)){var i=this.getAvailableFormula(t);if(!ot(i))return this.logUnavailableObject(i.reason);var o=i.value,u=o[0],c=o[1];if(!a.value)return this.logUnavailableObject({kind:Lb.GridRange,range:t});var s=this.docs.getServerValue(t);if(s.kind===Be.Failure)return this.logUnavailableObject(s.reason);var l={samples:[this.precisionResult(r,s.value,u,c)],failures:[]};this.outputMessageLog.push({kind:qC.PrecisionEvalStatistics,stateId:this.stateId,stats:l})}else if(a.value){var f=this.docs.getServerValue(t);if(f.kind===Be.Failure)return this.logUnavailableObject(f.reason);_t(r,f.value,!0)||this.docs.setCellFailure(t,Gb([{kind:Lb.PrecisionIncorrect}]),n)}else this.docs.setCellFailure(t,Gb([{kind:Lb.PrecisionUnknown}]),n)},e.prototype.precisionResult=function(e,t,r,n){var a=WC(t),i=this.docs.anonymizeFormula(r,n),o=i[0],u=i[1];if(_t(e,t,!0))return{expected:a,formula:o,functions:u};var c=WC(e);return"number"==typeof t&&"number"==typeof e?{expected:a,sampled:c,relMagnitude:BC(0===t?e:(e-t)/t),formula:o,functions:u}:{expected:a,sampled:c,formula:o,functions:u}},e.prototype.handleSetCellContents=function(e,t,r,n,a,i,o,u,c){var s=this,l=void 0!==n?n:void 0!==r&&zS(r),f=!e&&l?De:a,d=this.docs.setCellContents(e,t,r,l,i,f,u,o,c);if(d.kind===Be.Failure)return this.logUnavailableObject(d.reason);if(this.docs.onCellModified(e),e)void 0!==u||!l&&void 0!==r||DC(t.set,(function(e){return s.shouldSample(s.config.samplePrecisionEvalRate)&&s.enqueueComputeCellValue(rr(t.sheet,e),IC.PrecisionTest),s.shouldSample(s.config.samplePrecisionPrintFormulaRate)&&s.enqueuePrecisionPrintFormula(rr(t.sheet,e)),!0}));else{if(l){var h=rr(t.sheet,i);this.docs.inferRangeFormat(t.set,h).forEach(this.logUnavailableObject.bind(this))}this.enqueueBeforeCompute(c)}},e.prototype.enqueuePrecisionPrintFormula=function(e){var t=this;this.scheduler.addTask(Pb.PrecisionPrintFormula,Mb.Back,(function(){var r=t.getAvailableFormula(e);if(!ot(r))return t.logUnavailableObject(r.reason);var n=r.value,a=n[0],i=n[1],o=i.compiledFmla.getValue(),u=ot(o)?t.docs.printFormulaBarText(a,i.origin,o.value):o;if(ot(u)){var c=gi(i.fmla),s=u.value===i.fmla?{expected:c}:{expected:c,sampled:gi(u.value)};t.outputMessageLog.push({kind:qC.PrecisionPrintFormulaStatistics,stateId:t.stateId,stats:{samples:[s],failures:[]}})}else t.outputMessageLog.push({kind:qC.PrecisionPrintFormulaStatistics,stateId:t.stateId,stats:{samples:[],failures:[u.reason]}})}))},e.prototype.handleSetRangeFormula=function(e,t,r,n,a){var i=zS(r);b("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||i);var o=e?void 0:De,u=!!e&&void 0,c=this.docs.setRangeFormula(e,t,r,n,o,u,a);if(c.kind===Be.Failure)return this.logUnavailableObject(c.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(a)},e.prototype.evalFormula=function(e,t,r){var n=this;return new Promise((function(a){var i=function(){return a(it(wl))};n.scheduler.deleteTasks(Pb.EvalFormula,void 0),n.scheduler.addTask(Pb.EvalFormula,Mb.Back,{onRun:function(){if(!n.trySetStateId(Pb.EvalFormula,e))return i();n.enqueueComputeEvalFormula(t,r,a)},onDeleted:i}),n.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks(Pb.BeforeCompute,void 0),this.scheduler.addTask(Pb.BeforeCompute,Mb.Back,(function(){t.enqueueAfterCompute(),t.scheduleViewportCells(t.docs.getDirtyEditedCells(),e,IC.EditedCell),t.scheduleViewportCells(t.docs.getDirtyDependentCells(),e,IC.DependentCell)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=Cr();try{r=e()}finally{this.stateEvalTime+=pr(1,Cr()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(xb.EvalTimedOut),this.outputMessageLog.push({kind:qC.RecalcStatistics,stateId:this.stateId,message:xC.StateTimedOut}),r=[])}return r},e.prototype.enqueueComputeCellValue=function(e,t){var r,n=this,a=t===IC.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?mn("calc.calc.PartialWorkbook: recalc edited"):void 0,i=t===IC.PrecisionTest?Pb.PrecisionComputeCellValue:Pb.ComputeCellValue,o=!0,u=function(){return n.docs.evaluate(t,e)},c=function(){var t,s;if(o){o=!1,r=n.shouldSample(n.config.sampleCellEvalStopwatchRate)?mn("calc.calc.PartialWorkbook: cell eval"):void 0,i===Pb.PrecisionComputeCellValue&&n.docs.onCellModified(!0);var l=n.docs.hasRecalcDirty(e);if(!ot(l))return n.logUnavailableObject(l.reason);if(!l.value)return;var f=n.docs.getEditedFormula(e);if(f.kind===Be.Failure)return n.logUnavailableObject(f.reason);if(void 0===f.value)return}else n.outputMessageLog.push({kind:qC.RecalcStatistics,stateId:n.stateId,message:xC.ContinueComputation});var d=n.withEvalTiming(u);if(Array.isArray(d))return null===(t=r)||void 0===t||t.stop(),void(null===(s=a)||void 0===s||s.stop());u=d.resume,n.scheduler.addTask(i,Mb.Front,c)};this.scheduler.addTask(i,Mb.Back,c)},e.prototype.enqueueComputeEvalFormula=function(e,t,r){var n=this,a=function(){return n.docs.evalFormula(e,t)},i={onRun:function(){var e=a();e.kind===Be.Paused?(a=e.resume,n.scheduler.addTask(Pb.ComputeEvalFormula,Mb.Front,i)):r(e)},onDeleted:function(){return r(it(wl))}};this.scheduler.addTask(Pb.ComputeEvalFormula,Mb.Back,i)},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks(Pb.AfterCompute,xb.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?mn("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(Pb.AfterCompute,Mb.Back,{onRun:function(){var r;null===(r=t)||void 0===r||r.stop(xb.EvalFinished),e.outputMessageLog.push({kind:qC.RecalcStatistics,message:xC.EditFinished,stateId:e.stateId})},onDeleted:function(e){var r;null===(r=t)||void 0===r||r.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks(Pb.RecalcFinished,void 0),this.scheduler.addTask(Pb.RecalcFinished,Mb.Back,(function(){e.outputMessageLog.push({kind:qC.RecalcStatistics,message:xC.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,n){var a=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){if(a.trySetStateId(Pb.ServerUpdate,e)){var i=a.docs.promoteServerAvailability(r,n);if(i.kind===Be.Failure)return a.logUnavailableObject(i.reason);a.docs.onCellModified(!0),i.value||a.outputMessageLog.push({kind:qC.UpdateRequest,stateId:a.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,n,a,i,o,u){var c=this,s=void 0!==o?dS(!0,o):void 0;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){c.trySetStateId(Pb.ServerUpdate,e)&&c.handleSetCellContents(!0,t,r,n,i,a,s,u,void 0)}))},e.prototype.editCellContents=function(e,t,r,n,a,i,o){var u=this;void 0===i&&(i=De),void 0===o&&(o=tr(t.sheet,Ub)),this.scheduler.addTask(Pb.ClientEdit,Mb.Back,(function(){u.trySetStateId(Pb.ClientEdit,e)&&u.handleSetCellContents(!1,t,r,n,i,a,!1,void 0,o)})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=Ct(t.range)),void 0===a&&(a=!1),this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){i.trySetStateId(Pb.ServerUpdate,e)&&i.handleSetRangeFormula(!0,t,r,n,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,n,a){var i=this;void 0===n&&(n=Ct(t.range)),void 0===a&&(a=tr(t.sheet,Ub)),this.scheduler.addTask(Pb.ClientEdit,Mb.Back,(function(){i.trySetStateId(Pb.ClientEdit,e)&&i.handleSetRangeFormula(!1,t,r,n,a)})),this.enqueueRecalcFinished()},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask(Pb.TestAdvanceState,Mb.Back,(function(){t.trySetStateId(Pb.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(e,t){var r=this;if(t<this.stateId)return!1;if(e===Pb.ClientEdit&&(this.deleteComputeTasks(xb.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-1/0&&this.shouldSample(this.config.sampleWorkbookStatisticsRate)&&this.outputMessageLog.push({kind:qC.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics()}),2===this.stateChanges&&void 0!==this.config.experimentDefinitions){var n=this.config.experimentDefinitions;this.docs.forEachDocument((function(e){for(var t=e.cloneServer(),a=0,i=n.experiments;a<i.length;a++){var o=i[a];o.setContext(t),r.enqueueRunExperiment(n.budget,o)}}))}this.deleteComputeTasks(xb.StateIdAdvanced);var a=this.stateId;this.stateId=t,this.docs.advanceState(a),this.outputMessageLog.push({kind:qC.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks(Pb.BeforeCompute,void 0),this.scheduler.deleteTasks(Pb.ComputeCellValue,void 0),this.scheduler.deleteTasks(Pb.AfterCompute,e),e!==xb.EvalTimedOut&&this.scheduler.deleteTasks(Pb.ComputeEvalFormula,void 0),this.scheduler.deleteTasks(Pb.PrecisionComputeCellValue,void 0),this.scheduler.deleteTasks(Pb.PrecisionPrintFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t){var r=this,n=function(){if(t.done)r.outputMessageLog.push({kind:qC.ExperimentRunResult,logMessage:t.resultLogMessage});else{var a=Cr();if(t.step(),Cr()-a<e||t.done)r.scheduler.addTask(Pb.RunExperiment,Mb.Front,n);else{var i=t.failedLogMessage;void 0!==i&&r.outputMessageLog.push({kind:qC.ExperimentRunResult,logMessage:i})}}};this.scheduler.addTask(Pb.RunExperiment,Mb.Back,n)},e.prototype.setSheetNames=function(e,t,r){var n=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){if(n.trySetStateId(Pb.ServerUpdate,r)){var a=n.docs.setSheetNames(e,t);a.kind===Be.Failure&&n.logUnavailableObject(a.reason),n.deleteComputeTasks(xb.SetSheetNames)}}))},e.prototype.setRefStyle=function(e,t){var r=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){r.trySetStateId(Pb.ServerUpdate,t)&&(r.docs.setRefStyle(e),r.docs.clearCompiledFormulas(),r.deleteComputeTasks(xb.SetRefStyle))}))},e.prototype.setLocaleInfo=function(e,t){var r=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){r.trySetStateId(Pb.ServerUpdate,t)&&(r.docs.setLocaleInfo(e),r.docs.clearCompiledFormulas(),r.deleteComputeTasks(xb.SetLocaleInfo))}))},e.prototype.setNumberFormats=function(e,t,r){var n=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){n.trySetStateId(Pb.ServerUpdate,r)&&n.docs.setNumberFormats(e,t)}))},e.prototype.writeNamedObject=function(e,t,r,n){var a=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){if(a.trySetStateId(Pb.ServerUpdate,e)){var i=a.docs.setNamedObject(!0,or(t,r),n);return i.kind===Be.Failure?a.logUnavailableObject(i.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){if(r.trySetStateId(Pb.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===Be.Failure?r.logUnavailableObject(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var n=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){if(n.trySetStateId(Pb.ServerUpdate,e)){var a=n.docs.promoteNamedObjects(t,r);if(a.kind===Be.Failure)return n.logUnavailableObject(a.reason);a.value||n.outputMessageLog.push({kind:qC.UpdateNamesRequest,stateId:n.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){if(r.trySetStateId(Pb.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===Be.Failure)return r.logUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){if(r.trySetStateId(Pb.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===Be.Failure?r.logUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask(Pb.ServerUpdate,Mb.Back,(function(){if(r.trySetStateId(Pb.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===Be.Failure?r.logUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks(Pb.MaybeCollectGarbage,void 0),this.scheduler.addTask(Pb.MaybeCollectGarbage,Mb.Back,(function(){if(!(e.stateChangesSinceLastGC<17)){var t=e.stateId-17;e.docs.collectGarbage(t),e.outputMessageLog.push({kind:qC.GarbageCollected,minStateIdKept:t}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.scheduleAvailableFormulas=function(e,t){var r=this;return this.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(n){var a=rr(e.sheet,n),i=r.docs.getEditedFormula(a);return i.kind===Be.Failure?(r.logUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla&&r.enqueueComputeCellValue(a,t),!0)}))},e.prototype.scheduleViewportCells=function(e,t,r){if(void 0!==t)for(var n=t.sheet,a=bC(t.range),i=0,o=e;i<o.length;i++){pt(n,(s=o[i]).sheet)&&this.scheduleAvailableFormulas(UC(n,dC(s.set,a)),r)}else for(var u=0,c=e;u<c.length;u++){var s=c[u];this.scheduleAvailableFormulas(s,r)}},e}();function Bb(e){return new Promise((function(t){return setTimeout(t,e)}))}function Wb(e,t){var r=t&&t.timeThreshold||10,n=t&&t.costThreshold||1,a=t&&t.macrotaskDelay||0,i={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},o=Nm(),u=o[0],c=o[1],s=c[0],l=c[1];var f=!0;var d=Bb(a),h=Cr();return function t(){if(!f||!function(){try{for(var t=0;t<n;){i.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return l(e),!1}}())return s();var o=Cr();o-h<r?(Promise.resolve().then(t),i.microtaskContinues+=1):(d.then((function(){d=Bb(a),h=Cr(),i.macrotaskTotalDelay+=h-o,t()})),i.macrotaskContinues+=1)}(),{promise:u,stop:function(){f=!1},stats:i}}var jb=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given "+t;O.ULS.traceTag(591974878,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=Cr();Cr()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}(),Hb={TestExperiment:jb.create.bind(jb)};function Kb(e,t){var r=gr("en-US"),n=function(e,t,r){var n=Ra().slice();return MS(t,$S,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),Ia(e,n)}(r,e.worksheetFunctionNames,t),a=n.getWorksheetFuncId,i=n.getWorksheetFuncName,o=function(e,t){var r=ya.slice();return MS(e,eE,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t);return Object(j.a)(Object(j.a)({},e),{parseNumber:ma(oa()),getWorksheetFuncId:a,getWorksheetFuncName:i,isNumeral:ga,getOrdinal:Ca,isIdentStart:Sa,isIdentContinue:Ea,stringCompareCI:r,errorNames:o})}function qb(e,t){return fr(t)?{index:e,length:1}:{index:e,length:mr(t-e)+1}}function Jb(e,t){var r=qb(t.row,t.lastRow),n=r.index,a=r.length,i=qb(t.column,t.lastColumn),o=i.index,u=i.length;return tr(Jt(e,t.sheetId),zt(n,o,a,u))}function Qb(e,t){var r=t.sheetId,n=t.usedRange;return lr(n)?Jb(e,Object(j.a)({sheetId:r},n)):{sheet:Jt(e,r),range:void 0}}function Xb(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=Zg({row:t}),a=Zg({col:r}),i=lC(n,a);return vC(bC(e),i)}(e.range,t,r)}}function Yb(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function zb(e){return dt(e)?Wp(e.sheet.index,e.range.row,e.range.col):Wp(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function Zb(e,t,r,n){var a=Dg;if(fr(n))return a;for(var i=0;i<n.length;i+=1){var o=n[i];if(e<=o&&o<e+t){for(var u=1;i+u<n.length&&n[i+u]===o+u;)u+=1;i+=u-1,a=kg(a,r(hr(o,o+u)))}}return a}function $b(e,t){switch(typeof t){case"string":case"boolean":return t;case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return De;case"Error":return Ce(t.type);default:return}}function eR(e,t){switch(typeof t){case"string":case"boolean":return t;case"number":return e.toNumber(t)}switch(t.kind){case x.Error:return xp(t.type);case x.Blank:return Up;default:return}}function tR(e,t,r){if(!fr(r)){switch(r.kind){case"NamedValue":switch(typeof r.value){case"string":case"boolean":return UE(r.value);case"number":return UE(e.fromNumber(r.value))}return"Error"===r.value.kind?UE(Ce(r.value.type)):A("calc.calc.namedObjectDataToNamedObject: NamedValue",r.value.kind);case"NamedFormula":return xE(r.formulaBarText);case"NamedRange":var n=Jb(t,r.range);return UE(Me(n.sheet,n.range));case"NamedFailure":return PE(r.failureReason,fr(r.objectKind)?void 0:r.objectKind)}return A("calc.calc.namedObjectDataToNamedObject: kind",r)}}function rR(e,t){var r,n;if(t.kind===Ol.NotImplemented)for(var a=0,i=t.features;a<i.length;a++){var o=i[a];TS(e,Ol.NotImplemented+" "+o)}else if(t.kind===Ol.IllFormedFormula)TS(e,Ol.IllFormedFormula+" "+((null!=(r=t.mode)?r:"")+" ")+JSON.stringify(null!=(n=t.diagnostics)?n:{}));else if(t.kind===Ol.Unavailable)for(var u=0,c=t.objects;u<c.length;u++){var s=c[u],l=[Ol.Unavailable];if("string"==typeof s.kind&&s.kind in Lb){var f=s;switch(l.push(f.kind),f.kind){case Lb.SheetId:l.push(f.sheetId);break;case Lb.NameLoc:l.push(void 0===f.name.scope.index?"global":"sheet");break;case Lb.ClientFailure:l.push(f.reason);break;case Lb.VolatileFunction:l.push(f.name)}}else l.push(JSON.stringify(s));TS(e,l.join(" "))}else t.kind===Ol.LimitExceeded?TS(e,t.kind+" "+Il[t.limit]):TS(e,t.kind)}var nR=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.arrayDeltas=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.isRecalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==TC.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(t=e!==TC.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push.apply(t,r)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.isRecalcFinished=this.isRecalcFinished||e},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(bm(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.arrayDeltas.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,this.arrayDeltas),this.editedRangeDeltas=[],this.arrayDeltas=[]),this.dependentRangeDeltas.length>0&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[]),this.dependentRangeDeltas=[]),this.isRecalcFinished&&(this.onRecalcResults(km(this.currentOutputStateId,"Dependents",!0,[],[])),this.isRecalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r){for(var n=0;n<Math.max(t.length,r.length);n+=10)this.onRecalcResults(km(this.currentOutputStateId,e,!1,t.slice(n,n+10),r.slice(n,n+10)))},e}(),aR=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.document=Kt(void 0,""),this.localeInfo=Fa(),this.mathpack=oa(),this.refStyle=F.A1,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.recalcStatistics=PC,this.precisionEvalStatistics=jC,this.precisionPrintFormulaStatistics=JC,this.nameFailures=[],this.rangeFailures=[],this.printFormulaFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.setConfig({}),this.dataModel=new Vb(this.localeInfo,this.mathpack,this.refStyle,this.config)}return e.prototype.ping=function(){},e.prototype.setInputStateId=function(e){var t=e-this.currentInputStateId;return t<0?(this.logInputStateIdDecrease(),!1):(0!==t&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;return this.clearAsyncResumeRecalc(),this.recalcLoop=Wb((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs}),Tm(this.recalcLoop.promise,(function(){e.recalcLoop=void 0}))},e.prototype.processRecalcResults=function(e){for(var t,r,n=new nR(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),a=0,i=e;a<i.length;a++){var o=i[a];if(o.kind!==qC.GarbageCollected)if(o.kind!==qC.ExperimentRunResult){if(this.setOutputStateId(o.stateId))switch(n.setOutputStateId(o.stateId),o.kind){case qC.CellWrite:var u=o.cell,c=o.value,s=o.format,l=o.cellKind,f=o.formulaBarText,d=u.sheet,h=u.range,v=this.cellWriteToRangeDelta(d.index,h.row,h.col,c,s,f,"messages.<index>.value");lr(v)&&n.pushCellWrite(l,v);break;case qC.RangeWrite:var p=o.range,m=o.values;l=o.cellKind,f=o.formulaBarText,d=p.sheet,h=p.range;n.pushRangeWrite.apply(n,Object(j.f)([l],this.rangeWriteToRangeDeltas(d.index,h,m,f,"messages.<index>.values")));break;case qC.NameFailure:this.nameFailures.push(o);break;case qC.RangeFailure:this.rangeFailures.push(o);break;case qC.PrintFormulaFailure:this.printFormulaFailures.push(o);break;case qC.UnhandledFailure:this.unhandledFailures.push(o);break;case qC.UpdateRequest:n.pushUpdateRequest(zb(o.range));break;case qC.UpdateNamesRequest:n.pushUpdateNameRequest(o.scope);break;case qC.RecalcStatistics:n.pushRecalcFinished(o.message===xC.RecalcFinished),this.recalcStatistics=VC(this.recalcStatistics,o);break;case qC.PrecisionEvalStatistics:this.precisionEvalStatistics=(t=this.precisionEvalStatistics,r=o.stats,{samples:HC(t.samples,r.samples),failures:HC(t.failures,r.failures)});break;case qC.PrecisionPrintFormulaStatistics:this.precisionPrintFormulaStatistics=QC(this.precisionPrintFormulaStatistics,o.stats);break;case qC.WorkbookStatistics:this.logWorkbookStats(o.stateId,o.stats);break;case qC.StateAdvanced:break;default:return A("calc.calc.RecalcServiceImpl.processRecalcResults",o)}}else this.logExperimentRunResult(o.logMessage);else this.onGC(o.minStateIdKept)}n.flush()},e.prototype.logExperimentRunResult=function(e){O.ULS.traceTag(594409422,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,"calc.calc.RecalcService: experiment done; "+e)},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.printFormulaFailures;this.printFormulaFailures=[];var n=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",f.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",f.TraceLevel.Info),this.logGenFailureStats(r,592730065,"print-formula",f.TraceLevel.Info),this.logGenFailureStats(n,595194338,"unhandled",f.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var a={},i=0,o=e;i<o.length;i++){rR(a,o[i].reason)}var u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(a);O.ULS.traceTag(t,f.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var a=this;if(0!==e.length){for(var i={},o=0,u=e;o<u.length;o++){var c=u[o],s=c.reason,l=c.cellKind;rR(i[l]||(i[l]={}),s)}Object.getOwnPropertyNames(i).sort().forEach((function(e){var o=i[e],u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+a.currentOutputStateId+", cell kind = "+e+", stats = "+JSON.stringify(o);O.ULS.traceTag(t,f.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var a=n[r].reason;if(a.kind===Ol.JavaScriptError){var i="calc.calc.RecalcService: recalc "+t+" JavaScript error: "+p(a.error);O.ULS.traceTag(595658721,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,i)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var a="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+t+", stats = "+JSON.stringify(n));O.ULS.traceTag(e,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0){var e=this.recalcStatistics;if(this.recalcStatistics=PC,this.dataModel.shouldSample(this.config.sampleRecalcStatisticsRate)){var t="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(e));O.ULS.traceTag(595654593,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,t)}}},e.prototype.logPrecisionEvalStats=function(){if(0!==this.precisionEvalStatistics.samples.length||0!==this.precisionEvalStatistics.failures.length){var e=this.precisionEvalStatistics,t=e.samples,r=e.failures,n={};r.forEach((function(e){return rR(n,e)}));var a="calc.calc.RecalcService: precision eval statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify({samples:t,failures:n}));O.ULS.traceTag(595645023,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a),this.precisionEvalStatistics=jC}},e.prototype.logPrecisionPrintFormulaStats=function(){if(0!==this.precisionPrintFormulaStatistics.samples.length||0!==this.precisionPrintFormulaStatistics.failures.length){var e=this.precisionPrintFormulaStatistics,t=e.samples,r=e.failures,n={};r.forEach((function(e){return rR(n,e)}));var a="calc.calc.RecalcService: precision print-formula statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify({samples:t,failures:n}));O.ULS.traceTag(592730059,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a),this.precisionPrintFormulaStatistics=JC}},e.prototype.logWorkbookStats=function(e,t){var r="calc.calc.RecalcService: workbook statistics; "+("stateId = "+e+", stats = "+JSON.stringify(t));O.ULS.traceTag(595359882,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,r)},e.prototype.logInputStateIdDecrease=function(){TS(this.ignoredInputStats,"stateId went backwards")},e.prototype.logOutputStateIdDecrease=function(){TS(this.ignoredOutputStats,"stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats(),this.logPrecisionEvalStats(),this.logPrecisionPrintFormulaStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,a,i,o){if(_S(n,LE,this.ignoredOutputStats,o)){var u=eR(this.mathpack,n),c=function(e){if(void 0!==e)return Sm(e.isExact,e.iformat,!1,e.category,e.decimals)}(a);return lr(i)||lr(u)||lr(c)?ym(Wp(e,t,r),Em(i,u,c)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,a){for(var i=a+".<index>.<index>",o=t.row,u=t.col,c=t.rows,s=t.cols,l=[],f=0;f<c;f+=1)for(var d=0;d<s;d+=1){var h=this.cellWriteToRangeDelta(e,o+f,u+d,r[f][d],void 0,0===f&&0===d?n:void 0,i);lr(h)&&l.push(h)}return l},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?F.A1:F.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentInputStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.localeInfo=Kb(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentInputStateId)},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(MS(e,rE,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.setSheetNames=function(e){this.updateSheetNames(this.currentInputStateId,e)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e)&&(this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,MS(t,aE,this.ignoredInputStats,"sheetNames"),e))},e.prototype.updateNamedObjects=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=MS(t,kE,this.ignoredInputStats,"namedObjectsUpdates");r<n.length;r++){var a=n[r],i=a.scope,o=a.objects,u=a.fromStateId,c=ir(this.document,lr(i)?i:void 0);if(lr(o))for(var s=0,l=MS(o,AE,this.ignoredInputStats,"namedObjectsUpdates.<index>.objects");s<l.length;s++){var f=l[s],d=f.name,h=f.data;this.dataModel.writeNamedObject(e,c,d,tR(this.mathpack,this.document,h))}else lr(u)?this.dataModel.promoteNamedObjects(e,c,u):this.dataModel.writeUndefinedNames(e,c)}}},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=MS(t,gE,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var a=n[r];this.dataModel.extendUnusedRange(Qb(this.document,a),e)}}},e.prototype.updateRanges=function(e,t){var r,n;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var a=0,i=MS(t,vE,this.ignoredInputStats,"rangeUpdates");a<i.length;a++){var o=i[a],u=o.range,c=o.excludeRows,s=o.excludeColumns,l=o.data,f=o.fromStateId,d=Jb(this.document,u),h=d.range,v=Zb(h.row,h.rows,kC.row,c),p=Xb(d,v,Zb(h.col,h.cols,kC.col,s)),m=lr(l)?$b(this.mathpack,l.value):De;if(void 0!==m){var g=Ct(h);if(lr(l)){var C=l.iformat,S="ArrayFormula"===l.kind?void 0:null!=(r=l.formulaBarText)?r:void 0,E=null!=(n=l.failureReason)?n:void 0;if("Inferred"===l.kind)this.dataModel.writeCellContents(e,p,S,void 0,g,m,C,E);else{var y="CellFormula"===l.kind;this.dataModel.writeCellContents(e,p,S,y,g,m,C,E)}}else fr(f)?this.dataModel.writeCellContents(e,p,"",!1,g,De,0,void 0):this.dataModel.promoteCellContents(e,d,p,f);this.dataModel.writeHiddenRows(e,Yb(d,v))}}}},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=MS(t,mE,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var a=n[r],i=a.range,o=a.data,u=a.fromStateId,c=Jb(this.document,i);if(lr(o)){var s=o.formulaBarText,l=o.isSpilled,f=Ct(c.range);this.dataModel.writeArrayFormula(e,c,s,f,l)}else lr(u)}}},e.prototype.editRangeFormulas=function(e,t){var r=this;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var n=MS(t,NE,this.ignoredInputStats,"rangeFormulaEdits"),a=function(t){var n=t.kind,a=t.range,o=t.formulaBarText,u=t.value,c=t.origin,s=t.viewport,l=Dg;a.forEach((function(e){l=lC(l,bC(Jb(r.document,e).range))}));var f=Jb(i.document,a[0]),d=lr(c)?Zt(c.row,c.column):Ct(f.range),h=lr(s)?Jb(i.document,s):void 0,v=void 0;if(lr(u)){if(void 0===(v=$b(i.mathpack,u)))return"continue"}else v=void 0;var p="CellFormula"===n||"Value"!==n&&void 0;i.dataModel.editCellContents(e,UC(f.sheet,l),o,p,d,v,h)},i=this,o=0,u=n;o<u.length;o++){a(u[o])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=MS(t,FE,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var a=n[r],i=a.range,o=a.formulaBarText,u=a.origin,c=a.viewport,s=Jb(this.document,i),l=lr(u)?Zt(u.row,u.column):Zt(i.row,i.column),f=lr(c)?Jb(this.document,c):void 0;this.dataModel.editArrayFormula(e,s,o,l,f)}}},e.prototype.setConfig=function(e){var t,r,n,a,i,o,u,c,s,l,f,d=Array.isArray(e.runExperiments)?{budget:(t=e.experimentBudget,null!=t?t:10),experiments:(f=e.runExperiments,f.map((function(e){var t=e.name,r=e.param;return Hb[t](r)})).filter((function(e){return void 0!==e})))}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:(r=e.totalEvalTimeMs,null!=r?r:1e4),maxCellChain:32768,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:(n=e.samplePrecisionEvalRate,null!=n?n:.02),samplePrecisionPrintFormulaRate:(a=e.samplePrecisionPrintFormulaRate,null!=a?a:.001),sampleRecalcStatisticsRate:(i=e.sampleRecalcStatisticsRate,null!=i?i:.2),sampleWorkbookStatisticsRate:(o=e.sampleWorkbookStatisticsRate,null!=o?o:.1),sampleCellEvalStopwatchRate:(u=e.sampleCellEvalStopwatchRate,null!=u?u:.003),sampleRecalcEditedStopwatchRate:(c=e.sampleRecalcEditedStopwatchRate,null!=c?c:1),sampleRecalcViewportStopwatchRate:(s=e.sampleRecalcViewportStopwatchRate,null!=s?s:1),rngSeed:(l=e.rngSeed,null!=l?l:1e3*Date.now()),experimentDefinitions:d}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new Vb(this.localeInfo,this.mathpack,this.refStyle,this.config),this.recalcStatistics=PC,this.precisionEvalStatistics=jC,this.precisionPrintFormulaStatistics=JC,this.nameFailures=[],this.rangeFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=-1/0},e.prototype.evalFormula=function(e,t,r){var n=this,a=Jt(this.document,r);return this.dataModel.evalFormula(e,t,a).then((function(e){if(ot(e)){if(!_S(e.value,DE,n.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var t=eR(n.mathpack,e.value);return b("calc.calc.RecalcService.evalFormula",void 0!==t),at(t)}return it(e.reason.kind)}))},e.prototype.testAdvanceState=function(e){this.setInputStateId(e)&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.testDelay=function(e){return Object(j.b)(this,void 0,void 0,(function(){return Object(j.d)(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},e}();function iR(){return{onError:function(e,t){var r="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:p(t.error)});O.ULS.traceTag(595658753,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,r)},onInit:function(e){var t=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),r=t.onRecalcResults,n=t.onUpdateRequest,a=t.onGC;e.setExports("service",new aR(r.notify,n.notify,a.notify))},scriptName:"excelOnlineRecalcService.worker"}}var oR;!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(oR||(oR={}));var uR=function(e){return void 0===e&&(e=oR.Thread),Object(j.b)(this,void 0,void 0,(function(){var t,r,n,a,i,o,u,c,s=this;return Object(j.d)(this,(function(l){switch(l.label){case 0:return t=!1,r={outside:{onError:function(e,r){var n=p(r.error),a="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});O.ULS.traceTag(595658719,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a),r.closing&&(t=!0)},onClosed:function(e){var r="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(t?"because of an error":"normally");O.ULS.traceTag(595658720,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,r),t=!0}},inside:iR()},[4,rg(e===oR.Thread?[vm.Dedicated]:e===oR.Local?[vm.FunctionCall]:[vm.Dedicated,vm.FunctionCall],r)];case 1:if(null==(n=l.sent()))throw new Error("could not create recalc service worker");return a="calc.calc.createRecalcService: worker created; outside.workerKind = "+n.workerKind,O.ULS.traceTag(595731987,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Info,a),i=-1/0,o={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){i=e}},n.setExports("client",o),(u=n.getImports("service",["setA1ReferenceStyle","setLocale","setNumberFormats","setSheetNames","updateSheetNames","updateUnusedCells","updateNamedObjects","updateRanges","updateArrays","editRangeFormulas","editArrayFormulas","resumeRecalc","reconfigure","clearCache","testAdvanceState","testDelay","evalFormula","ping"])).ping.callTimeout=3e4,c=function(e,t){},Mm((function(){return Object(j.b)(s,void 0,void 0,(function(){var e,r,n,a;return Object(j.d)(this,(function(i){switch(i.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(i.sent(),t)return[2,void 0];e=Cr(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u.ping.call()];case 3:return i.sent(),[3,5];case 4:return i.sent(),r=u.ping.callTimeout,n=Cr()-e,a="calc.calc.RecalcService: unresponsive; timeout = "+r+", waitTime = "+n,O.ULS.traceTag(591934810,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,a),c(r,n),[3,5];case 5:return[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: "+p(e);O.ULS.traceTag(0,f.LogCategory.msoulscat_ES_EWAJS,f.TraceLevel.Warning,t)})),[2,{setOnRecalcResults:function(e){o.onRecalcResults=e},setOnUpdateRequest:function(e){o.onUpdateRequest=e},setOnUnresponsive:function(e){c=e},setA1ReferenceStyle:function(e){t||u.setA1ReferenceStyle.notify(e)},setLocale:function(e){t||u.setLocale.notify(e)},setNumberFormats:function(e,r){t||u.setNumberFormats.notify(e,r)},setSheetNames:function(e){t||u.setSheetNames.notify(e)},updateSheetNames:function(e,r){t||u.updateSheetNames.notify(e,r)},updateNamedObjects:function(e,r){t||u.updateNamedObjects.notify(e,r)},setUsedRanges:function(e,t){},updateUnusedCells:function(e,r){t||u.updateUnusedCells.notify(e,r)},updateRanges:function(e,r){t||u.updateRanges.notify(e,r)},updateArrays:function(e,r){t||u.updateArrays.notify(e,r)},editRangeFormulas:function(e,r){t||u.editRangeFormulas.notify(e,r)},editArrayFormulas:function(e,r){t||u.editArrayFormulas.notify(e,r)},resumeRecalc:function(){t||u.resumeRecalc.notify()},reconfigure:function(e){var r;t||(u.ping.callTimeout=null!=(r=e.responsivenessPingTimeout)?r:3e4,u.reconfigure.notify(e))},clearCache:function(){t||u.clearCache.notify()},testAdvanceState:function(e){t||u.testAdvanceState.notify(e)},testResumeRecalc:function(){return u.resumeRecalc.call()},testCrash:function(){return u.testDelay.isCritical=!0,u.testDelay.callTimeout=0,u.testDelay.call(100)},close:function(){n.close()},stateIdAvailable:function(e){return e>=i},evalFormula:function(e,t,r){return u.evalFormula.call(e,t,r)}}]}}))}))};r.d(t,"packageVersion",(function(){return"13.1.1"})),r.d(t,"location",(function(){return ei})),r.d(t,"formula",(function(){return ai})),r.d(t,"value",(function(){return ri})),r.d(t,"signature",(function(){return oi})),r.d(t,"util",(function(){return ci})),r.d(t,"config",(function(){return li})),r.d(t,"math",(function(){return di})),r.d(t,"parse",(function(){return n})),r.d(t,"analyze",(function(){return o})),r.d(t,"runtime",(function(){return u})),r.d(t,"calc",(function(){return l})),r.d(t,"funcs",(function(){return s})),r.d(t,"worker",(function(){return c}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map