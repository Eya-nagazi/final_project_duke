typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("Common.App.Enrichment");Common.App.Enrichment.m=function(){};Common.App.Enrichment.m.registerInterface("Common.App.Enrichment.m");Common.App.Enrichment.l=function(){};Common.App.Enrichment.l.registerInterface("Common.App.Enrichment.l");Common.App.Enrichment.k=function(){};Common.App.Enrichment.k.registerInterface("Common.App.Enrichment.k");Common.App.Enrichment.n=function(){this.requestId=requestId;this.cellId=cellId};Common.App.Enrichment.n.prototype={requestId:null,cellId:null};Common.App.Enrichment.h=function(){this.messageType=type};Common.App.Enrichment.h.prototype={messageType:0};Common.App.Enrichment.b=function(){this.messageContent=this.$$gta["Common.App.Enrichment.b"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.b"].T)?0:this.$$gta["Common.App.Enrichment.b"].T===Boolean?!1:null;Common.App.Enrichment.b.$$(this.$$gta["Common.App.Enrichment.b"].T).initializeBase(this,[type]);this.messageContent=content};Common.App.Enrichment.b.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="b$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.b.apply(this,t)};o=Common.App.Enrichment.h;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.b":{T:n},ctor:Common.App.Enrichment.b};i.prototype.$$gta=s;f=Common.App.Enrichment.b.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.j=function(){};Common.App.Enrichment.j.prototype={Query:null,TelemetryJson:null};Common.App.Enrichment.i=function(n){this.messageType=n};Common.App.Enrichment.i.prototype={messageType:0};Common.App.Enrichment.c=function(n,t){this.messageContent=this.$$gta["Common.App.Enrichment.c"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.c"].T)?0:this.$$gta["Common.App.Enrichment.c"].T===Boolean?!1:null;Common.App.Enrichment.c.$$(this.$$gta["Common.App.Enrichment.c"].T).initializeBase(this,[n]);this.messageContent=t};Common.App.Enrichment.c.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="c$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.c.apply(this,t)};o=Common.App.Enrichment.i;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.c":{T:n},ctor:Common.App.Enrichment.c};i.prototype.$$gta=s;f=Common.App.Enrichment.c.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d=function(n,t,i){Common.App.Enrichment.d.$$(this.$$gta["Common.App.Enrichment.d"].T).initializeBase(this,[n,t]);this.telemetryJson=i};Common.App.Enrichment.d.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="d$"+n.getName().replace(/\./g,"_"),i,f,e,o,s,h,c,l,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.d.apply(this,t)};f=Common.App.Enrichment.c.$$(n);i.registerClass("Common.App.Enrichment.__tc."+t,f);e={"Common.App.Enrichment.d":{T:n},ctor:Common.App.Enrichment.d};o=f.prototype.$$gta;for(s in o)h={key:s,value:o[s]},e[h.key]=h.value;i.prototype.$$gta=e;c=Common.App.Enrichment.d.prototype;for(l in c)r={key:l,value:c[l]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d.prototype={telemetryJson:null};Common.App.Enrichment.f=function(){};Common.App.Enrichment.f.prototype={keyCode:0};Common.App.Enrichment.e=function(){};Common.App.Enrichment.e.prototype={applicationName:null,applicationVersion:null,anid:null,sessionId:null,appCorrelationId:null,market:null,themeId:0,featuresBitMask:0,uiLanguage:null,disambiguationJson:null};Common.App.Enrichment.a=function(n,t,i,r,u){this.r=Function.createDelegate(this,this.O);this.q=Function.createDelegate(this,this.M);this.o=Function.createDelegate(this,this.K);this.p=Function.createDelegate(this,this.L);this.w=Function.createDelegate(this,this.D);this.n=Function.createDelegate(this,this.J);this.g=n;this.y=t;this.x=i;this.j=r;this.s=u;this.i=Common.h.b(27,0)};Common.App.Enrichment.a.a=function(n,t,i,r,u,f,e,o){var h,c,s;return Common.c.h()?(c=String.format("{0} {1} {2}",f?"Shift":"",e?"Control":"",o?"Alt":""),c.trim(),h=document.createEvent("KeyboardEvent"),h.initKeyboardEvent(n,r,u,window.self,t,0,c,!1,"en-US")):(s={},s.keyCode=i,s.ctrlKey=e,s.shiftKey=f,s.altKey=o,s.bubbles=r,s.cancelable=u,h=new KeyboardEvent(n,s)),h};Common.App.Enrichment.a.prototype={g:null,y:null,e:null,d:null,x:null,j:null,s:null,t:null,u:null,k:null,h:null,i:null,v:!1,A:function(){return!0},l:function(){return Common.a.a.b("EnrichmentPaneUrl")},dispose:function(){this.A()&&this.h&&this.g.b("click",this.h,this.n);this.h=null;this.d&&(this.Q(),this.d.parentNode.removeChild(this.d),this.d=null);var n=this.j.a("EnrichmentPaneId");n.a(this.i)},b:function(n,t,i){this.e=n;this.v||(this.k=this.E(),this.z().appendChild(this.k),this.N(),this.s.a(1520278933,2147483648,this.w),this.P(),this.v=!0);this.d.src=this.l()&&this.l().length?this.l()+"?culture="+t.market+"&appName="+t.applicationName+"&themeId="+t.themeId+"&featuresBitMask="+t.featuresBitMask:"about:blank";this.t=t;this.u=i;this.C()},c:function(n,t){var i=new(Common.App.Enrichment.d.$$(String))(2,n,t);this.m(i)},P:function(){var n=this.j.a("EnrichmentPaneId");n.d="main";this.g.d("EnrichmentPaneId",this.k,!1);n.b(this.i,1520278933)},O:function(){if(this.d){Common.n.b(this.d.contentWindow);var n=new(Common.App.Enrichment.d.$$(String))(4,null,null);this.m(n)}},J:function(){return this.a(),this.e&&this.e.f(),!0},E:function(){var n=CommonUI.a.a("div","EnrichmentPaneId","EnrichmentPane");return this.A()&&n.appendChild(this.F()),this.I(n),n},F:function(){var t=CommonUI.a.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),i=CommonUI.a.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle"),n;return i.innerText=$a.Z,i.title=$a.Z,n=CommonUI.e.a("CloseEnrichmentPane","EnrichmentPaneCloseButton",$a.c,"ClosePaneGlyph_16x16x32",!1),this.g.a("click",n,this.n),t.appendChild(i),t.appendChild(n),this.h=n,t},I:function(n){this.d=CommonUI.a.b("iframe","","EnrichmentFrame");n.appendChild(this.d);this.d.id="EnrichmentContentFrame"},N:function(){Common.j.a(this.d,"load",this.p);Common.j.a(this.d,"error",this.o);$addHandler(window,"message",this.q)},Q:function(){Common.j.c(this.d,"load",this.p);Common.j.c(this.d,"error",this.o);$removeHandler(window,"message",this.q)},G:function(){this.d.src="about:blank"},a:function(){this.B();this.G()},D:function(n,t,i){return i!==1&&this.a(),32},L:function(){},K:function(){},M:function(n){var r=n.rawEvent,t,u,f,e,o,i,s,h,c,l;if(!this.d||this.d.src.indexOf(r.origin)!==-1){try{t=JSON.parse(r.data)}catch(p){return}if(!CommandUI.a.a(t.messageType)){u=window.g_badCastCallback;window.g_badCastCallback=null;switch(t.messageType){case 2:this.m(new(Common.App.Enrichment.d.$$(String))(1,JSON.stringify(this.t),this.u));break;case 1:this.m(new(Common.App.Enrichment.c.$$(String))(0,this.H()));break;case 3:f=t;this.e&&this.e.i(f.messageContent);break;case 5:e=t;this.e&&this.e.e(e.messageContent);break;case 8:o=t;this.e&&(i=JSON.parse(o.messageContent),this.e.g(i.Query,i.TelemetryJson));break;case 6:this.e&&this.e.b();break;case 11:var a=t,v=JSON.parse(a.messageContent),y=Common.App.Enrichment.a.a("keydown","f6",117,!0,!1,v,!0,!1,!1);this.d&&this.d.dispatchEvent(y);break;case 12:s=t;h=JSON.parse(s.messageContent);h.keyCode===27&&(c=Common.App.Enrichment.a.a("keydown","esc",27,!0,!1,!1,!1,!1,!1),this.d&&this.d.dispatchEvent(c));break;case 13:l=t;this.e&&this.e.h(l.messageContent)}window.g_badCastCallback=u}}},H:function(){return JSON.stringify([2,1,3,5,8,6])},m:function(n){var t=JSON.stringify(n);this.d.contentWindow.postMessage(t,Common.k.g(this.l()))}};Common.App.Enrichment.g=function(n){this.k=n};Common.App.Enrichment.g.prototype={k:null,j:null,d:function(n,t,i){this.j=n;this.k&&this.k.b(this,t,i)},a:function(n,t){this.k&&this.k.c(n,t)},c:function(){this.k&&this.k.a()},dispose:function(){this.k&&(this.k.dispose(),this.k=null)},i:function(n){return this.j?this.j.m(n):!1},g:function(n,t){this.j&&this.j.k(n,t)},e:function(n){return this.j?this.j.i(n):!1},f:function(){this.j&&this.j.j()},b:function(){this.j&&this.j.h()},h:function(n){this.j&&this.j.l(n)}};Common.App.Enrichment.h.registerClass("Common.App.Enrichment.h");Common.App.Enrichment.i.registerClass("Common.App.Enrichment.i");Common.App.Enrichment.e.registerClass("Common.App.Enrichment.e");Common.App.Enrichment.a.registerClass("Common.App.Enrichment.a",null,Common.App.Enrichment.l,Sys.IDisposable);Common.App.Enrichment.g.registerClass("Common.App.Enrichment.g",null,Common.App.Enrichment.k,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.XC=function(){};_Ewa.Ea=function(n,t){this.b=t;this.a=n};_Ewa.Ea.prototype={b:null,a:null,x:function(n,t){if(48568533===t&&!this.b.isChangeGateEnabled("OfficeVSO:4237849_DisablePreviewGalleryFlyoutAnchor"))return!1;switch(t){case 48568533:case-1203788282:var i=_Ewa.b.a(this.b);return i&&i.a()&&i.a().a().D()>7e3?!0:!1;default:return!1}},v:function(n,t,i){var r=$$sc.a.a(Boolean,!0),u=t.a;switch(u){case-1203788282:this.a.s(i.MenuItemId.toString());break;case 311599363:this.a.q();break;case 439914789:this.a.g();break;case 2127195269:this.a.z();break;case-1662108744:this.a.A(i.MenuItemId.toString());break;case 1266950951:this.a.y(!0);break;case 49813714:this.a.t();break;default:r=_Ewa.L.a(u)}return r},u:function(n,t){switch(t.a){case-1203788282:case 439914789:case 2127195269:case 49813714:return this.b.a(168);case-1662108744:return this.b.a(837);case 311599363:case 1266950951:return!0;default:return!1}},w:function(n,t,i){return t==="PopulateConvertToLinkedEntityMenu"&&this.b.a(168)?this.a.C(n,t,i):!1}};_Ewa.ta=function(n){_Ewa.ta.initializeBase(this,[n])};_Ewa.ta.a=function(n){_Ewa.Z.a(273,new _Ewa.ta(n))};_Ewa.ta.prototype={m:function(){var n=this;_Ewa.gk.a(_Ewa.ew,this.h,271,272,function(t){n.l([new _Ewa.Ea(t,n.h)],null)})}};_Ewa.Eb=function(n,t,i,r,u){this.v=Function.createDelegate(this,this.H);this.i=Function.createDelegate(this,this.Q);this.j=Function.createDelegate(this,this.J);this.w=Function.createDelegate(this,this.I);this.x=Function.createDelegate(this,this.L);this.l=Function.createDelegate(this,this.N);this.y=Function.createDelegate(this,this.P);this.k=Function.createDelegate(this,this.K);this.m=Function.createDelegate(this,this.O);this.a=n;this.b=_Ewa.b.a(this.a);this.b.a().l(this.m);this.b.v(this.k);this.p=r;this.n=u;i.f(_Ewa.pk,t);var f=new _Ewa.Ed(t);this.g=new _Ewa.Ee(f)};_Ewa.Eb.prototype={a:null,o:!1,c:!1,e:!0,q:!1,f:null,h:0,p:null,b:null,g:null,n:null,dispose:function(){this.a&&(this.b.a().k(this.m),this.b.x(this.k))},T:function(n){var i=_Ewa.g.c(this.b.a().c(),this.a),t=this,r=function(r,u){return _Ewa.ev.m(t.a.d().a(),i,n,_Ewa.o.a(r,t.y),u,null,null)},u=this;return _Ewa.T.a(this.a.h(),r,function(n){return new _Ewa.I(109,0,n,0,null)},null),!0},R:function(n,t){Diag.a.a(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",t);var r=_Ewa.g.c(this.b.a().c(),this.a),i=this,u=function(t,u){return _Ewa.ev.l(i.a.d().a(),r,n,_Ewa.o.a(t,i.l),u,null,null)},f=this;_Ewa.T.a(this.a.h(),u,function(n){return new _Ewa.I(110,0,n,16,null)},null);return},G:function(n){var t=_Ewa.g.c(this.b.a().c(),this.a);!t;this.e=!1;var i=this,r=function(r,u){return _Ewa.ev.i(i.a.d().a(),t,n,_Ewa.o.a(r,i.x),u,null,null)},u=this;return _Ewa.T.a(this.a.h(),r,function(n){return new _Ewa.I(111,0,n,16,null)},null),!0},M:function(){this.c=!1;this.o=!0;return},A:function(){var n=this.u();if(n){var t=this,i=function(i,r){return _Ewa.ev.b(t.a.d().a(),n,_Ewa.o.a(i,t.l),r,null,null)},r=this;_Ewa.T.a(this.a.h(),i,function(n){return new _Ewa.I(112,0,n,16,null)},null);return}},S:function(n){var t,i;if(Diag.a.a(591005634,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane"),this.d(),!n||!n.length){Diag.a.a(593282251,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane");return}if(t=JSON.parse(n),!t){Diag.a.a(593282250,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");return}if(!(t.domainId!=null)){Diag.a.a(593282249,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");return}i={};i.Id=t.domainId;i.StringId=t.stringId;this.n.r(i)},K:function(){(this.e||this.c)&&(this.a.a(837)&&this.h!==1||this.r(!1))},Q:function(){Diag.a.a(39081763,0,15,"Session ID changed while ambiguous linked entities are present")},r:function(n){this.F(n)},D:function(){var n,t;if(Diag.a.a(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted"),n=this.u(),n){t=null;this.a.a(837)&&(t=1);var i=this,r=function(r,u){return _Ewa.ev.a(i.a.d().a(),n,!0,_Ewa.o.a(r,i.w),u,t,null)},u=this;_Ewa.T.a(this.a.h(),r,function(n){return new _Ewa.I(113,0,n,16,null)},null)}},E:function(n,t){var i=null;this.a.a(837)&&(i=2);var r=this,u=function(u,f){return _Ewa.ev.e(r.a.d().a(),n,t,_Ewa.o.a(u,r.j),f,i,null)},f=this;_Ewa.T.a(this.a.h(),u,function(n){return new _Ewa.I(233,0,n,16,null)},null)},H:function(n){var t,i,u,r;if(_Ewa.h.c(n.Errors)){t=_Ewa.h.a(n.Errors,",");_Ewa.e.c(t,"OperationSucceededWithAlert",!1)?Diag.a.a(38541457,0,50,"Convert to Linked Entity failed with an alert"):Diag.a.a(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",t);return}n.Result&&(!n.WorkbookMetadataResult.Metadata&&this.q&&(i=_Ewa.l.b(_Ewa.cR,this.a.b(),5,4,-2),u=this,_Ewa.f.cw(i,function(){i.a().h()},this.a.i(),3)),this.a.c().h(this.i),this.a.c().g(this.i),r=n.Result,this.f=r.SkydanceFeatureBitmask,this.t(r))},O:function(){(this.e||this.c)&&this.r(!1)},J:function(n,t){var i,r;if(_Ewa.h.c(n.Errors)){Diag.a.a(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",_Ewa.h.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552074,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null");return}this.z(t);this.f=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;Diag.a.a(591005633,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane");this.s(r)}return},I:function(n,t){var i,r;if(_Ewa.h.c(n.Errors)){Diag.a.a(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",_Ewa.h.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552075,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null");return}this.z(t);this.f=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;Diag.a.a(591005632,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane");this.s(r)}return},z:function(n){if(n&&this.a.a(837)){var t=n;t&&t!==this.h&&(Diag.a.a(591005603,0,50,"ConvertToLinkedEntityDisambiguationPane:SetPaneViewType: Calling CloseDisambiguationPane"),this.d());this.h=t}},s:function(n){if(this.c)this.g.a(n,null);else{var t=3;this.f!=null?t=this.f:Diag.a.b(40511299,0,!1,"SkydanceFeatureBitmask was not set");this.g.d(this.p,this.C(n,t),null);this.c=!0}return},d:function(){this.c&&(Diag.a.a(591005602,0,50,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.g.c(),this.c=!1,this.h=0);return},L:function(n){if(_Ewa.h.c(n.Errors)){Diag.a.a(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",_Ewa.h.a(n.Errors,","));this.e=!0;return}if(n.Result){var t=n.Result;this.f=t.SkydanceFeatureBitmask;this.t(t)}return},t:function(n){var t=n.Row+1,i=n.Column+1,u=n.DisambiguationJson,r;if(t<0||i<0){Diag.a.a(591005601,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane");this.d();this.a.c().h(this.i);return}r=new _Ewa.n(t,i,t,i,!0,!1);this.b.a().f(r,r,60,0,!0,"",!1,!0,!0);this.e=!0;Diag.a.a(591005600,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling LaunchOrUpdateDisambiguationPane");this.s(u)},C:function(n,t){var i=new Common.App.Enrichment.e,f,r,u;return i.applicationVersion=Common.a.p,i.applicationName="ExcelWac",f="00000000-0000-0000-0000-000000000000",i.anid=f,i.sessionId=Common.a.l,i.appCorrelationId=Common.A.a().a,r=Common.d.b(Common.a.m),u=r?r.a:null,i.uiLanguage=u,i.market=this.B(u),i.themeId=0,i.disambiguationJson=n,t<=2147483647?i.featuresBitMask=t:Diag.a.a(40511300,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties"),i},B:function(n){var t=n.split("-");return t[t.length-1]},F:function(n){var f=this.a.j(),t,r,i;if(!f||!this.u()){Diag.a.a(591005599,0,50,"ConvertToLinkedEntityDisambiguationPane:LaunchOrCloseDisambiguationPane: Calling CloseDisambiguationPane, items null");this.d();return}if(t=this.b.a().c(),_Ewa.b.a(this.a).f().l(t)){if(this.o&&!n)return;n&&(this.e=!0);r=_Ewa.g.c(t,this.a);i=null;this.a.a(837)&&(i=1);var u=this,e=function(n,t){return _Ewa.ev.a(u.a.d().a(),r,!1,_Ewa.o.a(n,u.j),t,i,null)},o=this;_Ewa.T.a(this.a.h(),e,function(n){return new _Ewa.I(114,0,n,16,null)},null)}else this.d();return},P:function(n){if(_Ewa.h.c(n.Errors)&&Diag.a.a(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",_Ewa.h.a(n.Errors,",")),n.Result){var t=n.Result;this.t(t)}else this.d();return},N:function(n){if(_Ewa.h.c(n.Errors)){Diag.a.a(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",_Ewa.h.a(n.Errors,","));return}if(n.Result){var t=n.Result;this.g.a(t,null)}else Diag.a.a(591005598,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.d();return},u:function(){var n=this.b.a();return(this.a.a(460)?n.d().e():n.a().j())?_Ewa.g.c(n.c(),this.a):null}};_Ewa.fV=function(n,t,i,r){this.bz=Function.createDelegate(this,this.ce);this.bA=Function.createDelegate(this,this.cf);this.bw=Function.createDelegate(this,this.bW);this.bx=Function.createDelegate(this,this.bX);this.be=Function.createDelegate(this,this.bO);this.by=Function.createDelegate(this,this.cc);this.bn=Function.createDelegate(this,this.ca);this.bo=Function.createDelegate(this,this.cb);this.bB=Function.createDelegate(this,this.cg);this.bm=Function.createDelegate(this,this.bY);this.bf=Function.createDelegate(this,this.bZ);this.bq=Function.createDelegate(this,this.ch);this.bp=Function.createDelegate(this,this.cd);this.N=new Array(12);this.I=n;this.P=[];this.K=_Ewa.b.a(this.I);this.ba=-1;this.Z=this.I.a(170);this.W=this.I.a(681);this.bj=this.I.isChangeGateEnabled("OfficeVSO:4209762_DetailedDataTypeRibbonTooltip");this.L=new($$sc.v.$$(_Ewa.Av));this.bt=this.I.n()+"Ribbon.Data.LinkedEntity";this.Y=new _Ewa.Ec(t,this,this.bj);i&&(this.J=new _Ewa.Eb(n,i,r,this,this));this.Z?(this.I.c().E(this.bp),_Ewa.cM.a(this.I)&&_Ewa.cM.a(this.I).q(this),this.bD()):n.b().b(_Ewa.ew,271,this);this.I.a(579)&&this.I.c().r(this.bq);this.I.a(168)&&this.I.a(178)&&(this.bL()||this.K.v(this.bf));this.W&&this.I.R(this.bm)};_Ewa.fV.b=function(n,t,i){var r=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"><\/span>',n,_Ewa.q.a(11),i),u=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',t);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',r,u)};_Ewa.fV.a=function(n){return n.StringId?n.Id.toString()+"."+n.StringId:n.Id.toString()};_Ewa.fV.prototype={I:null,Y:null,bj:!1,Z:!1,bb:null,bk:0,W:!1,X:null,P:null,J:null,bi:null,V:null,M:0,K:null,U:null,bh:null,ba:0,O:8,bt:null,S:null,T:null,bR:function(){return _Ewa.e.a(this.bh)&&(this.bh=_Ewa.ClientStringManager.a().a(1524)),this.bh},L:null,R:null,bg:0,bC:5,bc:3e4,bv:!1,Q:null,bd:null,dispose:function(){this.I.a(579)&&this.I.c().v(this.bq);!this.Q&&this.I.a(168)&&this.I.a(178)&&this.K.x(this.bf);this.J&&this.J.dispose();this.W&&this.I.S(this.bm);this.Z&&this.I.c().K(this.bp);System.a.a(this.R)},m:function(n){return this.J?this.J.T(n):!1},k:function(n,t){this.J&&this.J.R(n,t)},i:function(n){return this.J?this.J.G(n):!1},j:function(){this.J&&this.J.M()},h:function(){this.J&&this.J.A()},l:function(n){this.J&&this.J.S(n)},ch:function(){this.cm()},b:function(){return this.N.length},s:function(n){var t=this.bP(n);if(!t){Diag.a.a(593241931,0,10,"Could not convert key into domain ID");return}this.r(t)},r:function(n){var f,i,e,t;if(Diag.a.a(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",n.Id),!this.K){Diag.a.b(34415005,0,!1,"grid view should not be null");return}this.ck(n);var r=this.K.a().a(),o=this.K.N(),u=r.m(o);if(u){if(f=this.K.f().y(u),f){if(Diag.a.a(42467672,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range"),_Ewa.A.a().j()&&this.I.a(549)){if(_Ewa.r.a())i="[data-unique-id=LinkedEntity]";else if(i=document.getElementById(this.bt),!i){Diag.a.b(42467673,0,!1,"Could not get multi-line ribbon anchor DOM element for the linked entity blank cell convert teaching callout.");return}e=new _Ewa.Q(-847286761,_Ewa.E.a,this.I.s(),0,"Help");t={InputMethod:_Ewa.E.a};t.CalloutType=1;t.Target=i;t.RibbonButtonLabel=this.e(n.Id.toString());t.ExampleEntities=this.bQ(n);t.BlankCellResourceId=this.bN(n);t.HasBlankCellWalkthrough=this.bT(n);this.I.g().b(e,t,null);return}Diag.a.a(42764317,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.c(n,!1,r)}},cg:function(){var n=this;this.I.b().c(_Ewa.cF,211,function(n){n.a(_Ewa.ClientStringManager.a().a(1537))})},t:function(){this.Q&&this.Q.u()},B:function(){var n=this,t=function(t,i){return _Ewa.ev.j(n.I.d().a(),n.I.j().c(),t,i,null,null)},i=this;_Ewa.T.a(this.I.h(),t,function(n){return new _Ewa.bh(230,0,n,16,null)},null)},c:function(n,t,i){var u=_Ewa.g.d(i,this.I),r=this,f=function(i,f){return _Ewa.ev.d(r.I.d().a(),u,n,t,_Ewa.o.a(i,r.bB,r.J.v),f,null,null)},e=this;_Ewa.T.a(this.I.h(),f,function(n){return new _Ewa.I(115,0,n,0,null)},null)},q:function(){if(Diag.a.a(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted"),!this.K){Diag.a.b(34719502,0,!1,"grid view should not be null");return}var n=_Ewa.g.d(this.K.a().a(),this.I),t=this,i=function(i,r){return _Ewa.ev.c(t.I.d().a(),n,i,r,null,null)},r=this;_Ewa.T.a(this.I.h(),i,function(n){return new _Ewa.I(116,0,n,0,null)},null)},g:function(){var n;if(Diag.a.a(36234048,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntities() - refresh attempted"),n=_Ewa.b.a(this.I),!n){Diag.a.b(36234049,0,!1,"grid view should not be null");return}this.I.k()||Diag.a.a(591528644,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntities(): Refreshing selection during view mode");var t=_Ewa.g.c(n.a().c(),this.I),i=this,r=function(n,r){return _Ewa.ev.k(i.I.d().a(),t,n,r,null,null)},u=this;_Ewa.T.a(this.I.h(),r,function(n){return new _Ewa.I(117,0,n,16,null)},null)},G:function(){return this.bK(this.S)},F:function(){return this.bK(this.T)},bK:function(n){try{if(this.M===2&&n)return!this.bs(parseInt(n))}catch(t){Diag.a.a(595068756,0,10,"ConvertToLinkedEntityManager:ShouldHideRibbonDOMElement - Unable to parse domain ID: "+n)}return!0},D:function(n){return this.M!==2||!this.N[n]},E:function(){var n,t,i;if(this.W)return Diag.a.a(592213150,0,10,"Unexpectedly calling ShouldHideFlyout for new gallery design"),!1;if(!this.L)return!0;if(this.bd!=null)return this.bd;for(n=0,t=this.L.$$ge();t.$$mn();)i=t.$$cu(),i.a.DomainBlocked||++n;return this.bd=n<=2,this.bd},z:function(){this.J&&this.J.D()},C:function(n,t,i){if(t!=="PopulateConvertToLinkedEntityMenu")return!1;if(this.bi=i.MenuId,!this.M||this.M===3)return this.ci(),!0;if(this.W)if(this.X){if(this.L)return _Ewa.r.a()?(this.U=this.U||this.Y.d(this.X,i.MenuId,this.I.a(837)),i.MenuItems=this.U,!0):(this.V=this.V||this.Y.b(this.X,i.MenuId,this.I.a(837)),i.PopulationXML=this.V,!0);Diag.a.a(593264904,0,10,"PopulateMenu: Encountered null domain collection")}else Diag.a.a(593264905,0,10,"PopulateMenu: Encountered null ribbon section info");return _Ewa.r.a()?(this.U=this.U||this.Y.c(this.P,i.MenuId),i.MenuItems=this.U):(this.V=this.V||this.Y.a(this.P,i.MenuId),i.PopulationXML=this.V),!0},ci:function(){if(this.ba===-1){this.f();var n=this;this.ba=window.setInterval(function(){n.f()},2e3)}},f:function(){if(this.I.c().a()&&this.M!==2){this.O--;Diag.a.a(593590104,0,100,"ConvertToLinkedEntityManager.PopulateDomainData - handshakeRetriesRemaining = {0}",this.O);Diag.a.a(34415006,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.M=1;this.W?_Ewa.ev.f(this.I.d().a(),this.bo,this.bn,null,null):_Ewa.ev.g(this.I.d().a(),this.bo,this.bn,null,null);return}},bV:function(){return this.I.k()&&this.M!==2&&this.O>=0},bM:function(){_Ewa.cM.a(this.I).s();this.I.A()},cj:function(){this.bk=0;this.O=8;this.ba=0;this.M=0;this.X=null;this.P=null;this.br();for(var n=0;n<this.N.length;++n)this.N[n]=null;_Ewa.r.k(this.I)&&this.bI()&&this.bM()},cd:function(){this.I.k()?this.bD():this.cj()},br:function(){this.U=null;this.V=null},bI:function(){var t=_Ewa.r.a()?"Data":this.I.n()+"Ribbon.Data",n=_Ewa.cM.a(this.I);return!!n&&n.a().a()===t},cb:function(n){var s,u,h,i,f,r,t,o;if(Diag.a.a(591933471,0,100,"OnGetLinkedEntityServiceDomainsSuccess - hasResult? = {0}",!!n.Result),this.br(),n.Result){if(this.W?(f=n.Result,i=f.DomainDataArray,this.X=f.Ribbon):i=n.Result,this.M=2,r=!1,i){Diag.a.a(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",i.length);this.P||(this.P=[]);for(var a=_Ewa.ClientStringManager.a().a(1524),v=_Ewa.ClientStringManager.a().a(1526),c=this.I.isChangeGateEnabled("OfficeVSO:4149555_DataDomainLocString"),l=i,y=l.length,e=0;e<y;++e){if(t=l[e],!t.DomainId){Diag.a.a(593291469,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.");continue}if(this.P.push(t),t.DomainBlocked){o=!!t.DomainId.StringId;Diag.a.a(595068755,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",o?t.DomainId.Id.toString():t.Name,o);continue}this.L.b(_Ewa.fV.a(t.DomainId),t);t.Name===a||c&&t.DomainId.Id===268435456?this.S=t.DomainId.Id.toString():(t.Name===v||c&&t.DomainId.Id===536870912)&&(this.T=t.DomainId.Id.toString());r=!0}}r||(this.P=null);this.cn();Diag.a.a(593590103,0,100,"OnGetLinkedEntityServiceDomainsSuccess: atLeastOneDisplayableDomain = {0}",r.toString())}else this.P=null,this.M=3,s=this.Z?-1:0,this.O>s&&(u=0,this.Z&&(u=100*(8-this.O)),h=this,window.setTimeout(function(){h.f()},u)),Diag.a.a(39949272,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.bu();this.bv||(this.cl(),this.bv=!0)},ca:function(n){var t=_Ewa.W.a(n.b);Diag.a.a(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",_Ewa.h.a(t,","));this.P=null;this.M=3;this.Z&&(this.O=-1);this.bu()},cn:function(){var n,e,u,t;if(this.X){n=0;for(var f=this.X.Categories,s=f.length,i=0;i<s;++i){e=f[i];for(var o=e.DomainIds,h=o.length,r=0;r<h;++r)if(u=o[r],t=this.a(u),t&&!t.DomainBlocked&&t.ShowInRibbon&&(this.N[n]=u,++n,n>=this.N.length))break;if(n>=this.N.length)break}while(n<this.N.length)this.N[n]=null,++n}},bZ:function(){this.bL()&&this.K.x(this.bf)},ck:function(n){if(this.J){var t=this.a(n).Name===this.bR();this.J.q=t}},bL:function(){var n=$$as(_Ewa.hs,_Ewa.b.a(this.I).b()),i=!!n&&n.F(),r=this.K.a().e(),t;return i&&r===1&&this.K.a().c()?(t=_Ewa.l.a(_Ewa.da,this.I.b(),12,this.I.i(),1),this.Q=new _Ewa.BB(this.I,t.a(),this),!0):!1},y:function(n){this.J&&this.J.r(n)},A:function(n){var t,i;if(this.J){if(t=this.bE(n),!t){Diag.a.a(593097799,0,10,"Unknown domain used when launching Data Type Selector pane");return}if(t.DomainId.StringId){Diag.a.a(593097798,0,10,"Domain with a string ID used when launching Data Type Selector pane");return}i=this.I.a(460)?_Ewa.g.e(this.K.a().d().a(),this.I):_Ewa.g.d(this.K.a().a(),this.I);this.J.E(i,t.DomainId.Id)}},o:function(){return this.p(this.S)},n:function(){return this.p(this.T)},p:function(n){var t=this.bU(n),i=this.e(n),r=this.H(n);return _Ewa.fV.b(t,i,r)},H:function(n){try{return this.bs(parseInt(n)).Description}catch(t){}return _Ewa.ClientStringManager.a().a(1521)},e:function(n){try{return this.bs(parseInt(n)).Name}catch(t){}return _Ewa.ClientStringManager.a().a(1513)},bN:function(n){try{return this.a(n).BlankCellResourceId}catch(t){}return null},bT:function(n){try{return this.a(n).HasBlankCellWalkthrough}catch(t){}return!1},w:function(n){return n===this.S?"ewadata_StockLinkedEntity16":n===this.T?"ewadata_GeographyLinkedEntity16":"ewadata_ConvertToEntityIcon16"},x:function(n){return this.Q?this.Q.y(n,!1):!1},u:function(){return this.Q?this.Q.z():""},v:function(n,t){var u=this.bG(n),r,i;if(u<0){Diag.a.a(592843911,0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",n);return}(r=this.bF(n),i=r?this.a(r):null,i)&&(_Ewa.r.a()?t[CommandUI.Controls.a.GalleryButtonProps]=this.Y.f(u,i):t[CommandUI.Controls.a.InnerHTML]=this.Y.e(i),t.Alt=this.bj?i.RibbonTooltip:i.Description)},bU:function(n){return n===this.S?"ewadata_StockLinkedEntity32":n===this.T?"ewadata_GeographyLinkedEntity32":"ewadata_ConvertToEntityIcon32"},bQ:function(n){try{return this.a(n).ExampleEntities}catch(t){}return _Ewa.ClientStringManager.a().a(1528)},bu:function(){this.O<0&&Diag.a.a(37089859,0,10,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(this.M===2||this.O<0)&&window.clearInterval(this.ba);_Ewa.r.k(this.I)&&this.bI()&&!this.bV()?this.bM():this.bi&&this.I.v().w(this.bi)},a:function(n){var t=_Ewa.fV.a(n);return this.L.c(t)?this.L.a(t):(Diag.a.a(592729218,0,10,"No domain data for domain ID {0} (Has String ID: {1})",n.Id,!!n.StringId),null)},d:function(n,t){var i,r;return t?(i="ConvertToLinkedEntityPreview",i+n.toString()):(r="Data.LinkedEntityPreview.",this.I.n()+r+n.toString()+"-Large")},bP:function(n){var t,i,r;return this.I.a(681)&&(t=this.bF(n),t)?t:(i=this.bE(n),i)?i.DomainId:this.I.a(681)?(Diag.a.a(592843910,0,10,"Could not convert key into domain: {0}",n),null):(r=this.bS(n),!r)?(Diag.a.a(593241929,0,10,"Could not convert key into domain using fallback logic, Key: {0}",n),null):(t={},t.Id=r,t.StringId=null,t)},bS:function(n){var t=parseInt(n),i,r;return t>0?t:(Diag.a.a(593241928,0,50,"Checking for specific domains, Key: {0}",n),i=_Ewa.ClientStringManager.a().a(1525),r=_Ewa.ClientStringManager.a().a(1526),n===this.T||n===this.S)?parseInt(n):this.bJ(n,i,"Stock")?parseInt(this.S):this.bJ(n,r,"Geography")?parseInt(this.T):t},bs:function(n){var t={};return t.Id=n,this.a(t)},bE:function(n){return this.L.c(n)?this.L.a(n):null},bG:function(n){if(!n.startsWith("PreviewGalleryButtonIndex."))return-1;var t=parseInt(n.substr(26));return isNaN(t)?(Diag.a.a(592843909,0,10,"Unexpected index in preview gallery button key: {0}",n),-1):t},bF:function(n){var t=this.bG(n);return t<0?null:this.N[t]},bY:function(){this.br()},bH:function(n,t,i){if(this.I.a(579)&&this.L&&this.L.e){Diag.a.a(51659660,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",n);var r=this.I.d().a().b(!1);this.I.c().a()&&_Ewa.ev.h(this.I.d().a(),_Ewa.o.a(this.by,t),i,r,null)}},cc:function(n){if(_Ewa.S.a(n)){Diag.a.a(591147843,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.h.a(n.Errors,","));this.I.c().n(n.Errors);return}},cl:function(){this.bH("Auto-refresh on load",null,null)},cm:function(){if(this.I.a(579)&&this.L&&this.L.e){if(this.R){Diag.a.a(51659661,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one");return}var n=this.I.c().t().HasAutoRefreshableLinkedEntityDomainsEver;if(!n){Diag.a.a(51659662,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created");return}Diag.a.a(51659663,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context");this.R=_Ewa.y.a().a(this.be,this.bc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)}},bO:function(){Diag.a.a(51659664,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",this.bc);this.bH("Periodic auto-refresh check",this.bx,this.bw)},bX:function(n){if(_Ewa.S.a(n)?(Diag.a.a(51659665,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.h.a(n.Errors,",")),++this.bg):this.bg=0,System.a.a(this.R),this.bg>=this.bC){Diag.a.a(51659666,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh");this.R=null;return}Diag.a.a(51659667,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext");this.R=_Ewa.y.a().a(this.be,this.bc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},bW:function(n){var t=_Ewa.W.a(n.b);!t||!t.length?Diag.a.a(51659669,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):Diag.a.a(51659668,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",_Ewa.h.a(t,","));System.a.a(this.R);this.R=_Ewa.y.a().a(this.be,this.bc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},bJ:function(n,t,i){return _Ewa.e.c(n,t,!0)||this.I.isChangeGateEnabled("OfficeVSO:4168494_RemoveStaticButtons")&&_Ewa.e.c(n,i,!0)},cf:function(n){var t=!!n.Result&&n.Result;Diag.a.a(591958236,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",t.toString());t?this.f():this.bl()},ce:function(){Diag.a.a(591958235,0,15,"OnNotifyFeatureLicensingStatusFailed");this.bl()},bl:function(){if(this.I.c().a()&&this.bb!=null)if(++this.bk,this.bk<=8){var n=this.I.d().a().b(!1);_Ewa.i.J(this.I.d().a(),"ExcelAdvancedAnalytics",this.bb,this.bA,this.bz,n)}else Diag.a.a(591958231,0,50,"StartLinkedEntityDelayedHandshake - Retry count expired"),this.O=-1,this.bu()},bD:function(){if(this.I.k()){if(this.bb!=null){this.bl();return}var t=_Ewa.w.a().b().m,n=this;Common.Utils.a.a().c(Common.App.ApplicationFeatureHelper.a).a(function(i){i.a("ExcelAdvancedAnalytics",!1).then(function(i){var r=_Ewa.w.a().b().m;return Diag.a.a(591958230,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelAdvancedAnalytics",r-t),Diag.a.a(591958229,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelAdvancedAnalytics",i),!i&&n.I.a(678)?(Diag.a.a(591541911,0,100,"CheckE5LicensingAndStartDelayedHandshake: Using override for {0}","ExcelAdvancedAnalytics"),n.bb=!0):n.bb=i,Diag.a.a(591958228,0,100,"CheckE5LicensingAndStartDelayedHandshake - licensing status is being sent to server."),n.bl(),null})})}}};_Ewa.tb=function(n){_Ewa.tb.initializeBase(this);this.h=n;this.k()};_Ewa.tb.a=function(n){n.b().b(_Ewa.bbW.$$(_Ewa.ew),272,new _Ewa.tb(n))};_Ewa.tb.prototype={h:null,b:function(){var n=_Ewa.l.a(_Ewa.dv,this.h.b(),102,this.h.i(),this.i),t;if(this.h.C())t=this,_Ewa.f.cw(_Ewa.f.ws([n],this.dH(),3),function(){t.j(t.h.b().a(_Ewa.ew,271,!1)||new _Ewa.fV(t.h,n.a(),null,null))},this.h.i(),3);else{var r=_Ewa.l.b(_Ewa.pk,this.h.b(),257,258,this.i),u=_Ewa.ck.a(this.h),i=this;_Ewa.f.cw(_Ewa.f.ws([n,r,u],this.dH(),3),function(){i.j(i.h.b().a(_Ewa.ew,271,!1)||new _Ewa.fV(i.h,n.a(),r.a(),u.a()))},this.h.i(),3)}}};_Ewa.Ec=function(n,t,i){this.j=i;this.g=n;this.h=t};_Ewa.Ec.prototype={k:2,i:"Size64by48",g:null,h:null,j:!1,c:function(n,t){var i=this.s(n,t);return i.b()},s:function(n,t){var r=this.g.c(t),u,f,i;if(n&&n.length>0){u=this.g.b();r.a().push(u);f=this.g.f("ConvertToLinkedEntitySeeMore",this.k,this.i,null);for(var o=n,h=o.length,e=0;e<h;++e)if((i=o[e],!i.DomainId.StringId)&&!i.DomainBlocked){var s=i.DomainId.Id.toString(),c=this.m(i.Name,!1),l=i.Name;f.c(0,"Data.ConvertToLinkedEntityMenuItem_"+s,-1203788282,"QueryLinkedEntityGalleryIcon",i.Description,s,c,null,null,null)}Array.add(u.a(),f)}return r.a().length||Diag.a.a(34415008,0,15,"No domain data available"),r},d:function(n,t,i){var a,f,y,s,u,e,l,r,w;this.o(!0);a=this.g.c(t);f=a.b();for(var v=n.Categories,b=v.length,o=0;o<b;++o)y=v[o],s=this.u(y),s&&Array.add(f.MenuSectionList,s);if(i){for(var k=this.g.b(),h=k.d(),d=_Ewa.q.a(11),p=n.LongButtons,g=p.length,c=0;c<g;++c)(u=p[c],e=this.h.a(u.DomainId),e&&!e.DomainBlocked&&e.ShowInRibbon)&&(l="Data.ConvertToLinkedEntityMenuItem_"+u.Name,w=(r=new Common.ca,r.Id=l,r.ExternalId=l,r.Command="-1662108744",r.LabelText=u.Name,r.Alt=u.SuperTip,r.Visible=!0,r.MenuItemId=_Ewa.fV.a(u.DomainId),r.Image16by16=d,r.Image16by16Class=this.l(u.DomainId,!0),r),Array.add(h.ControlList,w));h.ControlList.length>0&&Array.add(f.MenuSectionList,h)}return f},e:function(n){return _Ewa.fV.b(this.l(n.DomainId,!1),n.Name,n.Description)},f:function(n,t){var r=24,u={width:r,"min-width":r,height:r},i;return i=new Common.dL,i.Id="ConvertToLinkedEntityPreview"+n.toString(),i.ExternalId="ConvertToLinkedEntityPreview"+n.toString(),i.MenuItemId="PreviewGalleryButtonIndex."+n.toString(),i.Command="-1203788282",i.QueryCommand="QueryLinkedEntityGalleryButtons",i.Icon=this.m(t.Name,!0),i.LabelText=t.Name,i.PreviewIconStyle={root:u},i.Alt=this.j?t.RibbonTooltip:t.Description,i},u:function(n){for(var r,t,c,u,f,e=this.g.f("ConvertToLinkedEntity"+n.Name,this.k,this.i,null),o=!1,s=n.DomainIds,l=s.length,i=0;i<l;++i)if(r=s[i],t=this.h.a(r),t&&!t.DomainBlocked&&t.ShowInRibbon){var a=this.m(t.Name,!0),v=t.Name,h=_Ewa.fV.a(r);e.a("Data.ConvertToLinkedEntityMenuItem_"+h,-1203788282,"QueryLinkedEntityGalleryIcon",0,h,a,null,null,this.j?t.RibbonTooltip:t.Description,v);o=!0}return o?(c=e.b(!0),u=this.g.b(),u.c(n.Name),f=u.d(),Array.add(f.ControlList,c),f):null},m:function(n,t){return n==="Stocks"?"Bank_32":n==="Geography"?"OpenMap_32":t?"ConvertToEntity_20":"ConvertToEntity_32"},a:function(n,t){var u=[],i,e,o,s,h;if(n)for(var f=n,c=f.length,r=0;r<c;++r)(i=f[r],i.DomainId.StringId)||i.DomainBlocked||(e=i.DomainId.Id.toString(),o=i.Name,Array.add(u,this.p(o,"-1203788282","QueryLinkedEntityMenuGalleryButtons",e)));return s=this.r(t,[Common.w.g("ConvertToLinkedEntitySeeMore",this.i,this.k.toString(),u)],!1),h=[s],Common.w.c(h)},b:function(n,t,i){var f,u,v,h,e,y,r,o,l,w,b,k;this.o(!1);f=[];u=0;for(var a=n.Categories,d=a.length,s=0;s<d;++s)v=a[s],h=this.v(t,u,v),h&&(f.push(h),++u);if(i){e=[];y=_Ewa.q.a(11);for(var p=n.LongButtons,g=p.length,c=0;c<g;++c)(r=p[c],o=this.h.a(r.DomainId),o&&!o.DomainBlocked&&o.ShowInRibbon)&&(l=_Ewa.fV.a(r.DomainId),w=this.t("Data.ConvertToLinkedEntityMenuItem_"+l,"-1662108744","QueryLinkedEntityMenuGalleryButtonsRedesign",l,r.Name,y,this.l(r.DomainId,!0),r.SuperTip),Array.add(e,w));e.length>0&&(b=Common.w.d("ConvertToLinkedEntitySection_"+u.toString(),e),k=Common.w.b(t+u.toString(),b,null,null,null,null,null),f.push(k))}return Common.w.c(f)},q:function(n,t,i,r,u,f,e,o){var s=this.j?this.n(o):o,h=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"><\/span>',e,f,s),c=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',u),l=String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',h,c);return String.format('<GalleryButton InnerHTML="{0}" Id="{1}" Command="{2}" QueryCommand="{3}" MenuItemId="{4}" ElementDimensions="{5}" Alt="{6}"/>',Common.e.b(l),n,t,i,r,this.i,s)},l:function(n,t){return n.Id===268435456?t?(Diag.a.a(592512260,0,10,"Unexpectedly trying to request the 16x16 icon for Stocks"),"ewadata_ConvertToEntityIcon16"):"ewadata_StockLinkedEntity32":n.Id===536870912?t?(Diag.a.a(592512259,0,10,"Unexpectedly trying to request the 16x16 icon for Geography"),"ewadata_ConvertToEntityIcon16"):"ewadata_GeographyLinkedEntity32":t?"ewadata_ConvertToEntityIcon16":"ewadata_ConvertToEntityIcon32"},v:function(n,t,i){for(var u,r,h,c,f=[],l=_Ewa.q.a(11),o=i.DomainIds,a=o.length,e=0;e<a;++e)if(u=o[e],r=this.h.a(u),r&&!r.DomainBlocked&&r.ShowInRibbon){var v=this.l(u,!1),s=_Ewa.fV.a(u),y=this.q("Data.ConvertToLinkedEntityMenuItem_"+s,"-1203788282","QueryLinkedEntityMenuGalleryButtonsRedesign",s,r.Name,l,v,this.j?r.RibbonTooltip:r.Description);Array.add(f,y)}return f.length?(h=Common.w.g("ConvertToLinkedEntitySection_"+t.toString(),this.i,this.k.toString(),f),c=Common.w.b(n+t.toString(),h,null,i.Name,null,null,null),c):null},t:function(n,t,i,r,u,f,e,o){return Common.w.e(n,t,u,f,e,r,null,this.j?this.n(o):o,null,null,i,null,null,null,!0,null,null,null,null,null,null,null)},r:function(n,t,i){return Common.w.b(n,i?Common.w.d(null,t):t[0],null,null,null,null,null)},p:function(n,t,i,r){return String.format('<GalleryButton InnerHTML="" Id="{0}" Command="{1}" QueryCommand="{2}" MenuItemId="{3}" ElementDimensions="{4}"/>',n,t,i,r,this.i)},o:function(n){var i,t,r;if(n)this.k=5;else{for(i=this.h.b(),t=i-1;t>=5;--t)if(r=this.h.d(t,n),_Ewa.j.X(r))break;this.k=t+1}n&&(this.i="Size112by64")},n:function(n){return n.replace(new RegExp("\\n","g"),"&#010;")}};_Ewa.ev=function(){};_Ewa.ev.d=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.selectedRanges=t,s.domainId=i,s.autodetect=r,_Ewa.i.a(n,"ConvertToLinkedEntity",s,u,f,e,4,null)};_Ewa.ev.j=function(n,t,i,r,u,f){var e=n.a(1,f);return e.sheetName=t,_Ewa.i.a(n,"OnAutoDetectUIShown",e,i,r,u,4,null)};_Ewa.ev.g=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.i.a(n,"GetLinkedEntityServiceDomains",f,t,i,r,4,null)};_Ewa.ev.f=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.i.a(n,"GetLinkedEntityMetadata",f,t,i,r,4,null)};_Ewa.ev.c=function(n,t,i,r,u,f){var e=n.a(1,f);return e.selectedRanges=t,_Ewa.i.a(n,"ConvertLinkedEntityToText",e,i,r,u,4,null)};_Ewa.ev.k=function(n,t,i,r,u,f){var e=n.a(1,f);return e.activeCell=t,_Ewa.i.a(n,"RefreshLinkedEntities",e,i,r,u,4,null)};_Ewa.ev.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isChangeObject=i,_Ewa.i.a(n,"GetLinkedEntityDisambiguationData",o,r,u,f,4,null)};_Ewa.ev.m=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.activeCell=t,o.selectionIndex=i,_Ewa.i.a(n,"SelectLinkedEntityForDisambiguation",o,r,u,f,4,null)};_Ewa.ev.l=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.searchQuery=i,_Ewa.i.a(n,"SearchLinkedEntity",o,r,u,f,4,null)};_Ewa.ev.i=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isBackward=i,_Ewa.i.a(n,"MoveToNextAmbiguousLinkedEntity",o,r,u,f,4,null)};_Ewa.ev.b=function(n,t,i,r,u,f){var e=n.a(9,f);return e.activeCell=t,_Ewa.i.a(n,"CancelSearchLinkedEntity",e,i,r,u,4,null)};_Ewa.ev.e=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.selectedRanges=t,o.letyDomainId=i,_Ewa.i.a(n,"GetDataTypeSelectorData",o,r,u,f,4,null)};_Ewa.ev.h=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.i.a(n,"LinkedEntityTryAutoRefresh",f,t,i,r,0,null)};_Ewa.Ee=function(n){_Ewa.Ee.initializeBase(this,[n])};_Ewa.Ee.prototype={dispose:function(){Common.App.Enrichment.g.prototype.dispose.call(this)}};_Ewa.ms=function(n,t,i){this.m=Function.createDelegate(this,this.n);this.c=this.ct;this.d=this.cp;_Ewa.ms.initializeBase(this,[n,null]);this.i=t;this.l=i;_Ewa.bm.a(t).a(this);this.i.H(this.m)};_Ewa.ms.a=function(n,t){var u=n.n(),i=document.getElementById(u+"m_enrichmentTaskPane"),f,r,e;return i||(i=CommonUI.a.a("div",n.n()+"m_enrichmentTaskPane","cui-taskpane"),f=document.getElementById(u+"novTaskpaneBody"),f.appendChild(i)),r=n.b(),e=r.a(_Ewa.ms,257,!1)||r.b(_Ewa.ms,257,new _Ewa.ms(i,n,t)),e};_Ewa.ms.prototype={l:null,P:function(n){this.get_events().addHandler("EnrichmentTaskPaneRemoved",n)},T:function(n){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",n)},e:function(n){this.cv("EnrichmentTaskPaneOnFocus",n)},f:function(n){this.cw("EnrichmentTaskPaneOnFocus",n)},ct:function(){return _Ewa.Wg.prototype.ct.call(this)},cp:function(n){return _Ewa.Wg.prototype.cp.call(this,n),this.cn("EnrichmentTaskPaneVilibilityChanged",null),n},bv:function(){return this.ct()},be:function(){return"ETP"},a:function(){return 10},s:function(){return"ewanov_linkedrecordPane"},t:function(){return"Enrichment"},R:function(){return 300},C:function(){return this.cl()},k:!1,i:null,j:function(){},Q:function(){},g:function(){return this.k},h:function(){return this.k},r:function(){},dispose:function(){this.i&&this.i.I(this.m);this.i=null;this.l=null;_Ewa.Wg.prototype.dispose.call(this)},B:function(n,t){return t||this.cn("EnrichmentTaskPaneOnFocus",null),!t},dC:function(n){return _Ewa.a.h(this.C(),n)},cA:function(){},bJ:function(){},b:function(n){this.k=n;var t=this.l;this.cp(n);n&&t.c().length>0&&(!t.a()||t.a().a().a()!==10||t.e())&&t.d(this,!0);t.b();n||(_Ewa.b.a(this.i).B(!0,!1),this.i.A())},S:function(){return!1},n:function(){this.b(!1)}};_Ewa.tc=function(n){_Ewa.tc.initializeBase(this);this.h=n;this.k()};_Ewa.tc.a=function(n){n.b().b(_Ewa.bbW.$$(_Ewa.pk),258,new _Ewa.tc(n))};_Ewa.tc.prototype={l:null,m:null,n:function(){if(!this.l){var n=this;this.l=_Ewa.f.cw(_Ewa.ck.a(this.h),function(t){n.m=_Ewa.ms.a(n.h,t.a())},this.dH(),3)}return this.l},h:null,b:function(){var t=_Ewa.l.a(Sys.IDisposable,this.h.b(),203,this.dH(),-2),i=_Ewa.l.a(Object,this.h.b(),155,this.dH(),-2),r=this,n=this;_Ewa.f.cw(_Ewa.f.tc(_Ewa.f.ws([t,i],this.dH(),3),function(){return r.n()},this.dH()),function(){n.j(n.m)},this.dH(),3)},dispose:function(){this.h=null;this.l=null;this.m=null;_Ewa.cr.prototype.dispose.call(this)}};_Ewa.Ed=function(n){_Ewa.Ed.initializeBase(this,[Common.a.b().c(),Common.a.b().f(),Common.a.b().i(),Common.a.b().b(),Common.a.c()]);this.f=n;this.f.e(this.r)};_Ewa.Ed.prototype={f:null,z:function(){return this.f.C()},C:function(){this.f.c()||this.f.b(!0)},B:function(){this.f.b(!1)},dispose:function(){this.f&&(this.f.f(this.r),this.f=null);Common.App.Enrichment.a.prototype.dispose.call(this)}};_Ewa.BA=function(n,t,i,r){_Ewa.BA.initializeBase(this,[!1]);this.c=n;this.a=i.b(n,t,"",_Ewa.q.a(11),r,"AutoDetectPointerDown",_Ewa.ClientStringManager.a().a(1535)+"...")};_Ewa.BA.prototype={c:null,a:null,b:function(){return this.a.b()},dispose:function(){this.a.dispose();this.c=null;_Ewa.YG.prototype.dispose.call(this)},f:function(n){return this.a.c(n,!1)},h:function(n,t,i,r){this.a.l(_Ewa.ClientStringManager.a().a(1535)+" "+n,t,r,!1);this.a.k(i,t,r,!1)},e:function(n,t){var r=_Ewa.b.a(this.c),u=r.j().c(n),i=r.z(n,u,!1,!1),f=r.n(u).K(),h;if(i&&i.a.a>=0&&i.a.b>=0&&f.c()>i.c()+160){var e=i.b.a+this.b(),o=i.a.b+this.b(),s=!1;if(e+160>f.b.a&&(e=i.a.a-this.b(),s=!0),h=o<f.a.b+this.b(),h){if(r.j().m()){this.d();return}o=f.a.b+this.b()}this.a.g(t,"AutoDetectHover",u);this.g(e,o,r.d(),u,s)}else this.d()},g:function(n,t,i,r,u){this.a.a(n,t,i,r,!1,u)},d:function(){this.a.d()}};_Ewa.BB=function(n,t,i){this.n=Function.createDelegate(this,this.x);this.l=Function.createDelegate(this,this.C);this.o=Function.createDelegate(this,this.F);this.m=Function.createDelegate(this,this.D);this.h=Function.createDelegate(this,this.E);this.t=Function.createDelegate(this,this.B);this.v=Common.c.e();_Ewa.BB.initializeBase(this,[!1]);this.b=n;this.d=i;i.f();this.c=new _Ewa.BA(n,this.t,t,"");this.p=new _Ewa.BC(this.b,i);this.a=_Ewa.b.a(this.b);this.a.a().l(this.h);this.a.g().p(this.h);this.a.v(this.m);this.b.H(this.o);this.b.R(this.l);this.j=$$as(_Ewa.hs,this.a.b());this.k()};_Ewa.BB.prototype={d:null,p:null,c:null,a:null,j:null,b:null,f:-1,i:null,e:-1,g:!1,q:function(){if(this.b.k()&&this.b.a(174)&&this.b.a(178)){var n=new _Ewa.bR(this.b.f());if(n.b())return!1}return this.e!==-1},dispose:function(){if(this.a&&this.a.a().k(this.h),this.b){var n=this.b;n.I(this.o);n.S(this.l);_Ewa.b.a(n).x(this.m)}System.a.a(this.c);this.c=null;this.a=null;this.b=null;_Ewa.YG.prototype.dispose.call(this)},r:function(){this.x(null,!1);this.f=-1;this.c.d()},w:function(){this.q()&&this.f!==-1&&this.d.B()},y:function(n,t){for(var r,f,e=new _Ewa.n(n.a===1?1:n.a-1,n.b,n.d,n.c,!0,!1),o=this.a.A(e),u=o,s=u.length,i=0;i<s;++i)if(r=u[i],_Ewa.hY.isInstanceOfType(r)&&(f=r,this.s(n,t,f)))return!0;return!1},u:function(){if(this.q()&&this.f!==-1){this.c.f(1).a();var n={};n.Id=this.e;n.StringId=null;this.d.c(n,!0,this.i);Diag.a.a(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");this.e=-1}},z:function(){var n=new Sys.StringBuilder(_Ewa.ClientStringManager.a().a(1497));if(this.e!==-1){n.append(" ");try{n.append(this.d.e(this.e.toString()))}catch(t){Diag.a.a(593847515,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.e)}}return n.append(" "),n.append(_Ewa.ClientStringManager.a().a(this.v?1499:1498)),n.toString()},E:function(){this.q()&&this.a&&this.k()},F:function(){this.r()},B:function(){this.u();_Ewa.b.a(this.b).B(!0,!1)},x:function(n,t){if(t)this.G(this.i);else{var i=[29];this.a.k().a(i);this.a.k().b(null,i,!0)}},C:function(){this.A()&&this.c.d();var n=this.a.a().e();n===1&&this.k()},D:function(){var n=this.a.a().c(),t=this.a.a().e();n&&t===1&&this.k()},s:function(n,t,i){var f=new _Ewa.n(i.a,i.b,i.d===1048576?i.d:i.d+1,i.c,!0,!1),r,u;return f.h(n)?(t&&(r=i,r&&r.q!==this.f&&(this.f=r.q,u=r.q.toString(),this.c.h(this.d.e(u),this.d.H(u),this.d.w(u),1)),this.e=r.q,this.i=i),!0):!1},k:function(){var r,n;if(this.d){var f=!!this.j&&this.j.F(),e=this.b.a(460)?this.a.a().d().e():this.a.a().a().j(),o=this.a.a().e();if(!f||!e||o!==1){this.r();return}for(var t=this.a.a().c(),s=this.a.q(),h=this.a.A(s),u=h,c=u.length,i=0;i<c;++i)if(r=u[i],_Ewa.hY.isInstanceOfType(r))if(n=r,this.b.a(745))switch(n.t){case 3:if(this.s(t,!0,n)){Diag.a.a(593831632,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.c.e(t,this.n);this.g||(this.g=!0,this.w());return}break;case 2:case 1:this.p.f(n);break;default:Diag.a.a(593266063,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}else if(this.s(t,!0,n)){Diag.a.a(594612634,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.c.e(t,this.n);this.g||(this.g=!0,this.w());return}this.r()}},G:function(n){var t=[29];this.a.k().b(n,t,!0);this.a.k().c(t,null,null)},A:function(){return this.b.c().b()&&_Ewa.B.a(this.b.j())}};_Ewa.rQ=function(n,t){this.c=Function.createDelegate(this,this.f);_Ewa.rQ.initializeBase(this,[!1]);this.b=n;this.d=t;this.a=document.createElement("div");this.a.className="clip16x16";this.e=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',Common.e.b("autodetectid"+this.b.b),"ewadata_ConvertToEntityIcon16",_Ewa.q.a(11));this.a.innerHTML=this.e;var i=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");Common.i.a().a("click",i,this.c)};_Ewa.rQ.prototype={e:"",d:null,b:null,a:null,dispose:function(){if(this.a){var n=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");Common.i.a().b("click",n,this.c)}_Ewa.YG.prototype.dispose.call(this)},f:function(n){if(n.c.id===this.a.firstChild.id){var t=this.b,i={};return i.Id=t.q,this.d.c(i,!0,t),this.a.removeChild(this.a.firstChild),!0}return!1}};_Ewa.BC=function(n,t){_Ewa.BC.initializeBase(this,[!1]);this.d=n;this.b=_Ewa.b.a(n);this.c=t;this.a=new($$sc.r.$$(_Ewa.rQ))};_Ewa.BC.prototype={d:null,b:null,c:null,a:null,dispose:function(){_Ewa.YG.prototype.dispose.call(this)},f:function(n){for(var r=this.b.bg().$$ge(),u,t;r.$$mn();)for(u=r.$$cu(),t=u.$$ge();t.$$mn();){var i=t.$$cu(),e=i.b(),f=_Ewa.pf.a(i.e());this.e(n,f,e);i.k(f)}},e:function(n,t,i){var u,f,r;if(t.length&&(u=i.length,!(i[u-1]<n.b))&&(f=_Ewa.j.f(new _Ewa.dp(i),0,u,n.b,_Ewa.j.h),!(f<0))&&(r=t[f],r)){this.b.d()?Sys.UI.DomElement.addCssClass(r,"ewr-autodetect-column-rtl"):Sys.UI.DomElement.addCssClass(r,"ewr-autodetect-column-ltr");this.a.c(n.b)||this.a.d(n.b,new _Ewa.rQ(n,this.c));var e=this.a.a(n.b),o=e.a,s=r.getElementsByClassName("clip16x16");!s.length&&this.g(r)&&r.appendChild(o)}},g:function(n){var u=parseInt(n.style.width),i=this.d.b().a(_Ewa.cg,268,!1),r,t;if(!i)return Diag.a.a(593266065,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton IInstantaneousSupportInformationManager not initialized in time for rendering Auto Detect Column Header Button"),!0;if(r=i?i.b():null,!r)return Diag.a.a(593266064,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton NumberFormattingCalculator not initialized in time for rendering Auto Detect Column Header Button"),!0;t={};t.fontVariant="normal";t.fontStyle="normal";t.fontFamily='"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif';t.fontSize="10pt";t.fontWeight=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";t.lineHeight="normal";t.letterSpacing="0px";var f=r.calculateTextWidth(n.firstChild.innerHTML,t),e=u-(u/2+f/2);return e>16*.9+4?!0:!1}};_Ewa.Ea.registerClass("_Ewa.Ea",null,_Ewa.jS);_Ewa.ta.registerClass("_Ewa.ta",_Ewa.Z);_Ewa.Eb.registerClass("_Ewa.Eb",null,Sys.IDisposable);_Ewa.fV.registerClass("_Ewa.fV",null,_Ewa.ew,Common.App.Enrichment.m,Sys.IDisposable);_Ewa.tb.registerClass("_Ewa.tb",_Ewa.qm.$$(_Ewa.ew));_Ewa.Ee.registerClass("_Ewa.Ee",Common.App.Enrichment.g);_Ewa.ms.registerClass("_Ewa.ms",_Ewa.Wg,_Ewa.pk,Sys.IDisposable,_Ewa.bcg,_Ewa.vu);_Ewa.tc.registerClass("_Ewa.tc",_Ewa.qm.$$(_Ewa.pk));_Ewa.Ed.registerClass("_Ewa.Ed",Common.App.Enrichment.a);_Ewa.BA.registerClass("_Ewa.BA",_Ewa.YG);_Ewa.BB.registerClass("_Ewa.BB",_Ewa.YG);_Ewa.rQ.registerClass("_Ewa.rQ",_Ewa.YG);_Ewa.BC.registerClass("_Ewa.BC",_Ewa.YG);Type.registerNamespace("_Ewa");_Ewa.XA=function(){};_Ewa.XA.a=function(){_Ewa.k.a(function(n){_Ewa.tc.a(n);_Ewa.tb.a(n);_Ewa.ta.a(n)})};_Ewa.XA.a();